# Comparing `tmp/Pgenlib-0.83.0.tar.gz` & `tmp/Pgenlib-0.90.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "Pgenlib-0.83.0.tar", last modified: Sun Apr 23 17:46:29 2023, max compression
+gzip compressed data, was "Pgenlib-0.90.0.tar", last modified: Sun May 21 00:41:23 2023, max compression
```

## Comparing `Pgenlib-0.83.0.tar` & `Pgenlib-0.90.0.tar`

### file list

```diff
@@ -1,48 +1,173 @@
-drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-04-23 17:46:29.985729 Pgenlib-0.83.0/
--rw-r--r--   0 chrchang   (501) staff       (20)     7652 2022-06-12 20:06:17.000000 Pgenlib-0.83.0/LICENSE
--rw-r--r--   0 chrchang   (501) staff       (20)     1106 2023-04-23 17:45:53.000000 Pgenlib-0.83.0/MANIFEST.in
--rw-r--r--   0 chrchang   (501) staff       (20)     1464 2023-04-23 17:46:29.985594 Pgenlib-0.83.0/PKG-INFO
--rw-r--r--   0 chrchang   (501) staff       (20)      897 2023-04-23 17:21:35.000000 Pgenlib-0.83.0/README.md
--rw-r--r--   0 chrchang   (501) staff       (20)      143 2022-11-26 19:14:19.000000 Pgenlib-0.83.0/pyproject.toml
--rw-r--r--   0 chrchang   (501) staff       (20)       38 2023-04-23 17:46:29.985770 Pgenlib-0.83.0/setup.cfg
--rw-r--r--   0 chrchang   (501) staff       (20)     1845 2023-04-18 03:20:48.000000 Pgenlib-0.83.0/setup.py
-drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-04-23 17:46:29.967182 Pgenlib-0.83.0/src/
-drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-04-23 17:46:29.970941 Pgenlib-0.83.0/src/Pgenlib.egg-info/
--rw-r--r--   0 chrchang   (501) staff       (20)     1464 2023-04-23 17:46:29.000000 Pgenlib-0.83.0/src/Pgenlib.egg-info/PKG-INFO
--rw-r--r--   0 chrchang   (501) staff       (20)     1418 2023-04-23 17:46:29.000000 Pgenlib-0.83.0/src/Pgenlib.egg-info/SOURCES.txt
--rw-r--r--   0 chrchang   (501) staff       (20)        1 2023-04-23 17:46:29.000000 Pgenlib-0.83.0/src/Pgenlib.egg-info/dependency_links.txt
--rw-r--r--   0 chrchang   (501) staff       (20)        8 2023-04-23 17:46:29.000000 Pgenlib-0.83.0/src/Pgenlib.egg-info/top_level.txt
-drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-04-23 17:46:29.975208 Pgenlib-0.83.0/src/pgenlib/
--rw-r--r--   0 chrchang   (501) staff       (20)  2047820 2023-04-23 17:46:29.000000 Pgenlib-0.83.0/src/pgenlib/pgenlib.cpp
--rw-r--r--   0 chrchang   (501) staff       (20)   125619 2023-04-23 17:00:44.000000 Pgenlib-0.83.0/src/pgenlib/pgenlib.pyx
-drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-04-23 17:46:29.975822 Pgenlib-0.83.0/src/plink2/
-drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-04-23 17:46:29.983713 Pgenlib-0.83.0/src/plink2/include/
--rw-r--r--   0 chrchang   (501) staff       (20)     9846 2022-09-24 13:42:00.000000 Pgenlib-0.83.0/src/plink2/include/check.h
--rw-r--r--   0 chrchang   (501) staff       (20)     3119 2022-09-24 13:42:00.000000 Pgenlib-0.83.0/src/plink2/include/debug-trap.h
--rw-r--r--   0 chrchang   (501) staff       (20)    77513 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/hedley.h
--rw-r--r--   0 chrchang   (501) staff       (20)   126324 2023-04-18 02:32:01.000000 Pgenlib-0.83.0/src/plink2/include/pgenlib_misc.cc
--rw-r--r--   0 chrchang   (501) staff       (20)    45478 2023-04-23 16:10:18.000000 Pgenlib-0.83.0/src/plink2/include/pgenlib_misc.h
--rw-r--r--   0 chrchang   (501) staff       (20)   467494 2023-04-23 15:58:03.000000 Pgenlib-0.83.0/src/plink2/include/pgenlib_read.cc
--rw-r--r--   0 chrchang   (501) staff       (20)    36167 2022-12-31 18:46:00.000000 Pgenlib-0.83.0/src/plink2/include/pgenlib_read.h
--rw-r--r--   0 chrchang   (501) staff       (20)   113428 2023-04-23 16:10:07.000000 Pgenlib-0.83.0/src/plink2/include/pgenlib_write.cc
--rw-r--r--   0 chrchang   (501) staff       (20)    19411 2023-04-17 00:13:15.000000 Pgenlib-0.83.0/src/plink2/include/pgenlib_write.h
--rw-r--r--   0 chrchang   (501) staff       (20)    19155 2022-12-31 18:47:11.000000 Pgenlib-0.83.0/src/plink2/include/plink2_base.cc
--rw-r--r--   0 chrchang   (501) staff       (20)   121745 2023-03-02 03:08:31.000000 Pgenlib-0.83.0/src/plink2/include/plink2_base.h
--rw-r--r--   0 chrchang   (501) staff       (20)   120996 2022-12-31 18:47:24.000000 Pgenlib-0.83.0/src/plink2/include/plink2_bits.cc
--rw-r--r--   0 chrchang   (501) staff       (20)    26110 2022-12-31 18:46:24.000000 Pgenlib-0.83.0/src/plink2/include/plink2_bits.h
--rw-r--r--   0 chrchang   (501) staff       (20)    18009 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/simde-align.h
--rw-r--r--   0 chrchang   (501) staff       (20)    17620 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/simde-arch.h
--rw-r--r--   0 chrchang   (501) staff       (20)    41599 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/simde-common.h
--rw-r--r--   0 chrchang   (501) staff       (20)    18585 2022-09-24 13:42:00.000000 Pgenlib-0.83.0/src/plink2/include/simde-constify.h
--rw-r--r--   0 chrchang   (501) staff       (20)     5054 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/simde-detect-clang.h
--rw-r--r--   0 chrchang   (501) staff       (20)    20930 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/simde-diagnostic.h
--rw-r--r--   0 chrchang   (501) staff       (20)    25041 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/simde-features.h
--rw-r--r--   0 chrchang   (501) staff       (20)    58922 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/simde-math.h
-drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-04-23 17:46:29.984718 Pgenlib-0.83.0/src/plink2/include/x86/
--rw-r--r--   0 chrchang   (501) staff       (20)    76719 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/x86/mmx.h
--rw-r--r--   0 chrchang   (501) staff       (20)   156055 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/x86/sse.h
--rw-r--r--   0 chrchang   (501) staff       (20)   255141 2023-02-13 21:29:14.000000 Pgenlib-0.83.0/src/plink2/include/x86/sse2.h
--rw-r--r--   0 chrchang   (501) staff       (20)    32721 2023-04-18 04:03:11.000000 Pgenlib-0.83.0/src/plink2/pgenlib_ffi_support.cc
--rw-r--r--   0 chrchang   (501) staff       (20)     6814 2023-04-18 00:21:46.000000 Pgenlib-0.83.0/src/plink2/pgenlib_ffi_support.h
-drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-04-23 17:46:29.985341 Pgenlib-0.83.0/tests/
--rw-r--r--   0 chrchang   (501) staff       (20)    19169 2023-04-23 17:35:49.000000 Pgenlib-0.83.0/tests/test_pgenlib.py
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.910255 Pgenlib-0.90.0/
+-rw-r--r--   0 chrchang   (501) staff       (20)     7652 2022-06-12 20:06:17.000000 Pgenlib-0.90.0/LICENSE
+-rw-r--r--   0 chrchang   (501) staff       (20)     6928 2023-05-20 16:20:44.000000 Pgenlib-0.90.0/MANIFEST.in
+-rw-r--r--   0 chrchang   (501) staff       (20)     1478 2023-05-21 00:41:23.910113 Pgenlib-0.90.0/PKG-INFO
+-rw-r--r--   0 chrchang   (501) staff       (20)      911 2023-05-20 16:23:15.000000 Pgenlib-0.90.0/README.md
+-rw-r--r--   0 chrchang   (501) staff       (20)      143 2022-11-26 19:14:19.000000 Pgenlib-0.90.0/pyproject.toml
+-rw-r--r--   0 chrchang   (501) staff       (20)       38 2023-05-21 00:41:23.910299 Pgenlib-0.90.0/setup.cfg
+-rw-r--r--   0 chrchang   (501) staff       (20)     5217 2023-05-21 00:18:14.000000 Pgenlib-0.90.0/setup.py
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.794856 Pgenlib-0.90.0/src/
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.802029 Pgenlib-0.90.0/src/Pgenlib.egg-info/
+-rw-r--r--   0 chrchang   (501) staff       (20)     1478 2023-05-21 00:41:23.000000 Pgenlib-0.90.0/src/Pgenlib.egg-info/PKG-INFO
+-rw-r--r--   0 chrchang   (501) staff       (20)     6312 2023-05-21 00:41:23.000000 Pgenlib-0.90.0/src/Pgenlib.egg-info/SOURCES.txt
+-rw-r--r--   0 chrchang   (501) staff       (20)        1 2023-05-21 00:41:23.000000 Pgenlib-0.90.0/src/Pgenlib.egg-info/dependency_links.txt
+-rw-r--r--   0 chrchang   (501) staff       (20)        8 2023-05-21 00:41:23.000000 Pgenlib-0.90.0/src/Pgenlib.egg-info/top_level.txt
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.806172 Pgenlib-0.90.0/src/pgenlib/
+-rw-r--r--   0 chrchang   (501) staff       (20)  2184413 2023-05-21 00:41:23.000000 Pgenlib-0.90.0/src/pgenlib/pgenlib.cpp
+-rw-r--r--   0 chrchang   (501) staff       (20)   129817 2023-05-20 23:20:27.000000 Pgenlib-0.90.0/src/pgenlib/pgenlib.pyx
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.810304 Pgenlib-0.90.0/src/plink2/
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.842811 Pgenlib-0.90.0/src/plink2/include/
+-rw-r--r--   0 chrchang   (501) staff       (20)     9846 2022-09-24 13:42:00.000000 Pgenlib-0.90.0/src/plink2/include/check.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     3119 2022-09-24 13:42:00.000000 Pgenlib-0.90.0/src/plink2/include/debug-trap.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    77513 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/hedley.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   126324 2023-04-18 02:32:01.000000 Pgenlib-0.90.0/src/plink2/include/pgenlib_misc.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)    45478 2023-04-23 16:10:18.000000 Pgenlib-0.90.0/src/plink2/include/pgenlib_misc.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   467494 2023-04-23 15:58:03.000000 Pgenlib-0.90.0/src/plink2/include/pgenlib_read.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)    36167 2022-12-31 18:46:00.000000 Pgenlib-0.90.0/src/plink2/include/pgenlib_read.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   113428 2023-04-23 16:10:07.000000 Pgenlib-0.90.0/src/plink2/include/pgenlib_write.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)    19411 2023-04-17 00:13:15.000000 Pgenlib-0.90.0/src/plink2/include/pgenlib_write.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    19155 2022-12-31 18:47:11.000000 Pgenlib-0.90.0/src/plink2/include/plink2_base.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)   121745 2023-03-02 03:08:31.000000 Pgenlib-0.90.0/src/plink2/include/plink2_base.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    42724 2022-12-31 18:47:15.000000 Pgenlib-0.90.0/src/plink2/include/plink2_bgzf.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)    12196 2022-12-31 18:46:17.000000 Pgenlib-0.90.0/src/plink2/include/plink2_bgzf.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   120996 2022-12-31 18:47:24.000000 Pgenlib-0.90.0/src/plink2/include/plink2_bits.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)    26110 2022-12-31 18:46:24.000000 Pgenlib-0.90.0/src/plink2/include/plink2_bits.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   110789 2023-02-25 01:56:26.000000 Pgenlib-0.90.0/src/plink2/include/plink2_string.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)    59649 2023-05-20 14:17:05.000000 Pgenlib-0.90.0/src/plink2/include/plink2_string.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    69403 2022-12-31 18:47:40.000000 Pgenlib-0.90.0/src/plink2/include/plink2_text.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)    26012 2023-02-27 02:30:19.000000 Pgenlib-0.90.0/src/plink2/include/plink2_text.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    12349 2023-01-07 23:32:54.000000 Pgenlib-0.90.0/src/plink2/include/plink2_thread.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)    10481 2022-12-31 18:46:46.000000 Pgenlib-0.90.0/src/plink2/include/plink2_thread.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     6439 2022-12-31 18:47:48.000000 Pgenlib-0.90.0/src/plink2/include/plink2_zstfile.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)     4000 2022-12-31 18:46:50.000000 Pgenlib-0.90.0/src/plink2/include/plink2_zstfile.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    18009 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/simde-align.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    17620 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/simde-arch.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    41599 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/simde-common.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    18585 2022-09-24 13:42:00.000000 Pgenlib-0.90.0/src/plink2/include/simde-constify.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     5054 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/simde-detect-clang.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    20930 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/simde-diagnostic.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    25041 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/simde-features.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    58922 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/simde-math.h
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.849545 Pgenlib-0.90.0/src/plink2/include/x86/
+-rw-r--r--   0 chrchang   (501) staff       (20)    76719 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/x86/mmx.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   156055 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/x86/sse.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   255141 2023-02-13 21:29:14.000000 Pgenlib-0.90.0/src/plink2/include/x86/sse2.h
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.852080 Pgenlib-0.90.0/src/plink2/libdeflate/
+-rw-r--r--   0 chrchang   (501) staff       (20)    17388 2022-09-24 14:15:27.000000 Pgenlib-0.90.0/src/plink2/libdeflate/common_defs.h
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.862932 Pgenlib-0.90.0/src/plink2/libdeflate/lib/
+-rw-r--r--   0 chrchang   (501) staff       (20)     3663 2022-09-24 14:16:16.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/adler32.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     3914 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/adler32_vec_template.h
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.866760 Pgenlib-0.90.0/src/plink2/libdeflate/lib/arm/
+-rw-r--r--   0 chrchang   (501) staff       (20)     9459 2022-09-24 14:20:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/arm/adler32_impl.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     5397 2022-09-24 14:30:39.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/arm/arm_cpu_features.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     7542 2022-09-24 14:20:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/arm/cpu_features.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    22684 2022-09-24 14:20:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/arm/crc32_impl.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     5100 2022-09-24 14:20:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/arm/crc32_pmull_helpers.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     6849 2022-09-24 14:20:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/arm/crc32_pmull_wide.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     2875 2022-09-24 14:20:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/arm/matchfinder_impl.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    11500 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/bt_matchfinder.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     2836 2022-09-24 14:26:25.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/cpu_features_common.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     9261 2022-09-24 14:16:16.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/crc32.c
+-rw-r--r--   0 chrchang   (501) staff       (20)    20575 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/crc32_multipliers.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    25448 2022-06-01 22:48:11.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/crc32_table.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    28471 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/crc32_tables.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     2114 2022-06-01 22:48:11.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/crc32_vec_template.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    25006 2022-09-24 14:36:49.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/decompress_template.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   129696 2022-09-24 14:34:54.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/deflate_compress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)      398 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/deflate_compress.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     1747 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/deflate_constants.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    47899 2022-09-24 14:25:10.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/deflate_decompress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     2724 2022-09-24 14:16:16.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/gzip_compress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     1029 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/gzip_constants.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     4065 2022-09-24 14:37:06.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/gzip_decompress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)    13980 2022-09-24 14:33:55.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/hc_matchfinder.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     7145 2022-09-24 14:34:11.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/ht_matchfinder.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     2262 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/lib_common.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     5718 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/matchfinder_common.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     5645 2022-06-01 22:48:11.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/unaligned.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     3566 2022-09-24 14:16:16.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/utils.c
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.871162 Pgenlib-0.90.0/src/plink2/libdeflate/lib/x86/
+-rw-r--r--   0 chrchang   (501) staff       (20)     8738 2022-09-24 14:20:02.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/x86/adler32_impl.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     5897 2022-09-24 14:16:40.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/x86/cpu_features.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     3370 2022-09-24 14:19:52.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/x86/crc32_impl.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    11043 2022-09-24 14:16:40.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/x86/crc32_pclmul_template.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     1678 2022-09-24 14:19:45.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/x86/decompress_impl.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     3781 2022-09-24 14:19:38.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/x86/matchfinder_impl.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     4226 2022-09-24 14:37:41.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/x86/x86_cpu_features.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     2677 2022-09-24 14:16:16.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/zlib_compress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)      488 2022-09-24 14:16:14.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/zlib_constants.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     3197 2022-09-24 14:16:16.000000 Pgenlib-0.90.0/src/plink2/libdeflate/lib/zlib_decompress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)    16710 2022-09-24 14:14:18.000000 Pgenlib-0.90.0/src/plink2/libdeflate/libdeflate.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    32721 2023-04-18 04:03:11.000000 Pgenlib-0.90.0/src/plink2/pgenlib_ffi_support.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)     6814 2023-04-18 00:21:46.000000 Pgenlib-0.90.0/src/plink2/pgenlib_ffi_support.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    15848 2023-01-07 21:54:35.000000 Pgenlib-0.90.0/src/plink2/pvar_ffi_support.cc
+-rw-r--r--   0 chrchang   (501) staff       (20)     1745 2022-12-31 18:42:54.000000 Pgenlib-0.90.0/src/plink2/pvar_ffi_support.h
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.795455 Pgenlib-0.90.0/src/plink2/zstd/
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.875431 Pgenlib-0.90.0/src/plink2/zstd/lib/
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.888453 Pgenlib-0.90.0/src/plink2/zstd/lib/common/
+-rw-r--r--   0 chrchang   (501) staff       (20)     1632 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/allocations.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     6226 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/bits.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    17522 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/bitstream.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    13012 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/compiler.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     4466 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/cpu.h
+-rw-r--r--   0 chrchang   (501) staff       (20)      843 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/debug.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     3761 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/debug.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    13308 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/entropy_common.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     3797 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/error_private.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     4876 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/error_private.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    30110 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/fse.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    12152 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/fse_decompress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)    13808 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/huf.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    13278 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/mem.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    11779 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/pool.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     2654 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/pool.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     4403 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/portability_macros.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     4740 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/threading.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     5195 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/threading.h
+-rw-r--r--   0 chrchang   (501) staff       (20)      767 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/xxhash.c
+-rw-r--r--   0 chrchang   (501) staff       (20)   212896 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/xxhash.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     1683 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/zstd_common.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     2508 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/zstd_deps.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    13342 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/zstd_internal.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     4619 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/common/zstd_trace.h
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.904368 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/
+-rw-r--r--   0 chrchang   (501) staff       (20)     6860 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/clevels.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    24096 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/fse_compress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     7448 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/hist.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     3448 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/hist.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    57710 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/huf_compress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)   312774 2023-04-05 19:43:36.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_compress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)    64413 2023-04-05 19:44:25.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_compress_internal.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     9155 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_compress_literals.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     1613 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_compress_literals.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    20004 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_compress_sequences.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     2175 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_compress_sequences.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    28499 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_compress_superblock.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     1168 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_compress_superblock.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    27872 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_cwksp.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    34479 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_double_fast.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     1347 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_double_fast.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    36950 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_fast.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     1261 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_fast.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   101952 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_lazy.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     5722 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_lazy.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    28437 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_ldm.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     4448 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_ldm.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     6077 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_ldm_geartab.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    67459 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_opt.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     2011 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstd_opt.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    81334 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstdmt_compress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     4663 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/compress/zstdmt_compress.h
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.909329 Pgenlib-0.90.0/src/plink2/zstd/lib/decompress/
+-rw-r--r--   0 chrchang   (501) staff       (20)    73693 2023-04-05 19:44:46.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/decompress/huf_decompress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     9182 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/decompress/zstd_ddict.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     1319 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/decompress/zstd_ddict.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    99701 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/decompress/zstd_decompress.c
+-rw-r--r--   0 chrchang   (501) staff       (20)    99641 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/decompress/zstd_decompress_block.c
+-rw-r--r--   0 chrchang   (501) staff       (20)     2699 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/decompress/zstd_decompress_block.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     9630 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/decompress/zstd_decompress_internal.h
+-rw-r--r--   0 chrchang   (501) staff       (20)    26433 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/zdict.h
+-rw-r--r--   0 chrchang   (501) staff       (20)   171378 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/zstd.h
+-rw-r--r--   0 chrchang   (501) staff       (20)     4532 2023-04-05 19:42:37.000000 Pgenlib-0.90.0/src/plink2/zstd/lib/zstd_errors.h
+drwxr-xr-x   0 chrchang   (501) staff       (20)        0 2023-05-21 00:41:23.909506 Pgenlib-0.90.0/tests/
+-rw-r--r--   0 chrchang   (501) staff       (20)    19169 2023-05-20 16:23:50.000000 Pgenlib-0.90.0/tests/test_pgenlib.py
```

### Comparing `Pgenlib-0.83.0/LICENSE` & `Pgenlib-0.90.0/LICENSE`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/PKG-INFO` & `Pgenlib-0.90.0/PKG-INFO`

 * *Files 6% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Pgenlib
-Version: 0.83.0
+Version: 0.90.0
 Summary: Python wrapper for pgenlib's basic reader and writer.
 Home-page: https://github.com/chrchang/plink-ng
 Author: Christopher Chang
 Author-email: chrchang@alumni.caltech.edu
 Project-URL: Bug Tracker, https://github.com/chrchang/plink-ng/issues
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU Lesser General Public License v3 (LGPLv3)
@@ -29,15 +29,15 @@
 Then install Cython and NumPy:
 ```
 pip3 install "cython>=0.29.21" "numpy>=1.19.0"
 ```
 
 and then build and install the package
 ```
-python3 setup.py build_ext
+python3 setup.py build_clib build_ext -i
 python3 setup.py install
 ```
 
 
 ##### Example usage:
 ```
 #write a 2 sample file
```

### Comparing `Pgenlib-0.83.0/README.md` & `Pgenlib-0.90.0/README.md`

 * *Files 14% similar despite different names*

```diff
@@ -14,15 +14,15 @@
 Then install Cython and NumPy:
 ```
 pip3 install "cython>=0.29.21" "numpy>=1.19.0"
 ```
 
 and then build and install the package
 ```
-python3 setup.py build_ext
+python3 setup.py build_clib build_ext -i
 python3 setup.py install
 ```
 
 
 ##### Example usage:
 ```
 #write a 2 sample file
```

### Comparing `Pgenlib-0.83.0/src/Pgenlib.egg-info/PKG-INFO` & `Pgenlib-0.90.0/src/Pgenlib.egg-info/PKG-INFO`

 * *Files 6% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Pgenlib
-Version: 0.83.0
+Version: 0.90.0
 Summary: Python wrapper for pgenlib's basic reader and writer.
 Home-page: https://github.com/chrchang/plink-ng
 Author: Christopher Chang
 Author-email: chrchang@alumni.caltech.edu
 Project-URL: Bug Tracker, https://github.com/chrchang/plink-ng/issues
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU Lesser General Public License v3 (LGPLv3)
@@ -29,15 +29,15 @@
 Then install Cython and NumPy:
 ```
 pip3 install "cython>=0.29.21" "numpy>=1.19.0"
 ```
 
 and then build and install the package
 ```
-python3 setup.py build_ext
+python3 setup.py build_clib build_ext -i
 python3 setup.py install
 ```
 
 
 ##### Example usage:
 ```
 #write a 2 sample file
```

### Comparing `Pgenlib-0.83.0/src/pgenlib/pgenlib.cpp` & `Pgenlib-0.90.0/src/pgenlib/pgenlib.cpp`

 * *Files 1% similar despite different names*

```diff
@@ -1,45 +1,55 @@
 /* Generated by Cython 0.29.34 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "src/plink2/include/pgenlib_misc.h",
             "src/plink2/include/pgenlib_read.h",
             "src/plink2/include/pgenlib_write.h",
-            "src/plink2/pgenlib_ffi_support.h"
+            "src/plink2/pgenlib_ffi_support.h",
+            "src/plink2/pvar_ffi_support.h"
         ],
         "extra_compile_args": [
             "-std=c++98",
             "-Wno-unused-function",
-            "-Wno-macro-redefined"
+            "-Wno-macro-redefined",
+            "-DSTATIC_ZSTD",
+            "-DZSTD_DISABLE_ASM",
+            "-DLIBDEFLATE_STATIC"
         ],
         "extra_link_args": [
             "-std=c++98"
         ],
         "include_dirs": [
             "src/pgenlib",
-            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/core/include"
+            "/private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/core/include"
         ],
         "language": "c++",
         "name": "pgenlib",
         "sources": [
             "src/pgenlib/pgenlib.pyx",
             "src/plink2/pgenlib_ffi_support.cc",
+            "src/plink2/pvar_ffi_support.cc",
             "src/plink2/include/pgenlib_misc.cc",
             "src/plink2/include/pgenlib_read.cc",
             "src/plink2/include/pgenlib_write.cc",
             "src/plink2/include/plink2_base.cc",
-            "src/plink2/include/plink2_bits.cc"
+            "src/plink2/include/plink2_bgzf.cc",
+            "src/plink2/include/plink2_bits.cc",
+            "src/plink2/include/plink2_string.cc",
+            "src/plink2/include/plink2_text.cc",
+            "src/plink2/include/plink2_thread.cc",
+            "src/plink2/include/plink2_zstfile.cc"
         ]
     },
     "module_name": "pgenlib"
 }
 END: Cython Metadata */
 
 #ifndef PY_SSIZE_T_CLEAN
@@ -805,14 +815,15 @@
 #include "numpy/ndarraytypes.h"
 #include "numpy/arrayscalars.h"
 #include "numpy/ufuncobject.h"
 
     /* NumPy API declarations from "numpy/__init__.pxd" */
     
 #include "../plink2/include/pgenlib_misc.h"
+#include "../plink2/pvar_ffi_support.h"
 #include "../plink2/pgenlib_ffi_support.h"
 #include "../plink2/include/pgenlib_read.h"
 #include "../plink2/include/pgenlib_write.h"
 #ifdef _OPENMP
 #include <omp.h>
 #endif /* _OPENMP */
 
@@ -1081,195 +1092,195 @@
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":690
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":690
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":691
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":691
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":692
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":693
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":693
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":697
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":697
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":698
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":698
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":699
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":700
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":700
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":704
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":704
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":705
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":705
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":714
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":714
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":715
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":715
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":716
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":716
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":718
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":718
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":719
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":719
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":720
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":720
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":722
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":722
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":723
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":723
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":725
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":725
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":726
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":726
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":727
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":727
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1295,45 +1306,46 @@
 #else
     typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
 static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
 
 /*--- Type declarations ---*/
+struct __pyx_obj_7pgenlib_PvarReader;
 struct __pyx_obj_7pgenlib_PgenReader;
 struct __pyx_obj_7pgenlib_PgenWriter;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":729
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":729
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":730
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":730
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":731
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":731
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":733
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":733
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -1360,343 +1372,357 @@
 struct __pyx_opt_args_7pgenlib_10PgenReader_count;
 struct __pyx_opt_args_7pgenlib_10PgenReader_change_sample_subset;
 struct __pyx_opt_args_7pgenlib_10PgenWriter_append_alleles;
 struct __pyx_opt_args_7pgenlib_10PgenWriter_append_partially_phased;
 struct __pyx_opt_args_7pgenlib_10PgenWriter_append_alleles_batch;
 struct __pyx_opt_args_7pgenlib_10PgenWriter_append_partially_phased_batch;
 
-/* "pgenlib.pyx":438
+/* "pgenlib.pyx":549
  * 
  * 
  *     cpdef read(self, uint32_t variant_idx, np.ndarray geno_int_out, uint32_t allele_idx = 1):             # <<<<<<<<<<<<<<
  *         # for full genotype info for multiallelic variants, use read_alleles()
  *         # instead
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read {
   int __pyx_n;
   uint32_t allele_idx;
 };
 
-/* "pgenlib.pyx":473
+/* "pgenlib.pyx":584
  * 
  * 
  *     cpdef read_dosages(self, uint32_t variant_idx, np.ndarray floatarr_out, uint32_t allele_idx = 1):             # <<<<<<<<<<<<<<
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages {
   int __pyx_n;
   uint32_t allele_idx;
 };
 
-/* "pgenlib.pyx":532
+/* "pgenlib.pyx":643
  * 
  * 
  *     cdef read_range_internal8(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         # todo: benchmark effect of adding @cython.boundscheck(False) and
  *         # @cython.wraparound(False) annotations to these multiple-variant-load
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_range_internal8 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":604
+/* "pgenlib.pyx":715
  *         return
  * 
  *     cdef read_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_range_internal32 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":670
+/* "pgenlib.pyx":781
  *         return
  * 
  *     cdef read_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_range_internal64 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":736
+/* "pgenlib.pyx":847
  *         return
  * 
  *     cpdef read_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_range {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":750
+/* "pgenlib.pyx":861
  * 
  * 
  *     cdef read_list_internal8(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_list_internal8 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":822
+/* "pgenlib.pyx":933
  *         return
  * 
  *     cdef read_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_list_internal32 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":894
+/* "pgenlib.pyx":1005
  *         return
  * 
  *     cdef read_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_list_internal64 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":966
+/* "pgenlib.pyx":1077
  *         return
  * 
  *     cpdef read_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if geno_int_out.dtype == np.int8:
  *             self.read_list_internal8(variant_idxs, geno_int_out, allele_idx, sample_maj)
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_list {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":978
+/* "pgenlib.pyx":1089
  * 
  * 
  *     cpdef read_alleles_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_alleles_range {
   int __pyx_n;
   int hap_maj;
 };
 
-/* "pgenlib.pyx":1081
+/* "pgenlib.pyx":1192
  * 
  * 
  *     cpdef read_alleles_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_alleles_list {
   int __pyx_n;
   int hap_maj;
 };
 
-/* "pgenlib.pyx":1185
+/* "pgenlib.pyx":1296
  * 
  * 
  *     cpdef read_alleles_and_phasepresent_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_alleles_and_phasepresent_range {
   int __pyx_n;
   int hap_maj;
 };
 
-/* "pgenlib.pyx":1221
+/* "pgenlib.pyx":1332
  * 
  * 
  *     cpdef read_alleles_and_phasepresent_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, np.ndarray[np.uint8_t,cast=True,mode="c",ndim=2] phasepresent_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_alleles_and_phasepresent_list {
   int __pyx_n;
   int hap_maj;
 };
 
-/* "pgenlib.pyx":1263
+/* "pgenlib.pyx":1374
  * 
  * 
  *     cdef read_dosages_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages_range_internal32 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":1287
+/* "pgenlib.pyx":1398
  * 
  * 
  *     cdef read_dosages_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages_range_internal64 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":1311
+/* "pgenlib.pyx":1422
  * 
  * 
  *     cpdef read_dosages_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages_range {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":1323
+/* "pgenlib.pyx":1434
  * 
  * 
  *     cdef read_dosages_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages_list_internal32 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":1356
+/* "pgenlib.pyx":1467
  * 
  * 
  *     cdef read_dosages_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages_list_internal64 {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":1389
+/* "pgenlib.pyx":1500
  * 
  * 
  *     cpdef read_dosages_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_list_internal32(variant_idxs, floatarr_out, allele_idx, sample_maj)
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages_list {
   int __pyx_n;
   uint32_t allele_idx;
   int sample_maj;
 };
 
-/* "pgenlib.pyx":1398
+/* "pgenlib.pyx":1509
  *         return
  * 
  *     cpdef count(self, uint32_t variant_idx, np.ndarray[np.uint32_t,mode="c"] genocount_uint32_out, object allele_idx = 1):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_count {
   int __pyx_n;
   PyObject *allele_idx;
 };
 
-/* "pgenlib.pyx":1464
+/* "pgenlib.pyx":1575
  * 
  * 
  *     cpdef change_sample_subset(self, object sample_subset = None):             # <<<<<<<<<<<<<<
  *         if sample_subset is not None:
  *             self.set_sample_subset_internal(sample_subset)
  */
 struct __pyx_opt_args_7pgenlib_10PgenReader_change_sample_subset {
   int __pyx_n;
   PyObject *sample_subset;
 };
 
-/* "pgenlib.pyx":1650
+/* "pgenlib.pyx":1761
  * 
  * 
  *     cpdef append_alleles(self, np.ndarray[np.int32_t,mode="c"] allele_int32, bint all_phased = False, object allele_ct = None):             # <<<<<<<<<<<<<<
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  */
 struct __pyx_opt_args_7pgenlib_10PgenWriter_append_alleles {
   int __pyx_n;
   int all_phased;
   PyObject *allele_ct;
 };
 
-/* "pgenlib.pyx":1694
+/* "pgenlib.pyx":1805
  * 
  * 
  *     cpdef append_partially_phased(self, np.ndarray[np.int32_t,mode="c"] allele_int32, np.ndarray[np.uint8_t,cast=True] phasepresent, object allele_ct = None):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  */
 struct __pyx_opt_args_7pgenlib_10PgenWriter_append_partially_phased {
   int __pyx_n;
   PyObject *allele_ct;
 };
 
-/* "pgenlib.pyx":1780
+/* "pgenlib.pyx":1891
  * 
  * 
  *     cpdef append_alleles_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, bint all_phased = False, object allele_cts = None):             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  */
 struct __pyx_opt_args_7pgenlib_10PgenWriter_append_alleles_batch {
   int __pyx_n;
   int all_phased;
   PyObject *allele_cts;
 };
 
-/* "pgenlib.pyx":1846
+/* "pgenlib.pyx":1957
  * 
  * 
  *     cpdef append_partially_phased_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_batch, object allele_cts = None):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased_batch cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  */
 struct __pyx_opt_args_7pgenlib_10PgenWriter_append_partially_phased_batch {
   int __pyx_n;
   PyObject *allele_cts;
 };
 
-/* "pgenlib.pyx":227
+/* "pgenlib.pyx":245
+ * 
+ * 
+ * cdef class PvarReader:             # <<<<<<<<<<<<<<
+ *     cdef MinimalPvarStruct _mp
+ * 
+ */
+struct __pyx_obj_7pgenlib_PvarReader {
+  PyObject_HEAD
+  struct __pyx_vtabstruct_7pgenlib_PvarReader *__pyx_vtab;
+  struct plink2::MinimalPvarStruct _mp;
+};
+
+
+/* "pgenlib.pyx":330
  * 
  * 
  * cdef class PgenReader:             # <<<<<<<<<<<<<<
  *     cdef PgenFileInfo* _info_ptr
  *     cdef PgenReaderStruct* _state_ptr
  */
 struct __pyx_obj_7pgenlib_PgenReader {
@@ -1716,15 +1742,15 @@
   uintptr_t *_multivar_vmaj_phaseinfo_buf;
   uintptr_t *_multivar_smaj_geno_batch_buf;
   uintptr_t *_multivar_smaj_phaseinfo_batch_buf;
   uintptr_t *_multivar_smaj_phasepresent_batch_buf;
 };
 
 
-/* "pgenlib.pyx":1524
+/* "pgenlib.pyx":1635
  * 
  * 
  * cdef class PgenWriter:             # <<<<<<<<<<<<<<
  *     cdef STPgenWriter* _state_ptr
  *     cdef uintptr_t* _nonref_flags
  */
 struct __pyx_obj_7pgenlib_PgenWriter {
@@ -1743,15 +1769,37 @@
   uintptr_t *_phaseinfo;
   uintptr_t *_dosage_present;
   uint16_t *_dosage_main;
 };
 
 
 
-/* "pgenlib.pyx":227
+/* "pgenlib.pyx":245
+ * 
+ * 
+ * cdef class PvarReader:             # <<<<<<<<<<<<<<
+ *     cdef MinimalPvarStruct _mp
+ * 
+ */
+
+struct __pyx_vtabstruct_7pgenlib_PvarReader {
+  PyObject *(*__pyx___enter__)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch);
+  PyObject *(*get_variant_ct)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch);
+  PyObject *(*get_variant_id)(struct __pyx_obj_7pgenlib_PvarReader *, uint32_t, int __pyx_skip_dispatch);
+  PyObject *(*get_allele_ct)(struct __pyx_obj_7pgenlib_PvarReader *, uint32_t, int __pyx_skip_dispatch);
+  PyObject *(*get_allele_code)(struct __pyx_obj_7pgenlib_PvarReader *, uint32_t, uint32_t, int __pyx_skip_dispatch);
+  PyObject *(*get_allele_idx_offsets)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch);
+  PyObject *(*get_max_allele_ct)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch);
+  PyObject *(*close)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch);
+  PyObject *(*__pyx___exit__)(struct __pyx_obj_7pgenlib_PvarReader *, PyObject *, PyObject *, PyObject *, int __pyx_skip_dispatch);
+};
+static struct __pyx_vtabstruct_7pgenlib_PvarReader *__pyx_vtabptr_7pgenlib_PvarReader;
+
+
+/* "pgenlib.pyx":330
  * 
  * 
  * cdef class PgenReader:             # <<<<<<<<<<<<<<
  *     cdef PgenFileInfo* _info_ptr
  *     cdef PgenReaderStruct* _state_ptr
  */
 
@@ -1788,15 +1836,15 @@
   PyObject *(*change_sample_subset)(struct __pyx_obj_7pgenlib_PgenReader *, int __pyx_skip_dispatch, struct __pyx_opt_args_7pgenlib_10PgenReader_change_sample_subset *__pyx_optional_args);
   PyObject *(*close)(struct __pyx_obj_7pgenlib_PgenReader *, int __pyx_skip_dispatch);
   PyObject *(*__pyx___exit__)(struct __pyx_obj_7pgenlib_PgenReader *, PyObject *, PyObject *, PyObject *, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_7pgenlib_PgenReader *__pyx_vtabptr_7pgenlib_PgenReader;
 
 
-/* "pgenlib.pyx":1524
+/* "pgenlib.pyx":1635
  * 
  * 
  * cdef class PgenWriter:             # <<<<<<<<<<<<<<
  *     cdef STPgenWriter* _state_ptr
  *     cdef uintptr_t* _nonref_flags
  */
 
@@ -1889,84 +1937,31 @@
 #else
 #define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
 #endif
 
 /* GetBuiltinName.proto */
 static PyObject *__Pyx_GetBuiltinName(PyObject *name);
 
-/* IsLittleEndian.proto */
-static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);
-
-/* BufferFormatCheck.proto */
-static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
-static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
-                              __Pyx_BufFmt_StackElem* stack,
-                              __Pyx_TypeInfo* type);
-
-/* BufferGetAndValidate.proto */
-#define __Pyx_GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack)\
-    ((obj == Py_None || obj == NULL) ?\
-    (__Pyx_ZeroBuffer(buf), 0) :\
-    __Pyx__GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack))
-static int  __Pyx__GetBufferAndValidate(Py_buffer* buf, PyObject* obj,
-    __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack);
-static void __Pyx_ZeroBuffer(Py_buffer* buf);
-static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info);
-static Py_ssize_t __Pyx_minusones[] = { -1, -1, -1, -1, -1, -1, -1, -1 };
-static Py_ssize_t __Pyx_zeros[] = { 0, 0, 0, 0, 0, 0, 0, 0 };
-
-/* BufferIndexError.proto */
-static void __Pyx_RaiseBufferIndexError(int axis);
-
-#define __Pyx_BufPtrCContig1d(type, buf, i0, s0) ((type)buf + i0)
-/* PyThreadStateGet.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
-#define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
-#define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
-#else
-#define __Pyx_PyThreadState_declare
-#define __Pyx_PyThreadState_assign
-#define __Pyx_PyErr_Occurred()  PyErr_Occurred()
-#endif
+/* RaiseDoubleKeywords.proto */
+static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
 
-/* PyErrFetchRestore.proto */
-#if CYTHON_FAST_THREAD_STATE
-#define __Pyx_PyErr_Clear() __Pyx_ErrRestore(NULL, NULL, NULL)
-#define __Pyx_ErrRestoreWithState(type, value, tb)  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
-#define __Pyx_ErrFetchWithState(type, value, tb)    __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
-#define __Pyx_ErrRestore(type, value, tb)  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
-#define __Pyx_ErrFetch(type, value, tb)    __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
-static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
-static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
-#if CYTHON_COMPILING_IN_CPYTHON
-#define __Pyx_PyErr_SetNone(exc) (Py_INCREF(exc), __Pyx_ErrRestore((exc), NULL, NULL))
-#else
-#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
-#endif
-#else
-#define __Pyx_PyErr_Clear() PyErr_Clear()
-#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
-#define __Pyx_ErrRestoreWithState(type, value, tb)  PyErr_Restore(type, value, tb)
-#define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
-#define __Pyx_ErrRestoreInState(tstate, type, value, tb)  PyErr_Restore(type, value, tb)
-#define __Pyx_ErrFetchInState(tstate, type, value, tb)  PyErr_Fetch(type, value, tb)
-#define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
-#define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
-#endif
+/* ParseKeywords.proto */
+static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
+    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
+    const char* function_name);
 
-/* PyObjectCall.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
-#else
-#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
-#endif
+/* RaiseArgTupleInvalid.proto */
+static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
+    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
 
-/* RaiseException.proto */
-static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
+/* ArgTypeTest.proto */
+#define __Pyx_ArgTypeTest(obj, type, none_allowed, name, exact)\
+    ((likely((Py_TYPE(obj) == type) | (none_allowed && (obj == Py_None)))) ? 1 :\
+        __Pyx__ArgTypeTest(obj, type, name, exact))
+static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact);
 
 /* PyCFunctionFastCall.proto */
 #if CYTHON_FAST_PYCCALL
 static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
 #else
 #define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
 #endif
@@ -1998,45 +1993,67 @@
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
 #endif // CYTHON_FAST_PYCALL
 #endif
 
+/* PyObjectCall.proto */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
+#else
+#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
+#endif
+
 /* PyObjectCallMethO.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
 #endif
 
 /* PyObjectCallOneArg.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
 
-/* RaiseDoubleKeywords.proto */
-static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
-
-/* ParseKeywords.proto */
-static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
-    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
-    const char* function_name);
-
-/* RaiseArgTupleInvalid.proto */
-static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
-    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
-
-/* ArgTypeTest.proto */
-#define __Pyx_ArgTypeTest(obj, type, none_allowed, name, exact)\
-    ((likely((Py_TYPE(obj) == type) | (none_allowed && (obj == Py_None)))) ? 1 :\
-        __Pyx__ArgTypeTest(obj, type, name, exact))
-static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact);
+/* PyThreadStateGet.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
+#define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
+#define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
+#else
+#define __Pyx_PyThreadState_declare
+#define __Pyx_PyThreadState_assign
+#define __Pyx_PyErr_Occurred()  PyErr_Occurred()
+#endif
 
-/* ExtTypeTest.proto */
-static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
+/* PyErrFetchRestore.proto */
+#if CYTHON_FAST_THREAD_STATE
+#define __Pyx_PyErr_Clear() __Pyx_ErrRestore(NULL, NULL, NULL)
+#define __Pyx_ErrRestoreWithState(type, value, tb)  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
+#define __Pyx_ErrFetchWithState(type, value, tb)    __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
+#define __Pyx_ErrRestore(type, value, tb)  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
+#define __Pyx_ErrFetch(type, value, tb)    __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
+static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
+static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
+#if CYTHON_COMPILING_IN_CPYTHON
+#define __Pyx_PyErr_SetNone(exc) (Py_INCREF(exc), __Pyx_ErrRestore((exc), NULL, NULL))
+#else
+#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
+#endif
+#else
+#define __Pyx_PyErr_Clear() PyErr_Clear()
+#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
+#define __Pyx_ErrRestoreWithState(type, value, tb)  PyErr_Restore(type, value, tb)
+#define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
+#define __Pyx_ErrRestoreInState(tstate, type, value, tb)  PyErr_Restore(type, value, tb)
+#define __Pyx_ErrFetchInState(tstate, type, value, tb)  PyErr_Fetch(type, value, tb)
+#define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
+#define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
+#endif
 
-/* DivInt[long].proto */
-static CYTHON_INLINE long __Pyx_div_long(long, long);
+/* RaiseException.proto */
+static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
 
 /* PyDictVersioning.proto */
 #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
 #define __PYX_DICT_VERSION_INIT  ((PY_UINT64_T) -1)
 #define __PYX_GET_DICT_VERSION(dict)  (((PyDictObject*)(dict))->ma_version_tag)
 #define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)\
     (version_var) = __PYX_GET_DICT_VERSION(dict);\
@@ -2063,14 +2080,17 @@
 /* PyObjectCallNoArg.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
 #else
 #define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
 #endif
 
+/* PyObjectCall2Args.proto */
+static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
+
 /* GetModuleGlobalName.proto */
 #if CYTHON_USE_DICT_VERSIONS
 #define __Pyx_GetModuleGlobalName(var, name)  do {\
     static PY_UINT64_T __pyx_dict_version = 0;\
     static PyObject *__pyx_dict_cached_value = NULL;\
     (var) = (likely(__pyx_dict_version == __PYX_GET_DICT_VERSION(__pyx_d))) ?\
         (likely(__pyx_dict_cached_value) ? __Pyx_NewRef(__pyx_dict_cached_value) : __Pyx_GetBuiltinName(name)) :\
@@ -2084,14 +2104,48 @@
 static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
 #else
 #define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 #define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
 static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
 #endif
 
+/* ExtTypeTest.proto */
+static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
+
+/* IsLittleEndian.proto */
+static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);
+
+/* BufferFormatCheck.proto */
+static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
+static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
+                              __Pyx_BufFmt_StackElem* stack,
+                              __Pyx_TypeInfo* type);
+
+/* BufferGetAndValidate.proto */
+#define __Pyx_GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack)\
+    ((obj == Py_None || obj == NULL) ?\
+    (__Pyx_ZeroBuffer(buf), 0) :\
+    __Pyx__GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack))
+static int  __Pyx__GetBufferAndValidate(Py_buffer* buf, PyObject* obj,
+    __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack);
+static void __Pyx_ZeroBuffer(Py_buffer* buf);
+static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info);
+static Py_ssize_t __Pyx_minusones[] = { -1, -1, -1, -1, -1, -1, -1, -1 };
+static Py_ssize_t __Pyx_zeros[] = { 0, 0, 0, 0, 0, 0, 0, 0 };
+
+/* BufferIndexError.proto */
+static void __Pyx_RaiseBufferIndexError(int axis);
+
+#define __Pyx_BufPtrCContig1d(type, buf, i0, s0) ((type)buf + i0)
+/* PyIntCompare.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, long intval, long inplace);
+
+/* DivInt[long].proto */
+static CYTHON_INLINE long __Pyx_div_long(long, long);
+
 #define __Pyx_BufPtrCContig2d(type, buf, i0, s0, i1, s1) ((type)((char*)buf + i0 * s0) + i1)
 /* ModInt[long].proto */
 static CYTHON_INLINE long __Pyx_mod_long(long, long);
 
 #define __Pyx_BufPtrStrided1d(type, buf, i0, s0) (type)((char*)buf + i0 * s0)
 /* PyIntBinop.proto */
 #if !CYTHON_COMPILING_IN_PYPY
@@ -2100,17 +2154,14 @@
 #define __Pyx_PyInt_AddObjC(op1, op2, intval, inplace, zerodivision_check)\
     (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
 #endif
 
 /* PyIntCompare.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_NeObjC(PyObject *op1, PyObject *op2, long intval, long inplace);
 
-/* PyObjectCall2Args.proto */
-static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
-
 /* UnaryNegOverflows.proto */
 #define UNARY_NEG_WOULD_OVERFLOW(x)\
         (((x) < 0) & ((unsigned long)(x) == 0-(unsigned long)(x)))
 
 /* GetItemInt.proto */
 #define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
     (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
@@ -2367,18 +2418,18 @@
     #endif
 #endif
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE uint32_t __Pyx_PyInt_As_uint32_t(PyObject *);
 
 /* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_uint32(npy_uint32 value);
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_uint32_t(uint32_t value);
 
 /* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_uint32_t(uint32_t value);
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_uint32(npy_uint32 value);
 
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
 
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_plink2_3a__3a_PglErr(plink2::PglErr value);
 
@@ -2412,14 +2463,23 @@
 
 /* CheckBinaryVersion.proto */
 static int __Pyx_check_binary_version(void);
 
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
+static PyObject *__pyx_f_7pgenlib_10PvarReader___enter__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_variant_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_variant_id(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_allele_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_allele_code(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, uint32_t __pyx_v_allele_idx, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_allele_idx_offsets(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_max_allele_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_close(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader___exit__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_exc_type, CYTHON_UNUSED PyObject *__pyx_v_exc_val, CYTHON_UNUSED PyObject *__pyx_v_exc_tb, int __pyx_skip_dispatch); /* proto*/
 static PyObject *__pyx_f_7pgenlib_10PgenReader_set_allele_idx_offsets_internal(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, PyArrayObject *__pyx_v_allele_idx_offsets); /* proto*/
 static PyObject *__pyx_f_7pgenlib_10PgenReader_set_sample_subset_internal(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, PyArrayObject *__pyx_v_sample_subset); /* proto*/
 static PyObject *__pyx_f_7pgenlib_10PgenReader___enter__(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
 static PyObject *__pyx_f_7pgenlib_10PgenReader_get_raw_sample_ct(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
 static PyObject *__pyx_f_7pgenlib_10PgenReader_get_variant_ct(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
 static PyObject *__pyx_f_7pgenlib_10PgenReader_hardcall_phase_present(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, int __pyx_skip_dispatch); /* proto*/
 static PyObject *__pyx_f_7pgenlib_10PgenReader_read(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, PyArrayObject *__pyx_v_geno_int_out, int __pyx_skip_dispatch, struct __pyx_opt_args_7pgenlib_10PgenReader_read *__pyx_optional_args); /* proto*/
@@ -2501,14 +2561,15 @@
 static PyTypeObject *__pyx_ptype_5numpy_floating = 0;
 static PyTypeObject *__pyx_ptype_5numpy_complexfloating = 0;
 static PyTypeObject *__pyx_ptype_5numpy_flexible = 0;
 static PyTypeObject *__pyx_ptype_5numpy_character = 0;
 static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
 
 /* Module declarations from 'pgenlib' */
+static PyTypeObject *__pyx_ptype_7pgenlib_PvarReader = 0;
 static PyTypeObject *__pyx_ptype_7pgenlib_PgenReader = 0;
 static PyTypeObject *__pyx_ptype_7pgenlib_PgenWriter = 0;
 static PyObject *__pyx_f_7pgenlib_bytes_to_bits_internal(PyArrayObject *, uint32_t, uintptr_t *); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_uintp_t = { "uintp_t", NULL, sizeof(__pyx_t_5numpy_uintp_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_5numpy_uintp_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_5numpy_uintp_t), 0 };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t = { "uint32_t", NULL, sizeof(__pyx_t_5numpy_uint32_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_5numpy_uint32_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_5numpy_uint32_t), 0 };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t = { "int32_t", NULL, sizeof(__pyx_t_5numpy_int32_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_5numpy_int32_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_5numpy_int32_t), 0 };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t = { "uint8_t", NULL, sizeof(__pyx_t_5numpy_uint8_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_5numpy_uint8_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_5numpy_uint8_t), 0 };
@@ -2517,40 +2578,43 @@
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t = { "float32_t", NULL, sizeof(__pyx_t_5numpy_float32_t), { 0 }, 0, 'R', 0, 0 };
 static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t = { "float64_t", NULL, sizeof(__pyx_t_5numpy_float64_t), { 0 }, 0, 'R', 0, 0 };
 #define __Pyx_MODULE_NAME "pgenlib"
 extern int __pyx_module_is_main_pgenlib;
 int __pyx_module_is_main_pgenlib = 0;
 
 /* Implementation of 'pgenlib' */
-static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin_RuntimeError;
 static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_TypeError;
+static PyObject *__pyx_builtin_MemoryError;
 static PyObject *__pyx_builtin_ImportError;
-static const char __pyx_k__5[] = ").";
-static const char __pyx_k__9[] = ")";
+static const char __pyx_k__8[] = ").";
 static const char __pyx_k_np[] = "np";
-static const char __pyx_k__10[] = ", ";
+static const char __pyx_k__12[] = ")";
+static const char __pyx_k__13[] = ", ";
 static const char __pyx_k_sys[] = "sys";
 static const char __pyx_k_exit[] = "__exit__";
 static const char __pyx_k_int8[] = "int8";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_name[] = "__name__";
 static const char __pyx_k_only[] = "; only ";
+static const char __pyx_k_pvar[] = "pvar";
 static const char __pyx_k_read[] = "read";
 static const char __pyx_k_size[] = "size";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_close[] = "close";
 static const char __pyx_k_count[] = "count";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_enter[] = "__enter__";
 static const char __pyx_k_int32[] = "int32";
 static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
+static const char __pyx_k_uintp[] = "uintp";
+static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_exc_tb[] = "exc_tb";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_exc_val[] = "exc_val";
 static const char __pyx_k_float32[] = "float32";
 static const char __pyx_k_float64[] = "float64";
 static const char __pyx_k_hap_maj[] = "hap_maj";
@@ -2563,14 +2627,15 @@
 static const char __pyx_k_allele_ct[] = "allele_ct";
 static const char __pyx_k_in_file_2[] = " in file)";
 static const char __pyx_k_read_list[] = "read_list";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_sample_ct[] = "sample_ct";
 static const char __pyx_k_PgenReader[] = "PgenReader";
 static const char __pyx_k_PgenWriter[] = "PgenWriter";
+static const char __pyx_k_PvarReader[] = "PvarReader";
 static const char __pyx_k_all_phased[] = "all_phased";
 static const char __pyx_k_allele_cts[] = "allele_cts";
 static const char __pyx_k_allele_idx[] = "allele_idx";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_read_error[] = "read() error ";
 static const char __pyx_k_read_range[] = "read_range";
 static const char __pyx_k_sample_maj[] = "sample_maj";
@@ -2586,31 +2651,36 @@
 static const char __pyx_k_geno_int_out[] = "geno_int_out";
 static const char __pyx_k_nonref_flags[] = "nonref_flags";
 static const char __pyx_k_phasepresent[] = "phasepresent";
 static const char __pyx_k_read_alleles[] = "read_alleles";
 static const char __pyx_k_read_dosages[] = "read_dosages";
 static const char __pyx_k_variant_idxs[] = "variant_idxs";
 static const char __pyx_k_PgrInit_error[] = "PgrInit() error ";
+static const char __pyx_k_get_allele_ct[] = "get_allele_ct";
 static const char __pyx_k_raw_sample_ct[] = "raw_sample_ct";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
 static const char __pyx_k_sample_subset[] = "sample_subset";
 static const char __pyx_k_variant_idx_2[] = "variant_idx ";
 static const char __pyx_k_append_alleles[] = "append_alleles";
 static const char __pyx_k_append_dosages[] = "append_dosages";
 static const char __pyx_k_dosage_present[] = "dosage_present";
 static const char __pyx_k_get_variant_ct[] = "get_variant_ct";
+static const char __pyx_k_get_variant_id[] = "get_variant_id";
 static const char __pyx_k_allele_ct_limit[] = "allele_ct_limit";
+static const char __pyx_k_get_allele_code[] = "get_allele_code";
 static const char __pyx_k_read_list_error[] = "read_list() error ";
 static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
 static const char __pyx_k_variant_idx_end[] = "variant_idx_end";
 static const char __pyx_k_allele_int32_out[] = "allele_int32_out";
 static const char __pyx_k_append_biallelic[] = "append_biallelic";
+static const char __pyx_k_for_this_variant[] = " for this variant).";
 static const char __pyx_k_phasepresent_out[] = "phasepresent_out";
 static const char __pyx_k_read_range_error[] = "read_range() error ";
 static const char __pyx_k_variant_ct_limit[] = "variant_ct_limit";
+static const char __pyx_k_get_max_allele_ct[] = "get_max_allele_ct";
 static const char __pyx_k_get_raw_sample_ct[] = "get_raw_sample_ct";
 static const char __pyx_k_read_alleles_list[] = "read_alleles_list";
 static const char __pyx_k_read_dosages_list[] = "read_dosages_list";
 static const char __pyx_k_variant_idx_start[] = "variant_idx_start";
 static const char __pyx_k_allele_idx_offsets[] = "allele_idx_offsets";
 static const char __pyx_k_allele_int32_batch[] = "allele_int32_batch";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
@@ -2625,39 +2695,43 @@
 static const char __pyx_k_append_dosages_batch[] = "append_dosages_batch";
 static const char __pyx_k_append_dosages_error[] = "append_dosages() error ";
 static const char __pyx_k_change_sample_subset[] = "change_sample_subset";
 static const char __pyx_k_dosage_phase_present[] = "dosage_phase_present";
 static const char __pyx_k_genocount_uint32_out[] = "genocount_uint32_out";
 static const char __pyx_k_append_biallelic_batch[] = "append_biallelic_batch";
 static const char __pyx_k_append_biallelic_error[] = "append_biallelic() error ";
+static const char __pyx_k_get_allele_idx_offsets[] = "get_allele_idx_offsets";
 static const char __pyx_k_hardcall_phase_present[] = "hardcall_phase_present";
 static const char __pyx_k_variant_idxs_length_is[] = "; variant_idxs length is ";
 static const char __pyx_k_append_partially_phased[] = "append_partially_phased";
 static const char __pyx_k_read_alleles_list_error[] = "read_alleles_list() error ";
 static const char __pyx_k_read_alleles_range_error[] = " read_alleles_range() error ";
 static const char __pyx_k_read_dosages_range_error[] = "read_dosages_range() error ";
 static const char __pyx_k_append_alleles_batch_error[] = "append_alleles_batch() error ";
 static const char __pyx_k_append_dosages_batch_error[] = "append_dosages_batch() error ";
 static const char __pyx_k_read_variant_idx_too_large[] = "read() variant_idx too large (";
+static const char __pyx_k_0_based_allele_idx_too_large[] = "0-based allele idx too large (";
 static const char __pyx_k_0_based_sample_idx_too_large[] = "0-based sample idx too large (";
 static const char __pyx_k_append_biallelic_batch_error[] = "append_biallelic_batch() error ";
+static const char __pyx_k_0_based_variant_idx_too_large[] = "0-based variant idx too large (";
 static const char __pyx_k_append_partially_phased_batch[] = "append_partially_phased_batch";
 static const char __pyx_k_append_partially_phased_error[] = "append_partially_phased() error ";
 static const char __pyx_k_read_alleles_and_phasepresent[] = "read_alleles_and_phasepresent";
 static const char __pyx_k_current_sample_subset_has_size[] = "; current sample subset has size ";
 static const char __pyx_k_read_geno_int_out_is_too_small[] = "read() geno_int_out is too small (";
 static const char __pyx_k_Invalid_read_geno_int_out_array[] = "Invalid read() geno_int_out array element type (int8, int32, or int64 expected).";
 static const char __pyx_k_Invalid_read_range_geno_int_out[] = "Invalid read_range() geno_int_out array element type (int8, int32, or int64 expected).";
 static const char __pyx_k_Sample_major_read_list_geno_int[] = "Sample-major read_list() geno_int_out buffer has too few rows (";
 static const char __pyx_k_Variant_major_read_alleles_list[] = "Variant-major read_alleles_list() allele_int32_out buffer has too few rows (";
 static const char __pyx_k_Variant_major_read_dosages_list[] = "Variant-major read_dosages_list() floatarr_out buffer has too few rows (";
 static const char __pyx_k_and_column_count_should_be_twic[] = ", , and column count should be twice that).";
 static const char __pyx_k_and_row_count_should_be_twice_t[] = ", and row count should be twice that)";
 static const char __pyx_k_append_dosages_cannot_be_called[] = "append_dosages cannot be called when PgenWriter was constructed with dosage_present False";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
+static const char __pyx_k_pvar_cannot_be_specified_at_the[] = "pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets";
 static const char __pyx_k_read_alleles_and_phasepresent_r[] = " read_alleles_and_phasepresent_range() error ";
 static const char __pyx_k_read_alleles_list_variant_index[] = "read_alleles_list() variant index too large (";
 static const char __pyx_k_read_dosages_list_variant_index[] = "read_dosages_list() variant index too large (";
 static const char __pyx_k_unequal_to_initially_declared_v[] = ") unequal to initially declared value (";
 static const char __pyx_k_variant_idx_end_variant_idx_sta[] = "; (variant_idx_end - variant_idx_start) is ";
 static const char __pyx_k_Empty_sample_subset_is_not_curre[] = "Empty sample_subset is not currently permitted.";
 static const char __pyx_k_Haplotype_major_read_alleles_lis[] = "Haplotype-major read_alleles_list() allele_int32_out buffer has too few rows (";
@@ -2744,15 +2818,17 @@
 static const char __pyx_k_append_partially_phased_called_w_2[] = "append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting";
 static const char __pyx_k_append_partially_phased_called_w_3[] = "append_partially_phased called with allele codes >= allele_ct argument";
 static const char __pyx_k_append_partially_phased_called_w_4[] = "append_partially_phased called with allele_ct > allele_ct_limit";
 static const char __pyx_k_read_alleles_and_phasepresent_li_2[] = "read_alleles_and_phasepresent_list() variant index too large (";
 static const char __pyx_k_read_alleles_and_phasepresent_li_3[] = "read_alleles_and_phasepresent_list() error ";
 static const char __pyx_k_read_alleles_and_phasepresent_li_4[] = "read_alleles_and_phasepresent_list() does not support hap_maj == 1 yet.";
 static const char __pyx_k_read_alleles_and_phasepresent_ra_2[] = "read_alleles_and_phasepresent_range() does not support hap_maj == 1 yet.";
+static PyObject *__pyx_kp_u_0_based_allele_idx_too_large;
 static PyObject *__pyx_kp_u_0_based_sample_idx_too_large;
+static PyObject *__pyx_kp_u_0_based_variant_idx_too_large;
 static PyObject *__pyx_kp_u_Empty_sample_subset_is_not_curre;
 static PyObject *__pyx_kp_u_Haplotype_major_read_alleles_lis;
 static PyObject *__pyx_kp_u_Haplotype_major_read_alleles_lis_2;
 static PyObject *__pyx_kp_u_Haplotype_major_read_alleles_lis_3;
 static PyObject *__pyx_kp_u_Haplotype_major_read_alleles_ran;
 static PyObject *__pyx_kp_u_Haplotype_major_read_alleles_ran_2;
 static PyObject *__pyx_kp_u_Haplotype_major_read_alleles_ran_3;
@@ -2773,14 +2849,15 @@
 static PyObject *__pyx_n_s_PgenReader;
 static PyObject *__pyx_kp_u_PgenReader_multiallelic_variants;
 static PyObject *__pyx_n_s_PgenWriter;
 static PyObject *__pyx_kp_u_PgenWriter___dealloc___SpgwFinis;
 static PyObject *__pyx_kp_u_PgenWriter_close_SpgwFinish_erro;
 static PyObject *__pyx_kp_u_PgenWriter_close_called_when_num;
 static PyObject *__pyx_kp_u_PgrInit_error;
+static PyObject *__pyx_n_s_PvarReader;
 static PyObject *__pyx_n_s_RuntimeError;
 static PyObject *__pyx_kp_u_Sample_major_read_list_geno_int;
 static PyObject *__pyx_kp_u_Sample_major_read_list_geno_int_2;
 static PyObject *__pyx_kp_u_Sample_major_read_range_geno_int;
 static PyObject *__pyx_kp_u_Sample_major_read_range_geno_int_2;
 static PyObject *__pyx_kp_u_SpgwInitPhase1_error;
 static PyObject *__pyx_n_s_TypeError;
@@ -2798,17 +2875,17 @@
 static PyObject *__pyx_kp_u_Variant_major_read_alleles_range_2;
 static PyObject *__pyx_kp_u_Variant_major_read_dosages_list;
 static PyObject *__pyx_kp_u_Variant_major_read_dosages_list_2;
 static PyObject *__pyx_kp_u_Variant_major_read_list_geno_int;
 static PyObject *__pyx_kp_u_Variant_major_read_list_geno_int_2;
 static PyObject *__pyx_kp_u_Variant_major_read_range_geno_in;
 static PyObject *__pyx_kp_u_Variant_major_read_range_geno_in_2;
-static PyObject *__pyx_kp_u__10;
-static PyObject *__pyx_kp_u__5;
-static PyObject *__pyx_kp_u__9;
+static PyObject *__pyx_kp_u__12;
+static PyObject *__pyx_kp_u__13;
+static PyObject *__pyx_kp_u__8;
 static PyObject *__pyx_n_s_all_phased;
 static PyObject *__pyx_n_s_allele_ct;
 static PyObject *__pyx_n_s_allele_ct_limit;
 static PyObject *__pyx_n_s_allele_cts;
 static PyObject *__pyx_n_s_allele_idx;
 static PyObject *__pyx_n_s_allele_idx_offsets;
 static PyObject *__pyx_n_s_allele_int32;
@@ -2869,18 +2946,24 @@
 static PyObject *__pyx_n_s_exc_type;
 static PyObject *__pyx_n_s_exc_val;
 static PyObject *__pyx_n_s_exit;
 static PyObject *__pyx_n_s_filename;
 static PyObject *__pyx_n_s_float32;
 static PyObject *__pyx_n_s_float64;
 static PyObject *__pyx_n_s_floatarr_out;
+static PyObject *__pyx_kp_u_for_this_variant;
 static PyObject *__pyx_n_s_geno_int_out;
 static PyObject *__pyx_n_s_genocount_uint32_out;
+static PyObject *__pyx_n_s_get_allele_code;
+static PyObject *__pyx_n_s_get_allele_ct;
+static PyObject *__pyx_n_s_get_allele_idx_offsets;
+static PyObject *__pyx_n_s_get_max_allele_ct;
 static PyObject *__pyx_n_s_get_raw_sample_ct;
 static PyObject *__pyx_n_s_get_variant_ct;
+static PyObject *__pyx_n_s_get_variant_id;
 static PyObject *__pyx_n_s_getstate;
 static PyObject *__pyx_n_s_hap_maj;
 static PyObject *__pyx_n_s_hardcall_phase_present;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_kp_u_in_file;
 static PyObject *__pyx_kp_u_in_file_2;
 static PyObject *__pyx_n_s_int32;
@@ -2894,14 +2977,16 @@
 static PyObject *__pyx_n_s_numpy;
 static PyObject *__pyx_kp_u_numpy_core_multiarray_failed_to;
 static PyObject *__pyx_kp_u_numpy_core_umath_failed_to_impor;
 static PyObject *__pyx_kp_u_only;
 static PyObject *__pyx_n_s_phasepresent;
 static PyObject *__pyx_n_s_phasepresent_batch;
 static PyObject *__pyx_n_s_phasepresent_out;
+static PyObject *__pyx_n_s_pvar;
+static PyObject *__pyx_kp_u_pvar_cannot_be_specified_at_the;
 static PyObject *__pyx_n_s_pyx_vtable;
 static PyObject *__pyx_n_s_range;
 static PyObject *__pyx_n_s_raw_sample_ct;
 static PyObject *__pyx_n_s_read;
 static PyObject *__pyx_n_s_read_alleles;
 static PyObject *__pyx_kp_u_read_alleles_allele_int32_out_is;
 static PyObject *__pyx_n_s_read_alleles_and_phasepresent;
@@ -2956,25 +3041,40 @@
 static PyObject *__pyx_n_s_sample_subset;
 static PyObject *__pyx_kp_u_sample_subset_is_not_in_strictly;
 static PyObject *__pyx_n_s_setstate;
 static PyObject *__pyx_n_s_setstate_cython;
 static PyObject *__pyx_n_s_size;
 static PyObject *__pyx_n_s_sys;
 static PyObject *__pyx_n_s_test;
+static PyObject *__pyx_n_s_uintp;
 static PyObject *__pyx_kp_u_unequal_to_initially_declared_v;
 static PyObject *__pyx_n_s_variant_ct;
 static PyObject *__pyx_n_s_variant_ct_limit;
 static PyObject *__pyx_n_s_variant_idx;
 static PyObject *__pyx_kp_u_variant_idx_2;
 static PyObject *__pyx_n_s_variant_idx_end;
 static PyObject *__pyx_kp_u_variant_idx_end_variant_idx_sta;
 static PyObject *__pyx_n_s_variant_idx_start;
 static PyObject *__pyx_n_s_variant_idxs;
 static PyObject *__pyx_kp_u_variant_idxs_length_is;
-static int __pyx_pf_7pgenlib_10PgenReader___cinit__(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, PyObject *__pyx_v_filename, PyObject *__pyx_v_raw_sample_ct, PyObject *__pyx_v_variant_ct, PyObject *__pyx_v_sample_subset, PyObject *__pyx_v_allele_idx_offsets); /* proto */
+static PyObject *__pyx_n_s_zeros;
+static int __pyx_pf_7pgenlib_10PvarReader___cinit__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, PyObject *__pyx_v_filename); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_2__enter__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_4get_variant_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_6get_variant_id(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_8get_allele_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_10get_allele_code(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, uint32_t __pyx_v_allele_idx); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_12get_allele_idx_offsets(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_14get_max_allele_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_16close(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_18__exit__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, PyObject *__pyx_v_exc_type, PyObject *__pyx_v_exc_val, PyObject *__pyx_v_exc_tb); /* proto */
+static void __pyx_pf_7pgenlib_10PvarReader_20__dealloc__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_22__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_24__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
+static int __pyx_pf_7pgenlib_10PgenReader___cinit__(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, PyObject *__pyx_v_filename, PyObject *__pyx_v_raw_sample_ct, PyObject *__pyx_v_variant_ct, PyObject *__pyx_v_sample_subset, PyObject *__pyx_v_allele_idx_offsets, PyObject *__pyx_v_pvar); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenReader_2__enter__(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenReader_4get_raw_sample_ct(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenReader_6get_variant_ct(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenReader_8hardcall_phase_present(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenReader_10read(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, PyArrayObject *__pyx_v_geno_int_out, uint32_t __pyx_v_allele_idx); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenReader_12read_dosages(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, PyArrayObject *__pyx_v_floatarr_out, uint32_t __pyx_v_allele_idx); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenReader_14read_alleles(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, PyArrayObject *__pyx_v_allele_int32_out); /* proto */
@@ -3005,30 +3105,31 @@
 static PyObject *__pyx_pf_7pgenlib_10PgenWriter_16append_partially_phased_batch(struct __pyx_obj_7pgenlib_PgenWriter *__pyx_v_self, PyArrayObject *__pyx_v_allele_int32_batch, PyArrayObject *__pyx_v_phasepresent_batch, PyObject *__pyx_v_allele_cts); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenWriter_18append_dosages_batch(struct __pyx_obj_7pgenlib_PgenWriter *__pyx_v_self, PyArrayObject *__pyx_v_floatarr_batch); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenWriter_20close(struct __pyx_obj_7pgenlib_PgenWriter *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenWriter_22__exit__(struct __pyx_obj_7pgenlib_PgenWriter *__pyx_v_self, PyObject *__pyx_v_exc_type, PyObject *__pyx_v_exc_val, PyObject *__pyx_v_exc_tb); /* proto */
 static void __pyx_pf_7pgenlib_10PgenWriter_24__dealloc__(struct __pyx_obj_7pgenlib_PgenWriter *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenWriter_26__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_7pgenlib_PgenWriter *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_7pgenlib_10PgenWriter_28__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_7pgenlib_PgenWriter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
+static PyObject *__pyx_tp_new_7pgenlib_PvarReader(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_7pgenlib_PgenReader(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_7pgenlib_PgenWriter(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_2;
 static PyObject *__pyx_int_3;
 static PyObject *__pyx_tuple_;
 static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__3;
 static PyObject *__pyx_tuple__4;
+static PyObject *__pyx_tuple__5;
 static PyObject *__pyx_tuple__6;
 static PyObject *__pyx_tuple__7;
-static PyObject *__pyx_tuple__8;
+static PyObject *__pyx_tuple__9;
+static PyObject *__pyx_tuple__10;
 static PyObject *__pyx_tuple__11;
-static PyObject *__pyx_tuple__12;
-static PyObject *__pyx_tuple__13;
 static PyObject *__pyx_tuple__14;
 static PyObject *__pyx_tuple__15;
 static PyObject *__pyx_tuple__16;
 static PyObject *__pyx_tuple__17;
 static PyObject *__pyx_tuple__18;
 static PyObject *__pyx_tuple__19;
 static PyObject *__pyx_tuple__20;
@@ -3061,17 +3162,2479 @@
 static PyObject *__pyx_tuple__47;
 static PyObject *__pyx_tuple__48;
 static PyObject *__pyx_tuple__49;
 static PyObject *__pyx_tuple__50;
 static PyObject *__pyx_tuple__51;
 static PyObject *__pyx_tuple__52;
 static PyObject *__pyx_tuple__53;
+static PyObject *__pyx_tuple__54;
+static PyObject *__pyx_tuple__55;
+static PyObject *__pyx_tuple__56;
 /* Late includes */
 
-/* "pgenlib.pyx":249
+/* "pgenlib.pyx":248
+ *     cdef MinimalPvarStruct _mp
+ * 
+ *     def __cinit__(self, bytes filename):             # <<<<<<<<<<<<<<
+ *         PreinitMinimalPvar(&self._mp)
+ *         cdef const char* fname = <const char*>filename
+ */
+
+/* Python wrapper */
+static int __pyx_pw_7pgenlib_10PvarReader_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static int __pyx_pw_7pgenlib_10PvarReader_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_filename = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_filename,0};
+    PyObject* values[1] = {0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_filename)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 248, __pyx_L3_error)
+      }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+    }
+    __pyx_v_filename = ((PyObject*)values[0]);
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 248, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pgenlib.PvarReader.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return -1;
+  __pyx_L4_argument_unpacking_done:;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_filename), (&PyBytes_Type), 1, "filename", 1))) __PYX_ERR(0, 248, __pyx_L1_error)
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader___cinit__(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self), __pyx_v_filename);
+
+  /* function exit code */
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static int __pyx_pf_7pgenlib_10PvarReader___cinit__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, PyObject *__pyx_v_filename) {
+  char const *__pyx_v_fname;
+  char __pyx_v_errstr_buf[plink2::kPglErrstrBufBlen];
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  char const *__pyx_t_1;
+  int __pyx_t_2;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__cinit__", 0);
+
+  /* "pgenlib.pyx":249
+ * 
+ *     def __cinit__(self, bytes filename):
+ *         PreinitMinimalPvar(&self._mp)             # <<<<<<<<<<<<<<
+ *         cdef const char* fname = <const char*>filename
+ *         cdef char errstr_buf[kPglErrstrBufBlen]
+ */
+  plink2::PreinitMinimalPvar((&__pyx_v_self->_mp));
+
+  /* "pgenlib.pyx":250
+ *     def __cinit__(self, bytes filename):
+ *         PreinitMinimalPvar(&self._mp)
+ *         cdef const char* fname = <const char*>filename             # <<<<<<<<<<<<<<
+ *         cdef char errstr_buf[kPglErrstrBufBlen]
+ *         if LoadMinimalPvar(fname, &self._mp, errstr_buf) != kPglRetSuccess:
+ */
+  if (unlikely(__pyx_v_filename == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
+    __PYX_ERR(0, 250, __pyx_L1_error)
+  }
+  __pyx_t_1 = __Pyx_PyBytes_AsString(__pyx_v_filename); if (unlikely((!__pyx_t_1) && PyErr_Occurred())) __PYX_ERR(0, 250, __pyx_L1_error)
+  __pyx_v_fname = ((char const *)__pyx_t_1);
+
+  /* "pgenlib.pyx":252
+ *         cdef const char* fname = <const char*>filename
+ *         cdef char errstr_buf[kPglErrstrBufBlen]
+ *         if LoadMinimalPvar(fname, &self._mp, errstr_buf) != kPglRetSuccess:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError(errstr_buf[7:])
+ *         return
+ */
+  __pyx_t_2 = ((plink2::LoadMinimalPvar(__pyx_v_fname, (&__pyx_v_self->_mp), __pyx_v_errstr_buf) != plink2::kPglRetSuccess) != 0);
+  if (unlikely(__pyx_t_2)) {
+
+    /* "pgenlib.pyx":253
+ *         cdef char errstr_buf[kPglErrstrBufBlen]
+ *         if LoadMinimalPvar(fname, &self._mp, errstr_buf) != kPglRetSuccess:
+ *             raise RuntimeError(errstr_buf[7:])             # <<<<<<<<<<<<<<
+ *         return
+ * 
+ */
+    __pyx_t_3 = __Pyx_PyBytes_FromString(((const char*)__pyx_v_errstr_buf) + 7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 253, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __PYX_ERR(0, 253, __pyx_L1_error)
+
+    /* "pgenlib.pyx":252
+ *         cdef const char* fname = <const char*>filename
+ *         cdef char errstr_buf[kPglErrstrBufBlen]
+ *         if LoadMinimalPvar(fname, &self._mp, errstr_buf) != kPglRetSuccess:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError(errstr_buf[7:])
+ *         return
+ */
+  }
+
+  /* "pgenlib.pyx":254
+ *         if LoadMinimalPvar(fname, &self._mp, errstr_buf) != kPglRetSuccess:
+ *             raise RuntimeError(errstr_buf[7:])
+ *         return             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = 0;
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":248
+ *     cdef MinimalPvarStruct _mp
+ * 
+ *     def __cinit__(self, bytes filename):             # <<<<<<<<<<<<<<
+ *         PreinitMinimalPvar(&self._mp)
+ *         cdef const char* fname = <const char*>filename
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_AddTraceback("pgenlib.PvarReader.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = -1;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":257
+ * 
+ * 
+ *     cpdef __enter__(self):             # <<<<<<<<<<<<<<
+ *         return self
+ * 
+ */
+
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_3__enter__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader___enter__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__enter__", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PvarReader_3__enter__)) {
+        __Pyx_XDECREF(__pyx_r);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_4)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_4);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_3, function);
+          }
+        }
+        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 257, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pgenlib.pyx":258
+ * 
+ *     cpdef __enter__(self):
+ *         return self             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)__pyx_v_self));
+  __pyx_r = ((PyObject *)__pyx_v_self);
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":257
+ * 
+ * 
+ *     cpdef __enter__(self):             # <<<<<<<<<<<<<<
+ *         return self
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_AddTraceback("pgenlib.PvarReader.__enter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_3__enter__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_3__enter__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__enter__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_2__enter__(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_2__enter__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__enter__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_7pgenlib_10PvarReader___enter__(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.__enter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":261
+ * 
+ * 
+ *     cpdef get_variant_ct(self):             # <<<<<<<<<<<<<<
+ *         return self._mp.variant_ct
+ * 
+ */
+
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_5get_variant_ct(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_variant_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_variant_ct", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PvarReader_5get_variant_ct)) {
+        __Pyx_XDECREF(__pyx_r);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_4)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_4);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_3, function);
+          }
+        }
+        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 261, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pgenlib.pyx":262
+ * 
+ *     cpdef get_variant_ct(self):
+ *         return self._mp.variant_ct             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_self->_mp.variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":261
+ * 
+ * 
+ *     cpdef get_variant_ct(self):             # <<<<<<<<<<<<<<
+ *         return self._mp.variant_ct
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_variant_ct", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_5get_variant_ct(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_5get_variant_ct(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("get_variant_ct (wrapper)", 0);
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_4get_variant_ct(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_4get_variant_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_variant_ct", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_7pgenlib_10PvarReader_get_variant_ct(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_variant_ct", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":265
+ * 
+ * 
+ *     cpdef get_variant_id(self, uint32_t variant_idx):             # <<<<<<<<<<<<<<
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:
+ */
+
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_7get_variant_id(PyObject *__pyx_v_self, PyObject *__pyx_arg_variant_idx); /*proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_variant_id(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, int __pyx_skip_dispatch) {
+  uint32_t __pyx_v_variant_ct;
+  PyObject *__pyx_v_py_string = 0;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  uint32_t __pyx_t_6;
+  int __pyx_t_7;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_variant_id", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_variant_id); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PvarReader_7get_variant_id)) {
+        __Pyx_XDECREF(__pyx_r);
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 265, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
+          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
+          if (likely(__pyx_t_5)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+            __Pyx_INCREF(__pyx_t_5);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_4, function);
+          }
+        }
+        __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
+        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 265, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pgenlib.pyx":266
+ * 
+ *     cpdef get_variant_id(self, uint32_t variant_idx):
+ *         cdef uint32_t variant_ct = self._mp.variant_ct             # <<<<<<<<<<<<<<
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ */
+  __pyx_t_6 = __pyx_v_self->_mp.variant_ct;
+  __pyx_v_variant_ct = __pyx_t_6;
+
+  /* "pgenlib.pyx":267
+ *     cpdef get_variant_id(self, uint32_t variant_idx):
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         cdef py_string = self._mp.variant_ids[variant_idx]
+ */
+  __pyx_t_7 = ((__pyx_v_variant_idx >= __pyx_v_variant_ct) != 0);
+  if (unlikely(__pyx_t_7)) {
+
+    /* "pgenlib.pyx":268
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")             # <<<<<<<<<<<<<<
+ *         cdef py_string = self._mp.variant_ids[variant_idx]
+ *         return py_string
+ */
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_0_based_variant_idx_too_large, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __PYX_ERR(0, 268, __pyx_L1_error)
+
+    /* "pgenlib.pyx":267
+ *     cpdef get_variant_id(self, uint32_t variant_idx):
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         cdef py_string = self._mp.variant_ids[variant_idx]
+ */
+  }
+
+  /* "pgenlib.pyx":269
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         cdef py_string = self._mp.variant_ids[variant_idx]             # <<<<<<<<<<<<<<
+ *         return py_string
+ * 
+ */
+  __pyx_t_1 = __Pyx_PyBytes_FromString((__pyx_v_self->_mp.variant_ids[__pyx_v_variant_idx])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_v_py_string = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "pgenlib.pyx":270
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         cdef py_string = self._mp.variant_ids[variant_idx]
+ *         return py_string             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(__pyx_v_py_string);
+  __pyx_r = __pyx_v_py_string;
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":265
+ * 
+ * 
+ *     cpdef get_variant_id(self, uint32_t variant_idx):             # <<<<<<<<<<<<<<
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_variant_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_py_string);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_7get_variant_id(PyObject *__pyx_v_self, PyObject *__pyx_arg_variant_idx); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_7get_variant_id(PyObject *__pyx_v_self, PyObject *__pyx_arg_variant_idx) {
+  uint32_t __pyx_v_variant_idx;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("get_variant_id (wrapper)", 0);
+  assert(__pyx_arg_variant_idx); {
+    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(__pyx_arg_variant_idx); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 265, __pyx_L3_error)
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_variant_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_6get_variant_id(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self), ((uint32_t)__pyx_v_variant_idx));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_6get_variant_id(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_variant_id", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_7pgenlib_10PvarReader_get_variant_id(__pyx_v_self, __pyx_v_variant_idx, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_variant_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":273
+ * 
+ * 
+ *     cpdef get_allele_ct(self, uint32_t variant_idx):             # <<<<<<<<<<<<<<
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:
+ */
+
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_9get_allele_ct(PyObject *__pyx_v_self, PyObject *__pyx_arg_variant_idx); /*proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_allele_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, int __pyx_skip_dispatch) {
+  uint32_t __pyx_v_variant_ct;
+  uintptr_t const *__pyx_v_allele_idx_offsets;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  uint32_t __pyx_t_6;
+  int __pyx_t_7;
+  uintptr_t *__pyx_t_8;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_allele_ct", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_allele_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PvarReader_9get_allele_ct)) {
+        __Pyx_XDECREF(__pyx_r);
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 273, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
+          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
+          if (likely(__pyx_t_5)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+            __Pyx_INCREF(__pyx_t_5);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_4, function);
+          }
+        }
+        __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
+        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 273, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pgenlib.pyx":274
+ * 
+ *     cpdef get_allele_ct(self, uint32_t variant_idx):
+ *         cdef uint32_t variant_ct = self._mp.variant_ct             # <<<<<<<<<<<<<<
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ */
+  __pyx_t_6 = __pyx_v_self->_mp.variant_ct;
+  __pyx_v_variant_ct = __pyx_t_6;
+
+  /* "pgenlib.pyx":275
+ *     cpdef get_allele_ct(self, uint32_t variant_idx):
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ */
+  __pyx_t_7 = ((__pyx_v_variant_idx >= __pyx_v_variant_ct) != 0);
+  if (unlikely(__pyx_t_7)) {
+
+    /* "pgenlib.pyx":276
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")             # <<<<<<<<<<<<<<
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ *             return 2
+ */
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_0_based_variant_idx_too_large, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __PYX_ERR(0, 276, __pyx_L1_error)
+
+    /* "pgenlib.pyx":275
+ *     cpdef get_allele_ct(self, uint32_t variant_idx):
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ */
+  }
+
+  /* "pgenlib.pyx":277
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         if self._mp.allele_idx_offsetsp == NULL:             # <<<<<<<<<<<<<<
+ *             return 2
+ *         cdef const uintptr_t* allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+ */
+  __pyx_t_7 = ((__pyx_v_self->_mp.allele_idx_offsetsp == NULL) != 0);
+  if (__pyx_t_7) {
+
+    /* "pgenlib.pyx":278
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ *             return 2             # <<<<<<<<<<<<<<
+ *         cdef const uintptr_t* allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+ *         return allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __Pyx_INCREF(__pyx_int_2);
+    __pyx_r = __pyx_int_2;
+    goto __pyx_L0;
+
+    /* "pgenlib.pyx":277
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         if self._mp.allele_idx_offsetsp == NULL:             # <<<<<<<<<<<<<<
+ *             return 2
+ *         cdef const uintptr_t* allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+ */
+  }
+
+  /* "pgenlib.pyx":279
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ *             return 2
+ *         cdef const uintptr_t* allele_idx_offsets = self._mp.allele_idx_offsetsp.p             # <<<<<<<<<<<<<<
+ *         return allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]
+ * 
+ */
+  __pyx_t_8 = __pyx_v_self->_mp.allele_idx_offsetsp->p;
+  __pyx_v_allele_idx_offsets = __pyx_t_8;
+
+  /* "pgenlib.pyx":280
+ *             return 2
+ *         cdef const uintptr_t* allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+ *         return allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __Pyx_PyInt_FromSize_t(((__pyx_v_allele_idx_offsets[(__pyx_v_variant_idx + 1)]) - (__pyx_v_allele_idx_offsets[__pyx_v_variant_idx]))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":273
+ * 
+ * 
+ *     cpdef get_allele_ct(self, uint32_t variant_idx):             # <<<<<<<<<<<<<<
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_allele_ct", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_9get_allele_ct(PyObject *__pyx_v_self, PyObject *__pyx_arg_variant_idx); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_9get_allele_ct(PyObject *__pyx_v_self, PyObject *__pyx_arg_variant_idx) {
+  uint32_t __pyx_v_variant_idx;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("get_allele_ct (wrapper)", 0);
+  assert(__pyx_arg_variant_idx); {
+    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(__pyx_arg_variant_idx); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 273, __pyx_L3_error)
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_allele_ct", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_8get_allele_ct(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self), ((uint32_t)__pyx_v_variant_idx));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_8get_allele_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_allele_ct", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_7pgenlib_10PvarReader_get_allele_ct(__pyx_v_self, __pyx_v_variant_idx, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_allele_ct", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":283
+ * 
+ * 
+ *     cpdef get_allele_code(self, uint32_t variant_idx, uint32_t allele_idx):             # <<<<<<<<<<<<<<
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:
+ */
+
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_11get_allele_code(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_allele_code(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, uint32_t __pyx_v_allele_idx, int __pyx_skip_dispatch) {
+  uint32_t __pyx_v_variant_ct;
+  uintptr_t __pyx_v_allele_idx_offset_base;
+  uint32_t __pyx_v_allele_ct;
+  uintptr_t const *__pyx_v_allele_idx_offsets;
+  PyObject *__pyx_v_py_string = 0;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyObject *__pyx_t_6 = NULL;
+  int __pyx_t_7;
+  PyObject *__pyx_t_8 = NULL;
+  uint32_t __pyx_t_9;
+  int __pyx_t_10;
+  uintptr_t *__pyx_t_11;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_allele_code", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_allele_code); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PvarReader_11get_allele_code)) {
+        __Pyx_XDECREF(__pyx_r);
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 283, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 283, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
+        __pyx_t_7 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
+          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
+          if (likely(__pyx_t_6)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+            __Pyx_INCREF(__pyx_t_6);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_5, function);
+            __pyx_t_7 = 1;
+          }
+        }
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_5)) {
+          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 283, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
+          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 283, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+        } else
+        #endif
+        {
+          __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 283, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_8);
+          if (__pyx_t_6) {
+            __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
+          }
+          __Pyx_GIVEREF(__pyx_t_3);
+          PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
+          __Pyx_GIVEREF(__pyx_t_4);
+          PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_t_4);
+          __pyx_t_3 = 0;
+          __pyx_t_4 = 0;
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 283, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+        }
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pgenlib.pyx":284
+ * 
+ *     cpdef get_allele_code(self, uint32_t variant_idx, uint32_t allele_idx):
+ *         cdef uint32_t variant_ct = self._mp.variant_ct             # <<<<<<<<<<<<<<
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ */
+  __pyx_t_9 = __pyx_v_self->_mp.variant_ct;
+  __pyx_v_variant_ct = __pyx_t_9;
+
+  /* "pgenlib.pyx":285
+ *     cpdef get_allele_code(self, uint32_t variant_idx, uint32_t allele_idx):
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         cdef uintptr_t allele_idx_offset_base = 2 * variant_idx
+ */
+  __pyx_t_10 = ((__pyx_v_variant_idx >= __pyx_v_variant_ct) != 0);
+  if (unlikely(__pyx_t_10)) {
+
+    /* "pgenlib.pyx":286
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")             # <<<<<<<<<<<<<<
+ *         cdef uintptr_t allele_idx_offset_base = 2 * variant_idx
+ *         cdef uint32_t allele_ct = 2
+ */
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_0_based_variant_idx_too_large, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __PYX_ERR(0, 286, __pyx_L1_error)
+
+    /* "pgenlib.pyx":285
+ *     cpdef get_allele_code(self, uint32_t variant_idx, uint32_t allele_idx):
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         cdef uintptr_t allele_idx_offset_base = 2 * variant_idx
+ */
+  }
+
+  /* "pgenlib.pyx":287
+ *         if variant_idx >= variant_ct:
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         cdef uintptr_t allele_idx_offset_base = 2 * variant_idx             # <<<<<<<<<<<<<<
+ *         cdef uint32_t allele_ct = 2
+ *         cdef const uintptr_t* allele_idx_offsets
+ */
+  __pyx_v_allele_idx_offset_base = (2 * __pyx_v_variant_idx);
+
+  /* "pgenlib.pyx":288
+ *             raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+ *         cdef uintptr_t allele_idx_offset_base = 2 * variant_idx
+ *         cdef uint32_t allele_ct = 2             # <<<<<<<<<<<<<<
+ *         cdef const uintptr_t* allele_idx_offsets
+ *         if self._mp.allele_idx_offsetsp != NULL:
+ */
+  __pyx_v_allele_ct = 2;
+
+  /* "pgenlib.pyx":290
+ *         cdef uint32_t allele_ct = 2
+ *         cdef const uintptr_t* allele_idx_offsets
+ *         if self._mp.allele_idx_offsetsp != NULL:             # <<<<<<<<<<<<<<
+ *             allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+ *             allele_idx_offset_base = allele_idx_offsets[variant_idx]
+ */
+  __pyx_t_10 = ((__pyx_v_self->_mp.allele_idx_offsetsp != NULL) != 0);
+  if (__pyx_t_10) {
+
+    /* "pgenlib.pyx":291
+ *         cdef const uintptr_t* allele_idx_offsets
+ *         if self._mp.allele_idx_offsetsp != NULL:
+ *             allele_idx_offsets = self._mp.allele_idx_offsetsp.p             # <<<<<<<<<<<<<<
+ *             allele_idx_offset_base = allele_idx_offsets[variant_idx]
+ *             allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offset_base
+ */
+    __pyx_t_11 = __pyx_v_self->_mp.allele_idx_offsetsp->p;
+    __pyx_v_allele_idx_offsets = __pyx_t_11;
+
+    /* "pgenlib.pyx":292
+ *         if self._mp.allele_idx_offsetsp != NULL:
+ *             allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+ *             allele_idx_offset_base = allele_idx_offsets[variant_idx]             # <<<<<<<<<<<<<<
+ *             allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offset_base
+ *         if allele_idx >= allele_ct:
+ */
+    __pyx_v_allele_idx_offset_base = (__pyx_v_allele_idx_offsets[__pyx_v_variant_idx]);
+
+    /* "pgenlib.pyx":293
+ *             allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+ *             allele_idx_offset_base = allele_idx_offsets[variant_idx]
+ *             allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offset_base             # <<<<<<<<<<<<<<
+ *         if allele_idx >= allele_ct:
+ *             raise RuntimeError("0-based allele idx too large (" + str(allele_idx) + "; only " + str(allele_ct) + " for this variant).")
+ */
+    __pyx_v_allele_ct = ((__pyx_v_allele_idx_offsets[(__pyx_v_variant_idx + 1)]) - __pyx_v_allele_idx_offset_base);
+
+    /* "pgenlib.pyx":290
+ *         cdef uint32_t allele_ct = 2
+ *         cdef const uintptr_t* allele_idx_offsets
+ *         if self._mp.allele_idx_offsetsp != NULL:             # <<<<<<<<<<<<<<
+ *             allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+ *             allele_idx_offset_base = allele_idx_offsets[variant_idx]
+ */
+  }
+
+  /* "pgenlib.pyx":294
+ *             allele_idx_offset_base = allele_idx_offsets[variant_idx]
+ *             allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offset_base
+ *         if allele_idx >= allele_ct:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError("0-based allele idx too large (" + str(allele_idx) + "; only " + str(allele_ct) + " for this variant).")
+ *         cdef bytes py_string = self._mp.allele_storage[allele_idx_offset_base + allele_idx]
+ */
+  __pyx_t_10 = ((__pyx_v_allele_idx >= __pyx_v_allele_ct) != 0);
+  if (unlikely(__pyx_t_10)) {
+
+    /* "pgenlib.pyx":295
+ *             allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offset_base
+ *         if allele_idx >= allele_ct:
+ *             raise RuntimeError("0-based allele idx too large (" + str(allele_idx) + "; only " + str(allele_ct) + " for this variant).")             # <<<<<<<<<<<<<<
+ *         cdef bytes py_string = self._mp.allele_storage[allele_idx_offset_base + allele_idx]
+ *         return py_string
+ */
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_0_based_allele_idx_too_large, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_for_this_variant); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __PYX_ERR(0, 295, __pyx_L1_error)
+
+    /* "pgenlib.pyx":294
+ *             allele_idx_offset_base = allele_idx_offsets[variant_idx]
+ *             allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offset_base
+ *         if allele_idx >= allele_ct:             # <<<<<<<<<<<<<<
+ *             raise RuntimeError("0-based allele idx too large (" + str(allele_idx) + "; only " + str(allele_ct) + " for this variant).")
+ *         cdef bytes py_string = self._mp.allele_storage[allele_idx_offset_base + allele_idx]
+ */
+  }
+
+  /* "pgenlib.pyx":296
+ *         if allele_idx >= allele_ct:
+ *             raise RuntimeError("0-based allele idx too large (" + str(allele_idx) + "; only " + str(allele_ct) + " for this variant).")
+ *         cdef bytes py_string = self._mp.allele_storage[allele_idx_offset_base + allele_idx]             # <<<<<<<<<<<<<<
+ *         return py_string
+ * 
+ */
+  __pyx_t_1 = __Pyx_PyBytes_FromString((__pyx_v_self->_mp.allele_storage[(__pyx_v_allele_idx_offset_base + __pyx_v_allele_idx)])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_v_py_string = ((PyObject*)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "pgenlib.pyx":297
+ *             raise RuntimeError("0-based allele idx too large (" + str(allele_idx) + "; only " + str(allele_ct) + " for this variant).")
+ *         cdef bytes py_string = self._mp.allele_storage[allele_idx_offset_base + allele_idx]
+ *         return py_string             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(__pyx_v_py_string);
+  __pyx_r = __pyx_v_py_string;
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":283
+ * 
+ * 
+ *     cpdef get_allele_code(self, uint32_t variant_idx, uint32_t allele_idx):             # <<<<<<<<<<<<<<
+ *         cdef uint32_t variant_ct = self._mp.variant_ct
+ *         if variant_idx >= variant_ct:
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_8);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_allele_code", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_py_string);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_11get_allele_code(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_11get_allele_code(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  uint32_t __pyx_v_variant_idx;
+  uint32_t __pyx_v_allele_idx;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("get_allele_code (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_variant_idx,&__pyx_n_s_allele_idx,0};
+    PyObject* values[2] = {0,0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_idx)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("get_allele_code", 1, 2, 2, 1); __PYX_ERR(0, 283, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_allele_code") < 0)) __PYX_ERR(0, 283, __pyx_L3_error)
+      }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+    }
+    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 283, __pyx_L3_error)
+    __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 283, __pyx_L3_error)
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("get_allele_code", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 283, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_allele_code", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_10get_allele_code(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self), __pyx_v_variant_idx, __pyx_v_allele_idx);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_10get_allele_code(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, uint32_t __pyx_v_variant_idx, uint32_t __pyx_v_allele_idx) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_allele_code", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_7pgenlib_10PvarReader_get_allele_code(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_allele_idx, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_allele_code", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":300
+ * 
+ * 
+ *     cpdef get_allele_idx_offsets(self):             # <<<<<<<<<<<<<<
+ *         cdef uint32_t variant_ct_p1 = 1 + self._mp.variant_ct
+ *         cdef np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets = np.zeros([variant_ct_p1], dtype=np.uintp)
+ */
+
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_13get_allele_idx_offsets(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_allele_idx_offsets(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch) {
+  uint32_t __pyx_v_variant_ct_p1;
+  PyArrayObject *__pyx_v_allele_idx_offsets = 0;
+  PyObject *__pyx_v_variant_idx = NULL;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_allele_idx_offsets;
+  __Pyx_Buffer __pyx_pybuffer_allele_idx_offsets;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  PyArrayObject *__pyx_t_6 = NULL;
+  int __pyx_t_7;
+  Py_ssize_t __pyx_t_8;
+  PyObject *(*__pyx_t_9)(PyObject *);
+  Py_ssize_t __pyx_t_10;
+  int __pyx_t_11;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_allele_idx_offsets", 0);
+  __pyx_pybuffer_allele_idx_offsets.pybuffer.buf = NULL;
+  __pyx_pybuffer_allele_idx_offsets.refcount = 0;
+  __pyx_pybuffernd_allele_idx_offsets.data = NULL;
+  __pyx_pybuffernd_allele_idx_offsets.rcbuffer = &__pyx_pybuffer_allele_idx_offsets;
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_allele_idx_offsets); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PvarReader_13get_allele_idx_offsets)) {
+        __Pyx_XDECREF(__pyx_r);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_4)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_4);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_3, function);
+          }
+        }
+        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 300, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pgenlib.pyx":301
+ * 
+ *     cpdef get_allele_idx_offsets(self):
+ *         cdef uint32_t variant_ct_p1 = 1 + self._mp.variant_ct             # <<<<<<<<<<<<<<
+ *         cdef np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets = np.zeros([variant_ct_p1], dtype=np.uintp)
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ */
+  __pyx_v_variant_ct_p1 = (1 + __pyx_v_self->_mp.variant_ct);
+
+  /* "pgenlib.pyx":302
+ *     cpdef get_allele_idx_offsets(self):
+ *         cdef uint32_t variant_ct_p1 = 1 + self._mp.variant_ct
+ *         cdef np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets = np.zeros([variant_ct_p1], dtype=np.uintp)             # <<<<<<<<<<<<<<
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ *             for variant_idx in range(variant_ct_p1):
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_ct_p1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uintp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 302, __pyx_L1_error)
+  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uintp_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_allele_idx_offsets = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 302, __pyx_L1_error)
+    } else {__pyx_pybuffernd_allele_idx_offsets.diminfo[0].strides = __pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_idx_offsets.diminfo[0].shape = __pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_6 = 0;
+  __pyx_v_allele_idx_offsets = ((PyArrayObject *)__pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "pgenlib.pyx":303
+ *         cdef uint32_t variant_ct_p1 = 1 + self._mp.variant_ct
+ *         cdef np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets = np.zeros([variant_ct_p1], dtype=np.uintp)
+ *         if self._mp.allele_idx_offsetsp == NULL:             # <<<<<<<<<<<<<<
+ *             for variant_idx in range(variant_ct_p1):
+ *                 allele_idx_offsets[variant_idx] = 2 * variant_idx
+ */
+  __pyx_t_7 = ((__pyx_v_self->_mp.allele_idx_offsetsp == NULL) != 0);
+  if (__pyx_t_7) {
+
+    /* "pgenlib.pyx":304
+ *         cdef np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets = np.zeros([variant_ct_p1], dtype=np.uintp)
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ *             for variant_idx in range(variant_ct_p1):             # <<<<<<<<<<<<<<
+ *                 allele_idx_offsets[variant_idx] = 2 * variant_idx
+ *         else:
+ */
+    __pyx_t_5 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_ct_p1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
+      __pyx_t_5 = __pyx_t_3; __Pyx_INCREF(__pyx_t_5); __pyx_t_8 = 0;
+      __pyx_t_9 = NULL;
+    } else {
+      __pyx_t_8 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 304, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 304, __pyx_L1_error)
+    }
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    for (;;) {
+      if (likely(!__pyx_t_9)) {
+        if (likely(PyList_CheckExact(__pyx_t_5))) {
+          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_5)) break;
+          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 304, __pyx_L1_error)
+          #else
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 304, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          #endif
+        } else {
+          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
+          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 304, __pyx_L1_error)
+          #else
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 304, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          #endif
+        }
+      } else {
+        __pyx_t_3 = __pyx_t_9(__pyx_t_5);
+        if (unlikely(!__pyx_t_3)) {
+          PyObject* exc_type = PyErr_Occurred();
+          if (exc_type) {
+            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
+            else __PYX_ERR(0, 304, __pyx_L1_error)
+          }
+          break;
+        }
+        __Pyx_GOTREF(__pyx_t_3);
+      }
+      __Pyx_XDECREF_SET(__pyx_v_variant_idx, __pyx_t_3);
+      __pyx_t_3 = 0;
+
+      /* "pgenlib.pyx":305
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ *             for variant_idx in range(variant_ct_p1):
+ *                 allele_idx_offsets[variant_idx] = 2 * variant_idx             # <<<<<<<<<<<<<<
+ *         else:
+ *             memcpy(&(allele_idx_offsets[0]), self._mp.allele_idx_offsetsp.p, variant_ct_p1 * sizeof(uintptr_t))
+ */
+      __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_allele_idx_offsets), __pyx_v_variant_idx, __pyx_t_3) < 0)) __PYX_ERR(0, 305, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+
+      /* "pgenlib.pyx":304
+ *         cdef np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets = np.zeros([variant_ct_p1], dtype=np.uintp)
+ *         if self._mp.allele_idx_offsetsp == NULL:
+ *             for variant_idx in range(variant_ct_p1):             # <<<<<<<<<<<<<<
+ *                 allele_idx_offsets[variant_idx] = 2 * variant_idx
+ *         else:
+ */
+    }
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+    /* "pgenlib.pyx":303
+ *         cdef uint32_t variant_ct_p1 = 1 + self._mp.variant_ct
+ *         cdef np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets = np.zeros([variant_ct_p1], dtype=np.uintp)
+ *         if self._mp.allele_idx_offsetsp == NULL:             # <<<<<<<<<<<<<<
+ *             for variant_idx in range(variant_ct_p1):
+ *                 allele_idx_offsets[variant_idx] = 2 * variant_idx
+ */
+    goto __pyx_L3;
+  }
+
+  /* "pgenlib.pyx":307
+ *                 allele_idx_offsets[variant_idx] = 2 * variant_idx
+ *         else:
+ *             memcpy(&(allele_idx_offsets[0]), self._mp.allele_idx_offsetsp.p, variant_ct_p1 * sizeof(uintptr_t))             # <<<<<<<<<<<<<<
+ *         return allele_idx_offsets
+ * 
+ */
+  /*else*/ {
+    __pyx_t_10 = 0;
+    __pyx_t_11 = -1;
+    if (__pyx_t_10 < 0) {
+      __pyx_t_10 += __pyx_pybuffernd_allele_idx_offsets.diminfo[0].shape;
+      if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
+    } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_allele_idx_offsets.diminfo[0].shape)) __pyx_t_11 = 0;
+    if (unlikely(__pyx_t_11 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_11);
+      __PYX_ERR(0, 307, __pyx_L1_error)
+    }
+    (void)(memcpy((&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_uintp_t *, __pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_allele_idx_offsets.diminfo[0].strides))), __pyx_v_self->_mp.allele_idx_offsetsp->p, (__pyx_v_variant_ct_p1 * (sizeof(uintptr_t)))));
+  }
+  __pyx_L3:;
+
+  /* "pgenlib.pyx":308
+ *         else:
+ *             memcpy(&(allele_idx_offsets[0]), self._mp.allele_idx_offsetsp.p, variant_ct_p1 * sizeof(uintptr_t))
+ *         return allele_idx_offsets             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF(((PyObject *)__pyx_v_allele_idx_offsets));
+  __pyx_r = ((PyObject *)__pyx_v_allele_idx_offsets);
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":300
+ * 
+ * 
+ *     cpdef get_allele_idx_offsets(self):             # <<<<<<<<<<<<<<
+ *         cdef uint32_t variant_ct_p1 = 1 + self._mp.variant_ct
+ *         cdef np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets = np.zeros([variant_ct_p1], dtype=np.uintp)
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_PyThreadState_declare
+    __Pyx_PyThreadState_assign
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_allele_idx_offsets", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  goto __pyx_L2;
+  __pyx_L0:;
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer);
+  __pyx_L2:;
+  __Pyx_XDECREF((PyObject *)__pyx_v_allele_idx_offsets);
+  __Pyx_XDECREF(__pyx_v_variant_idx);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_13get_allele_idx_offsets(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_13get_allele_idx_offsets(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("get_allele_idx_offsets (wrapper)", 0);
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_12get_allele_idx_offsets(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_12get_allele_idx_offsets(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_allele_idx_offsets", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_7pgenlib_10PvarReader_get_allele_idx_offsets(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_allele_idx_offsets", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":311
+ * 
+ * 
+ *     cpdef get_max_allele_ct(self):             # <<<<<<<<<<<<<<
+ *         return self._mp.max_allele_ct
+ * 
+ */
+
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_15get_max_allele_ct(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_get_max_allele_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_max_allele_ct", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_max_allele_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PvarReader_15get_max_allele_ct)) {
+        __Pyx_XDECREF(__pyx_r);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_4)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_4);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_3, function);
+          }
+        }
+        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 311, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pgenlib.pyx":312
+ * 
+ *     cpdef get_max_allele_ct(self):
+ *         return self._mp.max_allele_ct             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_self->_mp.max_allele_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":311
+ * 
+ * 
+ *     cpdef get_max_allele_ct(self):             # <<<<<<<<<<<<<<
+ *         return self._mp.max_allele_ct
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_max_allele_ct", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_15get_max_allele_ct(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_15get_max_allele_ct(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("get_max_allele_ct (wrapper)", 0);
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_14get_max_allele_ct(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_14get_max_allele_ct(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("get_max_allele_ct", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_7pgenlib_10PvarReader_get_max_allele_ct(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.get_max_allele_ct", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":315
+ * 
+ * 
+ *     cpdef close(self):             # <<<<<<<<<<<<<<
+ *         CleanupMinimalPvar(&self._mp)
+ *         return
+ */
+
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_17close(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader_close(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("close", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_close); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PvarReader_17close)) {
+        __Pyx_XDECREF(__pyx_r);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_4)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_4);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_3, function);
+          }
+        }
+        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 315, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pgenlib.pyx":316
+ * 
+ *     cpdef close(self):
+ *         CleanupMinimalPvar(&self._mp)             # <<<<<<<<<<<<<<
+ *         return
+ * 
+ */
+  plink2::CleanupMinimalPvar((&__pyx_v_self->_mp));
+
+  /* "pgenlib.pyx":317
+ *     cpdef close(self):
+ *         CleanupMinimalPvar(&self._mp)
+ *         return             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":315
+ * 
+ * 
+ *     cpdef close(self):             # <<<<<<<<<<<<<<
+ *         CleanupMinimalPvar(&self._mp)
+ *         return
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_AddTraceback("pgenlib.PvarReader.close", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_17close(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_17close(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("close (wrapper)", 0);
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_16close(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_16close(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("close", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_7pgenlib_10PvarReader_close(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.close", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":320
+ * 
+ * 
+ *     cpdef __exit__(self, exc_type, exc_val, exc_tb):             # <<<<<<<<<<<<<<
+ *         self.close()
+ *         return
+ */
+
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_19__exit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_7pgenlib_10PvarReader___exit__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_exc_type, CYTHON_UNUSED PyObject *__pyx_v_exc_val, CYTHON_UNUSED PyObject *__pyx_v_exc_tb, int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  int __pyx_t_5;
+  PyObject *__pyx_t_6 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__exit__", 0);
+  /* Check if called by wrapper */
+  if (unlikely(__pyx_skip_dispatch)) ;
+  /* Check if overridden in Python */
+  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
+    #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
+      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      #endif
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_exit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PvarReader_19__exit__)) {
+        __Pyx_XDECREF(__pyx_r);
+        __Pyx_INCREF(__pyx_t_1);
+        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
+        __pyx_t_5 = 0;
+        if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_4)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_4);
+            __Pyx_INCREF(function);
+            __Pyx_DECREF_SET(__pyx_t_3, function);
+            __pyx_t_5 = 1;
+          }
+        }
+        #if CYTHON_FAST_PYCALL
+        if (PyFunction_Check(__pyx_t_3)) {
+          PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb};
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+        } else
+        #endif
+        #if CYTHON_FAST_PYCCALL
+        if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+          PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb};
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)
+          __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+          __Pyx_GOTREF(__pyx_t_2);
+        } else
+        #endif
+        {
+          __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 320, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_6);
+          if (__pyx_t_4) {
+            __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
+          }
+          __Pyx_INCREF(__pyx_v_exc_type);
+          __Pyx_GIVEREF(__pyx_v_exc_type);
+          PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_exc_type);
+          __Pyx_INCREF(__pyx_v_exc_val);
+          __Pyx_GIVEREF(__pyx_v_exc_val);
+          PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_exc_val);
+          __Pyx_INCREF(__pyx_v_exc_tb);
+          __Pyx_GIVEREF(__pyx_v_exc_tb);
+          PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_5, __pyx_v_exc_tb);
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
+          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+        }
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_r = __pyx_t_2;
+        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        goto __pyx_L0;
+      }
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
+      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
+      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
+        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
+      }
+      #endif
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
+    }
+    #endif
+  }
+
+  /* "pgenlib.pyx":321
+ * 
+ *     cpdef __exit__(self, exc_type, exc_val, exc_tb):
+ *         self.close()             # <<<<<<<<<<<<<<
+ *         return
+ * 
+ */
+  __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PvarReader *)__pyx_v_self->__pyx_vtab)->close(__pyx_v_self, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "pgenlib.pyx":322
+ *     cpdef __exit__(self, exc_type, exc_val, exc_tb):
+ *         self.close()
+ *         return             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":320
+ * 
+ * 
+ *     cpdef __exit__(self, exc_type, exc_val, exc_tb):             # <<<<<<<<<<<<<<
+ *         self.close()
+ *         return
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_6);
+  __Pyx_AddTraceback("pgenlib.PvarReader.__exit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_19__exit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_19__exit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyObject *__pyx_v_exc_type = 0;
+  PyObject *__pyx_v_exc_val = 0;
+  PyObject *__pyx_v_exc_tb = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__exit__ (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_exc_type,&__pyx_n_s_exc_val,&__pyx_n_s_exc_tb,0};
+    PyObject* values[3] = {0,0,0};
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exc_type)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exc_val)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 1); __PYX_ERR(0, 320, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exc_tb)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 2); __PYX_ERR(0, 320, __pyx_L3_error)
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__exit__") < 0)) __PYX_ERR(0, 320, __pyx_L3_error)
+      }
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+    }
+    __pyx_v_exc_type = values[0];
+    __pyx_v_exc_val = values[1];
+    __pyx_v_exc_tb = values[2];
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 320, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("pgenlib.PvarReader.__exit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_18__exit__(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self), __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_18__exit__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, PyObject *__pyx_v_exc_type, PyObject *__pyx_v_exc_val, PyObject *__pyx_v_exc_tb) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__exit__", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_7pgenlib_10PvarReader___exit__(__pyx_v_self, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.__exit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":325
+ * 
+ * 
+ *     def __dealloc__(self):             # <<<<<<<<<<<<<<
+ *         CleanupMinimalPvar(&self._mp)
+ *         return
+ */
+
+/* Python wrapper */
+static void __pyx_pw_7pgenlib_10PvarReader_21__dealloc__(PyObject *__pyx_v_self); /*proto*/
+static void __pyx_pw_7pgenlib_10PvarReader_21__dealloc__(PyObject *__pyx_v_self) {
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
+  __pyx_pf_7pgenlib_10PvarReader_20__dealloc__(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+}
+
+static void __pyx_pf_7pgenlib_10PvarReader_20__dealloc__(struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self) {
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__dealloc__", 0);
+
+  /* "pgenlib.pyx":326
+ * 
+ *     def __dealloc__(self):
+ *         CleanupMinimalPvar(&self._mp)             # <<<<<<<<<<<<<<
+ *         return
+ * 
+ */
+  plink2::CleanupMinimalPvar((&__pyx_v_self->_mp));
+
+  /* "pgenlib.pyx":327
+ *     def __dealloc__(self):
+ *         CleanupMinimalPvar(&self._mp)
+ *         return             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  goto __pyx_L0;
+
+  /* "pgenlib.pyx":325
+ * 
+ * 
+ *     def __dealloc__(self):             # <<<<<<<<<<<<<<
+ *         CleanupMinimalPvar(&self._mp)
+ *         return
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+}
+
+/* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_23__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_23__reduce_cython__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_22__reduce_cython__(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_22__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__reduce_cython__", 0);
+
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(1, 2, __pyx_L1_error)
+
+  /* "(tree fragment)":1
+ * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_25__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state); /*proto*/
+static PyObject *__pyx_pw_7pgenlib_10PvarReader_25__setstate_cython__(PyObject *__pyx_v_self, PyObject *__pyx_v___pyx_state) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
+  __pyx_r = __pyx_pf_7pgenlib_10PvarReader_24__setstate_cython__(((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_v_self), ((PyObject *)__pyx_v___pyx_state));
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_7pgenlib_10PvarReader_24__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("__setstate_cython__", 0);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __PYX_ERR(1, 4, __pyx_L1_error)
+
+  /* "(tree fragment)":3
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("pgenlib.PvarReader.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "pgenlib.pyx":352
  *     cdef uintptr_t* _multivar_smaj_phasepresent_batch_buf
  * 
  *     cdef set_allele_idx_offsets_internal(self, np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets):             # <<<<<<<<<<<<<<
  *         # Make a copy instead of trying to share this with the caller.
  *         cdef uint32_t nvariant = self._info_ptr[0].raw_variant_ct
  */
 
@@ -3092,94 +5655,94 @@
   __Pyx_RefNannySetupContext("set_allele_idx_offsets_internal", 0);
   __pyx_pybuffer_allele_idx_offsets.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_idx_offsets.refcount = 0;
   __pyx_pybuffernd_allele_idx_offsets.data = NULL;
   __pyx_pybuffernd_allele_idx_offsets.rcbuffer = &__pyx_pybuffer_allele_idx_offsets;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_idx_offsets, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uintp_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 249, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_idx_offsets, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uintp_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 352, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_idx_offsets.diminfo[0].strides = __pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_idx_offsets.diminfo[0].shape = __pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer.shape[0];
 
-  /* "pgenlib.pyx":251
+  /* "pgenlib.pyx":354
  *     cdef set_allele_idx_offsets_internal(self, np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets):
  *         # Make a copy instead of trying to share this with the caller.
  *         cdef uint32_t nvariant = self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  *         cdef uintptr_t nbytes = (1 + nvariant) * sizeof(uintptr_t)
  *         if cachealigned_malloc(nbytes, &self._info_ptr[0].allele_idx_offsets):
  */
   __pyx_t_1 = (__pyx_v_self->_info_ptr[0]).raw_variant_ct;
   __pyx_v_nvariant = __pyx_t_1;
 
-  /* "pgenlib.pyx":252
+  /* "pgenlib.pyx":355
  *         # Make a copy instead of trying to share this with the caller.
  *         cdef uint32_t nvariant = self._info_ptr[0].raw_variant_ct
  *         cdef uintptr_t nbytes = (1 + nvariant) * sizeof(uintptr_t)             # <<<<<<<<<<<<<<
  *         if cachealigned_malloc(nbytes, &self._info_ptr[0].allele_idx_offsets):
  *             raise MemoryError()
  */
   __pyx_v_nbytes = ((1 + __pyx_v_nvariant) * (sizeof(uintptr_t)));
 
-  /* "pgenlib.pyx":253
+  /* "pgenlib.pyx":356
  *         cdef uint32_t nvariant = self._info_ptr[0].raw_variant_ct
  *         cdef uintptr_t nbytes = (1 + nvariant) * sizeof(uintptr_t)
  *         if cachealigned_malloc(nbytes, &self._info_ptr[0].allele_idx_offsets):             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         memcpy(self._info_ptr[0].allele_idx_offsets, &(allele_idx_offsets[0]), nbytes)
  */
   __pyx_t_2 = (plink2::cachealigned_malloc(__pyx_v_nbytes, (&(__pyx_v_self->_info_ptr[0]).allele_idx_offsets)) != 0);
   if (unlikely(__pyx_t_2)) {
 
-    /* "pgenlib.pyx":254
+    /* "pgenlib.pyx":357
  *         cdef uintptr_t nbytes = (1 + nvariant) * sizeof(uintptr_t)
  *         if cachealigned_malloc(nbytes, &self._info_ptr[0].allele_idx_offsets):
  *             raise MemoryError()             # <<<<<<<<<<<<<<
  *         memcpy(self._info_ptr[0].allele_idx_offsets, &(allele_idx_offsets[0]), nbytes)
  *         self._info_ptr[0].max_allele_ct = PglComputeMaxAlleleCt(self._info_ptr[0].allele_idx_offsets, nvariant)
  */
-    PyErr_NoMemory(); __PYX_ERR(0, 254, __pyx_L1_error)
+    PyErr_NoMemory(); __PYX_ERR(0, 357, __pyx_L1_error)
 
-    /* "pgenlib.pyx":253
+    /* "pgenlib.pyx":356
  *         cdef uint32_t nvariant = self._info_ptr[0].raw_variant_ct
  *         cdef uintptr_t nbytes = (1 + nvariant) * sizeof(uintptr_t)
  *         if cachealigned_malloc(nbytes, &self._info_ptr[0].allele_idx_offsets):             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         memcpy(self._info_ptr[0].allele_idx_offsets, &(allele_idx_offsets[0]), nbytes)
  */
   }
 
-  /* "pgenlib.pyx":255
+  /* "pgenlib.pyx":358
  *         if cachealigned_malloc(nbytes, &self._info_ptr[0].allele_idx_offsets):
  *             raise MemoryError()
  *         memcpy(self._info_ptr[0].allele_idx_offsets, &(allele_idx_offsets[0]), nbytes)             # <<<<<<<<<<<<<<
  *         self._info_ptr[0].max_allele_ct = PglComputeMaxAlleleCt(self._info_ptr[0].allele_idx_offsets, nvariant)
  * 
  */
   __pyx_t_3 = 0;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_pybuffernd_allele_idx_offsets.diminfo[0].shape;
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_pybuffernd_allele_idx_offsets.diminfo[0].shape)) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 255, __pyx_L1_error)
+    __PYX_ERR(0, 358, __pyx_L1_error)
   }
   (void)(memcpy((__pyx_v_self->_info_ptr[0]).allele_idx_offsets, (&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_uintp_t *, __pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer.buf, __pyx_t_3, __pyx_pybuffernd_allele_idx_offsets.diminfo[0].strides))), __pyx_v_nbytes));
 
-  /* "pgenlib.pyx":256
+  /* "pgenlib.pyx":359
  *             raise MemoryError()
  *         memcpy(self._info_ptr[0].allele_idx_offsets, &(allele_idx_offsets[0]), nbytes)
  *         self._info_ptr[0].max_allele_ct = PglComputeMaxAlleleCt(self._info_ptr[0].allele_idx_offsets, nvariant)             # <<<<<<<<<<<<<<
  * 
  *     cdef set_sample_subset_internal(self, np.ndarray[np.uint32_t,mode="c",ndim=1] sample_subset):
  */
   (__pyx_v_self->_info_ptr[0]).max_allele_ct = plink2::PglComputeMaxAlleleCt((__pyx_v_self->_info_ptr[0]).allele_idx_offsets, __pyx_v_nvariant);
 
-  /* "pgenlib.pyx":249
+  /* "pgenlib.pyx":352
  *     cdef uintptr_t* _multivar_smaj_phasepresent_batch_buf
  * 
  *     cdef set_allele_idx_offsets_internal(self, np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets):             # <<<<<<<<<<<<<<
  *         # Make a copy instead of trying to share this with the caller.
  *         cdef uint32_t nvariant = self._info_ptr[0].raw_variant_ct
  */
 
@@ -3200,15 +5763,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_allele_idx_offsets.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":258
+/* "pgenlib.pyx":361
  *         self._info_ptr[0].max_allele_ct = PglComputeMaxAlleleCt(self._info_ptr[0].allele_idx_offsets, nvariant)
  * 
  *     cdef set_sample_subset_internal(self, np.ndarray[np.uint32_t,mode="c",ndim=1] sample_subset):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_sample_ct = self._info_ptr[0].raw_sample_ct
  *         cdef uint32_t raw_sample_ctv = DivUp(raw_sample_ct, kBitsPerVec)
  */
 
@@ -3244,402 +5807,402 @@
   __Pyx_RefNannySetupContext("set_sample_subset_internal", 0);
   __pyx_pybuffer_sample_subset.pybuffer.buf = NULL;
   __pyx_pybuffer_sample_subset.refcount = 0;
   __pyx_pybuffernd_sample_subset.data = NULL;
   __pyx_pybuffernd_sample_subset.rcbuffer = &__pyx_pybuffer_sample_subset;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sample_subset.rcbuffer->pybuffer, (PyObject*)__pyx_v_sample_subset, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 258, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sample_subset.rcbuffer->pybuffer, (PyObject*)__pyx_v_sample_subset, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 361, __pyx_L1_error)
   }
   __pyx_pybuffernd_sample_subset.diminfo[0].strides = __pyx_pybuffernd_sample_subset.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sample_subset.diminfo[0].shape = __pyx_pybuffernd_sample_subset.rcbuffer->pybuffer.shape[0];
 
-  /* "pgenlib.pyx":259
+  /* "pgenlib.pyx":362
  * 
  *     cdef set_sample_subset_internal(self, np.ndarray[np.uint32_t,mode="c",ndim=1] sample_subset):
  *         cdef uint32_t raw_sample_ct = self._info_ptr[0].raw_sample_ct             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_sample_ctv = DivUp(raw_sample_ct, kBitsPerVec)
  *         cdef uint32_t raw_sample_ctaw = raw_sample_ctv * kWordsPerVec
  */
   __pyx_t_1 = (__pyx_v_self->_info_ptr[0]).raw_sample_ct;
   __pyx_v_raw_sample_ct = __pyx_t_1;
 
-  /* "pgenlib.pyx":260
+  /* "pgenlib.pyx":363
  *     cdef set_sample_subset_internal(self, np.ndarray[np.uint32_t,mode="c",ndim=1] sample_subset):
  *         cdef uint32_t raw_sample_ct = self._info_ptr[0].raw_sample_ct
  *         cdef uint32_t raw_sample_ctv = DivUp(raw_sample_ct, kBitsPerVec)             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_sample_ctaw = raw_sample_ctv * kWordsPerVec
  *         cdef uintptr_t* sample_include = self._subset_include_vec
  */
   __pyx_v_raw_sample_ctv = plink2::DivUp(__pyx_v_raw_sample_ct, plink2::kBitsPerVec);
 
-  /* "pgenlib.pyx":261
+  /* "pgenlib.pyx":364
  *         cdef uint32_t raw_sample_ct = self._info_ptr[0].raw_sample_ct
  *         cdef uint32_t raw_sample_ctv = DivUp(raw_sample_ct, kBitsPerVec)
  *         cdef uint32_t raw_sample_ctaw = raw_sample_ctv * kWordsPerVec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* sample_include = self._subset_include_vec
  *         ZeroWArr(raw_sample_ctaw, sample_include)
  */
   __pyx_v_raw_sample_ctaw = (__pyx_v_raw_sample_ctv * plink2::kWordsPerVec);
 
-  /* "pgenlib.pyx":262
+  /* "pgenlib.pyx":365
  *         cdef uint32_t raw_sample_ctv = DivUp(raw_sample_ct, kBitsPerVec)
  *         cdef uint32_t raw_sample_ctaw = raw_sample_ctv * kWordsPerVec
  *         cdef uintptr_t* sample_include = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         ZeroWArr(raw_sample_ctaw, sample_include)
  *         cdef uint32_t subset_size = sample_subset.size
  */
   __pyx_t_2 = __pyx_v_self->_subset_include_vec;
   __pyx_v_sample_include = __pyx_t_2;
 
-  /* "pgenlib.pyx":263
+  /* "pgenlib.pyx":366
  *         cdef uint32_t raw_sample_ctaw = raw_sample_ctv * kWordsPerVec
  *         cdef uintptr_t* sample_include = self._subset_include_vec
  *         ZeroWArr(raw_sample_ctaw, sample_include)             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = sample_subset.size
  *         if subset_size == 0:
  */
   plink2::ZeroWArr(__pyx_v_raw_sample_ctaw, __pyx_v_sample_include);
 
-  /* "pgenlib.pyx":264
+  /* "pgenlib.pyx":367
  *         cdef uintptr_t* sample_include = self._subset_include_vec
  *         ZeroWArr(raw_sample_ctaw, sample_include)
  *         cdef uint32_t subset_size = sample_subset.size             # <<<<<<<<<<<<<<
  *         if subset_size == 0:
  *             raise RuntimeError("Empty sample_subset is not currently permitted.")
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_sample_subset), __pyx_n_s_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_sample_subset), __pyx_n_s_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 367, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyInt_As_uint32_t(__pyx_t_3); if (unlikely((__pyx_t_1 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 264, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_As_uint32_t(__pyx_t_3); if (unlikely((__pyx_t_1 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 367, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_subset_size = __pyx_t_1;
 
-  /* "pgenlib.pyx":265
+  /* "pgenlib.pyx":368
  *         ZeroWArr(raw_sample_ctaw, sample_include)
  *         cdef uint32_t subset_size = sample_subset.size
  *         if subset_size == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Empty sample_subset is not currently permitted.")
  *         cdef sample_uidx = sample_subset[0]
  */
   __pyx_t_4 = ((__pyx_v_subset_size == 0) != 0);
   if (unlikely(__pyx_t_4)) {
 
-    /* "pgenlib.pyx":266
+    /* "pgenlib.pyx":369
  *         cdef uint32_t subset_size = sample_subset.size
  *         if subset_size == 0:
  *             raise RuntimeError("Empty sample_subset is not currently permitted.")             # <<<<<<<<<<<<<<
  *         cdef sample_uidx = sample_subset[0]
  *         cdef uint32_t idx = 0
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 266, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 369, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 266, __pyx_L1_error)
+    __PYX_ERR(0, 369, __pyx_L1_error)
 
-    /* "pgenlib.pyx":265
+    /* "pgenlib.pyx":368
  *         ZeroWArr(raw_sample_ctaw, sample_include)
  *         cdef uint32_t subset_size = sample_subset.size
  *         if subset_size == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Empty sample_subset is not currently permitted.")
  *         cdef sample_uidx = sample_subset[0]
  */
   }
 
-  /* "pgenlib.pyx":267
+  /* "pgenlib.pyx":370
  *         if subset_size == 0:
  *             raise RuntimeError("Empty sample_subset is not currently permitted.")
  *         cdef sample_uidx = sample_subset[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t idx = 0
  *         cdef next_uidx
  */
   __pyx_t_5 = 0;
   __pyx_t_6 = -1;
   if (__pyx_t_5 < 0) {
     __pyx_t_5 += __pyx_pybuffernd_sample_subset.diminfo[0].shape;
     if (unlikely(__pyx_t_5 < 0)) __pyx_t_6 = 0;
   } else if (unlikely(__pyx_t_5 >= __pyx_pybuffernd_sample_subset.diminfo[0].shape)) __pyx_t_6 = 0;
   if (unlikely(__pyx_t_6 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_6);
-    __PYX_ERR(0, 267, __pyx_L1_error)
+    __PYX_ERR(0, 370, __pyx_L1_error)
   }
-  __pyx_t_3 = __Pyx_PyInt_From_npy_uint32((*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_sample_subset.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_sample_subset.diminfo[0].strides))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 267, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_npy_uint32((*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_sample_subset.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_sample_subset.diminfo[0].strides))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 370, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_sample_uidx = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "pgenlib.pyx":268
+  /* "pgenlib.pyx":371
  *             raise RuntimeError("Empty sample_subset is not currently permitted.")
  *         cdef sample_uidx = sample_subset[0]
  *         cdef uint32_t idx = 0             # <<<<<<<<<<<<<<
  *         cdef next_uidx
  *         while True:
  */
   __pyx_v_idx = 0;
 
-  /* "pgenlib.pyx":270
+  /* "pgenlib.pyx":373
  *         cdef uint32_t idx = 0
  *         cdef next_uidx
  *         while True:             # <<<<<<<<<<<<<<
  *             if sample_uidx >= raw_sample_ct:
  *                 raise RuntimeError("0-based sample idx too large (" + str(sample_uidx) + "; only " + str(raw_sample_ct) + " in file).")
  */
   while (1) {
 
-    /* "pgenlib.pyx":271
+    /* "pgenlib.pyx":374
  *         cdef next_uidx
  *         while True:
  *             if sample_uidx >= raw_sample_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("0-based sample idx too large (" + str(sample_uidx) + "; only " + str(raw_sample_ct) + " in file).")
  *             sample_include[sample_uidx // kBitsPerWord] |= k1LU << (sample_uidx % kBitsPerWord)
  */
-    __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_sample_ct); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 271, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_sample_ct); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = PyObject_RichCompare(__pyx_v_sample_uidx, __pyx_t_3, Py_GE); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 271, __pyx_L1_error)
+    __pyx_t_7 = PyObject_RichCompare(__pyx_v_sample_uidx, __pyx_t_3, Py_GE); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 271, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (unlikely(__pyx_t_4)) {
 
-      /* "pgenlib.pyx":272
+      /* "pgenlib.pyx":375
  *         while True:
  *             if sample_uidx >= raw_sample_ct:
  *                 raise RuntimeError("0-based sample idx too large (" + str(sample_uidx) + "; only " + str(raw_sample_ct) + " in file).")             # <<<<<<<<<<<<<<
  *             sample_include[sample_uidx // kBitsPerWord] |= k1LU << (sample_uidx % kBitsPerWord)
  *             idx += 1
  */
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_v_sample_uidx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 272, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_v_sample_uidx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 375, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_0_based_sample_idx_too_large, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 272, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_0_based_sample_idx_too_large, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 375, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_3, __pyx_kp_u_only); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 272, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_3, __pyx_kp_u_only); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 375, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_sample_ct); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 272, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_sample_ct); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 375, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 272, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 375, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 272, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 375, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_3, __pyx_kp_u_in_file); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 272, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_3, __pyx_kp_u_in_file); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 375, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 272, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 375, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(0, 272, __pyx_L1_error)
+      __PYX_ERR(0, 375, __pyx_L1_error)
 
-      /* "pgenlib.pyx":271
+      /* "pgenlib.pyx":374
  *         cdef next_uidx
  *         while True:
  *             if sample_uidx >= raw_sample_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("0-based sample idx too large (" + str(sample_uidx) + "; only " + str(raw_sample_ct) + " in file).")
  *             sample_include[sample_uidx // kBitsPerWord] |= k1LU << (sample_uidx % kBitsPerWord)
  */
     }
 
-    /* "pgenlib.pyx":273
+    /* "pgenlib.pyx":376
  *             if sample_uidx >= raw_sample_ct:
  *                 raise RuntimeError("0-based sample idx too large (" + str(sample_uidx) + "; only " + str(raw_sample_ct) + " in file).")
  *             sample_include[sample_uidx // kBitsPerWord] |= k1LU << (sample_uidx % kBitsPerWord)             # <<<<<<<<<<<<<<
  *             idx += 1
  *             if idx == subset_size:
  */
-    __pyx_t_3 = __Pyx_PyInt_From_int(plink2::kBitsPerWord); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_int(plink2::kBitsPerWord); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_8 = PyNumber_FloorDivide(__pyx_v_sample_uidx, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_FloorDivide(__pyx_v_sample_uidx, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_8); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_8); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_FromSize_t((__pyx_v_sample_include[__pyx_t_9])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_FromSize_t((__pyx_v_sample_include[__pyx_t_9])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_3 = __Pyx_PyInt_From_int(plink2::k1LU); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_int(plink2::k1LU); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = __Pyx_PyInt_From_int(plink2::kBitsPerWord); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(plink2::kBitsPerWord); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_10 = PyNumber_Remainder(__pyx_v_sample_uidx, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Remainder(__pyx_v_sample_uidx, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Lshift(__pyx_t_3, __pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Lshift(__pyx_t_3, __pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyNumber_InPlaceOr(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_InPlaceOr(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_11 = __Pyx_PyInt_As_size_t(__pyx_t_10); if (unlikely((__pyx_t_11 == ((uintptr_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 273, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyInt_As_size_t(__pyx_t_10); if (unlikely((__pyx_t_11 == ((uintptr_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     (__pyx_v_sample_include[__pyx_t_9]) = __pyx_t_11;
 
-    /* "pgenlib.pyx":274
+    /* "pgenlib.pyx":377
  *                 raise RuntimeError("0-based sample idx too large (" + str(sample_uidx) + "; only " + str(raw_sample_ct) + " in file).")
  *             sample_include[sample_uidx // kBitsPerWord] |= k1LU << (sample_uidx % kBitsPerWord)
  *             idx += 1             # <<<<<<<<<<<<<<
  *             if idx == subset_size:
  *                 break
  */
     __pyx_v_idx = (__pyx_v_idx + 1);
 
-    /* "pgenlib.pyx":275
+    /* "pgenlib.pyx":378
  *             sample_include[sample_uidx // kBitsPerWord] |= k1LU << (sample_uidx % kBitsPerWord)
  *             idx += 1
  *             if idx == subset_size:             # <<<<<<<<<<<<<<
  *                 break
  *             next_uidx = sample_subset[idx]
  */
     __pyx_t_4 = ((__pyx_v_idx == __pyx_v_subset_size) != 0);
     if (__pyx_t_4) {
 
-      /* "pgenlib.pyx":276
+      /* "pgenlib.pyx":379
  *             idx += 1
  *             if idx == subset_size:
  *                 break             # <<<<<<<<<<<<<<
  *             next_uidx = sample_subset[idx]
  * 
  */
       goto __pyx_L5_break;
 
-      /* "pgenlib.pyx":275
+      /* "pgenlib.pyx":378
  *             sample_include[sample_uidx // kBitsPerWord] |= k1LU << (sample_uidx % kBitsPerWord)
  *             idx += 1
  *             if idx == subset_size:             # <<<<<<<<<<<<<<
  *                 break
  *             next_uidx = sample_subset[idx]
  */
     }
 
-    /* "pgenlib.pyx":277
+    /* "pgenlib.pyx":380
  *             if idx == subset_size:
  *                 break
  *             next_uidx = sample_subset[idx]             # <<<<<<<<<<<<<<
  * 
  *             # prohibit this since it implies that the caller expects genotypes
  */
     __pyx_t_12 = __pyx_v_idx;
     __pyx_t_6 = -1;
     if (unlikely(__pyx_t_12 >= (size_t)__pyx_pybuffernd_sample_subset.diminfo[0].shape)) __pyx_t_6 = 0;
     if (unlikely(__pyx_t_6 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_6);
-      __PYX_ERR(0, 277, __pyx_L1_error)
+      __PYX_ERR(0, 380, __pyx_L1_error)
     }
-    __pyx_t_10 = __Pyx_PyInt_From_npy_uint32((*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_sample_subset.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_sample_subset.diminfo[0].strides))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 277, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_From_npy_uint32((*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_sample_subset.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_sample_subset.diminfo[0].strides))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_XDECREF_SET(__pyx_v_next_uidx, __pyx_t_10);
     __pyx_t_10 = 0;
 
-    /* "pgenlib.pyx":281
+    /* "pgenlib.pyx":384
  *             # prohibit this since it implies that the caller expects genotypes
  *             # to be returned in a different order
  *             if next_uidx <= sample_uidx:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("sample_subset is not in strictly increasing order.")
  * 
  */
-    __pyx_t_10 = PyObject_RichCompare(__pyx_v_next_uidx, __pyx_v_sample_uidx, Py_LE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 281, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 281, __pyx_L1_error)
+    __pyx_t_10 = PyObject_RichCompare(__pyx_v_next_uidx, __pyx_v_sample_uidx, Py_LE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 384, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     if (unlikely(__pyx_t_4)) {
 
-      /* "pgenlib.pyx":282
+      /* "pgenlib.pyx":385
  *             # to be returned in a different order
  *             if next_uidx <= sample_uidx:
  *                 raise RuntimeError("sample_subset is not in strictly increasing order.")             # <<<<<<<<<<<<<<
  * 
  *             sample_uidx = next_uidx
  */
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 282, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 385, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __PYX_ERR(0, 282, __pyx_L1_error)
+      __PYX_ERR(0, 385, __pyx_L1_error)
 
-      /* "pgenlib.pyx":281
+      /* "pgenlib.pyx":384
  *             # prohibit this since it implies that the caller expects genotypes
  *             # to be returned in a different order
  *             if next_uidx <= sample_uidx:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("sample_subset is not in strictly increasing order.")
  * 
  */
     }
 
-    /* "pgenlib.pyx":284
+    /* "pgenlib.pyx":387
  *                 raise RuntimeError("sample_subset is not in strictly increasing order.")
  * 
  *             sample_uidx = next_uidx             # <<<<<<<<<<<<<<
  * 
  *         FillInterleavedMaskVec(sample_include, raw_sample_ctv, self._subset_include_interleaved_vec)
  */
     __Pyx_INCREF(__pyx_v_next_uidx);
     __Pyx_DECREF_SET(__pyx_v_sample_uidx, __pyx_v_next_uidx);
   }
   __pyx_L5_break:;
 
-  /* "pgenlib.pyx":286
+  /* "pgenlib.pyx":389
  *             sample_uidx = next_uidx
  * 
  *         FillInterleavedMaskVec(sample_include, raw_sample_ctv, self._subset_include_interleaved_vec)             # <<<<<<<<<<<<<<
  * 
  *         cdef uint32_t raw_sample_ctl = DivUp(raw_sample_ct, kBitsPerWord)
  */
   plink2::FillInterleavedMaskVec(__pyx_v_sample_include, __pyx_v_raw_sample_ctv, __pyx_v_self->_subset_include_interleaved_vec);
 
-  /* "pgenlib.pyx":288
+  /* "pgenlib.pyx":391
  *         FillInterleavedMaskVec(sample_include, raw_sample_ctv, self._subset_include_interleaved_vec)
  * 
  *         cdef uint32_t raw_sample_ctl = DivUp(raw_sample_ct, kBitsPerWord)             # <<<<<<<<<<<<<<
  *         # er, this isn't a safe usage pattern.
  *         FillCumulativePopcounts(sample_include, raw_sample_ctl, self._subset_cumulative_popcounts)
  */
   __pyx_v_raw_sample_ctl = plink2::DivUp(__pyx_v_raw_sample_ct, plink2::kBitsPerWord);
 
-  /* "pgenlib.pyx":290
+  /* "pgenlib.pyx":393
  *         cdef uint32_t raw_sample_ctl = DivUp(raw_sample_ct, kBitsPerWord)
  *         # er, this isn't a safe usage pattern.
  *         FillCumulativePopcounts(sample_include, raw_sample_ctl, self._subset_cumulative_popcounts)             # <<<<<<<<<<<<<<
  *         PgrSetSampleSubsetIndex(self._subset_cumulative_popcounts, self._state_ptr, &(self._subset_index))
  * 
  */
   plink2::FillCumulativePopcounts(__pyx_v_sample_include, __pyx_v_raw_sample_ctl, __pyx_v_self->_subset_cumulative_popcounts);
 
-  /* "pgenlib.pyx":291
+  /* "pgenlib.pyx":394
  *         # er, this isn't a safe usage pattern.
  *         FillCumulativePopcounts(sample_include, raw_sample_ctl, self._subset_cumulative_popcounts)
  *         PgrSetSampleSubsetIndex(self._subset_cumulative_popcounts, self._state_ptr, &(self._subset_index))             # <<<<<<<<<<<<<<
  * 
  *         self._subset_size = subset_size
  */
   plink2::PgrSetSampleSubsetIndex(__pyx_v_self->_subset_cumulative_popcounts, __pyx_v_self->_state_ptr, (&__pyx_v_self->_subset_index));
 
-  /* "pgenlib.pyx":293
+  /* "pgenlib.pyx":396
  *         PgrSetSampleSubsetIndex(self._subset_cumulative_popcounts, self._state_ptr, &(self._subset_index))
  * 
  *         self._subset_size = subset_size             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   __pyx_v_self->_subset_size = __pyx_v_subset_size;
 
-  /* "pgenlib.pyx":294
+  /* "pgenlib.pyx":397
  * 
  *         self._subset_size = subset_size
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":258
+  /* "pgenlib.pyx":361
  *         self._info_ptr[0].max_allele_ct = PglComputeMaxAlleleCt(self._info_ptr[0].allele_idx_offsets, nvariant)
  * 
  *     cdef set_sample_subset_internal(self, np.ndarray[np.uint32_t,mode="c",ndim=1] sample_subset):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_sample_ct = self._info_ptr[0].raw_sample_ct
  *         cdef uint32_t raw_sample_ctv = DivUp(raw_sample_ct, kBitsPerVec)
  */
 
@@ -3664,63 +6227,67 @@
   __Pyx_XDECREF(__pyx_v_sample_uidx);
   __Pyx_XDECREF(__pyx_v_next_uidx);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":297
+/* "pgenlib.pyx":400
  * 
  * 
  *     def __cinit__(self, bytes filename, object raw_sample_ct = None,             # <<<<<<<<<<<<<<
  *                   object variant_ct = None, object sample_subset = None,
- *                   object allele_idx_offsets = None):
+ *                   object allele_idx_offsets = None, object pvar = None):
  */
 
 /* Python wrapper */
 static int __pyx_pw_7pgenlib_10PgenReader_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_pw_7pgenlib_10PgenReader_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_filename = 0;
   PyObject *__pyx_v_raw_sample_ct = 0;
   PyObject *__pyx_v_variant_ct = 0;
   PyObject *__pyx_v_sample_subset = 0;
   PyObject *__pyx_v_allele_idx_offsets = 0;
+  PyObject *__pyx_v_pvar = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_filename,&__pyx_n_s_raw_sample_ct,&__pyx_n_s_variant_ct,&__pyx_n_s_sample_subset,&__pyx_n_s_allele_idx_offsets,0};
-    PyObject* values[5] = {0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_filename,&__pyx_n_s_raw_sample_ct,&__pyx_n_s_variant_ct,&__pyx_n_s_sample_subset,&__pyx_n_s_allele_idx_offsets,&__pyx_n_s_pvar,0};
+    PyObject* values[6] = {0,0,0,0,0,0};
     values[1] = ((PyObject *)Py_None);
 
-    /* "pgenlib.pyx":298
+    /* "pgenlib.pyx":401
  * 
  *     def __cinit__(self, bytes filename, object raw_sample_ct = None,
  *                   object variant_ct = None, object sample_subset = None,             # <<<<<<<<<<<<<<
- *                   object allele_idx_offsets = None):
+ *                   object allele_idx_offsets = None, object pvar = None):
  *         self._info_ptr = <PgenFileInfo*>PyMem_Malloc(sizeof(PgenFileInfo))
  */
     values[2] = ((PyObject *)Py_None);
     values[3] = ((PyObject *)Py_None);
 
-    /* "pgenlib.pyx":299
+    /* "pgenlib.pyx":402
  *     def __cinit__(self, bytes filename, object raw_sample_ct = None,
  *                   object variant_ct = None, object sample_subset = None,
- *                   object allele_idx_offsets = None):             # <<<<<<<<<<<<<<
+ *                   object allele_idx_offsets = None, object pvar = None):             # <<<<<<<<<<<<<<
  *         self._info_ptr = <PgenFileInfo*>PyMem_Malloc(sizeof(PgenFileInfo))
  *         if not self._info_ptr:
  */
     values[4] = ((PyObject *)Py_None);
+    values[5] = ((PyObject *)Py_None);
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
@@ -3755,20 +6322,28 @@
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_idx_offsets);
           if (value) { values[4] = value; kw_args--; }
         }
+        CYTHON_FALLTHROUGH;
+        case  5:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pvar);
+          if (value) { values[5] = value; kw_args--; }
+        }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 297, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 400, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
@@ -3779,46 +6354,48 @@
       }
     }
     __pyx_v_filename = ((PyObject*)values[0]);
     __pyx_v_raw_sample_ct = values[1];
     __pyx_v_variant_ct = values[2];
     __pyx_v_sample_subset = values[3];
     __pyx_v_allele_idx_offsets = values[4];
+    __pyx_v_pvar = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 1, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 297, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 1, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 400, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_filename), (&PyBytes_Type), 1, "filename", 1))) __PYX_ERR(0, 297, __pyx_L1_error)
-  __pyx_r = __pyx_pf_7pgenlib_10PgenReader___cinit__(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_filename, __pyx_v_raw_sample_ct, __pyx_v_variant_ct, __pyx_v_sample_subset, __pyx_v_allele_idx_offsets);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_filename), (&PyBytes_Type), 1, "filename", 1))) __PYX_ERR(0, 400, __pyx_L1_error)
+  __pyx_r = __pyx_pf_7pgenlib_10PgenReader___cinit__(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_filename, __pyx_v_raw_sample_ct, __pyx_v_variant_ct, __pyx_v_sample_subset, __pyx_v_allele_idx_offsets, __pyx_v_pvar);
 
-  /* "pgenlib.pyx":297
+  /* "pgenlib.pyx":400
  * 
  * 
  *     def __cinit__(self, bytes filename, object raw_sample_ct = None,             # <<<<<<<<<<<<<<
  *                   object variant_ct = None, object sample_subset = None,
- *                   object allele_idx_offsets = None):
+ *                   object allele_idx_offsets = None, object pvar = None):
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static int __pyx_pf_7pgenlib_10PgenReader___cinit__(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, PyObject *__pyx_v_filename, PyObject *__pyx_v_raw_sample_ct, PyObject *__pyx_v_variant_ct, PyObject *__pyx_v_sample_subset, PyObject *__pyx_v_allele_idx_offsets) {
+static int __pyx_pf_7pgenlib_10PgenReader___cinit__(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self, PyObject *__pyx_v_filename, PyObject *__pyx_v_raw_sample_ct, PyObject *__pyx_v_variant_ct, PyObject *__pyx_v_sample_subset, PyObject *__pyx_v_allele_idx_offsets, PyObject *__pyx_v_pvar) {
   uint32_t __pyx_v_cur_sample_ct;
   uint32_t __pyx_v_cur_variant_ct;
+  struct __pyx_obj_7pgenlib_PvarReader *__pyx_v_pr = 0;
   char const *__pyx_v_fname;
   plink2::PgenHeaderCtrl __pyx_v_header_ctrl;
   uintptr_t __pyx_v_pgfi_alloc_cacheline_ct;
   char __pyx_v_errstr_buf[plink2::kPglErrstrBufBlen];
   uint32_t __pyx_v_file_variant_ct;
   uintptr_t __pyx_v_nonref_flags_byte_ct;
   uint32_t __pyx_v_file_sample_ct;
@@ -3836,1208 +6413,1352 @@
   plink2::PglErr __pyx_v_reterr;
   unsigned char *__pyx_v_pgr_alloc_iter;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   uint32_t __pyx_t_3;
-  char const *__pyx_t_4;
+  int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
-  plink2::PglErr __pyx_t_7;
+  char const *__pyx_t_7;
+  plink2::PglErr __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
+  __Pyx_INCREF(__pyx_v_variant_ct);
+  __Pyx_INCREF(__pyx_v_allele_idx_offsets);
 
-  /* "pgenlib.pyx":300
+  /* "pgenlib.pyx":403
  *                   object variant_ct = None, object sample_subset = None,
- *                   object allele_idx_offsets = None):
+ *                   object allele_idx_offsets = None, object pvar = None):
  *         self._info_ptr = <PgenFileInfo*>PyMem_Malloc(sizeof(PgenFileInfo))             # <<<<<<<<<<<<<<
  *         if not self._info_ptr:
  *             raise MemoryError()
  */
   __pyx_v_self->_info_ptr = ((plink2::PgenFileInfo *)PyMem_Malloc((sizeof(plink2::PgenFileInfo))));
 
-  /* "pgenlib.pyx":301
- *                   object allele_idx_offsets = None):
+  /* "pgenlib.pyx":404
+ *                   object allele_idx_offsets = None, object pvar = None):
  *         self._info_ptr = <PgenFileInfo*>PyMem_Malloc(sizeof(PgenFileInfo))
  *         if not self._info_ptr:             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         PreinitPgfi(self._info_ptr)
  */
   __pyx_t_1 = ((!(__pyx_v_self->_info_ptr != 0)) != 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "pgenlib.pyx":302
+    /* "pgenlib.pyx":405
  *         self._info_ptr = <PgenFileInfo*>PyMem_Malloc(sizeof(PgenFileInfo))
  *         if not self._info_ptr:
  *             raise MemoryError()             # <<<<<<<<<<<<<<
  *         PreinitPgfi(self._info_ptr)
  *         # this depends on pgenlib_internal implementation.  could save
  */
-    PyErr_NoMemory(); __PYX_ERR(0, 302, __pyx_L1_error)
+    PyErr_NoMemory(); __PYX_ERR(0, 405, __pyx_L1_error)
 
-    /* "pgenlib.pyx":301
- *                   object allele_idx_offsets = None):
+    /* "pgenlib.pyx":404
+ *                   object allele_idx_offsets = None, object pvar = None):
  *         self._info_ptr = <PgenFileInfo*>PyMem_Malloc(sizeof(PgenFileInfo))
  *         if not self._info_ptr:             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         PreinitPgfi(self._info_ptr)
  */
   }
 
-  /* "pgenlib.pyx":303
+  /* "pgenlib.pyx":406
  *         if not self._info_ptr:
  *             raise MemoryError()
  *         PreinitPgfi(self._info_ptr)             # <<<<<<<<<<<<<<
  *         # this depends on pgenlib_internal implementation.  could save
  *         # pgfi_alloc and pgr_alloc instead.
  */
   plink2::PreinitPgfi(__pyx_v_self->_info_ptr);
 
-  /* "pgenlib.pyx":306
+  /* "pgenlib.pyx":409
  *         # this depends on pgenlib_internal implementation.  could save
  *         # pgfi_alloc and pgr_alloc instead.
  *         self._info_ptr[0].vrtypes = NULL             # <<<<<<<<<<<<<<
  *         cdef uint32_t cur_sample_ct = 0xffffffffU
  *         if raw_sample_ct is not None:
  */
   (__pyx_v_self->_info_ptr[0]).vrtypes = NULL;
 
-  /* "pgenlib.pyx":307
+  /* "pgenlib.pyx":410
  *         # pgfi_alloc and pgr_alloc instead.
  *         self._info_ptr[0].vrtypes = NULL
  *         cdef uint32_t cur_sample_ct = 0xffffffffU             # <<<<<<<<<<<<<<
  *         if raw_sample_ct is not None:
  *             cur_sample_ct = raw_sample_ct
  */
   __pyx_v_cur_sample_ct = 0xffffffffU;
 
-  /* "pgenlib.pyx":308
+  /* "pgenlib.pyx":411
  *         self._info_ptr[0].vrtypes = NULL
  *         cdef uint32_t cur_sample_ct = 0xffffffffU
  *         if raw_sample_ct is not None:             # <<<<<<<<<<<<<<
  *             cur_sample_ct = raw_sample_ct
  *         cdef uint32_t cur_variant_ct = 0xffffffffU
  */
   __pyx_t_1 = (__pyx_v_raw_sample_ct != Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "pgenlib.pyx":309
+    /* "pgenlib.pyx":412
  *         cdef uint32_t cur_sample_ct = 0xffffffffU
  *         if raw_sample_ct is not None:
  *             cur_sample_ct = raw_sample_ct             # <<<<<<<<<<<<<<
  *         cdef uint32_t cur_variant_ct = 0xffffffffU
- *         if variant_ct is not None:
+ *         cdef PvarReader pr
  */
-    __pyx_t_3 = __Pyx_PyInt_As_uint32_t(__pyx_v_raw_sample_ct); if (unlikely((__pyx_t_3 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 309, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_As_uint32_t(__pyx_v_raw_sample_ct); if (unlikely((__pyx_t_3 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 412, __pyx_L1_error)
     __pyx_v_cur_sample_ct = __pyx_t_3;
 
-    /* "pgenlib.pyx":308
+    /* "pgenlib.pyx":411
  *         self._info_ptr[0].vrtypes = NULL
  *         cdef uint32_t cur_sample_ct = 0xffffffffU
  *         if raw_sample_ct is not None:             # <<<<<<<<<<<<<<
  *             cur_sample_ct = raw_sample_ct
  *         cdef uint32_t cur_variant_ct = 0xffffffffU
  */
   }
 
-  /* "pgenlib.pyx":310
+  /* "pgenlib.pyx":413
  *         if raw_sample_ct is not None:
  *             cur_sample_ct = raw_sample_ct
  *         cdef uint32_t cur_variant_ct = 0xffffffffU             # <<<<<<<<<<<<<<
+ *         cdef PvarReader pr
+ *         if pvar is not None:
+ */
+  __pyx_v_cur_variant_ct = 0xffffffffU;
+
+  /* "pgenlib.pyx":415
+ *         cdef uint32_t cur_variant_ct = 0xffffffffU
+ *         cdef PvarReader pr
+ *         if pvar is not None:             # <<<<<<<<<<<<<<
+ *             if (variant_ct is not None) or (allele_idx_offsets is not None):
+ *                 raise RuntimeError("pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets")
+ */
+  __pyx_t_2 = (__pyx_v_pvar != Py_None);
+  __pyx_t_1 = (__pyx_t_2 != 0);
+  if (__pyx_t_1) {
+
+    /* "pgenlib.pyx":416
+ *         cdef PvarReader pr
+ *         if pvar is not None:
+ *             if (variant_ct is not None) or (allele_idx_offsets is not None):             # <<<<<<<<<<<<<<
+ *                 raise RuntimeError("pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets")
+ *             pr = pvar
+ */
+    __pyx_t_2 = (__pyx_v_variant_ct != Py_None);
+    __pyx_t_4 = (__pyx_t_2 != 0);
+    if (!__pyx_t_4) {
+    } else {
+      __pyx_t_1 = __pyx_t_4;
+      goto __pyx_L7_bool_binop_done;
+    }
+    __pyx_t_4 = (__pyx_v_allele_idx_offsets != Py_None);
+    __pyx_t_2 = (__pyx_t_4 != 0);
+    __pyx_t_1 = __pyx_t_2;
+    __pyx_L7_bool_binop_done:;
+    if (unlikely(__pyx_t_1)) {
+
+      /* "pgenlib.pyx":417
+ *         if pvar is not None:
+ *             if (variant_ct is not None) or (allele_idx_offsets is not None):
+ *                 raise RuntimeError("pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets")             # <<<<<<<<<<<<<<
+ *             pr = pvar
+ *             variant_ct = pr.get_variant_ct()
+ */
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 417, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __PYX_ERR(0, 417, __pyx_L1_error)
+
+      /* "pgenlib.pyx":416
+ *         cdef PvarReader pr
+ *         if pvar is not None:
+ *             if (variant_ct is not None) or (allele_idx_offsets is not None):             # <<<<<<<<<<<<<<
+ *                 raise RuntimeError("pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets")
+ *             pr = pvar
+ */
+    }
+
+    /* "pgenlib.pyx":418
+ *             if (variant_ct is not None) or (allele_idx_offsets is not None):
+ *                 raise RuntimeError("pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets")
+ *             pr = pvar             # <<<<<<<<<<<<<<
+ *             variant_ct = pr.get_variant_ct()
+ *             if pr.get_max_allele_ct() == 2:
+ */
+    if (!(likely(((__pyx_v_pvar) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_pvar, __pyx_ptype_7pgenlib_PvarReader))))) __PYX_ERR(0, 418, __pyx_L1_error)
+    __pyx_t_5 = __pyx_v_pvar;
+    __Pyx_INCREF(__pyx_t_5);
+    __pyx_v_pr = ((struct __pyx_obj_7pgenlib_PvarReader *)__pyx_t_5);
+    __pyx_t_5 = 0;
+
+    /* "pgenlib.pyx":419
+ *                 raise RuntimeError("pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets")
+ *             pr = pvar
+ *             variant_ct = pr.get_variant_ct()             # <<<<<<<<<<<<<<
+ *             if pr.get_max_allele_ct() == 2:
+ *                 allele_idx_offsets = None
+ */
+    __pyx_t_5 = ((struct __pyx_vtabstruct_7pgenlib_PvarReader *)__pyx_v_pr->__pyx_vtab)->get_variant_ct(__pyx_v_pr, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 419, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF_SET(__pyx_v_variant_ct, __pyx_t_5);
+    __pyx_t_5 = 0;
+
+    /* "pgenlib.pyx":420
+ *             pr = pvar
+ *             variant_ct = pr.get_variant_ct()
+ *             if pr.get_max_allele_ct() == 2:             # <<<<<<<<<<<<<<
+ *                 allele_idx_offsets = None
+ *             else:
+ */
+    __pyx_t_5 = ((struct __pyx_vtabstruct_7pgenlib_PvarReader *)__pyx_v_pr->__pyx_vtab)->get_max_allele_ct(__pyx_v_pr, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 420, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_5, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 420, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 420, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    if (__pyx_t_1) {
+
+      /* "pgenlib.pyx":421
+ *             variant_ct = pr.get_variant_ct()
+ *             if pr.get_max_allele_ct() == 2:
+ *                 allele_idx_offsets = None             # <<<<<<<<<<<<<<
+ *             else:
+ *                 allele_idx_offsets = pr.get_allele_idx_offsets()
+ */
+      __Pyx_INCREF(Py_None);
+      __Pyx_DECREF_SET(__pyx_v_allele_idx_offsets, Py_None);
+
+      /* "pgenlib.pyx":420
+ *             pr = pvar
+ *             variant_ct = pr.get_variant_ct()
+ *             if pr.get_max_allele_ct() == 2:             # <<<<<<<<<<<<<<
+ *                 allele_idx_offsets = None
+ *             else:
+ */
+      goto __pyx_L9;
+    }
+
+    /* "pgenlib.pyx":423
+ *                 allele_idx_offsets = None
+ *             else:
+ *                 allele_idx_offsets = pr.get_allele_idx_offsets()             # <<<<<<<<<<<<<<
  *         if variant_ct is not None:
  *             cur_variant_ct = variant_ct
  */
-  __pyx_v_cur_variant_ct = 0xffffffffU;
+    /*else*/ {
+      __pyx_t_6 = ((struct __pyx_vtabstruct_7pgenlib_PvarReader *)__pyx_v_pr->__pyx_vtab)->get_allele_idx_offsets(__pyx_v_pr, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 423, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF_SET(__pyx_v_allele_idx_offsets, __pyx_t_6);
+      __pyx_t_6 = 0;
+    }
+    __pyx_L9:;
 
-  /* "pgenlib.pyx":311
- *             cur_sample_ct = raw_sample_ct
+    /* "pgenlib.pyx":415
  *         cdef uint32_t cur_variant_ct = 0xffffffffU
+ *         cdef PvarReader pr
+ *         if pvar is not None:             # <<<<<<<<<<<<<<
+ *             if (variant_ct is not None) or (allele_idx_offsets is not None):
+ *                 raise RuntimeError("pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets")
+ */
+  }
+
+  /* "pgenlib.pyx":424
+ *             else:
+ *                 allele_idx_offsets = pr.get_allele_idx_offsets()
  *         if variant_ct is not None:             # <<<<<<<<<<<<<<
  *             cur_variant_ct = variant_ct
  *         cdef const char* fname = <const char*>filename
  */
-  __pyx_t_2 = (__pyx_v_variant_ct != Py_None);
-  __pyx_t_1 = (__pyx_t_2 != 0);
-  if (__pyx_t_1) {
+  __pyx_t_1 = (__pyx_v_variant_ct != Py_None);
+  __pyx_t_2 = (__pyx_t_1 != 0);
+  if (__pyx_t_2) {
 
-    /* "pgenlib.pyx":312
- *         cdef uint32_t cur_variant_ct = 0xffffffffU
+    /* "pgenlib.pyx":425
+ *                 allele_idx_offsets = pr.get_allele_idx_offsets()
  *         if variant_ct is not None:
  *             cur_variant_ct = variant_ct             # <<<<<<<<<<<<<<
  *         cdef const char* fname = <const char*>filename
  *         cdef PgenHeaderCtrl header_ctrl
  */
-    __pyx_t_3 = __Pyx_PyInt_As_uint32_t(__pyx_v_variant_ct); if (unlikely((__pyx_t_3 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 312, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_As_uint32_t(__pyx_v_variant_ct); if (unlikely((__pyx_t_3 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 425, __pyx_L1_error)
     __pyx_v_cur_variant_ct = __pyx_t_3;
 
-    /* "pgenlib.pyx":311
- *             cur_sample_ct = raw_sample_ct
- *         cdef uint32_t cur_variant_ct = 0xffffffffU
+    /* "pgenlib.pyx":424
+ *             else:
+ *                 allele_idx_offsets = pr.get_allele_idx_offsets()
  *         if variant_ct is not None:             # <<<<<<<<<<<<<<
  *             cur_variant_ct = variant_ct
  *         cdef const char* fname = <const char*>filename
  */
   }
 
-  /* "pgenlib.pyx":313
+  /* "pgenlib.pyx":426
  *         if variant_ct is not None:
  *             cur_variant_ct = variant_ct
  *         cdef const char* fname = <const char*>filename             # <<<<<<<<<<<<<<
  *         cdef PgenHeaderCtrl header_ctrl
  *         cdef uintptr_t pgfi_alloc_cacheline_ct
  */
   if (unlikely(__pyx_v_filename == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(0, 313, __pyx_L1_error)
+    __PYX_ERR(0, 426, __pyx_L1_error)
   }
-  __pyx_t_4 = __Pyx_PyBytes_AsString(__pyx_v_filename); if (unlikely((!__pyx_t_4) && PyErr_Occurred())) __PYX_ERR(0, 313, __pyx_L1_error)
-  __pyx_v_fname = ((char const *)__pyx_t_4);
+  __pyx_t_7 = __Pyx_PyBytes_AsString(__pyx_v_filename); if (unlikely((!__pyx_t_7) && PyErr_Occurred())) __PYX_ERR(0, 426, __pyx_L1_error)
+  __pyx_v_fname = ((char const *)__pyx_t_7);
 
-  /* "pgenlib.pyx":317
+  /* "pgenlib.pyx":430
  *         cdef uintptr_t pgfi_alloc_cacheline_ct
  *         cdef char errstr_buf[kPglErrstrBufBlen]
  *         if PgfiInitPhase1(fname, NULL, cur_variant_ct, cur_sample_ct, &header_ctrl, self._info_ptr, &pgfi_alloc_cacheline_ct, errstr_buf) != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError(errstr_buf[7:])
  *         cdef uint32_t file_variant_ct = self._info_ptr[0].raw_variant_ct
  */
-  __pyx_t_1 = ((plink2::PgfiInitPhase1(__pyx_v_fname, NULL, __pyx_v_cur_variant_ct, __pyx_v_cur_sample_ct, (&__pyx_v_header_ctrl), __pyx_v_self->_info_ptr, (&__pyx_v_pgfi_alloc_cacheline_ct), __pyx_v_errstr_buf) != plink2::kPglRetSuccess) != 0);
-  if (unlikely(__pyx_t_1)) {
+  __pyx_t_2 = ((plink2::PgfiInitPhase1(__pyx_v_fname, NULL, __pyx_v_cur_variant_ct, __pyx_v_cur_sample_ct, (&__pyx_v_header_ctrl), __pyx_v_self->_info_ptr, (&__pyx_v_pgfi_alloc_cacheline_ct), __pyx_v_errstr_buf) != plink2::kPglRetSuccess) != 0);
+  if (unlikely(__pyx_t_2)) {
 
-    /* "pgenlib.pyx":318
+    /* "pgenlib.pyx":431
  *         cdef char errstr_buf[kPglErrstrBufBlen]
  *         if PgfiInitPhase1(fname, NULL, cur_variant_ct, cur_sample_ct, &header_ctrl, self._info_ptr, &pgfi_alloc_cacheline_ct, errstr_buf) != kPglRetSuccess:
  *             raise RuntimeError(errstr_buf[7:])             # <<<<<<<<<<<<<<
  *         cdef uint32_t file_variant_ct = self._info_ptr[0].raw_variant_ct
  *         if allele_idx_offsets is not None:
  */
-    __pyx_t_5 = __Pyx_PyBytes_FromString(((const char*)__pyx_v_errstr_buf) + 7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 318, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyBytes_FromString(((const char*)__pyx_v_errstr_buf) + 7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 431, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 431, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 318, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __PYX_ERR(0, 431, __pyx_L1_error)
 
-    /* "pgenlib.pyx":317
+    /* "pgenlib.pyx":430
  *         cdef uintptr_t pgfi_alloc_cacheline_ct
  *         cdef char errstr_buf[kPglErrstrBufBlen]
  *         if PgfiInitPhase1(fname, NULL, cur_variant_ct, cur_sample_ct, &header_ctrl, self._info_ptr, &pgfi_alloc_cacheline_ct, errstr_buf) != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError(errstr_buf[7:])
  *         cdef uint32_t file_variant_ct = self._info_ptr[0].raw_variant_ct
  */
   }
 
-  /* "pgenlib.pyx":319
+  /* "pgenlib.pyx":432
  *         if PgfiInitPhase1(fname, NULL, cur_variant_ct, cur_sample_ct, &header_ctrl, self._info_ptr, &pgfi_alloc_cacheline_ct, errstr_buf) != kPglRetSuccess:
  *             raise RuntimeError(errstr_buf[7:])
  *         cdef uint32_t file_variant_ct = self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  *         if allele_idx_offsets is not None:
  *             self.set_allele_idx_offsets_internal(allele_idx_offsets)
  */
   __pyx_t_3 = (__pyx_v_self->_info_ptr[0]).raw_variant_ct;
   __pyx_v_file_variant_ct = __pyx_t_3;
 
-  /* "pgenlib.pyx":320
+  /* "pgenlib.pyx":433
  *             raise RuntimeError(errstr_buf[7:])
  *         cdef uint32_t file_variant_ct = self._info_ptr[0].raw_variant_ct
  *         if allele_idx_offsets is not None:             # <<<<<<<<<<<<<<
  *             self.set_allele_idx_offsets_internal(allele_idx_offsets)
  *         else:
  */
-  __pyx_t_1 = (__pyx_v_allele_idx_offsets != Py_None);
-  __pyx_t_2 = (__pyx_t_1 != 0);
-  if (__pyx_t_2) {
+  __pyx_t_2 = (__pyx_v_allele_idx_offsets != Py_None);
+  __pyx_t_1 = (__pyx_t_2 != 0);
+  if (__pyx_t_1) {
 
-    /* "pgenlib.pyx":321
+    /* "pgenlib.pyx":434
  *         cdef uint32_t file_variant_ct = self._info_ptr[0].raw_variant_ct
  *         if allele_idx_offsets is not None:
  *             self.set_allele_idx_offsets_internal(allele_idx_offsets)             # <<<<<<<<<<<<<<
  *         else:
  *             if (header_ctrl & 0x30) != 0:
  */
-    if (!(likely(((__pyx_v_allele_idx_offsets) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_allele_idx_offsets, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 321, __pyx_L1_error)
-    __pyx_t_6 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->set_allele_idx_offsets_internal(__pyx_v_self, ((PyArrayObject *)__pyx_v_allele_idx_offsets)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 321, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    if (!(likely(((__pyx_v_allele_idx_offsets) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_allele_idx_offsets, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 434, __pyx_L1_error)
+    __pyx_t_5 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->set_allele_idx_offsets_internal(__pyx_v_self, ((PyArrayObject *)__pyx_v_allele_idx_offsets)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 434, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pgenlib.pyx":320
+    /* "pgenlib.pyx":433
  *             raise RuntimeError(errstr_buf[7:])
  *         cdef uint32_t file_variant_ct = self._info_ptr[0].raw_variant_ct
  *         if allele_idx_offsets is not None:             # <<<<<<<<<<<<<<
  *             self.set_allele_idx_offsets_internal(allele_idx_offsets)
  *         else:
  */
-    goto __pyx_L7;
+    goto __pyx_L12;
   }
 
-  /* "pgenlib.pyx":323
+  /* "pgenlib.pyx":436
  *             self.set_allele_idx_offsets_internal(allele_idx_offsets)
  *         else:
  *             if (header_ctrl & 0x30) != 0:             # <<<<<<<<<<<<<<
  *                 # Not tested yet, since C pgenlib doesn't yet have a mode which
  *                 # embeds a copy of allele_idx_offsets in the .pgen.
  */
   /*else*/ {
-    __pyx_t_2 = (((__pyx_v_header_ctrl & 0x30) != 0) != 0);
-    if (__pyx_t_2) {
+    __pyx_t_1 = (((__pyx_v_header_ctrl & 0x30) != 0) != 0);
+    if (__pyx_t_1) {
 
-      /* "pgenlib.pyx":326
+      /* "pgenlib.pyx":439
  *                 # Not tested yet, since C pgenlib doesn't yet have a mode which
  *                 # embeds a copy of allele_idx_offsets in the .pgen.
  *                 if cachealigned_malloc((file_variant_ct + 1) * sizeof(uintptr_t), &self._info_ptr[0].allele_idx_offsets):             # <<<<<<<<<<<<<<
  *                     raise MemoryError()
  *         cdef uintptr_t nonref_flags_byte_ct = DivUp(file_variant_ct, kBitsPerWord) * kBytesPerWord
  */
-      __pyx_t_2 = (plink2::cachealigned_malloc(((__pyx_v_file_variant_ct + 1) * (sizeof(uintptr_t))), (&(__pyx_v_self->_info_ptr[0]).allele_idx_offsets)) != 0);
-      if (unlikely(__pyx_t_2)) {
+      __pyx_t_1 = (plink2::cachealigned_malloc(((__pyx_v_file_variant_ct + 1) * (sizeof(uintptr_t))), (&(__pyx_v_self->_info_ptr[0]).allele_idx_offsets)) != 0);
+      if (unlikely(__pyx_t_1)) {
 
-        /* "pgenlib.pyx":327
+        /* "pgenlib.pyx":440
  *                 # embeds a copy of allele_idx_offsets in the .pgen.
  *                 if cachealigned_malloc((file_variant_ct + 1) * sizeof(uintptr_t), &self._info_ptr[0].allele_idx_offsets):
  *                     raise MemoryError()             # <<<<<<<<<<<<<<
  *         cdef uintptr_t nonref_flags_byte_ct = DivUp(file_variant_ct, kBitsPerWord) * kBytesPerWord
  *         if (header_ctrl & 0xc0) == 0xc0:
  */
-        PyErr_NoMemory(); __PYX_ERR(0, 327, __pyx_L1_error)
+        PyErr_NoMemory(); __PYX_ERR(0, 440, __pyx_L1_error)
 
-        /* "pgenlib.pyx":326
+        /* "pgenlib.pyx":439
  *                 # Not tested yet, since C pgenlib doesn't yet have a mode which
  *                 # embeds a copy of allele_idx_offsets in the .pgen.
  *                 if cachealigned_malloc((file_variant_ct + 1) * sizeof(uintptr_t), &self._info_ptr[0].allele_idx_offsets):             # <<<<<<<<<<<<<<
  *                     raise MemoryError()
  *         cdef uintptr_t nonref_flags_byte_ct = DivUp(file_variant_ct, kBitsPerWord) * kBytesPerWord
  */
       }
 
-      /* "pgenlib.pyx":323
+      /* "pgenlib.pyx":436
  *             self.set_allele_idx_offsets_internal(allele_idx_offsets)
  *         else:
  *             if (header_ctrl & 0x30) != 0:             # <<<<<<<<<<<<<<
  *                 # Not tested yet, since C pgenlib doesn't yet have a mode which
  *                 # embeds a copy of allele_idx_offsets in the .pgen.
  */
     }
   }
-  __pyx_L7:;
+  __pyx_L12:;
 
-  /* "pgenlib.pyx":328
+  /* "pgenlib.pyx":441
  *                 if cachealigned_malloc((file_variant_ct + 1) * sizeof(uintptr_t), &self._info_ptr[0].allele_idx_offsets):
  *                     raise MemoryError()
  *         cdef uintptr_t nonref_flags_byte_ct = DivUp(file_variant_ct, kBitsPerWord) * kBytesPerWord             # <<<<<<<<<<<<<<
  *         if (header_ctrl & 0xc0) == 0xc0:
  *             # explicit nonref_flags
  */
   __pyx_v_nonref_flags_byte_ct = (plink2::DivUp(__pyx_v_file_variant_ct, plink2::kBitsPerWord) * plink2::kBytesPerWord);
 
-  /* "pgenlib.pyx":329
+  /* "pgenlib.pyx":442
  *                     raise MemoryError()
  *         cdef uintptr_t nonref_flags_byte_ct = DivUp(file_variant_ct, kBitsPerWord) * kBytesPerWord
  *         if (header_ctrl & 0xc0) == 0xc0:             # <<<<<<<<<<<<<<
  *             # explicit nonref_flags
  *             # might want to modify PgfiInitPhase2 to let us not load this.
  */
-  __pyx_t_2 = (((__pyx_v_header_ctrl & 0xc0) == 0xc0) != 0);
-  if (__pyx_t_2) {
+  __pyx_t_1 = (((__pyx_v_header_ctrl & 0xc0) == 0xc0) != 0);
+  if (__pyx_t_1) {
 
-    /* "pgenlib.pyx":332
+    /* "pgenlib.pyx":445
  *             # explicit nonref_flags
  *             # might want to modify PgfiInitPhase2 to let us not load this.
  *             if cachealigned_malloc(nonref_flags_byte_ct, &self._info_ptr[0].nonref_flags):             # <<<<<<<<<<<<<<
  *                 raise MemoryError()
  *         cdef uint32_t file_sample_ct = self._info_ptr[0].raw_sample_ct
  */
-    __pyx_t_2 = (plink2::cachealigned_malloc(__pyx_v_nonref_flags_byte_ct, (&(__pyx_v_self->_info_ptr[0]).nonref_flags)) != 0);
-    if (unlikely(__pyx_t_2)) {
+    __pyx_t_1 = (plink2::cachealigned_malloc(__pyx_v_nonref_flags_byte_ct, (&(__pyx_v_self->_info_ptr[0]).nonref_flags)) != 0);
+    if (unlikely(__pyx_t_1)) {
 
-      /* "pgenlib.pyx":333
+      /* "pgenlib.pyx":446
  *             # might want to modify PgfiInitPhase2 to let us not load this.
  *             if cachealigned_malloc(nonref_flags_byte_ct, &self._info_ptr[0].nonref_flags):
  *                 raise MemoryError()             # <<<<<<<<<<<<<<
  *         cdef uint32_t file_sample_ct = self._info_ptr[0].raw_sample_ct
  *         assert file_sample_ct != 0
  */
-      PyErr_NoMemory(); __PYX_ERR(0, 333, __pyx_L1_error)
+      PyErr_NoMemory(); __PYX_ERR(0, 446, __pyx_L1_error)
 
-      /* "pgenlib.pyx":332
+      /* "pgenlib.pyx":445
  *             # explicit nonref_flags
  *             # might want to modify PgfiInitPhase2 to let us not load this.
  *             if cachealigned_malloc(nonref_flags_byte_ct, &self._info_ptr[0].nonref_flags):             # <<<<<<<<<<<<<<
  *                 raise MemoryError()
  *         cdef uint32_t file_sample_ct = self._info_ptr[0].raw_sample_ct
  */
     }
 
-    /* "pgenlib.pyx":329
+    /* "pgenlib.pyx":442
  *                     raise MemoryError()
  *         cdef uintptr_t nonref_flags_byte_ct = DivUp(file_variant_ct, kBitsPerWord) * kBytesPerWord
  *         if (header_ctrl & 0xc0) == 0xc0:             # <<<<<<<<<<<<<<
  *             # explicit nonref_flags
  *             # might want to modify PgfiInitPhase2 to let us not load this.
  */
   }
 
-  /* "pgenlib.pyx":334
+  /* "pgenlib.pyx":447
  *             if cachealigned_malloc(nonref_flags_byte_ct, &self._info_ptr[0].nonref_flags):
  *                 raise MemoryError()
  *         cdef uint32_t file_sample_ct = self._info_ptr[0].raw_sample_ct             # <<<<<<<<<<<<<<
  *         assert file_sample_ct != 0
  *         cdef unsigned char* pgfi_alloc = NULL
  */
   __pyx_t_3 = (__pyx_v_self->_info_ptr[0]).raw_sample_ct;
   __pyx_v_file_sample_ct = __pyx_t_3;
 
-  /* "pgenlib.pyx":335
+  /* "pgenlib.pyx":448
  *                 raise MemoryError()
  *         cdef uint32_t file_sample_ct = self._info_ptr[0].raw_sample_ct
  *         assert file_sample_ct != 0             # <<<<<<<<<<<<<<
  *         cdef unsigned char* pgfi_alloc = NULL
  *         if pgfi_alloc_cacheline_ct != 0:
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(!Py_OptimizeFlag)) {
     if (unlikely(!((__pyx_v_file_sample_ct != 0) != 0))) {
       PyErr_SetNone(PyExc_AssertionError);
-      __PYX_ERR(0, 335, __pyx_L1_error)
+      __PYX_ERR(0, 448, __pyx_L1_error)
     }
   }
   #endif
 
-  /* "pgenlib.pyx":336
+  /* "pgenlib.pyx":449
  *         cdef uint32_t file_sample_ct = self._info_ptr[0].raw_sample_ct
  *         assert file_sample_ct != 0
  *         cdef unsigned char* pgfi_alloc = NULL             # <<<<<<<<<<<<<<
  *         if pgfi_alloc_cacheline_ct != 0:
  *             if cachealigned_malloc(pgfi_alloc_cacheline_ct * kCacheline, &pgfi_alloc):
  */
   __pyx_v_pgfi_alloc = NULL;
 
-  /* "pgenlib.pyx":337
+  /* "pgenlib.pyx":450
  *         assert file_sample_ct != 0
  *         cdef unsigned char* pgfi_alloc = NULL
  *         if pgfi_alloc_cacheline_ct != 0:             # <<<<<<<<<<<<<<
  *             if cachealigned_malloc(pgfi_alloc_cacheline_ct * kCacheline, &pgfi_alloc):
  *                 raise MemoryError()
  */
-  __pyx_t_2 = ((__pyx_v_pgfi_alloc_cacheline_ct != 0) != 0);
-  if (__pyx_t_2) {
+  __pyx_t_1 = ((__pyx_v_pgfi_alloc_cacheline_ct != 0) != 0);
+  if (__pyx_t_1) {
 
-    /* "pgenlib.pyx":338
+    /* "pgenlib.pyx":451
  *         cdef unsigned char* pgfi_alloc = NULL
  *         if pgfi_alloc_cacheline_ct != 0:
  *             if cachealigned_malloc(pgfi_alloc_cacheline_ct * kCacheline, &pgfi_alloc):             # <<<<<<<<<<<<<<
  *                 raise MemoryError()
  *         cdef uint32_t max_vrec_width
  */
-    __pyx_t_2 = (plink2::cachealigned_malloc((__pyx_v_pgfi_alloc_cacheline_ct * plink2::kCacheline), (&__pyx_v_pgfi_alloc)) != 0);
-    if (unlikely(__pyx_t_2)) {
+    __pyx_t_1 = (plink2::cachealigned_malloc((__pyx_v_pgfi_alloc_cacheline_ct * plink2::kCacheline), (&__pyx_v_pgfi_alloc)) != 0);
+    if (unlikely(__pyx_t_1)) {
 
-      /* "pgenlib.pyx":339
+      /* "pgenlib.pyx":452
  *         if pgfi_alloc_cacheline_ct != 0:
  *             if cachealigned_malloc(pgfi_alloc_cacheline_ct * kCacheline, &pgfi_alloc):
  *                 raise MemoryError()             # <<<<<<<<<<<<<<
  *         cdef uint32_t max_vrec_width
  *         cdef uintptr_t pgr_alloc_cacheline_ct
  */
-      PyErr_NoMemory(); __PYX_ERR(0, 339, __pyx_L1_error)
+      PyErr_NoMemory(); __PYX_ERR(0, 452, __pyx_L1_error)
 
-      /* "pgenlib.pyx":338
+      /* "pgenlib.pyx":451
  *         cdef unsigned char* pgfi_alloc = NULL
  *         if pgfi_alloc_cacheline_ct != 0:
  *             if cachealigned_malloc(pgfi_alloc_cacheline_ct * kCacheline, &pgfi_alloc):             # <<<<<<<<<<<<<<
  *                 raise MemoryError()
  *         cdef uint32_t max_vrec_width
  */
     }
 
-    /* "pgenlib.pyx":337
+    /* "pgenlib.pyx":450
  *         assert file_sample_ct != 0
  *         cdef unsigned char* pgfi_alloc = NULL
  *         if pgfi_alloc_cacheline_ct != 0:             # <<<<<<<<<<<<<<
  *             if cachealigned_malloc(pgfi_alloc_cacheline_ct * kCacheline, &pgfi_alloc):
  *                 raise MemoryError()
  */
   }
 
-  /* "pgenlib.pyx":342
+  /* "pgenlib.pyx":455
  *         cdef uint32_t max_vrec_width
  *         cdef uintptr_t pgr_alloc_cacheline_ct
  *         if PgfiInitPhase2(header_ctrl, 1, 0, 0, 0, file_variant_ct, &max_vrec_width, self._info_ptr, pgfi_alloc, &pgr_alloc_cacheline_ct, errstr_buf):             # <<<<<<<<<<<<<<
  *             if pgfi_alloc and not self._info_ptr[0].vrtypes:
  *                 aligned_free(pgfi_alloc)
  */
-  __pyx_t_7 = plink2::PgfiInitPhase2(__pyx_v_header_ctrl, 1, 0, 0, 0, __pyx_v_file_variant_ct, (&__pyx_v_max_vrec_width), __pyx_v_self->_info_ptr, __pyx_v_pgfi_alloc, (&__pyx_v_pgr_alloc_cacheline_ct), __pyx_v_errstr_buf);
-  if (__pyx_t_7) {
+  __pyx_t_8 = plink2::PgfiInitPhase2(__pyx_v_header_ctrl, 1, 0, 0, 0, __pyx_v_file_variant_ct, (&__pyx_v_max_vrec_width), __pyx_v_self->_info_ptr, __pyx_v_pgfi_alloc, (&__pyx_v_pgr_alloc_cacheline_ct), __pyx_v_errstr_buf);
+  if (__pyx_t_8) {
 
-    /* "pgenlib.pyx":343
+    /* "pgenlib.pyx":456
  *         cdef uintptr_t pgr_alloc_cacheline_ct
  *         if PgfiInitPhase2(header_ctrl, 1, 0, 0, 0, file_variant_ct, &max_vrec_width, self._info_ptr, pgfi_alloc, &pgr_alloc_cacheline_ct, errstr_buf):
  *             if pgfi_alloc and not self._info_ptr[0].vrtypes:             # <<<<<<<<<<<<<<
  *                 aligned_free(pgfi_alloc)
  *             raise RuntimeError(errstr_buf[7:])
  */
-    __pyx_t_1 = (__pyx_v_pgfi_alloc != 0);
-    if (__pyx_t_1) {
+    __pyx_t_2 = (__pyx_v_pgfi_alloc != 0);
+    if (__pyx_t_2) {
     } else {
-      __pyx_t_2 = __pyx_t_1;
-      goto __pyx_L16_bool_binop_done;
+      __pyx_t_1 = __pyx_t_2;
+      goto __pyx_L21_bool_binop_done;
     }
-    __pyx_t_1 = ((!((__pyx_v_self->_info_ptr[0]).vrtypes != 0)) != 0);
-    __pyx_t_2 = __pyx_t_1;
-    __pyx_L16_bool_binop_done:;
-    if (__pyx_t_2) {
+    __pyx_t_2 = ((!((__pyx_v_self->_info_ptr[0]).vrtypes != 0)) != 0);
+    __pyx_t_1 = __pyx_t_2;
+    __pyx_L21_bool_binop_done:;
+    if (__pyx_t_1) {
 
-      /* "pgenlib.pyx":344
+      /* "pgenlib.pyx":457
  *         if PgfiInitPhase2(header_ctrl, 1, 0, 0, 0, file_variant_ct, &max_vrec_width, self._info_ptr, pgfi_alloc, &pgr_alloc_cacheline_ct, errstr_buf):
  *             if pgfi_alloc and not self._info_ptr[0].vrtypes:
  *                 aligned_free(pgfi_alloc)             # <<<<<<<<<<<<<<
  *             raise RuntimeError(errstr_buf[7:])
  *         if self._info_ptr[0].gflags & kfPgenGlobalMultiallelicHardcallFound:
  */
       plink2::aligned_free(__pyx_v_pgfi_alloc);
 
-      /* "pgenlib.pyx":343
+      /* "pgenlib.pyx":456
  *         cdef uintptr_t pgr_alloc_cacheline_ct
  *         if PgfiInitPhase2(header_ctrl, 1, 0, 0, 0, file_variant_ct, &max_vrec_width, self._info_ptr, pgfi_alloc, &pgr_alloc_cacheline_ct, errstr_buf):
  *             if pgfi_alloc and not self._info_ptr[0].vrtypes:             # <<<<<<<<<<<<<<
  *                 aligned_free(pgfi_alloc)
  *             raise RuntimeError(errstr_buf[7:])
  */
     }
 
-    /* "pgenlib.pyx":345
+    /* "pgenlib.pyx":458
  *             if pgfi_alloc and not self._info_ptr[0].vrtypes:
  *                 aligned_free(pgfi_alloc)
  *             raise RuntimeError(errstr_buf[7:])             # <<<<<<<<<<<<<<
  *         if self._info_ptr[0].gflags & kfPgenGlobalMultiallelicHardcallFound:
- *             # todo: support easy initialization of allele_idx_offsets by
+ *             if self._info_ptr[0].allele_idx_offsets == NULL:
  */
-    __pyx_t_6 = __Pyx_PyBytes_FromString(((const char*)__pyx_v_errstr_buf) + 7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 345, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 345, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyBytes_FromString(((const char*)__pyx_v_errstr_buf) + 7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 458, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 458, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 345, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __PYX_ERR(0, 458, __pyx_L1_error)
 
-    /* "pgenlib.pyx":342
+    /* "pgenlib.pyx":455
  *         cdef uint32_t max_vrec_width
  *         cdef uintptr_t pgr_alloc_cacheline_ct
  *         if PgfiInitPhase2(header_ctrl, 1, 0, 0, 0, file_variant_ct, &max_vrec_width, self._info_ptr, pgfi_alloc, &pgr_alloc_cacheline_ct, errstr_buf):             # <<<<<<<<<<<<<<
  *             if pgfi_alloc and not self._info_ptr[0].vrtypes:
  *                 aligned_free(pgfi_alloc)
  */
   }
 
-  /* "pgenlib.pyx":346
+  /* "pgenlib.pyx":459
  *                 aligned_free(pgfi_alloc)
  *             raise RuntimeError(errstr_buf[7:])
  *         if self._info_ptr[0].gflags & kfPgenGlobalMultiallelicHardcallFound:             # <<<<<<<<<<<<<<
- *             # todo: support easy initialization of allele_idx_offsets by
- *             # wrapping pvar loader the same way as the R interface
+ *             if self._info_ptr[0].allele_idx_offsets == NULL:
+ *                 raise RuntimeError("PgenReader: multiallelic variants present, but allele_idx_offsets not provided")
  */
-  __pyx_t_2 = (((__pyx_v_self->_info_ptr[0]).gflags & plink2::kfPgenGlobalMultiallelicHardcallFound) != 0);
-  if (__pyx_t_2) {
+  __pyx_t_1 = (((__pyx_v_self->_info_ptr[0]).gflags & plink2::kfPgenGlobalMultiallelicHardcallFound) != 0);
+  if (__pyx_t_1) {
 
-    /* "pgenlib.pyx":349
- *             # todo: support easy initialization of allele_idx_offsets by
- *             # wrapping pvar loader the same way as the R interface
+    /* "pgenlib.pyx":460
+ *             raise RuntimeError(errstr_buf[7:])
+ *         if self._info_ptr[0].gflags & kfPgenGlobalMultiallelicHardcallFound:
  *             if self._info_ptr[0].allele_idx_offsets == NULL:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("PgenReader: multiallelic variants present, but allele_idx_offsets not provided")
  * 
  */
-    __pyx_t_2 = (((__pyx_v_self->_info_ptr[0]).allele_idx_offsets == NULL) != 0);
-    if (unlikely(__pyx_t_2)) {
+    __pyx_t_1 = (((__pyx_v_self->_info_ptr[0]).allele_idx_offsets == NULL) != 0);
+    if (unlikely(__pyx_t_1)) {
 
-      /* "pgenlib.pyx":350
- *             # wrapping pvar loader the same way as the R interface
+      /* "pgenlib.pyx":461
+ *         if self._info_ptr[0].gflags & kfPgenGlobalMultiallelicHardcallFound:
  *             if self._info_ptr[0].allele_idx_offsets == NULL:
  *                 raise RuntimeError("PgenReader: multiallelic variants present, but allele_idx_offsets not provided")             # <<<<<<<<<<<<<<
  * 
  *         self._state_ptr = <PgenReaderStruct*>PyMem_Malloc(sizeof(PgenReaderStruct))
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 350, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_Raise(__pyx_t_5, 0, 0, 0);
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __PYX_ERR(0, 350, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 461, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_Raise(__pyx_t_6, 0, 0, 0);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __PYX_ERR(0, 461, __pyx_L1_error)
 
-      /* "pgenlib.pyx":349
- *             # todo: support easy initialization of allele_idx_offsets by
- *             # wrapping pvar loader the same way as the R interface
+      /* "pgenlib.pyx":460
+ *             raise RuntimeError(errstr_buf[7:])
+ *         if self._info_ptr[0].gflags & kfPgenGlobalMultiallelicHardcallFound:
  *             if self._info_ptr[0].allele_idx_offsets == NULL:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("PgenReader: multiallelic variants present, but allele_idx_offsets not provided")
  * 
  */
     }
 
-    /* "pgenlib.pyx":346
+    /* "pgenlib.pyx":459
  *                 aligned_free(pgfi_alloc)
  *             raise RuntimeError(errstr_buf[7:])
  *         if self._info_ptr[0].gflags & kfPgenGlobalMultiallelicHardcallFound:             # <<<<<<<<<<<<<<
- *             # todo: support easy initialization of allele_idx_offsets by
- *             # wrapping pvar loader the same way as the R interface
+ *             if self._info_ptr[0].allele_idx_offsets == NULL:
+ *                 raise RuntimeError("PgenReader: multiallelic variants present, but allele_idx_offsets not provided")
  */
   }
 
-  /* "pgenlib.pyx":352
+  /* "pgenlib.pyx":463
  *                 raise RuntimeError("PgenReader: multiallelic variants present, but allele_idx_offsets not provided")
  * 
  *         self._state_ptr = <PgenReaderStruct*>PyMem_Malloc(sizeof(PgenReaderStruct))             # <<<<<<<<<<<<<<
  *         if not self._state_ptr:
  *             raise MemoryError()
  */
   __pyx_v_self->_state_ptr = ((struct plink2::PgenReaderStruct *)PyMem_Malloc((sizeof(struct plink2::PgenReaderStruct))));
 
-  /* "pgenlib.pyx":353
+  /* "pgenlib.pyx":464
  * 
  *         self._state_ptr = <PgenReaderStruct*>PyMem_Malloc(sizeof(PgenReaderStruct))
  *         if not self._state_ptr:             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         PreinitPgr(self._state_ptr)
  */
-  __pyx_t_2 = ((!(__pyx_v_self->_state_ptr != 0)) != 0);
-  if (unlikely(__pyx_t_2)) {
+  __pyx_t_1 = ((!(__pyx_v_self->_state_ptr != 0)) != 0);
+  if (unlikely(__pyx_t_1)) {
 
-    /* "pgenlib.pyx":354
+    /* "pgenlib.pyx":465
  *         self._state_ptr = <PgenReaderStruct*>PyMem_Malloc(sizeof(PgenReaderStruct))
  *         if not self._state_ptr:
  *             raise MemoryError()             # <<<<<<<<<<<<<<
  *         PreinitPgr(self._state_ptr)
  *         PgrSetFreadBuf(NULL, self._state_ptr)
  */
-    PyErr_NoMemory(); __PYX_ERR(0, 354, __pyx_L1_error)
+    PyErr_NoMemory(); __PYX_ERR(0, 465, __pyx_L1_error)
 
-    /* "pgenlib.pyx":353
+    /* "pgenlib.pyx":464
  * 
  *         self._state_ptr = <PgenReaderStruct*>PyMem_Malloc(sizeof(PgenReaderStruct))
  *         if not self._state_ptr:             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         PreinitPgr(self._state_ptr)
  */
   }
 
-  /* "pgenlib.pyx":355
+  /* "pgenlib.pyx":466
  *         if not self._state_ptr:
  *             raise MemoryError()
  *         PreinitPgr(self._state_ptr)             # <<<<<<<<<<<<<<
  *         PgrSetFreadBuf(NULL, self._state_ptr)
  *         cdef uintptr_t pgr_alloc_main_byte_ct = pgr_alloc_cacheline_ct * kCacheline
  */
   plink2::PreinitPgr(__pyx_v_self->_state_ptr);
 
-  /* "pgenlib.pyx":356
+  /* "pgenlib.pyx":467
  *             raise MemoryError()
  *         PreinitPgr(self._state_ptr)
  *         PgrSetFreadBuf(NULL, self._state_ptr)             # <<<<<<<<<<<<<<
  *         cdef uintptr_t pgr_alloc_main_byte_ct = pgr_alloc_cacheline_ct * kCacheline
  *         cdef uintptr_t sample_subset_byte_ct = DivUp(file_sample_ct, kBitsPerVec) * kBytesPerVec
  */
   plink2::PgrSetFreadBuf(NULL, __pyx_v_self->_state_ptr);
 
-  /* "pgenlib.pyx":357
+  /* "pgenlib.pyx":468
  *         PreinitPgr(self._state_ptr)
  *         PgrSetFreadBuf(NULL, self._state_ptr)
  *         cdef uintptr_t pgr_alloc_main_byte_ct = pgr_alloc_cacheline_ct * kCacheline             # <<<<<<<<<<<<<<
  *         cdef uintptr_t sample_subset_byte_ct = DivUp(file_sample_ct, kBitsPerVec) * kBytesPerVec
  *         cdef uintptr_t cumulative_popcounts_byte_ct = DivUp(file_sample_ct, kBitsPerWord * kInt32PerVec) * kBytesPerVec
  */
   __pyx_v_pgr_alloc_main_byte_ct = (__pyx_v_pgr_alloc_cacheline_ct * plink2::kCacheline);
 
-  /* "pgenlib.pyx":358
+  /* "pgenlib.pyx":469
  *         PgrSetFreadBuf(NULL, self._state_ptr)
  *         cdef uintptr_t pgr_alloc_main_byte_ct = pgr_alloc_cacheline_ct * kCacheline
  *         cdef uintptr_t sample_subset_byte_ct = DivUp(file_sample_ct, kBitsPerVec) * kBytesPerVec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t cumulative_popcounts_byte_ct = DivUp(file_sample_ct, kBitsPerWord * kInt32PerVec) * kBytesPerVec
  *         cdef uintptr_t genovec_byte_ct = DivUp(file_sample_ct, kNypsPerVec) * kBytesPerVec
  */
   __pyx_v_sample_subset_byte_ct = (plink2::DivUp(__pyx_v_file_sample_ct, plink2::kBitsPerVec) * plink2::kBytesPerVec);
 
-  /* "pgenlib.pyx":359
+  /* "pgenlib.pyx":470
  *         cdef uintptr_t pgr_alloc_main_byte_ct = pgr_alloc_cacheline_ct * kCacheline
  *         cdef uintptr_t sample_subset_byte_ct = DivUp(file_sample_ct, kBitsPerVec) * kBytesPerVec
  *         cdef uintptr_t cumulative_popcounts_byte_ct = DivUp(file_sample_ct, kBitsPerWord * kInt32PerVec) * kBytesPerVec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t genovec_byte_ct = DivUp(file_sample_ct, kNypsPerVec) * kBytesPerVec
  *         cdef uintptr_t patch_01_vals_byte_ct = RoundUpPow2(file_sample_ct * sizeof(AlleleCode), kBytesPerVec)
  */
   __pyx_v_cumulative_popcounts_byte_ct = (plink2::DivUp(__pyx_v_file_sample_ct, (plink2::kBitsPerWord * plink2::kInt32PerVec)) * plink2::kBytesPerVec);
 
-  /* "pgenlib.pyx":360
+  /* "pgenlib.pyx":471
  *         cdef uintptr_t sample_subset_byte_ct = DivUp(file_sample_ct, kBitsPerVec) * kBytesPerVec
  *         cdef uintptr_t cumulative_popcounts_byte_ct = DivUp(file_sample_ct, kBitsPerWord * kInt32PerVec) * kBytesPerVec
  *         cdef uintptr_t genovec_byte_ct = DivUp(file_sample_ct, kNypsPerVec) * kBytesPerVec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t patch_01_vals_byte_ct = RoundUpPow2(file_sample_ct * sizeof(AlleleCode), kBytesPerVec)
  *         cdef uintptr_t patch_10_vals_byte_ct = RoundUpPow2(file_sample_ct * 2 * sizeof(AlleleCode), kBytesPerVec)
  */
   __pyx_v_genovec_byte_ct = (plink2::DivUp(__pyx_v_file_sample_ct, plink2::kNypsPerVec) * plink2::kBytesPerVec);
 
-  /* "pgenlib.pyx":361
+  /* "pgenlib.pyx":472
  *         cdef uintptr_t cumulative_popcounts_byte_ct = DivUp(file_sample_ct, kBitsPerWord * kInt32PerVec) * kBytesPerVec
  *         cdef uintptr_t genovec_byte_ct = DivUp(file_sample_ct, kNypsPerVec) * kBytesPerVec
  *         cdef uintptr_t patch_01_vals_byte_ct = RoundUpPow2(file_sample_ct * sizeof(AlleleCode), kBytesPerVec)             # <<<<<<<<<<<<<<
  *         cdef uintptr_t patch_10_vals_byte_ct = RoundUpPow2(file_sample_ct * 2 * sizeof(AlleleCode), kBytesPerVec)
  *         cdef uintptr_t dosage_main_byte_ct = DivUp(file_sample_ct, (2 * kInt32PerVec)) * kBytesPerVec
  */
   __pyx_v_patch_01_vals_byte_ct = plink2::RoundUpPow2((__pyx_v_file_sample_ct * (sizeof(plink2::AlleleCode))), plink2::kBytesPerVec);
 
-  /* "pgenlib.pyx":362
+  /* "pgenlib.pyx":473
  *         cdef uintptr_t genovec_byte_ct = DivUp(file_sample_ct, kNypsPerVec) * kBytesPerVec
  *         cdef uintptr_t patch_01_vals_byte_ct = RoundUpPow2(file_sample_ct * sizeof(AlleleCode), kBytesPerVec)
  *         cdef uintptr_t patch_10_vals_byte_ct = RoundUpPow2(file_sample_ct * 2 * sizeof(AlleleCode), kBytesPerVec)             # <<<<<<<<<<<<<<
  *         cdef uintptr_t dosage_main_byte_ct = DivUp(file_sample_ct, (2 * kInt32PerVec)) * kBytesPerVec
  *         cdef unsigned char* pgr_alloc
  */
   __pyx_v_patch_10_vals_byte_ct = plink2::RoundUpPow2(((__pyx_v_file_sample_ct * 2) * (sizeof(plink2::AlleleCode))), plink2::kBytesPerVec);
 
-  /* "pgenlib.pyx":363
+  /* "pgenlib.pyx":474
  *         cdef uintptr_t patch_01_vals_byte_ct = RoundUpPow2(file_sample_ct * sizeof(AlleleCode), kBytesPerVec)
  *         cdef uintptr_t patch_10_vals_byte_ct = RoundUpPow2(file_sample_ct * 2 * sizeof(AlleleCode), kBytesPerVec)
  *         cdef uintptr_t dosage_main_byte_ct = DivUp(file_sample_ct, (2 * kInt32PerVec)) * kBytesPerVec             # <<<<<<<<<<<<<<
  *         cdef unsigned char* pgr_alloc
  *         if cachealigned_malloc(pgr_alloc_main_byte_ct + (2 * kPglNypTransposeBatch + 7) * sample_subset_byte_ct + cumulative_popcounts_byte_ct + (1 + kPglNypTransposeBatch) * genovec_byte_ct + patch_01_vals_byte_ct + patch_10_vals_byte_ct + dosage_main_byte_ct + kPglBitTransposeBufbytes + 4 * (kPglNypTransposeBatch * kPglNypTransposeBatch // 8), &pgr_alloc):
  */
   __pyx_v_dosage_main_byte_ct = (plink2::DivUp(__pyx_v_file_sample_ct, (2 * plink2::kInt32PerVec)) * plink2::kBytesPerVec);
 
-  /* "pgenlib.pyx":365
+  /* "pgenlib.pyx":476
  *         cdef uintptr_t dosage_main_byte_ct = DivUp(file_sample_ct, (2 * kInt32PerVec)) * kBytesPerVec
  *         cdef unsigned char* pgr_alloc
  *         if cachealigned_malloc(pgr_alloc_main_byte_ct + (2 * kPglNypTransposeBatch + 7) * sample_subset_byte_ct + cumulative_popcounts_byte_ct + (1 + kPglNypTransposeBatch) * genovec_byte_ct + patch_01_vals_byte_ct + patch_10_vals_byte_ct + dosage_main_byte_ct + kPglBitTransposeBufbytes + 4 * (kPglNypTransposeBatch * kPglNypTransposeBatch // 8), &pgr_alloc):             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         cdef PglErr reterr = PgrInit(fname, max_vrec_width, self._info_ptr, self._state_ptr, pgr_alloc)
  */
-  __pyx_t_2 = (plink2::cachealigned_malloc(((((((((__pyx_v_pgr_alloc_main_byte_ct + (((2 * plink2::kPglNypTransposeBatch) + 7) * __pyx_v_sample_subset_byte_ct)) + __pyx_v_cumulative_popcounts_byte_ct) + ((1 + plink2::kPglNypTransposeBatch) * __pyx_v_genovec_byte_ct)) + __pyx_v_patch_01_vals_byte_ct) + __pyx_v_patch_10_vals_byte_ct) + __pyx_v_dosage_main_byte_ct) + plink2::kPglBitTransposeBufbytes) + (4 * __Pyx_div_long((plink2::kPglNypTransposeBatch * plink2::kPglNypTransposeBatch), 8))), (&__pyx_v_pgr_alloc)) != 0);
-  if (unlikely(__pyx_t_2)) {
+  __pyx_t_1 = (plink2::cachealigned_malloc(((((((((__pyx_v_pgr_alloc_main_byte_ct + (((2 * plink2::kPglNypTransposeBatch) + 7) * __pyx_v_sample_subset_byte_ct)) + __pyx_v_cumulative_popcounts_byte_ct) + ((1 + plink2::kPglNypTransposeBatch) * __pyx_v_genovec_byte_ct)) + __pyx_v_patch_01_vals_byte_ct) + __pyx_v_patch_10_vals_byte_ct) + __pyx_v_dosage_main_byte_ct) + plink2::kPglBitTransposeBufbytes) + (4 * __Pyx_div_long((plink2::kPglNypTransposeBatch * plink2::kPglNypTransposeBatch), 8))), (&__pyx_v_pgr_alloc)) != 0);
+  if (unlikely(__pyx_t_1)) {
 
-    /* "pgenlib.pyx":366
+    /* "pgenlib.pyx":477
  *         cdef unsigned char* pgr_alloc
  *         if cachealigned_malloc(pgr_alloc_main_byte_ct + (2 * kPglNypTransposeBatch + 7) * sample_subset_byte_ct + cumulative_popcounts_byte_ct + (1 + kPglNypTransposeBatch) * genovec_byte_ct + patch_01_vals_byte_ct + patch_10_vals_byte_ct + dosage_main_byte_ct + kPglBitTransposeBufbytes + 4 * (kPglNypTransposeBatch * kPglNypTransposeBatch // 8), &pgr_alloc):
  *             raise MemoryError()             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = PgrInit(fname, max_vrec_width, self._info_ptr, self._state_ptr, pgr_alloc)
  *         if reterr != kPglRetSuccess:
  */
-    PyErr_NoMemory(); __PYX_ERR(0, 366, __pyx_L1_error)
+    PyErr_NoMemory(); __PYX_ERR(0, 477, __pyx_L1_error)
 
-    /* "pgenlib.pyx":365
+    /* "pgenlib.pyx":476
  *         cdef uintptr_t dosage_main_byte_ct = DivUp(file_sample_ct, (2 * kInt32PerVec)) * kBytesPerVec
  *         cdef unsigned char* pgr_alloc
  *         if cachealigned_malloc(pgr_alloc_main_byte_ct + (2 * kPglNypTransposeBatch + 7) * sample_subset_byte_ct + cumulative_popcounts_byte_ct + (1 + kPglNypTransposeBatch) * genovec_byte_ct + patch_01_vals_byte_ct + patch_10_vals_byte_ct + dosage_main_byte_ct + kPglBitTransposeBufbytes + 4 * (kPglNypTransposeBatch * kPglNypTransposeBatch // 8), &pgr_alloc):             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         cdef PglErr reterr = PgrInit(fname, max_vrec_width, self._info_ptr, self._state_ptr, pgr_alloc)
  */
   }
 
-  /* "pgenlib.pyx":367
+  /* "pgenlib.pyx":478
  *         if cachealigned_malloc(pgr_alloc_main_byte_ct + (2 * kPglNypTransposeBatch + 7) * sample_subset_byte_ct + cumulative_popcounts_byte_ct + (1 + kPglNypTransposeBatch) * genovec_byte_ct + patch_01_vals_byte_ct + patch_10_vals_byte_ct + dosage_main_byte_ct + kPglBitTransposeBufbytes + 4 * (kPglNypTransposeBatch * kPglNypTransposeBatch // 8), &pgr_alloc):
  *             raise MemoryError()
  *         cdef PglErr reterr = PgrInit(fname, max_vrec_width, self._info_ptr, self._state_ptr, pgr_alloc)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             if not PgrGetFreadBuf(self._state_ptr):
  */
   __pyx_v_reterr = plink2::PgrInit(__pyx_v_fname, __pyx_v_max_vrec_width, __pyx_v_self->_info_ptr, __pyx_v_self->_state_ptr, __pyx_v_pgr_alloc);
 
-  /* "pgenlib.pyx":368
+  /* "pgenlib.pyx":479
  *             raise MemoryError()
  *         cdef PglErr reterr = PgrInit(fname, max_vrec_width, self._info_ptr, self._state_ptr, pgr_alloc)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             if not PgrGetFreadBuf(self._state_ptr):
  *                 aligned_free(pgr_alloc)
  */
-  __pyx_t_2 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
-  if (__pyx_t_2) {
+  __pyx_t_1 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
+  if (__pyx_t_1) {
 
-    /* "pgenlib.pyx":369
+    /* "pgenlib.pyx":480
  *         cdef PglErr reterr = PgrInit(fname, max_vrec_width, self._info_ptr, self._state_ptr, pgr_alloc)
  *         if reterr != kPglRetSuccess:
  *             if not PgrGetFreadBuf(self._state_ptr):             # <<<<<<<<<<<<<<
  *                 aligned_free(pgr_alloc)
  *             raise RuntimeError("PgrInit() error " + str(reterr))
  */
-    __pyx_t_2 = ((!(plink2::PgrGetFreadBuf(__pyx_v_self->_state_ptr) != 0)) != 0);
-    if (__pyx_t_2) {
+    __pyx_t_1 = ((!(plink2::PgrGetFreadBuf(__pyx_v_self->_state_ptr) != 0)) != 0);
+    if (__pyx_t_1) {
 
-      /* "pgenlib.pyx":370
+      /* "pgenlib.pyx":481
  *         if reterr != kPglRetSuccess:
  *             if not PgrGetFreadBuf(self._state_ptr):
  *                 aligned_free(pgr_alloc)             # <<<<<<<<<<<<<<
  *             raise RuntimeError("PgrInit() error " + str(reterr))
  *         cdef unsigned char* pgr_alloc_iter = &(pgr_alloc[pgr_alloc_main_byte_ct])
  */
       plink2::aligned_free(__pyx_v_pgr_alloc);
 
-      /* "pgenlib.pyx":369
+      /* "pgenlib.pyx":480
  *         cdef PglErr reterr = PgrInit(fname, max_vrec_width, self._info_ptr, self._state_ptr, pgr_alloc)
  *         if reterr != kPglRetSuccess:
  *             if not PgrGetFreadBuf(self._state_ptr):             # <<<<<<<<<<<<<<
  *                 aligned_free(pgr_alloc)
  *             raise RuntimeError("PgrInit() error " + str(reterr))
  */
     }
 
-    /* "pgenlib.pyx":371
+    /* "pgenlib.pyx":482
  *             if not PgrGetFreadBuf(self._state_ptr):
  *                 aligned_free(pgr_alloc)
  *             raise RuntimeError("PgrInit() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         cdef unsigned char* pgr_alloc_iter = &(pgr_alloc[pgr_alloc_main_byte_ct])
  *         self._subset_include_vec = <uintptr_t*>pgr_alloc_iter
  */
-    __pyx_t_5 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 371, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 482, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_kp_u_PgrInit_error, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 482, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 371, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_PgrInit_error, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 482, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 482, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 371, __pyx_L1_error)
+    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __PYX_ERR(0, 482, __pyx_L1_error)
 
-    /* "pgenlib.pyx":368
+    /* "pgenlib.pyx":479
  *             raise MemoryError()
  *         cdef PglErr reterr = PgrInit(fname, max_vrec_width, self._info_ptr, self._state_ptr, pgr_alloc)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             if not PgrGetFreadBuf(self._state_ptr):
  *                 aligned_free(pgr_alloc)
  */
   }
 
-  /* "pgenlib.pyx":372
+  /* "pgenlib.pyx":483
  *                 aligned_free(pgr_alloc)
  *             raise RuntimeError("PgrInit() error " + str(reterr))
  *         cdef unsigned char* pgr_alloc_iter = &(pgr_alloc[pgr_alloc_main_byte_ct])             # <<<<<<<<<<<<<<
  *         self._subset_include_vec = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc[__pyx_v_pgr_alloc_main_byte_ct]));
 
-  /* "pgenlib.pyx":373
+  /* "pgenlib.pyx":484
  *             raise RuntimeError("PgrInit() error " + str(reterr))
  *         cdef unsigned char* pgr_alloc_iter = &(pgr_alloc[pgr_alloc_main_byte_ct])
  *         self._subset_include_vec = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._subset_include_interleaved_vec = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_subset_include_vec = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":374
+  /* "pgenlib.pyx":485
  *         cdef unsigned char* pgr_alloc_iter = &(pgr_alloc[pgr_alloc_main_byte_ct])
  *         self._subset_include_vec = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])             # <<<<<<<<<<<<<<
  *         self._subset_include_interleaved_vec = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_sample_subset_byte_ct]));
 
-  /* "pgenlib.pyx":375
+  /* "pgenlib.pyx":486
  *         self._subset_include_vec = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._subset_include_interleaved_vec = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  * 
  */
   __pyx_v_self->_subset_include_interleaved_vec = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":376
+  /* "pgenlib.pyx":487
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._subset_include_interleaved_vec = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])             # <<<<<<<<<<<<<<
  * 
  *         # assumes kWordsPerVec <= 2
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_sample_subset_byte_ct]));
 
-  /* "pgenlib.pyx":379
+  /* "pgenlib.pyx":490
  * 
  *         # assumes kWordsPerVec <= 2
  *         self._subset_include_interleaved_vec[-1] = 0             # <<<<<<<<<<<<<<
  * 
  *         self._subset_cumulative_popcounts = <uint32_t*>pgr_alloc_iter
  */
   (__pyx_v_self->_subset_include_interleaved_vec[-1L]) = 0;
 
-  /* "pgenlib.pyx":381
+  /* "pgenlib.pyx":492
  *         self._subset_include_interleaved_vec[-1] = 0
  * 
  *         self._subset_cumulative_popcounts = <uint32_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[cumulative_popcounts_byte_ct])
  *         self._pgv.genovec = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_subset_cumulative_popcounts = ((uint32_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":382
+  /* "pgenlib.pyx":493
  * 
  *         self._subset_cumulative_popcounts = <uint32_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[cumulative_popcounts_byte_ct])             # <<<<<<<<<<<<<<
  *         self._pgv.genovec = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[genovec_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_cumulative_popcounts_byte_ct]));
 
-  /* "pgenlib.pyx":383
+  /* "pgenlib.pyx":494
  *         self._subset_cumulative_popcounts = <uint32_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[cumulative_popcounts_byte_ct])
  *         self._pgv.genovec = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[genovec_byte_ct])
  *         self._pgv.patch_01_set = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_pgv.genovec = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":384
+  /* "pgenlib.pyx":495
  *         pgr_alloc_iter = &(pgr_alloc_iter[cumulative_popcounts_byte_ct])
  *         self._pgv.genovec = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[genovec_byte_ct])             # <<<<<<<<<<<<<<
  *         self._pgv.patch_01_set = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_genovec_byte_ct]));
 
-  /* "pgenlib.pyx":385
+  /* "pgenlib.pyx":496
  *         self._pgv.genovec = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[genovec_byte_ct])
  *         self._pgv.patch_01_set = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.patch_01_vals = <AlleleCode*>pgr_alloc_iter
  */
   __pyx_v_self->_pgv.patch_01_set = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":386
+  /* "pgenlib.pyx":497
  *         pgr_alloc_iter = &(pgr_alloc_iter[genovec_byte_ct])
  *         self._pgv.patch_01_set = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])             # <<<<<<<<<<<<<<
  *         self._pgv.patch_01_vals = <AlleleCode*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_01_vals_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_sample_subset_byte_ct]));
 
-  /* "pgenlib.pyx":387
+  /* "pgenlib.pyx":498
  *         self._pgv.patch_01_set = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.patch_01_vals = <AlleleCode*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_01_vals_byte_ct])
  *         self._pgv.patch_10_set = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_pgv.patch_01_vals = ((plink2::AlleleCode *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":388
+  /* "pgenlib.pyx":499
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.patch_01_vals = <AlleleCode*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_01_vals_byte_ct])             # <<<<<<<<<<<<<<
  *         self._pgv.patch_10_set = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_patch_01_vals_byte_ct]));
 
-  /* "pgenlib.pyx":389
+  /* "pgenlib.pyx":500
  *         self._pgv.patch_01_vals = <AlleleCode*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_01_vals_byte_ct])
  *         self._pgv.patch_10_set = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.patch_10_vals = <AlleleCode*>pgr_alloc_iter
  */
   __pyx_v_self->_pgv.patch_10_set = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":390
+  /* "pgenlib.pyx":501
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_01_vals_byte_ct])
  *         self._pgv.patch_10_set = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])             # <<<<<<<<<<<<<<
  *         self._pgv.patch_10_vals = <AlleleCode*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_10_vals_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_sample_subset_byte_ct]));
 
-  /* "pgenlib.pyx":391
+  /* "pgenlib.pyx":502
  *         self._pgv.patch_10_set = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.patch_10_vals = <AlleleCode*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_10_vals_byte_ct])
  *         self._pgv.phasepresent = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_pgv.patch_10_vals = ((plink2::AlleleCode *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":392
+  /* "pgenlib.pyx":503
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.patch_10_vals = <AlleleCode*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_10_vals_byte_ct])             # <<<<<<<<<<<<<<
  *         self._pgv.phasepresent = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_patch_10_vals_byte_ct]));
 
-  /* "pgenlib.pyx":393
+  /* "pgenlib.pyx":504
  *         self._pgv.patch_10_vals = <AlleleCode*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_10_vals_byte_ct])
  *         self._pgv.phasepresent = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.phaseinfo = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_pgv.phasepresent = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":394
+  /* "pgenlib.pyx":505
  *         pgr_alloc_iter = &(pgr_alloc_iter[patch_10_vals_byte_ct])
  *         self._pgv.phasepresent = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])             # <<<<<<<<<<<<<<
  *         self._pgv.phaseinfo = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_sample_subset_byte_ct]));
 
-  /* "pgenlib.pyx":395
+  /* "pgenlib.pyx":506
  *         self._pgv.phasepresent = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.phaseinfo = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.dosage_present = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_pgv.phaseinfo = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":396
+  /* "pgenlib.pyx":507
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.phaseinfo = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])             # <<<<<<<<<<<<<<
  *         self._pgv.dosage_present = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_sample_subset_byte_ct]));
 
-  /* "pgenlib.pyx":397
+  /* "pgenlib.pyx":508
  *         self._pgv.phaseinfo = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.dosage_present = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.dosage_main = <uint16_t*>pgr_alloc_iter
  */
   __pyx_v_self->_pgv.dosage_present = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":398
+  /* "pgenlib.pyx":509
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.dosage_present = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])             # <<<<<<<<<<<<<<
  *         self._pgv.dosage_main = <uint16_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[dosage_main_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_sample_subset_byte_ct]));
 
-  /* "pgenlib.pyx":399
+  /* "pgenlib.pyx":510
  *         self._pgv.dosage_present = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.dosage_main = <uint16_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[dosage_main_byte_ct])
  *         if sample_subset is not None:
  */
   __pyx_v_self->_pgv.dosage_main = ((uint16_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":400
+  /* "pgenlib.pyx":511
  *         pgr_alloc_iter = &(pgr_alloc_iter[sample_subset_byte_ct])
  *         self._pgv.dosage_main = <uint16_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[dosage_main_byte_ct])             # <<<<<<<<<<<<<<
  *         if sample_subset is not None:
  *             self.set_sample_subset_internal(sample_subset)
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__pyx_v_dosage_main_byte_ct]));
 
-  /* "pgenlib.pyx":401
+  /* "pgenlib.pyx":512
  *         self._pgv.dosage_main = <uint16_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[dosage_main_byte_ct])
  *         if sample_subset is not None:             # <<<<<<<<<<<<<<
  *             self.set_sample_subset_internal(sample_subset)
  *         else:
  */
-  __pyx_t_2 = (__pyx_v_sample_subset != Py_None);
-  __pyx_t_1 = (__pyx_t_2 != 0);
-  if (__pyx_t_1) {
+  __pyx_t_1 = (__pyx_v_sample_subset != Py_None);
+  __pyx_t_2 = (__pyx_t_1 != 0);
+  if (__pyx_t_2) {
 
-    /* "pgenlib.pyx":402
+    /* "pgenlib.pyx":513
  *         pgr_alloc_iter = &(pgr_alloc_iter[dosage_main_byte_ct])
  *         if sample_subset is not None:
  *             self.set_sample_subset_internal(sample_subset)             # <<<<<<<<<<<<<<
  *         else:
  *             self._subset_size = file_sample_ct
  */
-    if (!(likely(((__pyx_v_sample_subset) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_sample_subset, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 402, __pyx_L1_error)
-    __pyx_t_6 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->set_sample_subset_internal(__pyx_v_self, ((PyArrayObject *)__pyx_v_sample_subset)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 402, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    if (!(likely(((__pyx_v_sample_subset) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_sample_subset, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 513, __pyx_L1_error)
+    __pyx_t_5 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->set_sample_subset_internal(__pyx_v_self, ((PyArrayObject *)__pyx_v_sample_subset)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 513, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pgenlib.pyx":401
+    /* "pgenlib.pyx":512
  *         self._pgv.dosage_main = <uint16_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[dosage_main_byte_ct])
  *         if sample_subset is not None:             # <<<<<<<<<<<<<<
  *             self.set_sample_subset_internal(sample_subset)
  *         else:
  */
-    goto __pyx_L24;
+    goto __pyx_L29;
   }
 
-  /* "pgenlib.pyx":404
+  /* "pgenlib.pyx":515
  *             self.set_sample_subset_internal(sample_subset)
  *         else:
  *             self._subset_size = file_sample_ct             # <<<<<<<<<<<<<<
  *         self._transpose_batch_buf = <VecW*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglBitTransposeBufbytes])
  */
   /*else*/ {
     __pyx_v_self->_subset_size = __pyx_v_file_sample_ct;
   }
-  __pyx_L24:;
+  __pyx_L29:;
 
-  /* "pgenlib.pyx":405
+  /* "pgenlib.pyx":516
  *         else:
  *             self._subset_size = file_sample_ct
  *         self._transpose_batch_buf = <VecW*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglBitTransposeBufbytes])
  *         self._multivar_vmaj_geno_buf = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_transpose_batch_buf = ((plink2::VecW *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":406
+  /* "pgenlib.pyx":517
  *             self._subset_size = file_sample_ct
  *         self._transpose_batch_buf = <VecW*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglBitTransposeBufbytes])             # <<<<<<<<<<<<<<
  *         self._multivar_vmaj_geno_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * genovec_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[plink2::kPglBitTransposeBufbytes]));
 
-  /* "pgenlib.pyx":407
+  /* "pgenlib.pyx":518
  *         self._transpose_batch_buf = <VecW*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglBitTransposeBufbytes])
  *         self._multivar_vmaj_geno_buf = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * genovec_byte_ct])
  *         self._multivar_vmaj_phasepresent_buf = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_multivar_vmaj_geno_buf = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":408
+  /* "pgenlib.pyx":519
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglBitTransposeBufbytes])
  *         self._multivar_vmaj_geno_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * genovec_byte_ct])             # <<<<<<<<<<<<<<
  *         self._multivar_vmaj_phasepresent_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[(plink2::kPglNypTransposeBatch * __pyx_v_genovec_byte_ct)]));
 
-  /* "pgenlib.pyx":409
+  /* "pgenlib.pyx":520
  *         self._multivar_vmaj_geno_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * genovec_byte_ct])
  *         self._multivar_vmaj_phasepresent_buf = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])
  *         self._multivar_vmaj_phaseinfo_buf = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_multivar_vmaj_phasepresent_buf = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":410
+  /* "pgenlib.pyx":521
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * genovec_byte_ct])
  *         self._multivar_vmaj_phasepresent_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])             # <<<<<<<<<<<<<<
  *         self._multivar_vmaj_phaseinfo_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[(plink2::kPglNypTransposeBatch * __pyx_v_sample_subset_byte_ct)]));
 
-  /* "pgenlib.pyx":411
+  /* "pgenlib.pyx":522
  *         self._multivar_vmaj_phasepresent_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])
  *         self._multivar_vmaj_phaseinfo_buf = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])
  *         self._multivar_smaj_geno_batch_buf = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_multivar_vmaj_phaseinfo_buf = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":412
+  /* "pgenlib.pyx":523
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])
  *         self._multivar_vmaj_phaseinfo_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])             # <<<<<<<<<<<<<<
  *         self._multivar_smaj_geno_batch_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 4])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[(plink2::kPglNypTransposeBatch * __pyx_v_sample_subset_byte_ct)]));
 
-  /* "pgenlib.pyx":413
+  /* "pgenlib.pyx":524
  *         self._multivar_vmaj_phaseinfo_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])
  *         self._multivar_smaj_geno_batch_buf = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 4])
  *         self._multivar_smaj_phaseinfo_batch_buf = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_multivar_smaj_geno_batch_buf = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":414
+  /* "pgenlib.pyx":525
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * sample_subset_byte_ct])
  *         self._multivar_smaj_geno_batch_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 4])             # <<<<<<<<<<<<<<
  *         self._multivar_smaj_phaseinfo_batch_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 8])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__Pyx_div_long((plink2::kPglNypTransposeBatch * plink2::kPglNypTransposeBatch), 4)]));
 
-  /* "pgenlib.pyx":415
+  /* "pgenlib.pyx":526
  *         self._multivar_smaj_geno_batch_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 4])
  *         self._multivar_smaj_phaseinfo_batch_buf = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 8])
  *         self._multivar_smaj_phasepresent_batch_buf = <uintptr_t*>pgr_alloc_iter
  */
   __pyx_v_self->_multivar_smaj_phaseinfo_batch_buf = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":416
+  /* "pgenlib.pyx":527
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 4])
  *         self._multivar_smaj_phaseinfo_batch_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 8])             # <<<<<<<<<<<<<<
  *         self._multivar_smaj_phasepresent_batch_buf = <uintptr_t*>pgr_alloc_iter
  *         # pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 8])
  */
   __pyx_v_pgr_alloc_iter = (&(__pyx_v_pgr_alloc_iter[__Pyx_div_long((plink2::kPglNypTransposeBatch * plink2::kPglNypTransposeBatch), 8)]));
 
-  /* "pgenlib.pyx":417
+  /* "pgenlib.pyx":528
  *         self._multivar_smaj_phaseinfo_batch_buf = <uintptr_t*>pgr_alloc_iter
  *         pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 8])
  *         self._multivar_smaj_phasepresent_batch_buf = <uintptr_t*>pgr_alloc_iter             # <<<<<<<<<<<<<<
  *         # pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 8])
  *         return
  */
   __pyx_v_self->_multivar_smaj_phasepresent_batch_buf = ((uintptr_t *)__pyx_v_pgr_alloc_iter);
 
-  /* "pgenlib.pyx":419
+  /* "pgenlib.pyx":530
  *         self._multivar_smaj_phasepresent_batch_buf = <uintptr_t*>pgr_alloc_iter
  *         # pgr_alloc_iter = &(pgr_alloc_iter[kPglNypTransposeBatch * kPglNypTransposeBatch // 8])
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":297
+  /* "pgenlib.pyx":400
  * 
  * 
  *     def __cinit__(self, bytes filename, object raw_sample_ct = None,             # <<<<<<<<<<<<<<
  *                   object variant_ct = None, object sample_subset = None,
- *                   object allele_idx_offsets = None):
+ *                   object allele_idx_offsets = None, object pvar = None):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_AddTraceback("pgenlib.PgenReader.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
+  __Pyx_XDECREF((PyObject *)__pyx_v_pr);
+  __Pyx_XDECREF(__pyx_v_variant_ct);
+  __Pyx_XDECREF(__pyx_v_allele_idx_offsets);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":422
+/* "pgenlib.pyx":533
  * 
  * 
  *     cpdef __enter__(self):             # <<<<<<<<<<<<<<
  *         return self
  * 
  */
 
@@ -5058,15 +7779,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 533, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_3__enter__)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -5075,15 +7796,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 422, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -5096,27 +7817,27 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":423
+  /* "pgenlib.pyx":534
  * 
  *     cpdef __enter__(self):
  *         return self             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":422
+  /* "pgenlib.pyx":533
  * 
  * 
  *     cpdef __enter__(self):             # <<<<<<<<<<<<<<
  *         return self
  * 
  */
 
@@ -5152,15 +7873,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__enter__", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader___enter__(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader___enter__(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 533, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5169,15 +7890,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":426
+/* "pgenlib.pyx":537
  * 
  * 
  *     cpdef get_raw_sample_ct(self):             # <<<<<<<<<<<<<<
  *         return self._info_ptr[0].raw_sample_ct
  * 
  */
 
@@ -5198,15 +7919,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_raw_sample_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_raw_sample_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 537, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_5get_raw_sample_ct)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -5215,15 +7936,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 537, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -5236,29 +7957,29 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":427
+  /* "pgenlib.pyx":538
  * 
  *     cpdef get_raw_sample_ct(self):
  *         return self._info_ptr[0].raw_sample_ct             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_sample_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_sample_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":426
+  /* "pgenlib.pyx":537
  * 
  * 
  *     cpdef get_raw_sample_ct(self):             # <<<<<<<<<<<<<<
  *         return self._info_ptr[0].raw_sample_ct
  * 
  */
 
@@ -5294,15 +8015,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_raw_sample_ct", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_get_raw_sample_ct(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_get_raw_sample_ct(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 537, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5311,15 +8032,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":430
+/* "pgenlib.pyx":541
  * 
  * 
  *     cpdef get_variant_ct(self):             # <<<<<<<<<<<<<<
  *         return self._info_ptr[0].raw_variant_ct
  * 
  */
 
@@ -5340,15 +8061,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_get_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 541, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_7get_variant_ct)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -5357,15 +8078,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 541, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -5378,29 +8099,29 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":431
+  /* "pgenlib.pyx":542
  * 
  *     cpdef get_variant_ct(self):
  *         return self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":430
+  /* "pgenlib.pyx":541
  * 
  * 
  *     cpdef get_variant_ct(self):             # <<<<<<<<<<<<<<
  *         return self._info_ptr[0].raw_variant_ct
  * 
  */
 
@@ -5436,15 +8157,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_variant_ct", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_get_variant_ct(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_get_variant_ct(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5453,15 +8174,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":434
+/* "pgenlib.pyx":545
  * 
  * 
  *     cpdef hardcall_phase_present(self):             # <<<<<<<<<<<<<<
  *         return ((self._info_ptr[0].gflags & kfPgenGlobalHardcallPhasePresent) != 0)
  * 
  */
 
@@ -5482,15 +8203,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_hardcall_phase_present); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_hardcall_phase_present); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_9hardcall_phase_present)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -5499,15 +8220,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 434, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 545, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -5520,29 +8241,29 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":435
+  /* "pgenlib.pyx":546
  * 
  *     cpdef hardcall_phase_present(self):
  *         return ((self._info_ptr[0].gflags & kfPgenGlobalHardcallPhasePresent) != 0)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyBool_FromLong((((__pyx_v_self->_info_ptr[0]).gflags & plink2::kfPgenGlobalHardcallPhasePresent) != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyBool_FromLong((((__pyx_v_self->_info_ptr[0]).gflags & plink2::kfPgenGlobalHardcallPhasePresent) != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":434
+  /* "pgenlib.pyx":545
  * 
  * 
  *     cpdef hardcall_phase_present(self):             # <<<<<<<<<<<<<<
  *         return ((self._info_ptr[0].gflags & kfPgenGlobalHardcallPhasePresent) != 0)
  * 
  */
 
@@ -5578,15 +8299,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("hardcall_phase_present", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_hardcall_phase_present(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_hardcall_phase_present(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5595,15 +8316,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":438
+/* "pgenlib.pyx":549
  * 
  * 
  *     cpdef read(self, uint32_t variant_idx, np.ndarray geno_int_out, uint32_t allele_idx = 1):             # <<<<<<<<<<<<<<
  *         # for full genotype info for multiallelic variants, use read_alleles()
  *         # instead
  */
 
@@ -5643,21 +8364,21 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 438, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_11read)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 438, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 549, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 438, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
         __pyx_t_7 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
           if (likely(__pyx_t_6)) {
@@ -5667,47 +8388,47 @@
             __Pyx_DECREF_SET(__pyx_t_5, function);
             __pyx_t_7 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, ((PyObject *)__pyx_v_geno_int_out), __pyx_t_4};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 438, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 549, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, ((PyObject *)__pyx_v_geno_int_out), __pyx_t_4};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 438, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 549, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         {
-          __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 438, __pyx_L1_error)
+          __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 549, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           if (__pyx_t_6) {
             __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
           __Pyx_INCREF(((PyObject *)__pyx_v_geno_int_out));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_geno_int_out));
           PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, ((PyObject *)__pyx_v_geno_int_out));
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_t_4);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 438, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 549, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -5722,403 +8443,403 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":444
+  /* "pgenlib.pyx":555
  *         # when this is too much bounds-checking, caller should be using
  *         # read_range() or read_list()
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.ndim != 1:
  */
   __pyx_t_9 = ((__pyx_v_variant_idx >= (__pyx_v_self->_info_ptr[0]).raw_variant_ct) != 0);
   if (unlikely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":445
+    /* "pgenlib.pyx":556
  *         # read_range() or read_list()
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *         if geno_int_out.ndim != 1:
  *             raise RuntimeError("read() requires geno_int_out to be one-dimensional.")
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_variant_idx_too_large, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_variant_idx_too_large, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 445, __pyx_L1_error)
+    __PYX_ERR(0, 556, __pyx_L1_error)
 
-    /* "pgenlib.pyx":444
+    /* "pgenlib.pyx":555
  *         # when this is too much bounds-checking, caller should be using
  *         # read_range() or read_list()
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.ndim != 1:
  */
   }
 
-  /* "pgenlib.pyx":446
+  /* "pgenlib.pyx":557
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.ndim != 1:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read() requires geno_int_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_9 = ((__pyx_v_geno_int_out->nd != 1) != 0);
   if (unlikely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":447
+    /* "pgenlib.pyx":558
  *             raise RuntimeError("read() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.ndim != 1:
  *             raise RuntimeError("read() requires geno_int_out to be one-dimensional.")             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         if geno_int_out.shape[0] < subset_size:
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 447, __pyx_L1_error)
+    __PYX_ERR(0, 558, __pyx_L1_error)
 
-    /* "pgenlib.pyx":446
+    /* "pgenlib.pyx":557
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.ndim != 1:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read() requires geno_int_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size
  */
   }
 
-  /* "pgenlib.pyx":448
+  /* "pgenlib.pyx":559
  *         if geno_int_out.ndim != 1:
  *             raise RuntimeError("read() requires geno_int_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         if geno_int_out.shape[0] < subset_size:
  *             raise RuntimeError("read() geno_int_out is too small (" + str(geno_int_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  */
   __pyx_t_10 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_10;
 
-  /* "pgenlib.pyx":449
+  /* "pgenlib.pyx":560
  *             raise RuntimeError("read() requires geno_int_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size
  *         if geno_int_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read() geno_int_out is too small (" + str(geno_int_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  */
   __pyx_t_9 = (((__pyx_v_geno_int_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":450
+    /* "pgenlib.pyx":561
  *         cdef uint32_t subset_size = self._subset_size
  *         if geno_int_out.shape[0] < subset_size:
  *             raise RuntimeError("read() geno_int_out is too small (" + str(geno_int_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")             # <<<<<<<<<<<<<<
  * 
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
-    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_geno_int_out_is_too_small, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_geno_int_out_is_too_small, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 450, __pyx_L1_error)
+    __PYX_ERR(0, 561, __pyx_L1_error)
 
-    /* "pgenlib.pyx":449
+    /* "pgenlib.pyx":560
  *             raise RuntimeError("read() requires geno_int_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size
  *         if geno_int_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read() geno_int_out is too small (" + str(geno_int_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  */
   }
 
-  /* "pgenlib.pyx":452
+  /* "pgenlib.pyx":563
  *             raise RuntimeError("read() geno_int_out is too small (" + str(geno_int_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = PgrGet1(self._subset_include_vec, self._subset_index, subset_size, variant_idx, allele_idx, self._state_ptr, genovec)
  *         if reterr != kPglRetSuccess:
  */
   __pyx_t_11 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_11;
 
-  /* "pgenlib.pyx":453
+  /* "pgenlib.pyx":564
  * 
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef PglErr reterr = PgrGet1(self._subset_include_vec, self._subset_index, subset_size, variant_idx, allele_idx, self._state_ptr, genovec)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read() error " + str(reterr))
  */
   __pyx_v_reterr = plink2::PgrGet1(__pyx_v_self->_subset_include_vec, __pyx_v_self->_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_self->_state_ptr, __pyx_v_genovec);
 
-  /* "pgenlib.pyx":454
+  /* "pgenlib.pyx":565
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef PglErr reterr = PgrGet1(self._subset_include_vec, self._subset_index, subset_size, variant_idx, allele_idx, self._state_ptr, genovec)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read() error " + str(reterr))
  *         cdef int8_t* data8_ptr
  */
   __pyx_t_9 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":455
+    /* "pgenlib.pyx":566
  *         cdef PglErr reterr = PgrGet1(self._subset_include_vec, self._subset_index, subset_size, variant_idx, allele_idx, self._state_ptr, genovec)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         cdef int8_t* data8_ptr
  *         cdef int32_t* data32_ptr
  */
-    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 455, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 455, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 455, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 455, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 455, __pyx_L1_error)
+    __PYX_ERR(0, 566, __pyx_L1_error)
 
-    /* "pgenlib.pyx":454
+    /* "pgenlib.pyx":565
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef PglErr reterr = PgrGet1(self._subset_include_vec, self._subset_index, subset_size, variant_idx, allele_idx, self._state_ptr, genovec)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read() error " + str(reterr))
  *         cdef int8_t* data8_ptr
  */
   }
 
-  /* "pgenlib.pyx":459
+  /* "pgenlib.pyx":570
  *         cdef int32_t* data32_ptr
  *         cdef int64_t* data64_ptr
  *         if geno_int_out.dtype == np.int8:             # <<<<<<<<<<<<<<
  *             data8_ptr = <int8_t*>geno_int_out.data
  *             GenoarrToBytesMinus9(genovec, subset_size, data8_ptr)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 459, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 459, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 459, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 459, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 459, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_9) {
 
-    /* "pgenlib.pyx":460
+    /* "pgenlib.pyx":571
  *         cdef int64_t* data64_ptr
  *         if geno_int_out.dtype == np.int8:
  *             data8_ptr = <int8_t*>geno_int_out.data             # <<<<<<<<<<<<<<
  *             GenoarrToBytesMinus9(genovec, subset_size, data8_ptr)
  *         elif geno_int_out.dtype == np.int32:
  */
     __pyx_v_data8_ptr = ((int8_t *)__pyx_v_geno_int_out->data);
 
-    /* "pgenlib.pyx":461
+    /* "pgenlib.pyx":572
  *         if geno_int_out.dtype == np.int8:
  *             data8_ptr = <int8_t*>geno_int_out.data
  *             GenoarrToBytesMinus9(genovec, subset_size, data8_ptr)             # <<<<<<<<<<<<<<
  *         elif geno_int_out.dtype == np.int32:
  *             data32_ptr = <int32_t*>geno_int_out.data
  */
     plink2::GenoarrToBytesMinus9(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data8_ptr);
 
-    /* "pgenlib.pyx":459
+    /* "pgenlib.pyx":570
  *         cdef int32_t* data32_ptr
  *         cdef int64_t* data64_ptr
  *         if geno_int_out.dtype == np.int8:             # <<<<<<<<<<<<<<
  *             data8_ptr = <int8_t*>geno_int_out.data
  *             GenoarrToBytesMinus9(genovec, subset_size, data8_ptr)
  */
     goto __pyx_L7;
   }
 
-  /* "pgenlib.pyx":462
+  /* "pgenlib.pyx":573
  *             data8_ptr = <int8_t*>geno_int_out.data
  *             GenoarrToBytesMinus9(genovec, subset_size, data8_ptr)
  *         elif geno_int_out.dtype == np.int32:             # <<<<<<<<<<<<<<
  *             data32_ptr = <int32_t*>geno_int_out.data
  *             GenoarrToInt32sMinus9(genovec, subset_size, data32_ptr)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 462, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 462, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 462, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 462, __pyx_L1_error)
+  __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 462, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 573, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_9) {
 
-    /* "pgenlib.pyx":463
+    /* "pgenlib.pyx":574
  *             GenoarrToBytesMinus9(genovec, subset_size, data8_ptr)
  *         elif geno_int_out.dtype == np.int32:
  *             data32_ptr = <int32_t*>geno_int_out.data             # <<<<<<<<<<<<<<
  *             GenoarrToInt32sMinus9(genovec, subset_size, data32_ptr)
  *         elif geno_int_out.dtype == np.int64:
  */
     __pyx_v_data32_ptr = ((int32_t *)__pyx_v_geno_int_out->data);
 
-    /* "pgenlib.pyx":464
+    /* "pgenlib.pyx":575
  *         elif geno_int_out.dtype == np.int32:
  *             data32_ptr = <int32_t*>geno_int_out.data
  *             GenoarrToInt32sMinus9(genovec, subset_size, data32_ptr)             # <<<<<<<<<<<<<<
  *         elif geno_int_out.dtype == np.int64:
  *             data64_ptr = <int64_t*>geno_int_out.data
  */
     plink2::GenoarrToInt32sMinus9(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data32_ptr);
 
-    /* "pgenlib.pyx":462
+    /* "pgenlib.pyx":573
  *             data8_ptr = <int8_t*>geno_int_out.data
  *             GenoarrToBytesMinus9(genovec, subset_size, data8_ptr)
  *         elif geno_int_out.dtype == np.int32:             # <<<<<<<<<<<<<<
  *             data32_ptr = <int32_t*>geno_int_out.data
  *             GenoarrToInt32sMinus9(genovec, subset_size, data32_ptr)
  */
     goto __pyx_L7;
   }
 
-  /* "pgenlib.pyx":465
+  /* "pgenlib.pyx":576
  *             data32_ptr = <int32_t*>geno_int_out.data
  *             GenoarrToInt32sMinus9(genovec, subset_size, data32_ptr)
  *         elif geno_int_out.dtype == np.int64:             # <<<<<<<<<<<<<<
  *             data64_ptr = <int64_t*>geno_int_out.data
  *             GenoarrToInt64sMinus9(genovec, subset_size, data64_ptr)
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_5, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_5, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 576, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 576, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (likely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":466
+    /* "pgenlib.pyx":577
  *             GenoarrToInt32sMinus9(genovec, subset_size, data32_ptr)
  *         elif geno_int_out.dtype == np.int64:
  *             data64_ptr = <int64_t*>geno_int_out.data             # <<<<<<<<<<<<<<
  *             GenoarrToInt64sMinus9(genovec, subset_size, data64_ptr)
  *         else:
  */
     __pyx_v_data64_ptr = ((int64_t *)__pyx_v_geno_int_out->data);
 
-    /* "pgenlib.pyx":467
+    /* "pgenlib.pyx":578
  *         elif geno_int_out.dtype == np.int64:
  *             data64_ptr = <int64_t*>geno_int_out.data
  *             GenoarrToInt64sMinus9(genovec, subset_size, data64_ptr)             # <<<<<<<<<<<<<<
  *         else:
  *             raise RuntimeError("Invalid read() geno_int_out array element type (int8, int32, or int64 expected).")
  */
     plink2::GenoarrToInt64sMinus9(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data64_ptr);
 
-    /* "pgenlib.pyx":465
+    /* "pgenlib.pyx":576
  *             data32_ptr = <int32_t*>geno_int_out.data
  *             GenoarrToInt32sMinus9(genovec, subset_size, data32_ptr)
  *         elif geno_int_out.dtype == np.int64:             # <<<<<<<<<<<<<<
  *             data64_ptr = <int64_t*>geno_int_out.data
  *             GenoarrToInt64sMinus9(genovec, subset_size, data64_ptr)
  */
     goto __pyx_L7;
   }
 
-  /* "pgenlib.pyx":469
+  /* "pgenlib.pyx":580
  *             GenoarrToInt64sMinus9(genovec, subset_size, data64_ptr)
  *         else:
  *             raise RuntimeError("Invalid read() geno_int_out array element type (int8, int32, or int64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   /*else*/ {
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 469, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 469, __pyx_L1_error)
+    __PYX_ERR(0, 580, __pyx_L1_error)
   }
   __pyx_L7:;
 
-  /* "pgenlib.pyx":470
+  /* "pgenlib.pyx":581
  *         else:
  *             raise RuntimeError("Invalid read() geno_int_out array element type (int8, int32, or int64 expected).")
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":438
+  /* "pgenlib.pyx":549
  * 
  * 
  *     cpdef read(self, uint32_t variant_idx, np.ndarray geno_int_out, uint32_t allele_idx = 1):             # <<<<<<<<<<<<<<
  *         # for full genotype info for multiallelic variants, use read_alleles()
  *         # instead
  */
 
@@ -6172,53 +8893,53 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_geno_int_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read", 0, 2, 3, 1); __PYX_ERR(0, 438, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read", 0, 2, 3, 1); __PYX_ERR(0, 549, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_idx);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read") < 0)) __PYX_ERR(0, 438, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read") < 0)) __PYX_ERR(0, 549, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 438, __pyx_L3_error)
+    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 549, __pyx_L3_error)
     __pyx_v_geno_int_out = ((PyArrayObject *)values[1]);
     if (values[2]) {
-      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[2]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 438, __pyx_L3_error)
+      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[2]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 549, __pyx_L3_error)
     } else {
       __pyx_v_allele_idx = ((uint32_t)1);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 438, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 549, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int_out), __pyx_ptype_5numpy_ndarray, 1, "geno_int_out", 0))) __PYX_ERR(0, 438, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int_out), __pyx_ptype_5numpy_ndarray, 1, "geno_int_out", 0))) __PYX_ERR(0, 549, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_10read(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idx, __pyx_v_geno_int_out, __pyx_v_allele_idx);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -6234,15 +8955,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.allele_idx = __pyx_v_allele_idx;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_geno_int_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 438, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_geno_int_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -6251,15 +8972,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":473
+/* "pgenlib.pyx":584
  * 
  * 
  *     cpdef read_dosages(self, uint32_t variant_idx, np.ndarray floatarr_out, uint32_t allele_idx = 1):             # <<<<<<<<<<<<<<
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -6297,21 +9018,21 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_dosages); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_dosages); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 584, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_13read_dosages)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 584, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 473, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 584, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
         __pyx_t_7 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
           if (likely(__pyx_t_6)) {
@@ -6321,47 +9042,47 @@
             __Pyx_DECREF_SET(__pyx_t_5, function);
             __pyx_t_7 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, ((PyObject *)__pyx_v_floatarr_out), __pyx_t_4};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 473, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 584, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, ((PyObject *)__pyx_v_floatarr_out), __pyx_t_4};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 473, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 584, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         {
-          __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 473, __pyx_L1_error)
+          __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 584, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           if (__pyx_t_6) {
             __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
           __Pyx_INCREF(((PyObject *)__pyx_v_floatarr_out));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_floatarr_out));
           PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, ((PyObject *)__pyx_v_floatarr_out));
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_t_4);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 473, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 584, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -6376,344 +9097,344 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":474
+  /* "pgenlib.pyx":585
  * 
  *     cpdef read_dosages(self, uint32_t variant_idx, np.ndarray floatarr_out, uint32_t allele_idx = 1):
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.ndim != 1:
  */
   __pyx_t_9 = ((__pyx_v_variant_idx >= (__pyx_v_self->_info_ptr[0]).raw_variant_ct) != 0);
   if (unlikely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":475
+    /* "pgenlib.pyx":586
  *     cpdef read_dosages(self, uint32_t variant_idx, np.ndarray floatarr_out, uint32_t allele_idx = 1):
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *         if floatarr_out.ndim != 1:
  *             raise RuntimeError("read_dosages() requires floatarr_out to be one-dimensional.")
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 475, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 586, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_variant_idx_too_lar, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_variant_idx_too_lar, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 475, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 586, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 475, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 586, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 475, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 586, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 475, __pyx_L1_error)
+    __PYX_ERR(0, 586, __pyx_L1_error)
 
-    /* "pgenlib.pyx":474
+    /* "pgenlib.pyx":585
  * 
  *     cpdef read_dosages(self, uint32_t variant_idx, np.ndarray floatarr_out, uint32_t allele_idx = 1):
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.ndim != 1:
  */
   }
 
-  /* "pgenlib.pyx":476
+  /* "pgenlib.pyx":587
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.ndim != 1:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages() requires floatarr_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_9 = ((__pyx_v_floatarr_out->nd != 1) != 0);
   if (unlikely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":477
+    /* "pgenlib.pyx":588
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.ndim != 1:
  *             raise RuntimeError("read_dosages() requires floatarr_out to be one-dimensional.")             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         if floatarr_out.shape[0] < subset_size:
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 588, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 477, __pyx_L1_error)
+    __PYX_ERR(0, 588, __pyx_L1_error)
 
-    /* "pgenlib.pyx":476
+    /* "pgenlib.pyx":587
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.ndim != 1:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages() requires floatarr_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size
  */
   }
 
-  /* "pgenlib.pyx":478
+  /* "pgenlib.pyx":589
  *         if floatarr_out.ndim != 1:
  *             raise RuntimeError("read_dosages() requires floatarr_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         if floatarr_out.shape[0] < subset_size:
  *             raise RuntimeError("read_dosages() floatarr_out is too small (" + str(floatarr_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  */
   __pyx_t_10 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_10;
 
-  /* "pgenlib.pyx":479
+  /* "pgenlib.pyx":590
  *             raise RuntimeError("read_dosages() requires floatarr_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size
  *         if floatarr_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages() floatarr_out is too small (" + str(floatarr_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  */
   __pyx_t_9 = (((__pyx_v_floatarr_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":480
+    /* "pgenlib.pyx":591
  *         cdef uint32_t subset_size = self._subset_size
  *         if floatarr_out.shape[0] < subset_size:
  *             raise RuntimeError("read_dosages() floatarr_out is too small (" + str(floatarr_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")             # <<<<<<<<<<<<<<
  * 
  *         cdef uint32_t dosage_ct
  */
-    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_floatarr_out_is_too, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_floatarr_out_is_too, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 480, __pyx_L1_error)
+    __PYX_ERR(0, 591, __pyx_L1_error)
 
-    /* "pgenlib.pyx":479
+    /* "pgenlib.pyx":590
  *             raise RuntimeError("read_dosages() requires floatarr_out to be one-dimensional.")
  *         cdef uint32_t subset_size = self._subset_size
  *         if floatarr_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages() floatarr_out is too small (" + str(floatarr_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  */
   }
 
-  /* "pgenlib.pyx":483
+  /* "pgenlib.pyx":594
  * 
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr = PgrGet1D(self._subset_include_vec, self._subset_index, subset_size, variant_idx, allele_idx, self._state_ptr, self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, &dosage_ct)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read_dosages() error " + str(reterr))
  */
   __pyx_v_reterr = plink2::PgrGet1D(__pyx_v_self->_subset_include_vec, __pyx_v_self->_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_self->_state_ptr, __pyx_v_self->_pgv.genovec, __pyx_v_self->_pgv.dosage_present, __pyx_v_self->_pgv.dosage_main, (&__pyx_v_dosage_ct));
 
-  /* "pgenlib.pyx":484
+  /* "pgenlib.pyx":595
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr = PgrGet1D(self._subset_include_vec, self._subset_index, subset_size, variant_idx, allele_idx, self._state_ptr, self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, &dosage_ct)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages() error " + str(reterr))
  *         cdef float* data32_ptr
  */
   __pyx_t_9 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":485
+    /* "pgenlib.pyx":596
  *         cdef PglErr reterr = PgrGet1D(self._subset_include_vec, self._subset_index, subset_size, variant_idx, allele_idx, self._state_ptr, self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, &dosage_ct)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read_dosages() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         cdef float* data32_ptr
  *         cdef double* data64_ptr
  */
-    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 485, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 596, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 596, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 485, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 596, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 596, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 485, __pyx_L1_error)
+    __PYX_ERR(0, 596, __pyx_L1_error)
 
-    /* "pgenlib.pyx":484
+    /* "pgenlib.pyx":595
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr = PgrGet1D(self._subset_include_vec, self._subset_index, subset_size, variant_idx, allele_idx, self._state_ptr, self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, &dosage_ct)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages() error " + str(reterr))
  *         cdef float* data32_ptr
  */
   }
 
-  /* "pgenlib.pyx":488
+  /* "pgenlib.pyx":599
  *         cdef float* data32_ptr
  *         cdef double* data64_ptr
  *         if floatarr_out.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             data32_ptr = <float*>floatarr_out.data
  *             Dosage16ToFloatsMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data32_ptr)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 488, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 488, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 488, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 599, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_9) {
 
-    /* "pgenlib.pyx":489
+    /* "pgenlib.pyx":600
  *         cdef double* data64_ptr
  *         if floatarr_out.dtype == np.float32:
  *             data32_ptr = <float*>floatarr_out.data             # <<<<<<<<<<<<<<
  *             Dosage16ToFloatsMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data32_ptr)
  *         elif floatarr_out.dtype == np.float64:
  */
     __pyx_v_data32_ptr = ((float *)__pyx_v_floatarr_out->data);
 
-    /* "pgenlib.pyx":490
+    /* "pgenlib.pyx":601
  *         if floatarr_out.dtype == np.float32:
  *             data32_ptr = <float*>floatarr_out.data
  *             Dosage16ToFloatsMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data32_ptr)             # <<<<<<<<<<<<<<
  *         elif floatarr_out.dtype == np.float64:
  *             data64_ptr = <double*>floatarr_out.data
  */
     plink2::Dosage16ToFloatsMinus9(__pyx_v_self->_pgv.genovec, __pyx_v_self->_pgv.dosage_present, __pyx_v_self->_pgv.dosage_main, __pyx_v_subset_size, __pyx_v_dosage_ct, __pyx_v_data32_ptr);
 
-    /* "pgenlib.pyx":488
+    /* "pgenlib.pyx":599
  *         cdef float* data32_ptr
  *         cdef double* data64_ptr
  *         if floatarr_out.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             data32_ptr = <float*>floatarr_out.data
  *             Dosage16ToFloatsMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data32_ptr)
  */
     goto __pyx_L7;
   }
 
-  /* "pgenlib.pyx":491
+  /* "pgenlib.pyx":602
  *             data32_ptr = <float*>floatarr_out.data
  *             Dosage16ToFloatsMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data32_ptr)
  *         elif floatarr_out.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             data64_ptr = <double*>floatarr_out.data
  *             Dosage16ToDoublesMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data64_ptr)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 602, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 491, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 602, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 602, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 491, __pyx_L1_error)
+  __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 602, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 491, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 602, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (likely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":492
+    /* "pgenlib.pyx":603
  *             Dosage16ToFloatsMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data32_ptr)
  *         elif floatarr_out.dtype == np.float64:
  *             data64_ptr = <double*>floatarr_out.data             # <<<<<<<<<<<<<<
  *             Dosage16ToDoublesMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data64_ptr)
  *         else:
  */
     __pyx_v_data64_ptr = ((double *)__pyx_v_floatarr_out->data);
 
-    /* "pgenlib.pyx":493
+    /* "pgenlib.pyx":604
  *         elif floatarr_out.dtype == np.float64:
  *             data64_ptr = <double*>floatarr_out.data
  *             Dosage16ToDoublesMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data64_ptr)             # <<<<<<<<<<<<<<
  *         else:
  *             raise RuntimeError("Invalid read_dosages() floatarr_out array element type (float32 or float64 expected).")
  */
     plink2::Dosage16ToDoublesMinus9(__pyx_v_self->_pgv.genovec, __pyx_v_self->_pgv.dosage_present, __pyx_v_self->_pgv.dosage_main, __pyx_v_subset_size, __pyx_v_dosage_ct, __pyx_v_data64_ptr);
 
-    /* "pgenlib.pyx":491
+    /* "pgenlib.pyx":602
  *             data32_ptr = <float*>floatarr_out.data
  *             Dosage16ToFloatsMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data32_ptr)
  *         elif floatarr_out.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             data64_ptr = <double*>floatarr_out.data
  *             Dosage16ToDoublesMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data64_ptr)
  */
     goto __pyx_L7;
   }
 
-  /* "pgenlib.pyx":495
+  /* "pgenlib.pyx":606
  *             Dosage16ToDoublesMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data64_ptr)
  *         else:
  *             raise RuntimeError("Invalid read_dosages() floatarr_out array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   /*else*/ {
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 606, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_Raise(__pyx_t_5, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 495, __pyx_L1_error)
+    __PYX_ERR(0, 606, __pyx_L1_error)
   }
   __pyx_L7:;
 
-  /* "pgenlib.pyx":496
+  /* "pgenlib.pyx":607
  *         else:
  *             raise RuntimeError("Invalid read_dosages() floatarr_out array element type (float32 or float64 expected).")
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":473
+  /* "pgenlib.pyx":584
  * 
  * 
  *     cpdef read_dosages(self, uint32_t variant_idx, np.ndarray floatarr_out, uint32_t allele_idx = 1):             # <<<<<<<<<<<<<<
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -6767,53 +9488,53 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_floatarr_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_dosages", 0, 2, 3, 1); __PYX_ERR(0, 473, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_dosages", 0, 2, 3, 1); __PYX_ERR(0, 584, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_idx);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_dosages") < 0)) __PYX_ERR(0, 473, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_dosages") < 0)) __PYX_ERR(0, 584, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 473, __pyx_L3_error)
+    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 584, __pyx_L3_error)
     __pyx_v_floatarr_out = ((PyArrayObject *)values[1]);
     if (values[2]) {
-      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[2]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 473, __pyx_L3_error)
+      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[2]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 584, __pyx_L3_error)
     } else {
       __pyx_v_allele_idx = ((uint32_t)1);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_dosages", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 473, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_dosages", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 584, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_dosages", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr_out), __pyx_ptype_5numpy_ndarray, 1, "floatarr_out", 0))) __PYX_ERR(0, 473, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr_out), __pyx_ptype_5numpy_ndarray, 1, "floatarr_out", 0))) __PYX_ERR(0, 584, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_12read_dosages(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idx, __pyx_v_floatarr_out, __pyx_v_allele_idx);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -6829,15 +9550,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_dosages", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.allele_idx = __pyx_v_allele_idx;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_dosages(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_floatarr_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_dosages(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_floatarr_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 584, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -6846,15 +9567,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":499
+/* "pgenlib.pyx":610
  * 
  * 
  *     cpdef read_alleles(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out):             # <<<<<<<<<<<<<<
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -6883,31 +9604,31 @@
   __Pyx_RefNannySetupContext("read_alleles", 0);
   __pyx_pybuffer_allele_int32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32_out.refcount = 0;
   __pyx_pybuffernd_allele_int32_out.data = NULL;
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 499, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 610, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 499, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_15read_alleles)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 499, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_5)) {
@@ -6917,42 +9638,42 @@
             __Pyx_DECREF_SET(__pyx_t_4, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, ((PyObject *)__pyx_v_allele_int32_out)};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 499, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, ((PyObject *)__pyx_v_allele_int32_out)};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 499, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 499, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 610, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_5) {
             __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_t_3);
           __Pyx_INCREF(((PyObject *)__pyx_v_allele_int32_out));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_allele_int32_out));
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, ((PyObject *)__pyx_v_allele_int32_out));
           __pyx_t_3 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 499, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -6967,226 +9688,226 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":500
+  /* "pgenlib.pyx":611
  * 
  *     cpdef read_alleles(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out):
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_8 = ((__pyx_v_variant_idx >= (__pyx_v_self->_info_ptr[0]).raw_variant_ct) != 0);
   if (unlikely(__pyx_t_8)) {
 
-    /* "pgenlib.pyx":501
+    /* "pgenlib.pyx":612
  *     cpdef read_alleles(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out):
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         if allele_int32_out.shape[0] < subset_size:
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 501, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_variant_idx_too_lar, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_variant_idx_too_lar, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 501, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 501, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 501, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 501, __pyx_L1_error)
+    __PYX_ERR(0, 612, __pyx_L1_error)
 
-    /* "pgenlib.pyx":500
+    /* "pgenlib.pyx":611
  * 
  *     cpdef read_alleles(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out):
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size
  */
   }
 
-  /* "pgenlib.pyx":502
+  /* "pgenlib.pyx":613
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         if allele_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("read_alleles() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  */
   __pyx_t_9 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_9;
 
-  /* "pgenlib.pyx":503
+  /* "pgenlib.pyx":614
  *             raise RuntimeError("read_alleles() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size
  *         if allele_int32_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  */
   __pyx_t_8 = (((__pyx_v_allele_int32_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_8)) {
 
-    /* "pgenlib.pyx":504
+    /* "pgenlib.pyx":615
  *         cdef uint32_t subset_size = self._subset_size
  *         if allele_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("read_alleles() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")             # <<<<<<<<<<<<<<
  * 
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)
  */
-    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_allele_int32_out_is, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_allele_int32_out_is, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 504, __pyx_L1_error)
+    __PYX_ERR(0, 615, __pyx_L1_error)
 
-    /* "pgenlib.pyx":503
+    /* "pgenlib.pyx":614
  *             raise RuntimeError("read_alleles() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size
  *         if allele_int32_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  */
   }
 
-  /* "pgenlib.pyx":506
+  /* "pgenlib.pyx":617
  *             raise RuntimeError("read_alleles() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read_alleles() error " + str(reterr))
  */
   __pyx_v_reterr = plink2::PgrGetMP(__pyx_v_self->_subset_include_vec, __pyx_v_self->_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_self->_state_ptr, (&__pyx_v_self->_pgv));
 
-  /* "pgenlib.pyx":507
+  /* "pgenlib.pyx":618
  * 
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles() error " + str(reterr))
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  */
   __pyx_t_8 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_8)) {
 
-    /* "pgenlib.pyx":508
+    /* "pgenlib.pyx":619
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read_alleles() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  *         GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  */
-    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 508, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 508, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 508, __pyx_L1_error)
+    __PYX_ERR(0, 619, __pyx_L1_error)
 
-    /* "pgenlib.pyx":507
+    /* "pgenlib.pyx":618
  * 
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles() error " + str(reterr))
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  */
   }
 
-  /* "pgenlib.pyx":509
+  /* "pgenlib.pyx":620
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read_alleles() error " + str(reterr))
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))             # <<<<<<<<<<<<<<
  *         GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *         return
  */
   __pyx_t_10 = 0;
   __pyx_t_6 = -1;
   if (__pyx_t_10 < 0) {
     __pyx_t_10 += __pyx_pybuffernd_allele_int32_out.diminfo[0].shape;
     if (unlikely(__pyx_t_10 < 0)) __pyx_t_6 = 0;
   } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_6 = 0;
   if (unlikely(__pyx_t_6 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_6);
-    __PYX_ERR(0, 509, __pyx_L1_error)
+    __PYX_ERR(0, 620, __pyx_L1_error)
   }
   __pyx_v_main_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides))));
 
-  /* "pgenlib.pyx":510
+  /* "pgenlib.pyx":621
  *             raise RuntimeError("read_alleles() error " + str(reterr))
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  *         GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   plink2::GenoarrMPToAlleleCodesMinus9((&__pyx_v_self->_pgv), __pyx_v_subset_size, NULL, __pyx_v_main_data_ptr);
 
-  /* "pgenlib.pyx":511
+  /* "pgenlib.pyx":622
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  *         GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":499
+  /* "pgenlib.pyx":610
  * 
  * 
  *     cpdef read_alleles(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out):             # <<<<<<<<<<<<<<
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -7245,38 +9966,38 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_int32_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles", 1, 2, 2, 1); __PYX_ERR(0, 499, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles", 1, 2, 2, 1); __PYX_ERR(0, 610, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles") < 0)) __PYX_ERR(0, 499, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles") < 0)) __PYX_ERR(0, 610, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 499, __pyx_L3_error)
+    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 610, __pyx_L3_error)
     __pyx_v_allele_int32_out = ((PyArrayObject *)values[1]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_alleles", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 499, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_alleles", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 610, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_alleles", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 499, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 610, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_14read_alleles(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idx, __pyx_v_allele_int32_out);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -7296,19 +10017,19 @@
   __Pyx_RefNannySetupContext("read_alleles", 0);
   __pyx_pybuffer_allele_int32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32_out.refcount = 0;
   __pyx_pybuffernd_allele_int32_out.data = NULL;
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 499, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 610, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0];
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_read_alleles(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_allele_int32_out, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_read_alleles(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_allele_int32_out, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -7326,15 +10047,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":514
+/* "pgenlib.pyx":625
  * 
  * 
  *     cpdef read_alleles_and_phasepresent(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out, np.ndarray[np.uint8_t,mode="c",cast=True] phasepresent_out):             # <<<<<<<<<<<<<<
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles_and_phasepresent() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -7370,36 +10091,36 @@
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   __pyx_pybuffer_phasepresent_out.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent_out.refcount = 0;
   __pyx_pybuffernd_phasepresent_out.data = NULL;
   __pyx_pybuffernd_phasepresent_out.rcbuffer = &__pyx_pybuffer_phasepresent_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 514, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 625, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 514, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 625, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent_out.diminfo[0].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent_out.diminfo[0].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[0];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_and_phasepresent); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_and_phasepresent); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_17read_alleles_and_phasepresent)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 625, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_5)) {
@@ -7409,45 +10130,45 @@
             __Pyx_DECREF_SET(__pyx_t_4, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_t_3, ((PyObject *)__pyx_v_allele_int32_out), ((PyObject *)__pyx_v_phasepresent_out)};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 514, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_t_3, ((PyObject *)__pyx_v_allele_int32_out), ((PyObject *)__pyx_v_phasepresent_out)};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 514, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 514, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 625, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_5) {
             __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_t_3);
           __Pyx_INCREF(((PyObject *)__pyx_v_allele_int32_out));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_allele_int32_out));
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, ((PyObject *)__pyx_v_allele_int32_out));
           __Pyx_INCREF(((PyObject *)__pyx_v_phasepresent_out));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_phasepresent_out));
           PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, ((PyObject *)__pyx_v_phasepresent_out));
           __pyx_t_3 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 514, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -7462,301 +10183,301 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":515
+  /* "pgenlib.pyx":626
  * 
  *     cpdef read_alleles_and_phasepresent(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out, np.ndarray[np.uint8_t,mode="c",cast=True] phasepresent_out):
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_and_phasepresent() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_8 = ((__pyx_v_variant_idx >= (__pyx_v_self->_info_ptr[0]).raw_variant_ct) != 0);
   if (unlikely(__pyx_t_8)) {
 
-    /* "pgenlib.pyx":516
+    /* "pgenlib.pyx":627
  *     cpdef read_alleles_and_phasepresent(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out, np.ndarray[np.uint8_t,mode="c",cast=True] phasepresent_out):
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles_and_phasepresent() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_va, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_va, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 516, __pyx_L1_error)
+    __PYX_ERR(0, 627, __pyx_L1_error)
 
-    /* "pgenlib.pyx":515
+    /* "pgenlib.pyx":626
  * 
  *     cpdef read_alleles_and_phasepresent(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out, np.ndarray[np.uint8_t,mode="c",cast=True] phasepresent_out):
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_and_phasepresent() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size
  */
   }
 
-  /* "pgenlib.pyx":517
+  /* "pgenlib.pyx":628
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles_and_phasepresent() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("read_alleles_and_phasepresent() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", , and column count should be twice that).")
  */
   __pyx_t_9 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_9;
 
-  /* "pgenlib.pyx":518
+  /* "pgenlib.pyx":629
  *             raise RuntimeError("read_alleles_and_phasepresent() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size
  *         if allele_int32_out.shape[0] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_and_phasepresent() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", , and column count should be twice that).")
  *         if phasepresent_out.shape[0] < subset_size:
  */
   __pyx_t_8 = (((__pyx_v_allele_int32_out->dimensions[0]) < (2 * __pyx_v_subset_size)) != 0);
   if (unlikely(__pyx_t_8)) {
 
-    /* "pgenlib.pyx":519
+    /* "pgenlib.pyx":630
  *         cdef uint32_t subset_size = self._subset_size
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("read_alleles_and_phasepresent() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", , and column count should be twice that).")             # <<<<<<<<<<<<<<
  *         if phasepresent_out.shape[0] < subset_size:
  *             raise RuntimeError("read_alleles_and_phasepresent() phasepresent_out is too small (" + str(phasepresent_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  */
-    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 630, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 630, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_al, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_al, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 630, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 630, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 630, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 630, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 630, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 630, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 630, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 519, __pyx_L1_error)
+    __PYX_ERR(0, 630, __pyx_L1_error)
 
-    /* "pgenlib.pyx":518
+    /* "pgenlib.pyx":629
  *             raise RuntimeError("read_alleles_and_phasepresent() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef uint32_t subset_size = self._subset_size
  *         if allele_int32_out.shape[0] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_and_phasepresent() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", , and column count should be twice that).")
  *         if phasepresent_out.shape[0] < subset_size:
  */
   }
 
-  /* "pgenlib.pyx":520
+  /* "pgenlib.pyx":631
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("read_alleles_and_phasepresent() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", , and column count should be twice that).")
  *         if phasepresent_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_and_phasepresent() phasepresent_out is too small (" + str(phasepresent_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  */
   __pyx_t_8 = (((__pyx_v_phasepresent_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_8)) {
 
-    /* "pgenlib.pyx":521
+    /* "pgenlib.pyx":632
  *             raise RuntimeError("read_alleles_and_phasepresent() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", , and column count should be twice that).")
  *         if phasepresent_out.shape[0] < subset_size:
  *             raise RuntimeError("read_alleles_and_phasepresent() phasepresent_out is too small (" + str(phasepresent_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")             # <<<<<<<<<<<<<<
  * 
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)
  */
-    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_phasepresent_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_phasepresent_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_ph, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_ph, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 521, __pyx_L1_error)
+    __PYX_ERR(0, 632, __pyx_L1_error)
 
-    /* "pgenlib.pyx":520
+    /* "pgenlib.pyx":631
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("read_alleles_and_phasepresent() allele_int32_out is too small (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", , and column count should be twice that).")
  *         if phasepresent_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_and_phasepresent() phasepresent_out is too small (" + str(phasepresent_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  */
   }
 
-  /* "pgenlib.pyx":523
+  /* "pgenlib.pyx":634
  *             raise RuntimeError("read_alleles_and_phasepresent() phasepresent_out is too small (" + str(phasepresent_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ").")
  * 
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read_alleles_and_phasepresent() error " + str(reterr))
  */
   __pyx_v_reterr = plink2::PgrGetMP(__pyx_v_self->_subset_include_vec, __pyx_v_self->_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_self->_state_ptr, (&__pyx_v_self->_pgv));
 
-  /* "pgenlib.pyx":524
+  /* "pgenlib.pyx":635
  * 
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_and_phasepresent() error " + str(reterr))
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  */
   __pyx_t_8 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_8)) {
 
-    /* "pgenlib.pyx":525
+    /* "pgenlib.pyx":636
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read_alleles_and_phasepresent() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  *         cdef unsigned char* phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[0]))
  */
-    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 525, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 525, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_er, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 525, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_er, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 525, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 525, __pyx_L1_error)
+    __PYX_ERR(0, 636, __pyx_L1_error)
 
-    /* "pgenlib.pyx":524
+    /* "pgenlib.pyx":635
  * 
  *         cdef PglErr reterr = PgrGetMP(self._subset_include_vec, self._subset_index, subset_size, variant_idx, self._state_ptr, &self._pgv)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_and_phasepresent() error " + str(reterr))
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  */
   }
 
-  /* "pgenlib.pyx":526
+  /* "pgenlib.pyx":637
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("read_alleles_and_phasepresent() error " + str(reterr))
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))             # <<<<<<<<<<<<<<
  *         cdef unsigned char* phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[0]))
  *         GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  */
   __pyx_t_10 = 0;
   __pyx_t_6 = -1;
   if (__pyx_t_10 < 0) {
     __pyx_t_10 += __pyx_pybuffernd_allele_int32_out.diminfo[0].shape;
     if (unlikely(__pyx_t_10 < 0)) __pyx_t_6 = 0;
   } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_6 = 0;
   if (unlikely(__pyx_t_6 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_6);
-    __PYX_ERR(0, 526, __pyx_L1_error)
+    __PYX_ERR(0, 637, __pyx_L1_error)
   }
   __pyx_v_main_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides))));
 
-  /* "pgenlib.pyx":527
+  /* "pgenlib.pyx":638
  *             raise RuntimeError("read_alleles_and_phasepresent() error " + str(reterr))
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  *         cdef unsigned char* phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[0]))             # <<<<<<<<<<<<<<
  *         GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *         return
  */
   __pyx_t_10 = 0;
   __pyx_t_6 = -1;
   if (__pyx_t_10 < 0) {
     __pyx_t_10 += __pyx_pybuffernd_phasepresent_out.diminfo[0].shape;
     if (unlikely(__pyx_t_10 < 0)) __pyx_t_6 = 0;
   } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_phasepresent_out.diminfo[0].shape)) __pyx_t_6 = 0;
   if (unlikely(__pyx_t_6 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_6);
-    __PYX_ERR(0, 527, __pyx_L1_error)
+    __PYX_ERR(0, 638, __pyx_L1_error)
   }
   __pyx_v_phasepresent_data_ptr = ((unsigned char *)(&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_uint8_t *, __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_phasepresent_out.diminfo[0].strides))));
 
-  /* "pgenlib.pyx":528
+  /* "pgenlib.pyx":639
  *         cdef int32_t* main_data_ptr = <int32_t*>(&(allele_int32_out[0]))
  *         cdef unsigned char* phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[0]))
  *         GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   plink2::GenoarrMPToAlleleCodesMinus9((&__pyx_v_self->_pgv), __pyx_v_subset_size, __pyx_v_phasepresent_data_ptr, __pyx_v_main_data_ptr);
 
-  /* "pgenlib.pyx":529
+  /* "pgenlib.pyx":640
  *         cdef unsigned char* phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[0]))
  *         GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":514
+  /* "pgenlib.pyx":625
  * 
  * 
  *     cpdef read_alleles_and_phasepresent(self, uint32_t variant_idx, np.ndarray[np.int32_t,mode="c",ndim=1] allele_int32_out, np.ndarray[np.uint8_t,mode="c",cast=True] phasepresent_out):             # <<<<<<<<<<<<<<
  *         if variant_idx >= self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles_and_phasepresent() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -7820,47 +10541,47 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_int32_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent", 1, 3, 3, 1); __PYX_ERR(0, 514, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent", 1, 3, 3, 1); __PYX_ERR(0, 625, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_phasepresent_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent", 1, 3, 3, 2); __PYX_ERR(0, 514, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent", 1, 3, 3, 2); __PYX_ERR(0, 625, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_and_phasepresent") < 0)) __PYX_ERR(0, 514, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_and_phasepresent") < 0)) __PYX_ERR(0, 625, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
-    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 514, __pyx_L3_error)
+    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 625, __pyx_L3_error)
     __pyx_v_allele_int32_out = ((PyArrayObject *)values[1]);
     __pyx_v_phasepresent_out = ((PyArrayObject *)values[2]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 514, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 625, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_alleles_and_phasepresent", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 514, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent_out), __pyx_ptype_5numpy_ndarray, 1, "phasepresent_out", 0))) __PYX_ERR(0, 514, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 625, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent_out), __pyx_ptype_5numpy_ndarray, 1, "phasepresent_out", 0))) __PYX_ERR(0, 625, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_16read_alleles_and_phasepresent(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idx, __pyx_v_allele_int32_out, __pyx_v_phasepresent_out);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -7886,24 +10607,24 @@
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   __pyx_pybuffer_phasepresent_out.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent_out.refcount = 0;
   __pyx_pybuffernd_phasepresent_out.data = NULL;
   __pyx_pybuffernd_phasepresent_out.rcbuffer = &__pyx_pybuffer_phasepresent_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 514, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 625, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 514, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 625, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent_out.diminfo[0].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent_out.diminfo[0].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[0];
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_read_alleles_and_phasepresent(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_allele_int32_out, __pyx_v_phasepresent_out, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_read_alleles_and_phasepresent(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_allele_int32_out, __pyx_v_phasepresent_out, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -7923,15 +10644,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":532
+/* "pgenlib.pyx":643
  * 
  * 
  *     cdef read_range_internal8(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         # todo: benchmark effect of adding @cython.boundscheck(False) and
  *         # @cython.wraparound(False) annotations to these multiple-variant-load
  */
 
@@ -8001,262 +10722,262 @@
   }
   __pyx_pybuffer_geno_int8_out.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int8_out.refcount = 0;
   __pyx_pybuffernd_geno_int8_out.data = NULL;
   __pyx_pybuffernd_geno_int8_out.rcbuffer = &__pyx_pybuffer_geno_int8_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 532, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 643, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int8_out.diminfo[0].strides = __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int8_out.diminfo[0].shape = __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_geno_int8_out.diminfo[1].strides = __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_geno_int8_out.diminfo[1].shape = __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":539
+  /* "pgenlib.pyx":650
  *         # large jobs (this probably belongs under pgenlib_ffi_support, rather
  *         # than here)
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_1 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_1;
 
-  /* "pgenlib.pyx":540
+  /* "pgenlib.pyx":651
  *         # than here)
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_2 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_2;
 
-  /* "pgenlib.pyx":541
+  /* "pgenlib.pyx":652
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  */
   __pyx_t_3 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_3;
 
-  /* "pgenlib.pyx":542
+  /* "pgenlib.pyx":653
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_1 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_1;
 
-  /* "pgenlib.pyx":543
+  /* "pgenlib.pyx":654
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int8_t* data_ptr
  */
   __pyx_v_variant_idx_ct = (__pyx_v_variant_idx_end - __pyx_v_variant_idx_start);
 
-  /* "pgenlib.pyx":544
+  /* "pgenlib.pyx":655
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int8_t* data_ptr
  *         cdef uint32_t variant_idx
  */
   __pyx_t_4 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_4;
 
-  /* "pgenlib.pyx":548
+  /* "pgenlib.pyx":659
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_5 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":549
+    /* "pgenlib.pyx":660
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int8_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:
  */
     __pyx_t_5 = (((__pyx_v_geno_int8_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":550
+      /* "pgenlib.pyx":661
  *         if sample_maj == 0:
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if geno_int8_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 550, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 661, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 550, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 661, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 550, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 661, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 550, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 661, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 550, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 661, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 550, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 661, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 550, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 661, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 550, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 661, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 550, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 661, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 550, __pyx_L1_error)
+      __PYX_ERR(0, 661, __pyx_L1_error)
 
-      /* "pgenlib.pyx":549
+      /* "pgenlib.pyx":660
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int8_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":551
+    /* "pgenlib.pyx":662
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     __pyx_t_5 = (((__pyx_v_geno_int8_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":552
+      /* "pgenlib.pyx":663
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 663, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 663, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 663, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 663, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 663, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 663, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 663, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 663, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 663, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 552, __pyx_L1_error)
+      __PYX_ERR(0, 663, __pyx_L1_error)
 
-      /* "pgenlib.pyx":551
+      /* "pgenlib.pyx":662
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     }
 
-    /* "pgenlib.pyx":553
+    /* "pgenlib.pyx":664
  *             if geno_int8_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_4 = __pyx_v_variant_idx_end;
     __pyx_t_9 = __pyx_t_4;
     for (__pyx_t_10 = __pyx_v_variant_idx_start; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
       __pyx_v_variant_idx = __pyx_t_10;
 
-      /* "pgenlib.pyx":554
+      /* "pgenlib.pyx":665
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec);
 
-      /* "pgenlib.pyx":555
+      /* "pgenlib.pyx":666
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int8_out[(variant_idx - variant_idx_start), 0])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":556
+        /* "pgenlib.pyx":667
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data_ptr = &(geno_int8_out[(variant_idx - variant_idx_start), 0])
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  */
-        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 556, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 667, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 556, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 667, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 556, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 667, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 556, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 667, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_Raise(__pyx_t_7, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __PYX_ERR(0, 556, __pyx_L1_error)
+        __PYX_ERR(0, 667, __pyx_L1_error)
 
-        /* "pgenlib.pyx":555
+        /* "pgenlib.pyx":666
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int8_out[(variant_idx - variant_idx_start), 0])
  */
       }
 
-      /* "pgenlib.pyx":557
+      /* "pgenlib.pyx":668
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int8_out[(variant_idx - variant_idx_start), 0])             # <<<<<<<<<<<<<<
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  *             return
  */
       __pyx_t_11 = (__pyx_v_variant_idx - __pyx_v_variant_idx_start);
@@ -8265,579 +10986,579 @@
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int8_out.diminfo[0].shape)) __pyx_t_13 = 0;
       if (__pyx_t_12 < 0) {
         __pyx_t_12 += __pyx_pybuffernd_geno_int8_out.diminfo[1].shape;
         if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 1;
       } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_geno_int8_out.diminfo[1].shape)) __pyx_t_13 = 1;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        __PYX_ERR(0, 557, __pyx_L1_error)
+        __PYX_ERR(0, 668, __pyx_L1_error)
       }
       __pyx_v_data_ptr = (&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int8_out.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_geno_int8_out.diminfo[1].strides)));
 
-      /* "pgenlib.pyx":558
+      /* "pgenlib.pyx":669
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int8_out[(variant_idx - variant_idx_start), 0])
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         if variant_idx_start >= variant_idx_end:
  */
       plink2::GenoarrToBytesMinus9(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data_ptr);
     }
 
-    /* "pgenlib.pyx":559
+    /* "pgenlib.pyx":670
  *                 data_ptr = &(geno_int8_out[(variant_idx - variant_idx_start), 0])
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":548
+    /* "pgenlib.pyx":659
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":560
+  /* "pgenlib.pyx":671
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if variant_idx_start >= variant_idx_end:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int8_out.shape[0] < subset_size:
  */
   __pyx_t_5 = ((__pyx_v_variant_idx_start >= __pyx_v_variant_idx_end) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":561
+    /* "pgenlib.pyx":672
  *             return
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")             # <<<<<<<<<<<<<<
  *         if geno_int8_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_variant_idx_start_var, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_variant_idx_start_var, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 561, __pyx_L1_error)
+    __PYX_ERR(0, 672, __pyx_L1_error)
 
-    /* "pgenlib.pyx":560
+    /* "pgenlib.pyx":671
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if variant_idx_start >= variant_idx_end:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int8_out.shape[0] < subset_size:
  */
   }
 
-  /* "pgenlib.pyx":562
+  /* "pgenlib.pyx":673
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int8_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  */
   __pyx_t_5 = (((__pyx_v_geno_int8_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":563
+    /* "pgenlib.pyx":674
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int8_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
-    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 563, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 563, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 563, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 563, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 563, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 563, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 563, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 563, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 563, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 563, __pyx_L1_error)
+    __PYX_ERR(0, 674, __pyx_L1_error)
 
-    /* "pgenlib.pyx":562
+    /* "pgenlib.pyx":673
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int8_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  */
   }
 
-  /* "pgenlib.pyx":564
+  /* "pgenlib.pyx":675
  *         if geno_int8_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   __pyx_t_5 = (((__pyx_v_geno_int8_out->dimensions[1]) < __pyx_v_variant_idx_ct) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":565
+    /* "pgenlib.pyx":676
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  */
-    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 565, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 565, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int_2, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 565, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int_2, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 565, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 565, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 565, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 565, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 565, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 565, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 565, __pyx_L1_error)
+    __PYX_ERR(0, 676, __pyx_L1_error)
 
-    /* "pgenlib.pyx":564
+    /* "pgenlib.pyx":675
  *         if geno_int8_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   }
 
-  /* "pgenlib.pyx":566
+  /* "pgenlib.pyx":677
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  */
   __pyx_v_variant_batch_ct = plink2::DivUp(__pyx_v_variant_idx_ct, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":567
+  /* "pgenlib.pyx":678
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  */
   __pyx_v_variant_batch_size = plink2::kPglNypTransposeBatch;
 
-  /* "pgenlib.pyx":568
+  /* "pgenlib.pyx":679
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_idx_offset = variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  */
   __pyx_v_variant_idx_offset = __pyx_v_variant_idx_start;
 
-  /* "pgenlib.pyx":569
+  /* "pgenlib.pyx":680
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  */
   __pyx_v_sample_ctaw2 = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWordD2));
 
-  /* "pgenlib.pyx":570
+  /* "pgenlib.pyx":681
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  */
   __pyx_v_sample_batch_ct = plink2::DivUp(__pyx_v_subset_size, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":571
+  /* "pgenlib.pyx":682
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  */
   __pyx_t_14 = __pyx_v_self->_transpose_batch_buf;
   __pyx_v_transpose_batch_buf = __pyx_t_14;
 
-  /* "pgenlib.pyx":572
+  /* "pgenlib.pyx":683
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* vmaj_iter
  */
   __pyx_t_1 = __pyx_v_self->_multivar_vmaj_geno_buf;
   __pyx_v_multivar_vmaj_geno_buf = __pyx_t_1;
 
-  /* "pgenlib.pyx":573
+  /* "pgenlib.pyx":684
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* vmaj_iter
  *         cdef uintptr_t* smaj_iter
  */
   __pyx_t_1 = __pyx_v_self->_multivar_smaj_geno_batch_buf;
   __pyx_v_multivar_smaj_geno_batch_buf = __pyx_t_1;
 
-  /* "pgenlib.pyx":580
+  /* "pgenlib.pyx":691
  *         cdef uint32_t sample_batch_idx
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):             # <<<<<<<<<<<<<<
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  */
   __pyx_t_4 = __pyx_v_variant_batch_ct;
   __pyx_t_9 = __pyx_t_4;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_variant_batch_idx = __pyx_t_10;
 
-    /* "pgenlib.pyx":581
+    /* "pgenlib.pyx":692
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     __pyx_t_5 = ((__pyx_v_variant_batch_idx == (__pyx_v_variant_batch_ct - 1)) != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":582
+      /* "pgenlib.pyx":693
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  */
       __pyx_t_15 = (__pyx_v_variant_idx_ct - 1);
       if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(0, 582, __pyx_L1_error)
+        __PYX_ERR(0, 693, __pyx_L1_error)
       }
       __pyx_v_variant_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-      /* "pgenlib.pyx":581
+      /* "pgenlib.pyx":692
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     }
 
-    /* "pgenlib.pyx":583
+    /* "pgenlib.pyx":694
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":584
+    /* "pgenlib.pyx":695
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_16 = __pyx_v_variant_batch_size;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_uii = __pyx_t_18;
 
-      /* "pgenlib.pyx":585
+      /* "pgenlib.pyx":696
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, (__pyx_v_uii + __pyx_v_variant_idx_offset), __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_vmaj_iter);
 
-      /* "pgenlib.pyx":586
+      /* "pgenlib.pyx":697
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":587
+        /* "pgenlib.pyx":698
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  */
-        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 587, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 587, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 587, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 587, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 587, __pyx_L1_error)
+        __PYX_ERR(0, 698, __pyx_L1_error)
 
-        /* "pgenlib.pyx":586
+        /* "pgenlib.pyx":697
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       }
 
-      /* "pgenlib.pyx":588
+      /* "pgenlib.pyx":699
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])             # <<<<<<<<<<<<<<
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[__pyx_v_sample_ctaw2]));
     }
 
-    /* "pgenlib.pyx":589
+    /* "pgenlib.pyx":700
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  */
     __pyx_v_sample_batch_size = plink2::kPglNypTransposeBatch;
 
-    /* "pgenlib.pyx":590
+    /* "pgenlib.pyx":701
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":591
+    /* "pgenlib.pyx":702
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):             # <<<<<<<<<<<<<<
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  */
     __pyx_t_16 = __pyx_v_sample_batch_ct;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_sample_batch_idx = __pyx_t_18;
 
-      /* "pgenlib.pyx":592
+      /* "pgenlib.pyx":703
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       __pyx_t_5 = ((__pyx_v_sample_batch_idx == (__pyx_v_sample_batch_ct - 1)) != 0);
       if (__pyx_t_5) {
 
-        /* "pgenlib.pyx":593
+        /* "pgenlib.pyx":704
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  */
         __pyx_t_15 = (__pyx_v_subset_size - 1);
         if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-          __PYX_ERR(0, 593, __pyx_L1_error)
+          __PYX_ERR(0, 704, __pyx_L1_error)
         }
         __pyx_v_sample_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-        /* "pgenlib.pyx":592
+        /* "pgenlib.pyx":703
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       }
 
-      /* "pgenlib.pyx":594
+      /* "pgenlib.pyx":705
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  */
       __pyx_v_smaj_iter = __pyx_v_multivar_smaj_geno_batch_buf;
 
-      /* "pgenlib.pyx":595
+      /* "pgenlib.pyx":706
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  */
       plink2::TransposeNypblock(__pyx_v_vmaj_iter, __pyx_v_sample_ctaw2, plink2::kPglNypTransposeWords, __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":596
+      /* "pgenlib.pyx":707
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):             # <<<<<<<<<<<<<<
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)
  */
       __pyx_t_19 = __pyx_v_sample_batch_size;
       __pyx_t_20 = __pyx_t_19;
       for (__pyx_t_21 = 0; __pyx_t_21 < __pyx_t_20; __pyx_t_21+=1) {
         __pyx_v_uii = __pyx_t_21;
 
-        /* "pgenlib.pyx":597
+        /* "pgenlib.pyx":708
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])             # <<<<<<<<<<<<<<
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  */
         __pyx_t_11 = (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch));
         __pyx_t_22 = (__pyx_v_variant_batch_idx * plink2::kPglNypTransposeBatch);
         __pyx_t_13 = -1;
         if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int8_out.diminfo[0].shape)) __pyx_t_13 = 0;
         if (unlikely(__pyx_t_22 >= (size_t)__pyx_pybuffernd_geno_int8_out.diminfo[1].shape)) __pyx_t_13 = 1;
         if (unlikely(__pyx_t_13 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_13);
-          __PYX_ERR(0, 597, __pyx_L1_error)
+          __PYX_ERR(0, 708, __pyx_L1_error)
         }
         __pyx_v_data_ptr = (&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int8_out.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_geno_int8_out.diminfo[1].strides)));
 
-        /* "pgenlib.pyx":598
+        /* "pgenlib.pyx":709
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)             # <<<<<<<<<<<<<<
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  */
         plink2::GenoarrToBytesMinus9(__pyx_v_smaj_iter, __pyx_v_variant_batch_size, __pyx_v_data_ptr);
 
-        /* "pgenlib.pyx":599
+        /* "pgenlib.pyx":710
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_idx_offset += kPglNypTransposeBatch
  */
         __pyx_v_smaj_iter = (&(__pyx_v_smaj_iter[plink2::kPglNypTransposeWords]));
       }
 
-      /* "pgenlib.pyx":600
+      /* "pgenlib.pyx":711
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *             variant_idx_offset += kPglNypTransposeBatch
  *         return
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[plink2::kPglNypTransposeWords]));
     }
 
-    /* "pgenlib.pyx":601
+    /* "pgenlib.pyx":712
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_idx_offset += kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     __pyx_v_variant_idx_offset = (__pyx_v_variant_idx_offset + plink2::kPglNypTransposeBatch);
   }
 
-  /* "pgenlib.pyx":602
+  /* "pgenlib.pyx":713
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_idx_offset += kPglNypTransposeBatch
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cdef read_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":532
+  /* "pgenlib.pyx":643
  * 
  * 
  *     cdef read_range_internal8(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         # todo: benchmark effect of adding @cython.boundscheck(False) and
  *         # @cython.wraparound(False) annotations to these multiple-variant-load
  */
 
@@ -8859,15 +11580,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":604
+/* "pgenlib.pyx":715
  *         return
  * 
  *     cdef read_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -8937,262 +11658,262 @@
   }
   __pyx_pybuffer_geno_int32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int32_out.refcount = 0;
   __pyx_pybuffernd_geno_int32_out.data = NULL;
   __pyx_pybuffernd_geno_int32_out.rcbuffer = &__pyx_pybuffer_geno_int32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 604, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 715, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int32_out.diminfo[0].strides = __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int32_out.diminfo[0].shape = __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_geno_int32_out.diminfo[1].strides = __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_geno_int32_out.diminfo[1].shape = __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":605
+  /* "pgenlib.pyx":716
  * 
  *     cdef read_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_1 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_1;
 
-  /* "pgenlib.pyx":606
+  /* "pgenlib.pyx":717
  *     cdef read_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_2 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_2;
 
-  /* "pgenlib.pyx":607
+  /* "pgenlib.pyx":718
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  */
   __pyx_t_3 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_3;
 
-  /* "pgenlib.pyx":608
+  /* "pgenlib.pyx":719
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_1 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_1;
 
-  /* "pgenlib.pyx":609
+  /* "pgenlib.pyx":720
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int32_t* data_ptr
  */
   __pyx_v_variant_idx_ct = (__pyx_v_variant_idx_end - __pyx_v_variant_idx_start);
 
-  /* "pgenlib.pyx":610
+  /* "pgenlib.pyx":721
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int32_t* data_ptr
  *         cdef uint32_t variant_idx
  */
   __pyx_t_4 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_4;
 
-  /* "pgenlib.pyx":614
+  /* "pgenlib.pyx":725
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_5 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":615
+    /* "pgenlib.pyx":726
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:
  */
     __pyx_t_5 = (((__pyx_v_geno_int32_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":616
+      /* "pgenlib.pyx":727
  *         if sample_maj == 0:
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if geno_int32_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 727, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 727, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 727, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 727, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 727, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 727, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 727, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 727, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 727, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 616, __pyx_L1_error)
+      __PYX_ERR(0, 727, __pyx_L1_error)
 
-      /* "pgenlib.pyx":615
+      /* "pgenlib.pyx":726
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":617
+    /* "pgenlib.pyx":728
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     __pyx_t_5 = (((__pyx_v_geno_int32_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":618
+      /* "pgenlib.pyx":729
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 618, __pyx_L1_error)
+      __PYX_ERR(0, 729, __pyx_L1_error)
 
-      /* "pgenlib.pyx":617
+      /* "pgenlib.pyx":728
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     }
 
-    /* "pgenlib.pyx":619
+    /* "pgenlib.pyx":730
  *             if geno_int32_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_4 = __pyx_v_variant_idx_end;
     __pyx_t_9 = __pyx_t_4;
     for (__pyx_t_10 = __pyx_v_variant_idx_start; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
       __pyx_v_variant_idx = __pyx_t_10;
 
-      /* "pgenlib.pyx":620
+      /* "pgenlib.pyx":731
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec);
 
-      /* "pgenlib.pyx":621
+      /* "pgenlib.pyx":732
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = <int32_t*>(&(geno_int32_out[(variant_idx - variant_idx_start), 0]))
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":622
+        /* "pgenlib.pyx":733
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data_ptr = <int32_t*>(&(geno_int32_out[(variant_idx - variant_idx_start), 0]))
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  */
-        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 733, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 622, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 733, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 733, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 622, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 733, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_Raise(__pyx_t_7, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __PYX_ERR(0, 622, __pyx_L1_error)
+        __PYX_ERR(0, 733, __pyx_L1_error)
 
-        /* "pgenlib.pyx":621
+        /* "pgenlib.pyx":732
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = <int32_t*>(&(geno_int32_out[(variant_idx - variant_idx_start), 0]))
  */
       }
 
-      /* "pgenlib.pyx":623
+      /* "pgenlib.pyx":734
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = <int32_t*>(&(geno_int32_out[(variant_idx - variant_idx_start), 0]))             # <<<<<<<<<<<<<<
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  *             return
  */
       __pyx_t_11 = (__pyx_v_variant_idx - __pyx_v_variant_idx_start);
@@ -9201,579 +11922,579 @@
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int32_out.diminfo[0].shape)) __pyx_t_13 = 0;
       if (__pyx_t_12 < 0) {
         __pyx_t_12 += __pyx_pybuffernd_geno_int32_out.diminfo[1].shape;
         if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 1;
       } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_geno_int32_out.diminfo[1].shape)) __pyx_t_13 = 1;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        __PYX_ERR(0, 623, __pyx_L1_error)
+        __PYX_ERR(0, 734, __pyx_L1_error)
       }
       __pyx_v_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int32_out.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_geno_int32_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":624
+      /* "pgenlib.pyx":735
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = <int32_t*>(&(geno_int32_out[(variant_idx - variant_idx_start), 0]))
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         if variant_idx_start >= variant_idx_end:
  */
       plink2::GenoarrToInt32sMinus9(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data_ptr);
     }
 
-    /* "pgenlib.pyx":625
+    /* "pgenlib.pyx":736
  *                 data_ptr = <int32_t*>(&(geno_int32_out[(variant_idx - variant_idx_start), 0]))
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":614
+    /* "pgenlib.pyx":725
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":626
+  /* "pgenlib.pyx":737
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if variant_idx_start >= variant_idx_end:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int32_out.shape[0] < subset_size:
  */
   __pyx_t_5 = ((__pyx_v_variant_idx_start >= __pyx_v_variant_idx_end) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":627
+    /* "pgenlib.pyx":738
  *             return
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")             # <<<<<<<<<<<<<<
  *         if geno_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 627, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 627, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_variant_idx_start_var, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 627, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_variant_idx_start_var, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 627, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 627, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 627, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 627, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 627, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 627, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 627, __pyx_L1_error)
+    __PYX_ERR(0, 738, __pyx_L1_error)
 
-    /* "pgenlib.pyx":626
+    /* "pgenlib.pyx":737
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if variant_idx_start >= variant_idx_end:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int32_out.shape[0] < subset_size:
  */
   }
 
-  /* "pgenlib.pyx":628
+  /* "pgenlib.pyx":739
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int32_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  */
   __pyx_t_5 = (((__pyx_v_geno_int32_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":629
+    /* "pgenlib.pyx":740
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
-    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 629, __pyx_L1_error)
+    __PYX_ERR(0, 740, __pyx_L1_error)
 
-    /* "pgenlib.pyx":628
+    /* "pgenlib.pyx":739
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int32_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  */
   }
 
-  /* "pgenlib.pyx":630
+  /* "pgenlib.pyx":741
  *         if geno_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   __pyx_t_5 = (((__pyx_v_geno_int32_out->dimensions[1]) < __pyx_v_variant_idx_ct) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":631
+    /* "pgenlib.pyx":742
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  */
-    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int_2, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int_2, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 631, __pyx_L1_error)
+    __PYX_ERR(0, 742, __pyx_L1_error)
 
-    /* "pgenlib.pyx":630
+    /* "pgenlib.pyx":741
  *         if geno_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   }
 
-  /* "pgenlib.pyx":632
+  /* "pgenlib.pyx":743
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  */
   __pyx_v_variant_batch_ct = plink2::DivUp(__pyx_v_variant_idx_ct, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":633
+  /* "pgenlib.pyx":744
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  */
   __pyx_v_variant_batch_size = plink2::kPglNypTransposeBatch;
 
-  /* "pgenlib.pyx":634
+  /* "pgenlib.pyx":745
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_idx_offset = variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  */
   __pyx_v_variant_idx_offset = __pyx_v_variant_idx_start;
 
-  /* "pgenlib.pyx":635
+  /* "pgenlib.pyx":746
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  */
   __pyx_v_sample_ctaw2 = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWordD2));
 
-  /* "pgenlib.pyx":636
+  /* "pgenlib.pyx":747
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  */
   __pyx_v_sample_batch_ct = plink2::DivUp(__pyx_v_subset_size, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":637
+  /* "pgenlib.pyx":748
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  */
   __pyx_t_14 = __pyx_v_self->_transpose_batch_buf;
   __pyx_v_transpose_batch_buf = __pyx_t_14;
 
-  /* "pgenlib.pyx":638
+  /* "pgenlib.pyx":749
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* vmaj_iter
  */
   __pyx_t_1 = __pyx_v_self->_multivar_vmaj_geno_buf;
   __pyx_v_multivar_vmaj_geno_buf = __pyx_t_1;
 
-  /* "pgenlib.pyx":639
+  /* "pgenlib.pyx":750
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* vmaj_iter
  *         cdef uintptr_t* smaj_iter
  */
   __pyx_t_1 = __pyx_v_self->_multivar_smaj_geno_batch_buf;
   __pyx_v_multivar_smaj_geno_batch_buf = __pyx_t_1;
 
-  /* "pgenlib.pyx":646
+  /* "pgenlib.pyx":757
  *         cdef uint32_t sample_batch_idx
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):             # <<<<<<<<<<<<<<
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  */
   __pyx_t_4 = __pyx_v_variant_batch_ct;
   __pyx_t_9 = __pyx_t_4;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_variant_batch_idx = __pyx_t_10;
 
-    /* "pgenlib.pyx":647
+    /* "pgenlib.pyx":758
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     __pyx_t_5 = ((__pyx_v_variant_batch_idx == (__pyx_v_variant_batch_ct - 1)) != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":648
+      /* "pgenlib.pyx":759
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  */
       __pyx_t_15 = (__pyx_v_variant_idx_ct - 1);
       if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(0, 648, __pyx_L1_error)
+        __PYX_ERR(0, 759, __pyx_L1_error)
       }
       __pyx_v_variant_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-      /* "pgenlib.pyx":647
+      /* "pgenlib.pyx":758
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     }
 
-    /* "pgenlib.pyx":649
+    /* "pgenlib.pyx":760
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":650
+    /* "pgenlib.pyx":761
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_16 = __pyx_v_variant_batch_size;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_uii = __pyx_t_18;
 
-      /* "pgenlib.pyx":651
+      /* "pgenlib.pyx":762
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, (__pyx_v_uii + __pyx_v_variant_idx_offset), __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_vmaj_iter);
 
-      /* "pgenlib.pyx":652
+      /* "pgenlib.pyx":763
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":653
+        /* "pgenlib.pyx":764
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  */
-        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 653, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 764, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 653, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 764, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 653, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 764, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 653, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 764, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 653, __pyx_L1_error)
+        __PYX_ERR(0, 764, __pyx_L1_error)
 
-        /* "pgenlib.pyx":652
+        /* "pgenlib.pyx":763
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       }
 
-      /* "pgenlib.pyx":654
+      /* "pgenlib.pyx":765
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])             # <<<<<<<<<<<<<<
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[__pyx_v_sample_ctaw2]));
     }
 
-    /* "pgenlib.pyx":655
+    /* "pgenlib.pyx":766
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  */
     __pyx_v_sample_batch_size = plink2::kPglNypTransposeBatch;
 
-    /* "pgenlib.pyx":656
+    /* "pgenlib.pyx":767
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":657
+    /* "pgenlib.pyx":768
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):             # <<<<<<<<<<<<<<
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  */
     __pyx_t_16 = __pyx_v_sample_batch_ct;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_sample_batch_idx = __pyx_t_18;
 
-      /* "pgenlib.pyx":658
+      /* "pgenlib.pyx":769
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       __pyx_t_5 = ((__pyx_v_sample_batch_idx == (__pyx_v_sample_batch_ct - 1)) != 0);
       if (__pyx_t_5) {
 
-        /* "pgenlib.pyx":659
+        /* "pgenlib.pyx":770
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  */
         __pyx_t_15 = (__pyx_v_subset_size - 1);
         if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-          __PYX_ERR(0, 659, __pyx_L1_error)
+          __PYX_ERR(0, 770, __pyx_L1_error)
         }
         __pyx_v_sample_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-        /* "pgenlib.pyx":658
+        /* "pgenlib.pyx":769
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       }
 
-      /* "pgenlib.pyx":660
+      /* "pgenlib.pyx":771
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  */
       __pyx_v_smaj_iter = __pyx_v_multivar_smaj_geno_batch_buf;
 
-      /* "pgenlib.pyx":661
+      /* "pgenlib.pyx":772
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))
  */
       plink2::TransposeNypblock(__pyx_v_vmaj_iter, __pyx_v_sample_ctaw2, plink2::kPglNypTransposeWords, __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":662
+      /* "pgenlib.pyx":773
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):             # <<<<<<<<<<<<<<
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)
  */
       __pyx_t_19 = __pyx_v_sample_batch_size;
       __pyx_t_20 = __pyx_t_19;
       for (__pyx_t_21 = 0; __pyx_t_21 < __pyx_t_20; __pyx_t_21+=1) {
         __pyx_v_uii = __pyx_t_21;
 
-        /* "pgenlib.pyx":663
+        /* "pgenlib.pyx":774
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))             # <<<<<<<<<<<<<<
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  */
         __pyx_t_11 = (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch));
         __pyx_t_22 = (__pyx_v_variant_batch_idx * plink2::kPglNypTransposeBatch);
         __pyx_t_13 = -1;
         if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int32_out.diminfo[0].shape)) __pyx_t_13 = 0;
         if (unlikely(__pyx_t_22 >= (size_t)__pyx_pybuffernd_geno_int32_out.diminfo[1].shape)) __pyx_t_13 = 1;
         if (unlikely(__pyx_t_13 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_13);
-          __PYX_ERR(0, 663, __pyx_L1_error)
+          __PYX_ERR(0, 774, __pyx_L1_error)
         }
         __pyx_v_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int32_out.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_geno_int32_out.diminfo[1].strides))));
 
-        /* "pgenlib.pyx":664
+        /* "pgenlib.pyx":775
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)             # <<<<<<<<<<<<<<
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  */
         plink2::GenoarrToInt32sMinus9(__pyx_v_smaj_iter, __pyx_v_variant_batch_size, __pyx_v_data_ptr);
 
-        /* "pgenlib.pyx":665
+        /* "pgenlib.pyx":776
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_idx_offset += kPglNypTransposeBatch
  */
         __pyx_v_smaj_iter = (&(__pyx_v_smaj_iter[plink2::kPglNypTransposeWords]));
       }
 
-      /* "pgenlib.pyx":666
+      /* "pgenlib.pyx":777
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *             variant_idx_offset += kPglNypTransposeBatch
  *         return
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[plink2::kPglNypTransposeWords]));
     }
 
-    /* "pgenlib.pyx":667
+    /* "pgenlib.pyx":778
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_idx_offset += kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     __pyx_v_variant_idx_offset = (__pyx_v_variant_idx_offset + plink2::kPglNypTransposeBatch);
   }
 
-  /* "pgenlib.pyx":668
+  /* "pgenlib.pyx":779
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_idx_offset += kPglNypTransposeBatch
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cdef read_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":604
+  /* "pgenlib.pyx":715
  *         return
  * 
  *     cdef read_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -9795,15 +12516,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":670
+/* "pgenlib.pyx":781
  *         return
  * 
  *     cdef read_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -9873,262 +12594,262 @@
   }
   __pyx_pybuffer_geno_int64_out.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int64_out.refcount = 0;
   __pyx_pybuffernd_geno_int64_out.data = NULL;
   __pyx_pybuffernd_geno_int64_out.rcbuffer = &__pyx_pybuffer_geno_int64_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int64_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 670, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int64_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 781, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int64_out.diminfo[0].strides = __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int64_out.diminfo[0].shape = __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_geno_int64_out.diminfo[1].strides = __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_geno_int64_out.diminfo[1].shape = __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":671
+  /* "pgenlib.pyx":782
  * 
  *     cdef read_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_1 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_1;
 
-  /* "pgenlib.pyx":672
+  /* "pgenlib.pyx":783
  *     cdef read_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_2 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_2;
 
-  /* "pgenlib.pyx":673
+  /* "pgenlib.pyx":784
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  */
   __pyx_t_3 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_3;
 
-  /* "pgenlib.pyx":674
+  /* "pgenlib.pyx":785
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_1 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_1;
 
-  /* "pgenlib.pyx":675
+  /* "pgenlib.pyx":786
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int64_t* data_ptr
  */
   __pyx_v_variant_idx_ct = (__pyx_v_variant_idx_end - __pyx_v_variant_idx_start);
 
-  /* "pgenlib.pyx":676
+  /* "pgenlib.pyx":787
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int64_t* data_ptr
  *         cdef uint32_t variant_idx
  */
   __pyx_t_4 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_4;
 
-  /* "pgenlib.pyx":680
+  /* "pgenlib.pyx":791
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_5 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":681
+    /* "pgenlib.pyx":792
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int64_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:
  */
     __pyx_t_5 = (((__pyx_v_geno_int64_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":682
+      /* "pgenlib.pyx":793
  *         if sample_maj == 0:
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if geno_int64_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 793, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 793, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 793, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 793, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 793, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 682, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 793, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 793, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 682, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 793, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 793, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 682, __pyx_L1_error)
+      __PYX_ERR(0, 793, __pyx_L1_error)
 
-      /* "pgenlib.pyx":681
+      /* "pgenlib.pyx":792
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int64_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":683
+    /* "pgenlib.pyx":794
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     __pyx_t_5 = (((__pyx_v_geno_int64_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":684
+      /* "pgenlib.pyx":795
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 795, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 795, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_range_geno_in_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 795, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 795, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 795, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 795, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 795, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 795, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 795, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 684, __pyx_L1_error)
+      __PYX_ERR(0, 795, __pyx_L1_error)
 
-      /* "pgenlib.pyx":683
+      /* "pgenlib.pyx":794
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     }
 
-    /* "pgenlib.pyx":685
+    /* "pgenlib.pyx":796
  *             if geno_int64_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_4 = __pyx_v_variant_idx_end;
     __pyx_t_9 = __pyx_t_4;
     for (__pyx_t_10 = __pyx_v_variant_idx_start; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
       __pyx_v_variant_idx = __pyx_t_10;
 
-      /* "pgenlib.pyx":686
+      /* "pgenlib.pyx":797
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec);
 
-      /* "pgenlib.pyx":687
+      /* "pgenlib.pyx":798
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int64_out[(variant_idx - variant_idx_start), 0])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":688
+        /* "pgenlib.pyx":799
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data_ptr = &(geno_int64_out[(variant_idx - variant_idx_start), 0])
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  */
-        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 799, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 799, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 799, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 799, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_Raise(__pyx_t_7, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __PYX_ERR(0, 688, __pyx_L1_error)
+        __PYX_ERR(0, 799, __pyx_L1_error)
 
-        /* "pgenlib.pyx":687
+        /* "pgenlib.pyx":798
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int64_out[(variant_idx - variant_idx_start), 0])
  */
       }
 
-      /* "pgenlib.pyx":689
+      /* "pgenlib.pyx":800
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int64_out[(variant_idx - variant_idx_start), 0])             # <<<<<<<<<<<<<<
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  *             return
  */
       __pyx_t_11 = (__pyx_v_variant_idx - __pyx_v_variant_idx_start);
@@ -10137,579 +12858,579 @@
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int64_out.diminfo[0].shape)) __pyx_t_13 = 0;
       if (__pyx_t_12 < 0) {
         __pyx_t_12 += __pyx_pybuffernd_geno_int64_out.diminfo[1].shape;
         if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 1;
       } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_geno_int64_out.diminfo[1].shape)) __pyx_t_13 = 1;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        __PYX_ERR(0, 689, __pyx_L1_error)
+        __PYX_ERR(0, 800, __pyx_L1_error)
       }
       __pyx_v_data_ptr = ((int64_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int64_out.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_geno_int64_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":690
+      /* "pgenlib.pyx":801
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int64_out[(variant_idx - variant_idx_start), 0])
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         if variant_idx_start >= variant_idx_end:
  */
       plink2::GenoarrToInt64sMinus9(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data_ptr);
     }
 
-    /* "pgenlib.pyx":691
+    /* "pgenlib.pyx":802
  *                 data_ptr = &(geno_int64_out[(variant_idx - variant_idx_start), 0])
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":680
+    /* "pgenlib.pyx":791
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":692
+  /* "pgenlib.pyx":803
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if variant_idx_start >= variant_idx_end:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int64_out.shape[0] < subset_size:
  */
   __pyx_t_5 = ((__pyx_v_variant_idx_start >= __pyx_v_variant_idx_end) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":693
+    /* "pgenlib.pyx":804
  *             return
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")             # <<<<<<<<<<<<<<
  *         if geno_int64_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_variant_idx_start_var, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_variant_idx_start_var, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 693, __pyx_L1_error)
+    __PYX_ERR(0, 804, __pyx_L1_error)
 
-    /* "pgenlib.pyx":692
+    /* "pgenlib.pyx":803
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if variant_idx_start >= variant_idx_end:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int64_out.shape[0] < subset_size:
  */
   }
 
-  /* "pgenlib.pyx":694
+  /* "pgenlib.pyx":805
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int64_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  */
   __pyx_t_5 = (((__pyx_v_geno_int64_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":695
+    /* "pgenlib.pyx":806
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int64_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
-    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 695, __pyx_L1_error)
+    __PYX_ERR(0, 806, __pyx_L1_error)
 
-    /* "pgenlib.pyx":694
+    /* "pgenlib.pyx":805
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if geno_int64_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  */
   }
 
-  /* "pgenlib.pyx":696
+  /* "pgenlib.pyx":807
  *         if geno_int64_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   __pyx_t_5 = (((__pyx_v_geno_int64_out->dimensions[1]) < __pyx_v_variant_idx_ct) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":697
+    /* "pgenlib.pyx":808
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  */
-    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int_2, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_range_geno_int_2, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 697, __pyx_L1_error)
+    __PYX_ERR(0, 808, __pyx_L1_error)
 
-    /* "pgenlib.pyx":696
+    /* "pgenlib.pyx":807
  *         if geno_int64_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   }
 
-  /* "pgenlib.pyx":698
+  /* "pgenlib.pyx":809
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  */
   __pyx_v_variant_batch_ct = plink2::DivUp(__pyx_v_variant_idx_ct, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":699
+  /* "pgenlib.pyx":810
  *             raise RuntimeError("Sample-major read_range() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  */
   __pyx_v_variant_batch_size = plink2::kPglNypTransposeBatch;
 
-  /* "pgenlib.pyx":700
+  /* "pgenlib.pyx":811
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_idx_offset = variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  */
   __pyx_v_variant_idx_offset = __pyx_v_variant_idx_start;
 
-  /* "pgenlib.pyx":701
+  /* "pgenlib.pyx":812
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  */
   __pyx_v_sample_ctaw2 = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWordD2));
 
-  /* "pgenlib.pyx":702
+  /* "pgenlib.pyx":813
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  */
   __pyx_v_sample_batch_ct = plink2::DivUp(__pyx_v_subset_size, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":703
+  /* "pgenlib.pyx":814
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  */
   __pyx_t_14 = __pyx_v_self->_transpose_batch_buf;
   __pyx_v_transpose_batch_buf = __pyx_t_14;
 
-  /* "pgenlib.pyx":704
+  /* "pgenlib.pyx":815
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* vmaj_iter
  */
   __pyx_t_1 = __pyx_v_self->_multivar_vmaj_geno_buf;
   __pyx_v_multivar_vmaj_geno_buf = __pyx_t_1;
 
-  /* "pgenlib.pyx":705
+  /* "pgenlib.pyx":816
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* vmaj_iter
  *         cdef uintptr_t* smaj_iter
  */
   __pyx_t_1 = __pyx_v_self->_multivar_smaj_geno_batch_buf;
   __pyx_v_multivar_smaj_geno_batch_buf = __pyx_t_1;
 
-  /* "pgenlib.pyx":712
+  /* "pgenlib.pyx":823
  *         cdef uint32_t sample_batch_idx
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):             # <<<<<<<<<<<<<<
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  */
   __pyx_t_4 = __pyx_v_variant_batch_ct;
   __pyx_t_9 = __pyx_t_4;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_variant_batch_idx = __pyx_t_10;
 
-    /* "pgenlib.pyx":713
+    /* "pgenlib.pyx":824
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     __pyx_t_5 = ((__pyx_v_variant_batch_idx == (__pyx_v_variant_batch_ct - 1)) != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":714
+      /* "pgenlib.pyx":825
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  */
       __pyx_t_15 = (__pyx_v_variant_idx_ct - 1);
       if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(0, 714, __pyx_L1_error)
+        __PYX_ERR(0, 825, __pyx_L1_error)
       }
       __pyx_v_variant_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-      /* "pgenlib.pyx":713
+      /* "pgenlib.pyx":824
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     }
 
-    /* "pgenlib.pyx":715
+    /* "pgenlib.pyx":826
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":716
+    /* "pgenlib.pyx":827
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_16 = __pyx_v_variant_batch_size;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_uii = __pyx_t_18;
 
-      /* "pgenlib.pyx":717
+      /* "pgenlib.pyx":828
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, (__pyx_v_uii + __pyx_v_variant_idx_offset), __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_vmaj_iter);
 
-      /* "pgenlib.pyx":718
+      /* "pgenlib.pyx":829
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":719
+        /* "pgenlib.pyx":830
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  */
-        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 719, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 830, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 719, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 830, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 719, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 830, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 719, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 830, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 719, __pyx_L1_error)
+        __PYX_ERR(0, 830, __pyx_L1_error)
 
-        /* "pgenlib.pyx":718
+        /* "pgenlib.pyx":829
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       }
 
-      /* "pgenlib.pyx":720
+      /* "pgenlib.pyx":831
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])             # <<<<<<<<<<<<<<
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[__pyx_v_sample_ctaw2]));
     }
 
-    /* "pgenlib.pyx":721
+    /* "pgenlib.pyx":832
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  */
     __pyx_v_sample_batch_size = plink2::kPglNypTransposeBatch;
 
-    /* "pgenlib.pyx":722
+    /* "pgenlib.pyx":833
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":723
+    /* "pgenlib.pyx":834
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):             # <<<<<<<<<<<<<<
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  */
     __pyx_t_16 = __pyx_v_sample_batch_ct;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_sample_batch_idx = __pyx_t_18;
 
-      /* "pgenlib.pyx":724
+      /* "pgenlib.pyx":835
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       __pyx_t_5 = ((__pyx_v_sample_batch_idx == (__pyx_v_sample_batch_ct - 1)) != 0);
       if (__pyx_t_5) {
 
-        /* "pgenlib.pyx":725
+        /* "pgenlib.pyx":836
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  */
         __pyx_t_15 = (__pyx_v_subset_size - 1);
         if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-          __PYX_ERR(0, 725, __pyx_L1_error)
+          __PYX_ERR(0, 836, __pyx_L1_error)
         }
         __pyx_v_sample_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-        /* "pgenlib.pyx":724
+        /* "pgenlib.pyx":835
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       }
 
-      /* "pgenlib.pyx":726
+      /* "pgenlib.pyx":837
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  */
       __pyx_v_smaj_iter = __pyx_v_multivar_smaj_geno_batch_buf;
 
-      /* "pgenlib.pyx":727
+      /* "pgenlib.pyx":838
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  */
       plink2::TransposeNypblock(__pyx_v_vmaj_iter, __pyx_v_sample_ctaw2, plink2::kPglNypTransposeWords, __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":728
+      /* "pgenlib.pyx":839
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):             # <<<<<<<<<<<<<<
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)
  */
       __pyx_t_19 = __pyx_v_sample_batch_size;
       __pyx_t_20 = __pyx_t_19;
       for (__pyx_t_21 = 0; __pyx_t_21 < __pyx_t_20; __pyx_t_21+=1) {
         __pyx_v_uii = __pyx_t_21;
 
-        /* "pgenlib.pyx":729
+        /* "pgenlib.pyx":840
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])             # <<<<<<<<<<<<<<
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  */
         __pyx_t_11 = (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch));
         __pyx_t_22 = (__pyx_v_variant_batch_idx * plink2::kPglNypTransposeBatch);
         __pyx_t_13 = -1;
         if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int64_out.diminfo[0].shape)) __pyx_t_13 = 0;
         if (unlikely(__pyx_t_22 >= (size_t)__pyx_pybuffernd_geno_int64_out.diminfo[1].shape)) __pyx_t_13 = 1;
         if (unlikely(__pyx_t_13 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_13);
-          __PYX_ERR(0, 729, __pyx_L1_error)
+          __PYX_ERR(0, 840, __pyx_L1_error)
         }
         __pyx_v_data_ptr = ((int64_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int64_out.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_geno_int64_out.diminfo[1].strides))));
 
-        /* "pgenlib.pyx":730
+        /* "pgenlib.pyx":841
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)             # <<<<<<<<<<<<<<
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  */
         plink2::GenoarrToInt64sMinus9(__pyx_v_smaj_iter, __pyx_v_variant_batch_size, __pyx_v_data_ptr);
 
-        /* "pgenlib.pyx":731
+        /* "pgenlib.pyx":842
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_idx_offset += kPglNypTransposeBatch
  */
         __pyx_v_smaj_iter = (&(__pyx_v_smaj_iter[plink2::kPglNypTransposeWords]));
       }
 
-      /* "pgenlib.pyx":732
+      /* "pgenlib.pyx":843
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *             variant_idx_offset += kPglNypTransposeBatch
  *         return
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[plink2::kPglNypTransposeWords]));
     }
 
-    /* "pgenlib.pyx":733
+    /* "pgenlib.pyx":844
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_idx_offset += kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     __pyx_v_variant_idx_offset = (__pyx_v_variant_idx_offset + plink2::kPglNypTransposeBatch);
   }
 
-  /* "pgenlib.pyx":734
+  /* "pgenlib.pyx":845
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_idx_offset += kPglNypTransposeBatch
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cpdef read_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":670
+  /* "pgenlib.pyx":781
  *         return
  * 
  *     cdef read_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -10731,15 +13452,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":736
+/* "pgenlib.pyx":847
  *         return
  * 
  *     cpdef read_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -10780,25 +13501,25 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 847, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_19read_range)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 736, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 847, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 736, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 847, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 847, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_v_sample_maj); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 736, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_v_sample_maj); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 847, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_7 = __pyx_t_1; __pyx_t_8 = NULL;
         __pyx_t_9 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
           __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
           if (likely(__pyx_t_8)) {
@@ -10808,37 +13529,37 @@
             __Pyx_DECREF_SET(__pyx_t_7, function);
             __pyx_t_9 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_7)) {
           PyObject *__pyx_temp[6] = {__pyx_t_8, __pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_geno_int_out), __pyx_t_5, __pyx_t_6};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_9, 5+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_9, 5+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 847, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
           PyObject *__pyx_temp[6] = {__pyx_t_8, __pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_geno_int_out), __pyx_t_5, __pyx_t_6};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_9, 5+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_9, 5+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 847, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         } else
         #endif
         {
-          __pyx_t_10 = PyTuple_New(5+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 736, __pyx_L1_error)
+          __pyx_t_10 = PyTuple_New(5+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 847, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           if (__pyx_t_8) {
             __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
@@ -10850,15 +13571,15 @@
           PyTuple_SET_ITEM(__pyx_t_10, 3+__pyx_t_9, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_6);
           PyTuple_SET_ITEM(__pyx_t_10, 4+__pyx_t_9, __pyx_t_6);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
           __pyx_t_6 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 847, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -10873,233 +13594,233 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":737
+  /* "pgenlib.pyx":848
  * 
  *     cpdef read_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.dtype == np.int8:
  */
   __pyx_t_11 = ((__pyx_v_variant_idx_end > (__pyx_v_self->_info_ptr[0]).raw_variant_ct) != 0);
   if (unlikely(__pyx_t_11)) {
 
-    /* "pgenlib.pyx":738
+    /* "pgenlib.pyx":849
  *     cpdef read_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *         if geno_int_out.dtype == np.int8:
  *             self.read_range_internal8(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_variant_idx_end_too_l, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_variant_idx_end_too_l, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 738, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 738, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 738, __pyx_L1_error)
+    __PYX_ERR(0, 849, __pyx_L1_error)
 
-    /* "pgenlib.pyx":737
+    /* "pgenlib.pyx":848
  * 
  *     cpdef read_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.dtype == np.int8:
  */
   }
 
-  /* "pgenlib.pyx":739
+  /* "pgenlib.pyx":850
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.dtype == np.int8:             # <<<<<<<<<<<<<<
  *             self.read_range_internal8(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 739, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 739, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_int8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_int8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 739, __pyx_L1_error)
+  __pyx_t_7 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 739, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (__pyx_t_11) {
 
-    /* "pgenlib.pyx":740
+    /* "pgenlib.pyx":851
  *             raise RuntimeError("read_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.dtype == np.int8:
  *             self.read_range_internal8(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         elif geno_int_out.dtype == np.int32:
  *             self.read_range_internal32(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  */
     __pyx_t_12.__pyx_n = 2;
     __pyx_t_12.allele_idx = __pyx_v_allele_idx;
     __pyx_t_12.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_7 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_range_internal8(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
+    __pyx_t_7 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_range_internal8(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "pgenlib.pyx":739
+    /* "pgenlib.pyx":850
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.dtype == np.int8:             # <<<<<<<<<<<<<<
  *             self.read_range_internal8(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:
  */
     goto __pyx_L4;
   }
 
-  /* "pgenlib.pyx":741
+  /* "pgenlib.pyx":852
  *         if geno_int_out.dtype == np.int8:
  *             self.read_range_internal8(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:             # <<<<<<<<<<<<<<
  *             self.read_range_internal32(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_7, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_7, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_11) {
 
-    /* "pgenlib.pyx":742
+    /* "pgenlib.pyx":853
  *             self.read_range_internal8(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:
  *             self.read_range_internal32(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         elif geno_int_out.dtype == np.int64:
  *             self.read_range_internal64(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  */
     __pyx_t_13.__pyx_n = 2;
     __pyx_t_13.allele_idx = __pyx_v_allele_idx;
     __pyx_t_13.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_range_internal32(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_13); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_range_internal32(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_13); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pgenlib.pyx":741
+    /* "pgenlib.pyx":852
  *         if geno_int_out.dtype == np.int8:
  *             self.read_range_internal8(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:             # <<<<<<<<<<<<<<
  *             self.read_range_internal32(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:
  */
     goto __pyx_L4;
   }
 
-  /* "pgenlib.pyx":743
+  /* "pgenlib.pyx":854
  *         elif geno_int_out.dtype == np.int32:
  *             self.read_range_internal32(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:             # <<<<<<<<<<<<<<
  *             self.read_range_internal64(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         else:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_t_7, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_t_7, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (likely(__pyx_t_11)) {
 
-    /* "pgenlib.pyx":744
+    /* "pgenlib.pyx":855
  *             self.read_range_internal32(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:
  *             self.read_range_internal64(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         else:
  *             raise RuntimeError("Invalid read_range() geno_int_out array element type (int8, int32, or int64 expected).")
  */
     __pyx_t_14.__pyx_n = 2;
     __pyx_t_14.allele_idx = __pyx_v_allele_idx;
     __pyx_t_14.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_range_internal64(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_range_internal64(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 855, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pgenlib.pyx":743
+    /* "pgenlib.pyx":854
  *         elif geno_int_out.dtype == np.int32:
  *             self.read_range_internal32(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:             # <<<<<<<<<<<<<<
  *             self.read_range_internal64(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         else:
  */
     goto __pyx_L4;
   }
 
-  /* "pgenlib.pyx":746
+  /* "pgenlib.pyx":857
  *             self.read_range_internal64(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         else:
  *             raise RuntimeError("Invalid read_range() geno_int_out array element type (int8, int32, or int64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   /*else*/ {
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 746, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 857, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 746, __pyx_L1_error)
+    __PYX_ERR(0, 857, __pyx_L1_error)
   }
   __pyx_L4:;
 
-  /* "pgenlib.pyx":747
+  /* "pgenlib.pyx":858
  *         else:
  *             raise RuntimeError("Invalid read_range() geno_int_out array element type (int8, int32, or int64 expected).")
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":736
+  /* "pgenlib.pyx":847
  *         return
  * 
  *     cpdef read_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -11161,21 +13882,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx_start)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx_end)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_range", 0, 3, 5, 1); __PYX_ERR(0, 736, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_range", 0, 3, 5, 1); __PYX_ERR(0, 847, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_geno_int_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_range", 0, 3, 5, 2); __PYX_ERR(0, 736, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_range", 0, 3, 5, 2); __PYX_ERR(0, 847, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_idx);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -11183,52 +13904,52 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sample_maj);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_range") < 0)) __PYX_ERR(0, 736, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_range") < 0)) __PYX_ERR(0, 847, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_variant_idx_start = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx_start == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 736, __pyx_L3_error)
-    __pyx_v_variant_idx_end = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_variant_idx_end == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 736, __pyx_L3_error)
+    __pyx_v_variant_idx_start = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx_start == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 847, __pyx_L3_error)
+    __pyx_v_variant_idx_end = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_variant_idx_end == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 847, __pyx_L3_error)
     __pyx_v_geno_int_out = ((PyArrayObject *)values[2]);
     if (values[3]) {
-      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[3]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 736, __pyx_L3_error)
+      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[3]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 847, __pyx_L3_error)
     } else {
       __pyx_v_allele_idx = ((uint32_t)1);
     }
     if (values[4]) {
-      __pyx_v_sample_maj = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_sample_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 736, __pyx_L3_error)
+      __pyx_v_sample_maj = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_sample_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 847, __pyx_L3_error)
     } else {
       __pyx_v_sample_maj = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_range", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 736, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_range", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 847, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_range", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int_out), __pyx_ptype_5numpy_ndarray, 1, "geno_int_out", 0))) __PYX_ERR(0, 736, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int_out), __pyx_ptype_5numpy_ndarray, 1, "geno_int_out", 0))) __PYX_ERR(0, 847, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_18read_range(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_geno_int_out, __pyx_v_allele_idx, __pyx_v_sample_maj);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -11245,15 +13966,15 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_range", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.allele_idx = __pyx_v_allele_idx;
   __pyx_t_2.sample_maj = __pyx_v_sample_maj;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_range(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_geno_int_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_range(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_geno_int_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 847, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -11262,15 +13983,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":750
+/* "pgenlib.pyx":861
  * 
  * 
  *     cdef read_list_internal8(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -11347,349 +14068,349 @@
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   __pyx_pybuffer_geno_int8_out.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int8_out.refcount = 0;
   __pyx_pybuffernd_geno_int8_out.data = NULL;
   __pyx_pybuffernd_geno_int8_out.rcbuffer = &__pyx_pybuffer_geno_int8_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 861, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 861, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int8_out.diminfo[0].strides = __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int8_out.diminfo[0].shape = __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_geno_int8_out.diminfo[1].strides = __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_geno_int8_out.diminfo[1].shape = __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":751
+  /* "pgenlib.pyx":862
  * 
  *     cdef read_list_internal8(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
   __pyx_t_1 = (__pyx_v_self->_info_ptr[0]).raw_variant_ct;
   __pyx_v_raw_variant_ct = __pyx_t_1;
 
-  /* "pgenlib.pyx":752
+  /* "pgenlib.pyx":863
  *     cdef read_list_internal8(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_2 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_2;
 
-  /* "pgenlib.pyx":753
+  /* "pgenlib.pyx":864
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_3 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_3;
 
-  /* "pgenlib.pyx":754
+  /* "pgenlib.pyx":865
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  */
   __pyx_t_4 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_4;
 
-  /* "pgenlib.pyx":755
+  /* "pgenlib.pyx":866
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_2 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_2;
 
-  /* "pgenlib.pyx":756
+  /* "pgenlib.pyx":867
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int8_t* data_ptr
  */
   __pyx_v_variant_idx_ct = ((uint32_t)(__pyx_v_variant_idxs->dimensions[0]));
 
-  /* "pgenlib.pyx":757
+  /* "pgenlib.pyx":868
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int8_t* data_ptr
  *         cdef uint32_t variant_list_idx
  */
   __pyx_t_1 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_1;
 
-  /* "pgenlib.pyx":762
+  /* "pgenlib.pyx":873
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_5 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":763
+    /* "pgenlib.pyx":874
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int8_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:
  */
     __pyx_t_5 = (((__pyx_v_geno_int8_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":764
+      /* "pgenlib.pyx":875
  *         if sample_maj == 0:
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if geno_int8_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 764, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 764, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 764, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 764, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 764, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 764, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 764, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 764, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 764, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 875, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 764, __pyx_L1_error)
+      __PYX_ERR(0, 875, __pyx_L1_error)
 
-      /* "pgenlib.pyx":763
+      /* "pgenlib.pyx":874
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int8_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":765
+    /* "pgenlib.pyx":876
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     __pyx_t_5 = (((__pyx_v_geno_int8_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":766
+      /* "pgenlib.pyx":877
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 766, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 766, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 766, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 766, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 766, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 766, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 766, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 766, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 766, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 766, __pyx_L1_error)
+      __PYX_ERR(0, 877, __pyx_L1_error)
 
-      /* "pgenlib.pyx":765
+      /* "pgenlib.pyx":876
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int8_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     }
 
-    /* "pgenlib.pyx":767
+    /* "pgenlib.pyx":878
  *             if geno_int8_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_1 = __pyx_v_variant_idx_ct;
     __pyx_t_9 = __pyx_t_1;
     for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
       __pyx_v_variant_list_idx = __pyx_t_10;
 
-      /* "pgenlib.pyx":768
+      /* "pgenlib.pyx":879
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_11 = __pyx_v_variant_list_idx;
       __pyx_t_12 = -1;
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_12 = 0;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        __PYX_ERR(0, 768, __pyx_L1_error)
+        __PYX_ERR(0, 879, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":769
+      /* "pgenlib.pyx":880
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  */
       __pyx_t_5 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":770
+        /* "pgenlib.pyx":881
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 770, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 881, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 770, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 881, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 770, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 881, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_only); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 770, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_only); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 881, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 770, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 881, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 770, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 881, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 770, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 881, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 770, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 881, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 770, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 881, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_Raise(__pyx_t_6, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __PYX_ERR(0, 770, __pyx_L1_error)
+        __PYX_ERR(0, 881, __pyx_L1_error)
 
-        /* "pgenlib.pyx":769
+        /* "pgenlib.pyx":880
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  */
       }
 
-      /* "pgenlib.pyx":771
+      /* "pgenlib.pyx":882
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec);
 
-      /* "pgenlib.pyx":772
+      /* "pgenlib.pyx":883
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int8_out[variant_list_idx, 0])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":773
+        /* "pgenlib.pyx":884
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data_ptr = &(geno_int8_out[variant_list_idx, 0])
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  */
-        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 773, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 884, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 773, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 884, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 773, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 884, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 773, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 884, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 773, __pyx_L1_error)
+        __PYX_ERR(0, 884, __pyx_L1_error)
 
-        /* "pgenlib.pyx":772
+        /* "pgenlib.pyx":883
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int8_out[variant_list_idx, 0])
  */
       }
 
-      /* "pgenlib.pyx":774
+      /* "pgenlib.pyx":885
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int8_out[variant_list_idx, 0])             # <<<<<<<<<<<<<<
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  *             return
  */
       __pyx_t_11 = __pyx_v_variant_list_idx;
@@ -11698,595 +14419,595 @@
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int8_out.diminfo[0].shape)) __pyx_t_12 = 0;
       if (__pyx_t_13 < 0) {
         __pyx_t_13 += __pyx_pybuffernd_geno_int8_out.diminfo[1].shape;
         if (unlikely(__pyx_t_13 < 0)) __pyx_t_12 = 1;
       } else if (unlikely(__pyx_t_13 >= __pyx_pybuffernd_geno_int8_out.diminfo[1].shape)) __pyx_t_12 = 1;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        __PYX_ERR(0, 774, __pyx_L1_error)
+        __PYX_ERR(0, 885, __pyx_L1_error)
       }
       __pyx_v_data_ptr = (&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int8_out.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_geno_int8_out.diminfo[1].strides)));
 
-      /* "pgenlib.pyx":775
+      /* "pgenlib.pyx":886
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int8_out[variant_list_idx, 0])
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         if geno_int8_out.shape[0] < subset_size:
  */
       plink2::GenoarrToBytesMinus9(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data_ptr);
     }
 
-    /* "pgenlib.pyx":776
+    /* "pgenlib.pyx":887
  *                 data_ptr = &(geno_int8_out[variant_list_idx, 0])
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         if geno_int8_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":762
+    /* "pgenlib.pyx":873
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int8_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":777
+  /* "pgenlib.pyx":888
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if geno_int8_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  */
   __pyx_t_5 = (((__pyx_v_geno_int8_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":778
+    /* "pgenlib.pyx":889
  *             return
  *         if geno_int8_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
-    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[0])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[0])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 889, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_Raise(__pyx_t_8, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __PYX_ERR(0, 778, __pyx_L1_error)
+    __PYX_ERR(0, 889, __pyx_L1_error)
 
-    /* "pgenlib.pyx":777
+    /* "pgenlib.pyx":888
  *                 GenoarrToBytesMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if geno_int8_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  */
   }
 
-  /* "pgenlib.pyx":779
+  /* "pgenlib.pyx":890
  *         if geno_int8_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   __pyx_t_5 = (((__pyx_v_geno_int8_out->dimensions[1]) < __pyx_v_variant_idx_ct) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":780
+    /* "pgenlib.pyx":891
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  */
-    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[1])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int8_out->dimensions[1])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 891, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 891, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int_2, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int_2, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 891, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 891, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 891, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 891, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 891, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 891, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 891, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_8, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __PYX_ERR(0, 780, __pyx_L1_error)
+    __PYX_ERR(0, 891, __pyx_L1_error)
 
-    /* "pgenlib.pyx":779
+    /* "pgenlib.pyx":890
  *         if geno_int8_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int8_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int8_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   }
 
-  /* "pgenlib.pyx":781
+  /* "pgenlib.pyx":892
  *         if geno_int8_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  */
   __pyx_v_variant_batch_ct = plink2::DivUp(__pyx_v_variant_idx_ct, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":782
+  /* "pgenlib.pyx":893
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int8_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  */
   __pyx_v_variant_batch_size = plink2::kPglNypTransposeBatch;
 
-  /* "pgenlib.pyx":783
+  /* "pgenlib.pyx":894
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  */
   __pyx_v_sample_ctaw2 = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWordD2));
 
-  /* "pgenlib.pyx":784
+  /* "pgenlib.pyx":895
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  */
   __pyx_v_sample_batch_ct = plink2::DivUp(__pyx_v_subset_size, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":785
+  /* "pgenlib.pyx":896
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  */
   __pyx_t_14 = __pyx_v_self->_transpose_batch_buf;
   __pyx_v_transpose_batch_buf = __pyx_t_14;
 
-  /* "pgenlib.pyx":786
+  /* "pgenlib.pyx":897
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* vmaj_iter
  */
   __pyx_t_2 = __pyx_v_self->_multivar_vmaj_geno_buf;
   __pyx_v_multivar_vmaj_geno_buf = __pyx_t_2;
 
-  /* "pgenlib.pyx":787
+  /* "pgenlib.pyx":898
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* vmaj_iter
  *         cdef uintptr_t* smaj_iter
  */
   __pyx_t_2 = __pyx_v_self->_multivar_smaj_geno_batch_buf;
   __pyx_v_multivar_smaj_geno_batch_buf = __pyx_t_2;
 
-  /* "pgenlib.pyx":794
+  /* "pgenlib.pyx":905
  *         cdef uint32_t sample_batch_idx
  *         cdef uint32_t uii
  *         variant_list_idx = 0             # <<<<<<<<<<<<<<
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  */
   __pyx_v_variant_list_idx = 0;
 
-  /* "pgenlib.pyx":795
+  /* "pgenlib.pyx":906
  *         cdef uint32_t uii
  *         variant_list_idx = 0
  *         for variant_batch_idx in range(variant_batch_ct):             # <<<<<<<<<<<<<<
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  */
   __pyx_t_1 = __pyx_v_variant_batch_ct;
   __pyx_t_9 = __pyx_t_1;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_variant_batch_idx = __pyx_t_10;
 
-    /* "pgenlib.pyx":796
+    /* "pgenlib.pyx":907
  *         variant_list_idx = 0
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     __pyx_t_5 = ((__pyx_v_variant_batch_idx == (__pyx_v_variant_batch_ct - 1)) != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":797
+      /* "pgenlib.pyx":908
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  */
       __pyx_t_15 = (__pyx_v_variant_idx_ct - 1);
       if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(0, 797, __pyx_L1_error)
+        __PYX_ERR(0, 908, __pyx_L1_error)
       }
       __pyx_v_variant_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-      /* "pgenlib.pyx":796
+      /* "pgenlib.pyx":907
  *         variant_list_idx = 0
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     }
 
-    /* "pgenlib.pyx":798
+    /* "pgenlib.pyx":909
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":799
+    /* "pgenlib.pyx":910
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_16 = __pyx_v_variant_batch_size;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_uii = __pyx_t_18;
 
-      /* "pgenlib.pyx":800
+      /* "pgenlib.pyx":911
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_11 = (__pyx_v_uii + __pyx_v_variant_list_idx);
       __pyx_t_12 = -1;
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_12 = 0;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        __PYX_ERR(0, 800, __pyx_L1_error)
+        __PYX_ERR(0, 911, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":801
+      /* "pgenlib.pyx":912
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  */
       __pyx_t_5 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":802
+        /* "pgenlib.pyx":913
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 802, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 802, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 802, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_only); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 802, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_only); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 802, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 802, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 802, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 802, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 802, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 802, __pyx_L1_error)
+        __PYX_ERR(0, 913, __pyx_L1_error)
 
-        /* "pgenlib.pyx":801
+        /* "pgenlib.pyx":912
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  */
       }
 
-      /* "pgenlib.pyx":803
+      /* "pgenlib.pyx":914
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_list() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_vmaj_iter);
 
-      /* "pgenlib.pyx":804
+      /* "pgenlib.pyx":915
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":805
+        /* "pgenlib.pyx":916
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_list() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  */
-        __pyx_t_8 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 805, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 916, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 805, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 916, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_error, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 805, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_error, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 916, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 805, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 916, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_Raise(__pyx_t_7, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __PYX_ERR(0, 805, __pyx_L1_error)
+        __PYX_ERR(0, 916, __pyx_L1_error)
 
-        /* "pgenlib.pyx":804
+        /* "pgenlib.pyx":915
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       }
 
-      /* "pgenlib.pyx":806
+      /* "pgenlib.pyx":917
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])             # <<<<<<<<<<<<<<
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[__pyx_v_sample_ctaw2]));
     }
 
-    /* "pgenlib.pyx":807
+    /* "pgenlib.pyx":918
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  */
     __pyx_v_sample_batch_size = plink2::kPglNypTransposeBatch;
 
-    /* "pgenlib.pyx":808
+    /* "pgenlib.pyx":919
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":809
+    /* "pgenlib.pyx":920
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):             # <<<<<<<<<<<<<<
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  */
     __pyx_t_16 = __pyx_v_sample_batch_ct;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_sample_batch_idx = __pyx_t_18;
 
-      /* "pgenlib.pyx":810
+      /* "pgenlib.pyx":921
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       __pyx_t_5 = ((__pyx_v_sample_batch_idx == (__pyx_v_sample_batch_ct - 1)) != 0);
       if (__pyx_t_5) {
 
-        /* "pgenlib.pyx":811
+        /* "pgenlib.pyx":922
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  */
         __pyx_t_15 = (__pyx_v_subset_size - 1);
         if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-          __PYX_ERR(0, 811, __pyx_L1_error)
+          __PYX_ERR(0, 922, __pyx_L1_error)
         }
         __pyx_v_sample_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-        /* "pgenlib.pyx":810
+        /* "pgenlib.pyx":921
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       }
 
-      /* "pgenlib.pyx":812
+      /* "pgenlib.pyx":923
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  */
       __pyx_v_smaj_iter = __pyx_v_multivar_smaj_geno_batch_buf;
 
-      /* "pgenlib.pyx":813
+      /* "pgenlib.pyx":924
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  */
       plink2::TransposeNypblock(__pyx_v_vmaj_iter, __pyx_v_sample_ctaw2, plink2::kPglNypTransposeWords, __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":814
+      /* "pgenlib.pyx":925
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):             # <<<<<<<<<<<<<<
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)
  */
       __pyx_t_19 = __pyx_v_sample_batch_size;
       __pyx_t_20 = __pyx_t_19;
       for (__pyx_t_21 = 0; __pyx_t_21 < __pyx_t_20; __pyx_t_21+=1) {
         __pyx_v_uii = __pyx_t_21;
 
-        /* "pgenlib.pyx":815
+        /* "pgenlib.pyx":926
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])             # <<<<<<<<<<<<<<
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  */
         __pyx_t_11 = (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch));
         __pyx_t_22 = (__pyx_v_variant_batch_idx * plink2::kPglNypTransposeBatch);
         __pyx_t_12 = -1;
         if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int8_out.diminfo[0].shape)) __pyx_t_12 = 0;
         if (unlikely(__pyx_t_22 >= (size_t)__pyx_pybuffernd_geno_int8_out.diminfo[1].shape)) __pyx_t_12 = 1;
         if (unlikely(__pyx_t_12 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_12);
-          __PYX_ERR(0, 815, __pyx_L1_error)
+          __PYX_ERR(0, 926, __pyx_L1_error)
         }
         __pyx_v_data_ptr = (&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_geno_int8_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int8_out.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_geno_int8_out.diminfo[1].strides)));
 
-        /* "pgenlib.pyx":816
+        /* "pgenlib.pyx":927
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)             # <<<<<<<<<<<<<<
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  */
         plink2::GenoarrToBytesMinus9(__pyx_v_smaj_iter, __pyx_v_variant_batch_size, __pyx_v_data_ptr);
 
-        /* "pgenlib.pyx":817
+        /* "pgenlib.pyx":928
  *                     data_ptr = &(geno_int8_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_list_idx += kPglNypTransposeBatch
  */
         __pyx_v_smaj_iter = (&(__pyx_v_smaj_iter[plink2::kPglNypTransposeWords]));
       }
 
-      /* "pgenlib.pyx":818
+      /* "pgenlib.pyx":929
  *                     GenoarrToBytesMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *             variant_list_idx += kPglNypTransposeBatch
  *         return
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[plink2::kPglNypTransposeWords]));
     }
 
-    /* "pgenlib.pyx":819
+    /* "pgenlib.pyx":930
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_list_idx += kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     __pyx_v_variant_list_idx = (__pyx_v_variant_list_idx + plink2::kPglNypTransposeBatch);
   }
 
-  /* "pgenlib.pyx":820
+  /* "pgenlib.pyx":931
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_list_idx += kPglNypTransposeBatch
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cdef read_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":750
+  /* "pgenlib.pyx":861
  * 
  * 
  *     cdef read_list_internal8(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -12310,15 +15031,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":822
+/* "pgenlib.pyx":933
  *         return
  * 
  *     cdef read_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -12395,349 +15116,349 @@
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   __pyx_pybuffer_geno_int32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int32_out.refcount = 0;
   __pyx_pybuffernd_geno_int32_out.data = NULL;
   __pyx_pybuffernd_geno_int32_out.rcbuffer = &__pyx_pybuffer_geno_int32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 822, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 933, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 822, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 933, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int32_out.diminfo[0].strides = __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int32_out.diminfo[0].shape = __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_geno_int32_out.diminfo[1].strides = __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_geno_int32_out.diminfo[1].shape = __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":823
+  /* "pgenlib.pyx":934
  * 
  *     cdef read_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
   __pyx_t_1 = (__pyx_v_self->_info_ptr[0]).raw_variant_ct;
   __pyx_v_raw_variant_ct = __pyx_t_1;
 
-  /* "pgenlib.pyx":824
+  /* "pgenlib.pyx":935
  *     cdef read_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_2 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_2;
 
-  /* "pgenlib.pyx":825
+  /* "pgenlib.pyx":936
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_3 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_3;
 
-  /* "pgenlib.pyx":826
+  /* "pgenlib.pyx":937
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  */
   __pyx_t_4 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_4;
 
-  /* "pgenlib.pyx":827
+  /* "pgenlib.pyx":938
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_2 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_2;
 
-  /* "pgenlib.pyx":828
+  /* "pgenlib.pyx":939
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int32_t* data_ptr
  */
   __pyx_v_variant_idx_ct = ((uint32_t)(__pyx_v_variant_idxs->dimensions[0]));
 
-  /* "pgenlib.pyx":829
+  /* "pgenlib.pyx":940
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int32_t* data_ptr
  *         cdef uint32_t variant_list_idx
  */
   __pyx_t_1 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_1;
 
-  /* "pgenlib.pyx":834
+  /* "pgenlib.pyx":945
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_5 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":835
+    /* "pgenlib.pyx":946
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:
  */
     __pyx_t_5 = (((__pyx_v_geno_int32_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":836
+      /* "pgenlib.pyx":947
  *         if sample_maj == 0:
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if geno_int32_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 836, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 836, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 836, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 836, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 836, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 836, __pyx_L1_error)
+      __PYX_ERR(0, 947, __pyx_L1_error)
 
-      /* "pgenlib.pyx":835
+      /* "pgenlib.pyx":946
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":837
+    /* "pgenlib.pyx":948
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     __pyx_t_5 = (((__pyx_v_geno_int32_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":838
+      /* "pgenlib.pyx":949
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 838, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 949, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 838, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 949, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 838, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 949, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 838, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 949, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 838, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 949, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 838, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 949, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 838, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 949, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 838, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 949, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 838, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 949, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 838, __pyx_L1_error)
+      __PYX_ERR(0, 949, __pyx_L1_error)
 
-      /* "pgenlib.pyx":837
+      /* "pgenlib.pyx":948
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int32_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     }
 
-    /* "pgenlib.pyx":839
+    /* "pgenlib.pyx":950
  *             if geno_int32_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_1 = __pyx_v_variant_idx_ct;
     __pyx_t_9 = __pyx_t_1;
     for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
       __pyx_v_variant_list_idx = __pyx_t_10;
 
-      /* "pgenlib.pyx":840
+      /* "pgenlib.pyx":951
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_11 = __pyx_v_variant_list_idx;
       __pyx_t_12 = -1;
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_12 = 0;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        __PYX_ERR(0, 840, __pyx_L1_error)
+        __PYX_ERR(0, 951, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":841
+      /* "pgenlib.pyx":952
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  */
       __pyx_t_5 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":842
+        /* "pgenlib.pyx":953
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_only); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_only); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_Raise(__pyx_t_6, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __PYX_ERR(0, 842, __pyx_L1_error)
+        __PYX_ERR(0, 953, __pyx_L1_error)
 
-        /* "pgenlib.pyx":841
+        /* "pgenlib.pyx":952
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  */
       }
 
-      /* "pgenlib.pyx":843
+      /* "pgenlib.pyx":954
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec);
 
-      /* "pgenlib.pyx":844
+      /* "pgenlib.pyx":955
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = <int32_t*>(&(geno_int32_out[variant_list_idx, 0]))
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":845
+        /* "pgenlib.pyx":956
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data_ptr = <int32_t*>(&(geno_int32_out[variant_list_idx, 0]))
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  */
-        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 845, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 956, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 845, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 956, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 845, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 956, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 845, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 956, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 845, __pyx_L1_error)
+        __PYX_ERR(0, 956, __pyx_L1_error)
 
-        /* "pgenlib.pyx":844
+        /* "pgenlib.pyx":955
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = <int32_t*>(&(geno_int32_out[variant_list_idx, 0]))
  */
       }
 
-      /* "pgenlib.pyx":846
+      /* "pgenlib.pyx":957
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = <int32_t*>(&(geno_int32_out[variant_list_idx, 0]))             # <<<<<<<<<<<<<<
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  *             return
  */
       __pyx_t_11 = __pyx_v_variant_list_idx;
@@ -12746,595 +15467,595 @@
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int32_out.diminfo[0].shape)) __pyx_t_12 = 0;
       if (__pyx_t_13 < 0) {
         __pyx_t_13 += __pyx_pybuffernd_geno_int32_out.diminfo[1].shape;
         if (unlikely(__pyx_t_13 < 0)) __pyx_t_12 = 1;
       } else if (unlikely(__pyx_t_13 >= __pyx_pybuffernd_geno_int32_out.diminfo[1].shape)) __pyx_t_12 = 1;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        __PYX_ERR(0, 846, __pyx_L1_error)
+        __PYX_ERR(0, 957, __pyx_L1_error)
       }
       __pyx_v_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int32_out.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_geno_int32_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":847
+      /* "pgenlib.pyx":958
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = <int32_t*>(&(geno_int32_out[variant_list_idx, 0]))
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         if geno_int32_out.shape[0] < subset_size:
  */
       plink2::GenoarrToInt32sMinus9(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data_ptr);
     }
 
-    /* "pgenlib.pyx":848
+    /* "pgenlib.pyx":959
  *                 data_ptr = <int32_t*>(&(geno_int32_out[variant_list_idx, 0]))
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         if geno_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":834
+    /* "pgenlib.pyx":945
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":849
+  /* "pgenlib.pyx":960
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if geno_int32_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  */
   __pyx_t_5 = (((__pyx_v_geno_int32_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":850
+    /* "pgenlib.pyx":961
  *             return
  *         if geno_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
-    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[0])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[0])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_Raise(__pyx_t_8, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __PYX_ERR(0, 850, __pyx_L1_error)
+    __PYX_ERR(0, 961, __pyx_L1_error)
 
-    /* "pgenlib.pyx":849
+    /* "pgenlib.pyx":960
  *                 GenoarrToInt32sMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if geno_int32_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  */
   }
 
-  /* "pgenlib.pyx":851
+  /* "pgenlib.pyx":962
  *         if geno_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   __pyx_t_5 = (((__pyx_v_geno_int32_out->dimensions[1]) < __pyx_v_variant_idx_ct) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":852
+    /* "pgenlib.pyx":963
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  */
-    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[1])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 852, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int32_out->dimensions[1])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 852, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int_2, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 852, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int_2, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 852, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 852, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 852, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 852, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 852, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 852, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_8, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __PYX_ERR(0, 852, __pyx_L1_error)
+    __PYX_ERR(0, 963, __pyx_L1_error)
 
-    /* "pgenlib.pyx":851
+    /* "pgenlib.pyx":962
  *         if geno_int32_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int32_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   }
 
-  /* "pgenlib.pyx":853
+  /* "pgenlib.pyx":964
  *         if geno_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  */
   __pyx_v_variant_batch_ct = plink2::DivUp(__pyx_v_variant_idx_ct, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":854
+  /* "pgenlib.pyx":965
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  */
   __pyx_v_variant_batch_size = plink2::kPglNypTransposeBatch;
 
-  /* "pgenlib.pyx":855
+  /* "pgenlib.pyx":966
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  */
   __pyx_v_sample_ctaw2 = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWordD2));
 
-  /* "pgenlib.pyx":856
+  /* "pgenlib.pyx":967
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  */
   __pyx_v_sample_batch_ct = plink2::DivUp(__pyx_v_subset_size, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":857
+  /* "pgenlib.pyx":968
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  */
   __pyx_t_14 = __pyx_v_self->_transpose_batch_buf;
   __pyx_v_transpose_batch_buf = __pyx_t_14;
 
-  /* "pgenlib.pyx":858
+  /* "pgenlib.pyx":969
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* vmaj_iter
  */
   __pyx_t_2 = __pyx_v_self->_multivar_vmaj_geno_buf;
   __pyx_v_multivar_vmaj_geno_buf = __pyx_t_2;
 
-  /* "pgenlib.pyx":859
+  /* "pgenlib.pyx":970
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* vmaj_iter
  *         cdef uintptr_t* smaj_iter
  */
   __pyx_t_2 = __pyx_v_self->_multivar_smaj_geno_batch_buf;
   __pyx_v_multivar_smaj_geno_batch_buf = __pyx_t_2;
 
-  /* "pgenlib.pyx":866
+  /* "pgenlib.pyx":977
  *         cdef uint32_t sample_batch_idx
  *         cdef uint32_t uii
  *         variant_list_idx = 0             # <<<<<<<<<<<<<<
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  */
   __pyx_v_variant_list_idx = 0;
 
-  /* "pgenlib.pyx":867
+  /* "pgenlib.pyx":978
  *         cdef uint32_t uii
  *         variant_list_idx = 0
  *         for variant_batch_idx in range(variant_batch_ct):             # <<<<<<<<<<<<<<
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  */
   __pyx_t_1 = __pyx_v_variant_batch_ct;
   __pyx_t_9 = __pyx_t_1;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_variant_batch_idx = __pyx_t_10;
 
-    /* "pgenlib.pyx":868
+    /* "pgenlib.pyx":979
  *         variant_list_idx = 0
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     __pyx_t_5 = ((__pyx_v_variant_batch_idx == (__pyx_v_variant_batch_ct - 1)) != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":869
+      /* "pgenlib.pyx":980
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  */
       __pyx_t_15 = (__pyx_v_variant_idx_ct - 1);
       if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(0, 869, __pyx_L1_error)
+        __PYX_ERR(0, 980, __pyx_L1_error)
       }
       __pyx_v_variant_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-      /* "pgenlib.pyx":868
+      /* "pgenlib.pyx":979
  *         variant_list_idx = 0
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     }
 
-    /* "pgenlib.pyx":870
+    /* "pgenlib.pyx":981
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":871
+    /* "pgenlib.pyx":982
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_16 = __pyx_v_variant_batch_size;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_uii = __pyx_t_18;
 
-      /* "pgenlib.pyx":872
+      /* "pgenlib.pyx":983
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_11 = (__pyx_v_uii + __pyx_v_variant_list_idx);
       __pyx_t_12 = -1;
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_12 = 0;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        __PYX_ERR(0, 872, __pyx_L1_error)
+        __PYX_ERR(0, 983, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":873
+      /* "pgenlib.pyx":984
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  */
       __pyx_t_5 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":874
+        /* "pgenlib.pyx":985
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_only); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_only); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 874, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 874, __pyx_L1_error)
+        __PYX_ERR(0, 985, __pyx_L1_error)
 
-        /* "pgenlib.pyx":873
+        /* "pgenlib.pyx":984
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  */
       }
 
-      /* "pgenlib.pyx":875
+      /* "pgenlib.pyx":986
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_list() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_vmaj_iter);
 
-      /* "pgenlib.pyx":876
+      /* "pgenlib.pyx":987
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":877
+        /* "pgenlib.pyx":988
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_list() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  */
-        __pyx_t_8 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 877, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 988, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 877, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 988, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_error, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 877, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_error, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 988, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 877, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 988, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_Raise(__pyx_t_7, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __PYX_ERR(0, 877, __pyx_L1_error)
+        __PYX_ERR(0, 988, __pyx_L1_error)
 
-        /* "pgenlib.pyx":876
+        /* "pgenlib.pyx":987
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       }
 
-      /* "pgenlib.pyx":878
+      /* "pgenlib.pyx":989
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])             # <<<<<<<<<<<<<<
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[__pyx_v_sample_ctaw2]));
     }
 
-    /* "pgenlib.pyx":879
+    /* "pgenlib.pyx":990
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  */
     __pyx_v_sample_batch_size = plink2::kPglNypTransposeBatch;
 
-    /* "pgenlib.pyx":880
+    /* "pgenlib.pyx":991
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":881
+    /* "pgenlib.pyx":992
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):             # <<<<<<<<<<<<<<
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  */
     __pyx_t_16 = __pyx_v_sample_batch_ct;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_sample_batch_idx = __pyx_t_18;
 
-      /* "pgenlib.pyx":882
+      /* "pgenlib.pyx":993
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       __pyx_t_5 = ((__pyx_v_sample_batch_idx == (__pyx_v_sample_batch_ct - 1)) != 0);
       if (__pyx_t_5) {
 
-        /* "pgenlib.pyx":883
+        /* "pgenlib.pyx":994
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  */
         __pyx_t_15 = (__pyx_v_subset_size - 1);
         if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-          __PYX_ERR(0, 883, __pyx_L1_error)
+          __PYX_ERR(0, 994, __pyx_L1_error)
         }
         __pyx_v_sample_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-        /* "pgenlib.pyx":882
+        /* "pgenlib.pyx":993
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       }
 
-      /* "pgenlib.pyx":884
+      /* "pgenlib.pyx":995
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  */
       __pyx_v_smaj_iter = __pyx_v_multivar_smaj_geno_batch_buf;
 
-      /* "pgenlib.pyx":885
+      /* "pgenlib.pyx":996
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))
  */
       plink2::TransposeNypblock(__pyx_v_vmaj_iter, __pyx_v_sample_ctaw2, plink2::kPglNypTransposeWords, __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":886
+      /* "pgenlib.pyx":997
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):             # <<<<<<<<<<<<<<
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)
  */
       __pyx_t_19 = __pyx_v_sample_batch_size;
       __pyx_t_20 = __pyx_t_19;
       for (__pyx_t_21 = 0; __pyx_t_21 < __pyx_t_20; __pyx_t_21+=1) {
         __pyx_v_uii = __pyx_t_21;
 
-        /* "pgenlib.pyx":887
+        /* "pgenlib.pyx":998
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))             # <<<<<<<<<<<<<<
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  */
         __pyx_t_11 = (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch));
         __pyx_t_22 = (__pyx_v_variant_batch_idx * plink2::kPglNypTransposeBatch);
         __pyx_t_12 = -1;
         if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int32_out.diminfo[0].shape)) __pyx_t_12 = 0;
         if (unlikely(__pyx_t_22 >= (size_t)__pyx_pybuffernd_geno_int32_out.diminfo[1].shape)) __pyx_t_12 = 1;
         if (unlikely(__pyx_t_12 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_12);
-          __PYX_ERR(0, 887, __pyx_L1_error)
+          __PYX_ERR(0, 998, __pyx_L1_error)
         }
         __pyx_v_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_geno_int32_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int32_out.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_geno_int32_out.diminfo[1].strides))));
 
-        /* "pgenlib.pyx":888
+        /* "pgenlib.pyx":999
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)             # <<<<<<<<<<<<<<
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  */
         plink2::GenoarrToInt32sMinus9(__pyx_v_smaj_iter, __pyx_v_variant_batch_size, __pyx_v_data_ptr);
 
-        /* "pgenlib.pyx":889
+        /* "pgenlib.pyx":1000
  *                     data_ptr = <int32_t*>(&(geno_int32_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_list_idx += kPglNypTransposeBatch
  */
         __pyx_v_smaj_iter = (&(__pyx_v_smaj_iter[plink2::kPglNypTransposeWords]));
       }
 
-      /* "pgenlib.pyx":890
+      /* "pgenlib.pyx":1001
  *                     GenoarrToInt32sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *             variant_list_idx += kPglNypTransposeBatch
  *         return
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[plink2::kPglNypTransposeWords]));
     }
 
-    /* "pgenlib.pyx":891
+    /* "pgenlib.pyx":1002
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_list_idx += kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     __pyx_v_variant_list_idx = (__pyx_v_variant_list_idx + plink2::kPglNypTransposeBatch);
   }
 
-  /* "pgenlib.pyx":892
+  /* "pgenlib.pyx":1003
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_list_idx += kPglNypTransposeBatch
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cdef read_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":822
+  /* "pgenlib.pyx":933
  *         return
  * 
  *     cdef read_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] geno_int32_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -13358,15 +16079,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":894
+/* "pgenlib.pyx":1005
  *         return
  * 
  *     cdef read_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -13443,349 +16164,349 @@
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   __pyx_pybuffer_geno_int64_out.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int64_out.refcount = 0;
   __pyx_pybuffernd_geno_int64_out.data = NULL;
   __pyx_pybuffernd_geno_int64_out.rcbuffer = &__pyx_pybuffer_geno_int64_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 894, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1005, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int64_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 894, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int64_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1005, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int64_out.diminfo[0].strides = __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int64_out.diminfo[0].shape = __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_geno_int64_out.diminfo[1].strides = __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_geno_int64_out.diminfo[1].shape = __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":895
+  /* "pgenlib.pyx":1006
  * 
  *     cdef read_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
   __pyx_t_1 = (__pyx_v_self->_info_ptr[0]).raw_variant_ct;
   __pyx_v_raw_variant_ct = __pyx_t_1;
 
-  /* "pgenlib.pyx":896
+  /* "pgenlib.pyx":1007
  *     cdef read_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_2 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_2;
 
-  /* "pgenlib.pyx":897
+  /* "pgenlib.pyx":1008
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_3 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_3;
 
-  /* "pgenlib.pyx":898
+  /* "pgenlib.pyx":1009
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  */
   __pyx_t_4 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_4;
 
-  /* "pgenlib.pyx":899
+  /* "pgenlib.pyx":1010
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_2 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_2;
 
-  /* "pgenlib.pyx":900
+  /* "pgenlib.pyx":1011
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int64_t* data_ptr
  */
   __pyx_v_variant_idx_ct = ((uint32_t)(__pyx_v_variant_idxs->dimensions[0]));
 
-  /* "pgenlib.pyx":901
+  /* "pgenlib.pyx":1012
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int64_t* data_ptr
  *         cdef uint32_t variant_list_idx
  */
   __pyx_t_1 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_1;
 
-  /* "pgenlib.pyx":906
+  /* "pgenlib.pyx":1017
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_5 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":907
+    /* "pgenlib.pyx":1018
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int64_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:
  */
     __pyx_t_5 = (((__pyx_v_geno_int64_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":908
+      /* "pgenlib.pyx":1019
  *         if sample_maj == 0:
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if geno_int64_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[0])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1019, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1019, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1019, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1019, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1019, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1019, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1019, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1019, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1019, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 908, __pyx_L1_error)
+      __PYX_ERR(0, 1019, __pyx_L1_error)
 
-      /* "pgenlib.pyx":907
+      /* "pgenlib.pyx":1018
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if geno_int64_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":909
+    /* "pgenlib.pyx":1020
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     __pyx_t_5 = (((__pyx_v_geno_int64_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":910
+      /* "pgenlib.pyx":1021
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  */
-      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 910, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[1])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1021, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 910, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 910, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_list_geno_int_2, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1021, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 910, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 910, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1021, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 910, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 910, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1021, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 910, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u__12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 910, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1021, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 910, __pyx_L1_error)
+      __PYX_ERR(0, 1021, __pyx_L1_error)
 
-      /* "pgenlib.pyx":909
+      /* "pgenlib.pyx":1020
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if geno_int64_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     }
 
-    /* "pgenlib.pyx":911
+    /* "pgenlib.pyx":1022
  *             if geno_int64_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_1 = __pyx_v_variant_idx_ct;
     __pyx_t_9 = __pyx_t_1;
     for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
       __pyx_v_variant_list_idx = __pyx_t_10;
 
-      /* "pgenlib.pyx":912
+      /* "pgenlib.pyx":1023
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_11 = __pyx_v_variant_list_idx;
       __pyx_t_12 = -1;
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_12 = 0;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        __PYX_ERR(0, 912, __pyx_L1_error)
+        __PYX_ERR(0, 1023, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":913
+      /* "pgenlib.pyx":1024
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  */
       __pyx_t_5 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":914
+        /* "pgenlib.pyx":1025
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 914, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1025, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 914, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1025, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 914, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1025, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_only); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 914, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_only); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1025, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 914, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1025, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 914, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1025, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 914, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1025, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 914, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1025, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 914, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1025, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_Raise(__pyx_t_6, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __PYX_ERR(0, 914, __pyx_L1_error)
+        __PYX_ERR(0, 1025, __pyx_L1_error)
 
-        /* "pgenlib.pyx":913
+        /* "pgenlib.pyx":1024
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  */
       }
 
-      /* "pgenlib.pyx":915
+      /* "pgenlib.pyx":1026
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec);
 
-      /* "pgenlib.pyx":916
+      /* "pgenlib.pyx":1027
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int64_out[variant_list_idx, 0])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":917
+        /* "pgenlib.pyx":1028
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data_ptr = &(geno_int64_out[variant_list_idx, 0])
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  */
-        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 917, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1028, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 917, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1028, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 917, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1028, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 917, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1028, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 917, __pyx_L1_error)
+        __PYX_ERR(0, 1028, __pyx_L1_error)
 
-        /* "pgenlib.pyx":916
+        /* "pgenlib.pyx":1027
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int64_out[variant_list_idx, 0])
  */
       }
 
-      /* "pgenlib.pyx":918
+      /* "pgenlib.pyx":1029
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int64_out[variant_list_idx, 0])             # <<<<<<<<<<<<<<
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  *             return
  */
       __pyx_t_11 = __pyx_v_variant_list_idx;
@@ -13794,595 +16515,595 @@
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int64_out.diminfo[0].shape)) __pyx_t_12 = 0;
       if (__pyx_t_13 < 0) {
         __pyx_t_13 += __pyx_pybuffernd_geno_int64_out.diminfo[1].shape;
         if (unlikely(__pyx_t_13 < 0)) __pyx_t_12 = 1;
       } else if (unlikely(__pyx_t_13 >= __pyx_pybuffernd_geno_int64_out.diminfo[1].shape)) __pyx_t_12 = 1;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        __PYX_ERR(0, 918, __pyx_L1_error)
+        __PYX_ERR(0, 1029, __pyx_L1_error)
       }
       __pyx_v_data_ptr = ((int64_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int64_out.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_geno_int64_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":919
+      /* "pgenlib.pyx":1030
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data_ptr = &(geno_int64_out[variant_list_idx, 0])
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         if geno_int64_out.shape[0] < subset_size:
  */
       plink2::GenoarrToInt64sMinus9(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data_ptr);
     }
 
-    /* "pgenlib.pyx":920
+    /* "pgenlib.pyx":1031
  *                 data_ptr = &(geno_int64_out[variant_list_idx, 0])
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         if geno_int64_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":906
+    /* "pgenlib.pyx":1017
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if geno_int64_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":921
+  /* "pgenlib.pyx":1032
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if geno_int64_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  */
   __pyx_t_5 = (((__pyx_v_geno_int64_out->dimensions[0]) < __pyx_v_subset_size) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":922
+    /* "pgenlib.pyx":1033
  *             return
  *         if geno_int64_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
-    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[0])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[0])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1033, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1033, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1033, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1033, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1033, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1033, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1033, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1033, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1033, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_Raise(__pyx_t_8, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __PYX_ERR(0, 922, __pyx_L1_error)
+    __PYX_ERR(0, 1033, __pyx_L1_error)
 
-    /* "pgenlib.pyx":921
+    /* "pgenlib.pyx":1032
  *                 GenoarrToInt64sMinus9(genovec, subset_size, data_ptr)
  *             return
  *         if geno_int64_out.shape[0] < subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  */
   }
 
-  /* "pgenlib.pyx":923
+  /* "pgenlib.pyx":1034
  *         if geno_int64_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   __pyx_t_5 = (((__pyx_v_geno_int64_out->dimensions[1]) < __pyx_v_variant_idx_ct) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":924
+    /* "pgenlib.pyx":1035
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  */
-    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[1])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_geno_int64_out->dimensions[1])); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int_2, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Sample_major_read_list_geno_int_2, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1035, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_8, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __PYX_ERR(0, 924, __pyx_L1_error)
+    __PYX_ERR(0, 1035, __pyx_L1_error)
 
-    /* "pgenlib.pyx":923
+    /* "pgenlib.pyx":1034
  *         if geno_int64_out.shape[0] < subset_size:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few rows (" + str(geno_int64_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ")")
  *         if geno_int64_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   }
 
-  /* "pgenlib.pyx":925
+  /* "pgenlib.pyx":1036
  *         if geno_int64_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  */
   __pyx_v_variant_batch_ct = plink2::DivUp(__pyx_v_variant_idx_ct, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":926
+  /* "pgenlib.pyx":1037
  *             raise RuntimeError("Sample-major read_list() geno_int_out buffer has too few columns (" + str(geno_int64_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  */
   __pyx_v_variant_batch_size = plink2::kPglNypTransposeBatch;
 
-  /* "pgenlib.pyx":927
+  /* "pgenlib.pyx":1038
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  */
   __pyx_v_sample_ctaw2 = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWordD2));
 
-  /* "pgenlib.pyx":928
+  /* "pgenlib.pyx":1039
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  */
   __pyx_v_sample_batch_ct = plink2::DivUp(__pyx_v_subset_size, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":929
+  /* "pgenlib.pyx":1040
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  */
   __pyx_t_14 = __pyx_v_self->_transpose_batch_buf;
   __pyx_v_transpose_batch_buf = __pyx_t_14;
 
-  /* "pgenlib.pyx":930
+  /* "pgenlib.pyx":1041
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* vmaj_iter
  */
   __pyx_t_2 = __pyx_v_self->_multivar_vmaj_geno_buf;
   __pyx_v_multivar_vmaj_geno_buf = __pyx_t_2;
 
-  /* "pgenlib.pyx":931
+  /* "pgenlib.pyx":1042
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* vmaj_iter
  *         cdef uintptr_t* smaj_iter
  */
   __pyx_t_2 = __pyx_v_self->_multivar_smaj_geno_batch_buf;
   __pyx_v_multivar_smaj_geno_batch_buf = __pyx_t_2;
 
-  /* "pgenlib.pyx":938
+  /* "pgenlib.pyx":1049
  *         cdef uint32_t sample_batch_idx
  *         cdef uint32_t uii
  *         variant_list_idx = 0             # <<<<<<<<<<<<<<
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  */
   __pyx_v_variant_list_idx = 0;
 
-  /* "pgenlib.pyx":939
+  /* "pgenlib.pyx":1050
  *         cdef uint32_t uii
  *         variant_list_idx = 0
  *         for variant_batch_idx in range(variant_batch_ct):             # <<<<<<<<<<<<<<
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  */
   __pyx_t_1 = __pyx_v_variant_batch_ct;
   __pyx_t_9 = __pyx_t_1;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_variant_batch_idx = __pyx_t_10;
 
-    /* "pgenlib.pyx":940
+    /* "pgenlib.pyx":1051
  *         variant_list_idx = 0
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     __pyx_t_5 = ((__pyx_v_variant_batch_idx == (__pyx_v_variant_batch_ct - 1)) != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":941
+      /* "pgenlib.pyx":1052
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  */
       __pyx_t_15 = (__pyx_v_variant_idx_ct - 1);
       if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(0, 941, __pyx_L1_error)
+        __PYX_ERR(0, 1052, __pyx_L1_error)
       }
       __pyx_v_variant_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-      /* "pgenlib.pyx":940
+      /* "pgenlib.pyx":1051
  *         variant_list_idx = 0
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
     }
 
-    /* "pgenlib.pyx":942
+    /* "pgenlib.pyx":1053
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":943
+    /* "pgenlib.pyx":1054
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_16 = __pyx_v_variant_batch_size;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_uii = __pyx_t_18;
 
-      /* "pgenlib.pyx":944
+      /* "pgenlib.pyx":1055
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_11 = (__pyx_v_uii + __pyx_v_variant_list_idx);
       __pyx_t_12 = -1;
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_12 = 0;
       if (unlikely(__pyx_t_12 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_12);
-        __PYX_ERR(0, 944, __pyx_L1_error)
+        __PYX_ERR(0, 1055, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":945
+      /* "pgenlib.pyx":1056
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  */
       __pyx_t_5 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":946
+        /* "pgenlib.pyx":1057
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 946, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 946, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1057, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 946, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_variant_index_too_larg, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_only); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 946, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_only); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1057, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 946, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 946, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1057, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 946, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 946, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1057, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 946, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 946, __pyx_L1_error)
+        __PYX_ERR(0, 1057, __pyx_L1_error)
 
-        /* "pgenlib.pyx":945
+        /* "pgenlib.pyx":1056
  *             for uii in range(variant_batch_size):
  *                 variant_idx = variant_idxs[uii + variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  */
       }
 
-      /* "pgenlib.pyx":947
+      /* "pgenlib.pyx":1058
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_list() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_vmaj_iter);
 
-      /* "pgenlib.pyx":948
+      /* "pgenlib.pyx":1059
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_5)) {
 
-        /* "pgenlib.pyx":949
+        /* "pgenlib.pyx":1060
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_list() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  */
-        __pyx_t_8 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 949, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1060, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 949, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1060, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_error, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 949, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_list_error, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1060, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 949, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1060, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_Raise(__pyx_t_7, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __PYX_ERR(0, 949, __pyx_L1_error)
+        __PYX_ERR(0, 1060, __pyx_L1_error)
 
-        /* "pgenlib.pyx":948
+        /* "pgenlib.pyx":1059
  *                     raise RuntimeError("read_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, vmaj_iter)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  */
       }
 
-      /* "pgenlib.pyx":950
+      /* "pgenlib.pyx":1061
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])             # <<<<<<<<<<<<<<
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[__pyx_v_sample_ctaw2]));
     }
 
-    /* "pgenlib.pyx":951
+    /* "pgenlib.pyx":1062
  *                     raise RuntimeError("read_list() error " + str(reterr))
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  */
     __pyx_v_sample_batch_size = plink2::kPglNypTransposeBatch;
 
-    /* "pgenlib.pyx":952
+    /* "pgenlib.pyx":1063
  *                 vmaj_iter = &(vmaj_iter[sample_ctaw2])
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  */
     __pyx_v_vmaj_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":953
+    /* "pgenlib.pyx":1064
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):             # <<<<<<<<<<<<<<
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  */
     __pyx_t_16 = __pyx_v_sample_batch_ct;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_sample_batch_idx = __pyx_t_18;
 
-      /* "pgenlib.pyx":954
+      /* "pgenlib.pyx":1065
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       __pyx_t_5 = ((__pyx_v_sample_batch_idx == (__pyx_v_sample_batch_ct - 1)) != 0);
       if (__pyx_t_5) {
 
-        /* "pgenlib.pyx":955
+        /* "pgenlib.pyx":1066
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  */
         __pyx_t_15 = (__pyx_v_subset_size - 1);
         if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-          __PYX_ERR(0, 955, __pyx_L1_error)
+          __PYX_ERR(0, 1066, __pyx_L1_error)
         }
         __pyx_v_sample_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_15, plink2::kPglNypTransposeBatch)));
 
-        /* "pgenlib.pyx":954
+        /* "pgenlib.pyx":1065
  *             vmaj_iter = multivar_vmaj_geno_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  */
       }
 
-      /* "pgenlib.pyx":956
+      /* "pgenlib.pyx":1067
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  */
       __pyx_v_smaj_iter = __pyx_v_multivar_smaj_geno_batch_buf;
 
-      /* "pgenlib.pyx":957
+      /* "pgenlib.pyx":1068
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  */
       plink2::TransposeNypblock(__pyx_v_vmaj_iter, __pyx_v_sample_ctaw2, plink2::kPglNypTransposeWords, __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":958
+      /* "pgenlib.pyx":1069
  *                 smaj_iter = multivar_smaj_geno_batch_buf
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):             # <<<<<<<<<<<<<<
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)
  */
       __pyx_t_19 = __pyx_v_sample_batch_size;
       __pyx_t_20 = __pyx_t_19;
       for (__pyx_t_21 = 0; __pyx_t_21 < __pyx_t_20; __pyx_t_21+=1) {
         __pyx_v_uii = __pyx_t_21;
 
-        /* "pgenlib.pyx":959
+        /* "pgenlib.pyx":1070
  *                 TransposeNypblock(vmaj_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])             # <<<<<<<<<<<<<<
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  */
         __pyx_t_11 = (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch));
         __pyx_t_22 = (__pyx_v_variant_batch_idx * plink2::kPglNypTransposeBatch);
         __pyx_t_12 = -1;
         if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_geno_int64_out.diminfo[0].shape)) __pyx_t_12 = 0;
         if (unlikely(__pyx_t_22 >= (size_t)__pyx_pybuffernd_geno_int64_out.diminfo[1].shape)) __pyx_t_12 = 1;
         if (unlikely(__pyx_t_12 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_12);
-          __PYX_ERR(0, 959, __pyx_L1_error)
+          __PYX_ERR(0, 1070, __pyx_L1_error)
         }
         __pyx_v_data_ptr = ((int64_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int64_t *, __pyx_pybuffernd_geno_int64_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_geno_int64_out.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_geno_int64_out.diminfo[1].strides))));
 
-        /* "pgenlib.pyx":960
+        /* "pgenlib.pyx":1071
  *                 for uii in range(sample_batch_size):
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)             # <<<<<<<<<<<<<<
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  */
         plink2::GenoarrToInt64sMinus9(__pyx_v_smaj_iter, __pyx_v_variant_batch_size, __pyx_v_data_ptr);
 
-        /* "pgenlib.pyx":961
+        /* "pgenlib.pyx":1072
  *                     data_ptr = &(geno_int64_out[uii + sample_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch])
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_list_idx += kPglNypTransposeBatch
  */
         __pyx_v_smaj_iter = (&(__pyx_v_smaj_iter[plink2::kPglNypTransposeWords]));
       }
 
-      /* "pgenlib.pyx":962
+      /* "pgenlib.pyx":1073
  *                     GenoarrToInt64sMinus9(smaj_iter, variant_batch_size, data_ptr)
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *             variant_list_idx += kPglNypTransposeBatch
  *         return
  */
       __pyx_v_vmaj_iter = (&(__pyx_v_vmaj_iter[plink2::kPglNypTransposeWords]));
     }
 
-    /* "pgenlib.pyx":963
+    /* "pgenlib.pyx":1074
  *                     smaj_iter = &(smaj_iter[kPglNypTransposeWords])
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_list_idx += kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     __pyx_v_variant_list_idx = (__pyx_v_variant_list_idx + plink2::kPglNypTransposeBatch);
   }
 
-  /* "pgenlib.pyx":964
+  /* "pgenlib.pyx":1075
  *                 vmaj_iter = &(vmaj_iter[kPglNypTransposeWords])
  *             variant_list_idx += kPglNypTransposeBatch
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cpdef read_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":894
+  /* "pgenlib.pyx":1005
  *         return
  * 
  *     cdef read_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int64_t,mode="c",ndim=2] geno_int64_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -14406,15 +17127,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":966
+/* "pgenlib.pyx":1077
  *         return
  * 
  *     cpdef read_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if geno_int_out.dtype == np.int8:
  *             self.read_list_internal8(variant_idxs, geno_int_out, allele_idx, sample_maj)
  */
 
@@ -14452,33 +17173,33 @@
   }
   __pyx_pybuffer_variant_idxs.pybuffer.buf = NULL;
   __pyx_pybuffer_variant_idxs.refcount = 0;
   __pyx_pybuffernd_variant_idxs.data = NULL;
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 966, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1077, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 966, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_21read_list)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_sample_maj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 966, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_sample_maj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1077, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
         __pyx_t_7 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
           if (likely(__pyx_t_6)) {
@@ -14488,33 +17209,33 @@
             __Pyx_DECREF_SET(__pyx_t_5, function);
             __pyx_t_7 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[5] = {__pyx_t_6, ((PyObject *)__pyx_v_variant_idxs), ((PyObject *)__pyx_v_geno_int_out), __pyx_t_3, __pyx_t_4};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1077, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[5] = {__pyx_t_6, ((PyObject *)__pyx_v_variant_idxs), ((PyObject *)__pyx_v_geno_int_out), __pyx_t_3, __pyx_t_4};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1077, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         {
-          __pyx_t_8 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 966, __pyx_L1_error)
+          __pyx_t_8 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1077, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           if (__pyx_t_6) {
             __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
           }
           __Pyx_INCREF(((PyObject *)__pyx_v_variant_idxs));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_variant_idxs));
           PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, ((PyObject *)__pyx_v_variant_idxs));
@@ -14523,15 +17244,15 @@
           PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, ((PyObject *)__pyx_v_geno_int_out));
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_8, 3+__pyx_t_7, __pyx_t_4);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1077, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -14546,177 +17267,177 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":967
+  /* "pgenlib.pyx":1078
  * 
  *     cpdef read_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if geno_int_out.dtype == np.int8:             # <<<<<<<<<<<<<<
  *             self.read_list_internal8(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_9) {
 
-    /* "pgenlib.pyx":968
+    /* "pgenlib.pyx":1079
  *     cpdef read_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if geno_int_out.dtype == np.int8:
  *             self.read_list_internal8(variant_idxs, geno_int_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         elif geno_int_out.dtype == np.int32:
  *             self.read_list_internal32(variant_idxs, geno_int_out, allele_idx, sample_maj)
  */
     __pyx_t_10.__pyx_n = 2;
     __pyx_t_10.allele_idx = __pyx_v_allele_idx;
     __pyx_t_10.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_list_internal8(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 968, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_list_internal8(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1079, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pgenlib.pyx":967
+    /* "pgenlib.pyx":1078
  * 
  *     cpdef read_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if geno_int_out.dtype == np.int8:             # <<<<<<<<<<<<<<
  *             self.read_list_internal8(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:
  */
     goto __pyx_L3;
   }
 
-  /* "pgenlib.pyx":969
+  /* "pgenlib.pyx":1080
  *         if geno_int_out.dtype == np.int8:
  *             self.read_list_internal8(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:             # <<<<<<<<<<<<<<
  *             self.read_list_internal32(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1080, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1080, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1080, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1080, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_9) {
 
-    /* "pgenlib.pyx":970
+    /* "pgenlib.pyx":1081
  *             self.read_list_internal8(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:
  *             self.read_list_internal32(variant_idxs, geno_int_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         elif geno_int_out.dtype == np.int64:
  *             self.read_list_internal64(variant_idxs, geno_int_out, allele_idx, sample_maj)
  */
     __pyx_t_11.__pyx_n = 2;
     __pyx_t_11.allele_idx = __pyx_v_allele_idx;
     __pyx_t_11.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_5 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_list_internal32(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 970, __pyx_L1_error)
+    __pyx_t_5 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_list_internal32(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1081, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pgenlib.pyx":969
+    /* "pgenlib.pyx":1080
  *         if geno_int_out.dtype == np.int8:
  *             self.read_list_internal8(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int32:             # <<<<<<<<<<<<<<
  *             self.read_list_internal32(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:
  */
     goto __pyx_L3;
   }
 
-  /* "pgenlib.pyx":971
+  /* "pgenlib.pyx":1082
  *         elif geno_int_out.dtype == np.int32:
  *             self.read_list_internal32(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:             # <<<<<<<<<<<<<<
  *             self.read_list_internal64(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         else:
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 971, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_geno_int_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 971, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 971, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(__pyx_t_5, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 971, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_t_5, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 971, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (likely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":972
+    /* "pgenlib.pyx":1083
  *             self.read_list_internal32(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:
  *             self.read_list_internal64(variant_idxs, geno_int_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         else:
  *             raise RuntimeError("Invalid read_list() geno_int_out array element type (int8, int32, or int64 expected).")
  */
     __pyx_t_12.__pyx_n = 2;
     __pyx_t_12.allele_idx = __pyx_v_allele_idx;
     __pyx_t_12.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_list_internal64(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 972, __pyx_L1_error)
+    __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_list_internal64(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_geno_int_out), &__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1083, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pgenlib.pyx":971
+    /* "pgenlib.pyx":1082
  *         elif geno_int_out.dtype == np.int32:
  *             self.read_list_internal32(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         elif geno_int_out.dtype == np.int64:             # <<<<<<<<<<<<<<
  *             self.read_list_internal64(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "pgenlib.pyx":974
+  /* "pgenlib.pyx":1085
  *             self.read_list_internal64(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         else:
  *             raise RuntimeError("Invalid read_list() geno_int_out array element type (int8, int32, or int64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   /*else*/ {
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 974, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1085, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 974, __pyx_L1_error)
+    __PYX_ERR(0, 1085, __pyx_L1_error)
   }
   __pyx_L3:;
 
-  /* "pgenlib.pyx":975
+  /* "pgenlib.pyx":1086
  *         else:
  *             raise RuntimeError("Invalid read_list() geno_int_out array element type (int8, int32, or int64 expected).")
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":966
+  /* "pgenlib.pyx":1077
  *         return
  * 
  *     cpdef read_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray geno_int_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if geno_int_out.dtype == np.int8:
  *             self.read_list_internal8(variant_idxs, geno_int_out, allele_idx, sample_maj)
  */
 
@@ -14782,15 +17503,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idxs)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_geno_int_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_list", 0, 2, 4, 1); __PYX_ERR(0, 966, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_list", 0, 2, 4, 1); __PYX_ERR(0, 1077, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_idx);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -14798,15 +17519,15 @@
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sample_maj);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_list") < 0)) __PYX_ERR(0, 966, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_list") < 0)) __PYX_ERR(0, 1077, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
@@ -14815,34 +17536,34 @@
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_variant_idxs = ((PyArrayObject *)values[0]);
     __pyx_v_geno_int_out = ((PyArrayObject *)values[1]);
     if (values[2]) {
-      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[2]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L3_error)
+      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[2]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1077, __pyx_L3_error)
     } else {
       __pyx_v_allele_idx = ((uint32_t)1);
     }
     if (values[3]) {
-      __pyx_v_sample_maj = __Pyx_PyObject_IsTrue(values[3]); if (unlikely((__pyx_v_sample_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L3_error)
+      __pyx_v_sample_maj = __Pyx_PyObject_IsTrue(values[3]); if (unlikely((__pyx_v_sample_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1077, __pyx_L3_error)
     } else {
       __pyx_v_sample_maj = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_list", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 966, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_list", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1077, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_variant_idxs), __pyx_ptype_5numpy_ndarray, 1, "variant_idxs", 0))) __PYX_ERR(0, 966, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int_out), __pyx_ptype_5numpy_ndarray, 1, "geno_int_out", 0))) __PYX_ERR(0, 966, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_variant_idxs), __pyx_ptype_5numpy_ndarray, 1, "variant_idxs", 0))) __PYX_ERR(0, 1077, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int_out), __pyx_ptype_5numpy_ndarray, 1, "geno_int_out", 0))) __PYX_ERR(0, 1077, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_20read_list(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idxs, __pyx_v_geno_int_out, __pyx_v_allele_idx, __pyx_v_sample_maj);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -14863,22 +17584,22 @@
   __Pyx_RefNannySetupContext("read_list", 0);
   __pyx_pybuffer_variant_idxs.pybuffer.buf = NULL;
   __pyx_pybuffer_variant_idxs.refcount = 0;
   __pyx_pybuffernd_variant_idxs.data = NULL;
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 966, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1077, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.allele_idx = __pyx_v_allele_idx;
   __pyx_t_2.sample_maj = __pyx_v_sample_maj;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_list(__pyx_v_self, __pyx_v_variant_idxs, __pyx_v_geno_int_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 966, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_list(__pyx_v_self, __pyx_v_variant_idxs, __pyx_v_geno_int_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -14896,15 +17617,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":978
+/* "pgenlib.pyx":1089
  * 
  * 
  *     cpdef read_alleles_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 
@@ -14986,35 +17707,35 @@
   }
   __pyx_pybuffer_allele_int32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32_out.refcount = 0;
   __pyx_pybuffernd_allele_int32_out.data = NULL;
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 978, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1089, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_out.diminfo[1].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_out.diminfo[1].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[1];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 978, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_23read_alleles_range)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 978, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1089, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 978, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1089, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = __Pyx_PyBool_FromLong(__pyx_v_hap_maj); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 978, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyBool_FromLong(__pyx_v_hap_maj); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1089, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_6 = __pyx_t_1; __pyx_t_7 = NULL;
         __pyx_t_8 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_7)) {
@@ -15024,35 +17745,35 @@
             __Pyx_DECREF_SET(__pyx_t_6, function);
             __pyx_t_8 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_6)) {
           PyObject *__pyx_temp[5] = {__pyx_t_7, __pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_allele_int32_out), __pyx_t_5};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 978, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1089, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
           PyObject *__pyx_temp[5] = {__pyx_t_7, __pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_allele_int32_out), __pyx_t_5};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 978, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1089, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         {
-          __pyx_t_9 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 978, __pyx_L1_error)
+          __pyx_t_9 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1089, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           if (__pyx_t_7) {
             __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
@@ -15061,15 +17782,15 @@
           __Pyx_GIVEREF(((PyObject *)__pyx_v_allele_int32_out));
           PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_8, ((PyObject *)__pyx_v_allele_int32_out));
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_8, __pyx_t_5);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 978, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1089, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         }
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -15084,346 +17805,346 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":983
+  /* "pgenlib.pyx":1094
  *         # if hap_maj == True, allele_int32_out must have at least 2 * sample_ct
  *         #   rows, variant_idx_ct columns
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
   __pyx_t_10 = ((__pyx_v_variant_idx_end > (__pyx_v_self->_info_ptr[0]).raw_variant_ct) != 0);
   if (unlikely(__pyx_t_10)) {
 
-    /* "pgenlib.pyx":984
+    /* "pgenlib.pyx":1095
  *         #   rows, variant_idx_ct columns
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 984, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1095, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_range_variant_idx_e, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_range_variant_idx_e, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 984, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1095, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 984, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1095, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 984, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1095, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 984, __pyx_L1_error)
+    __PYX_ERR(0, 1095, __pyx_L1_error)
 
-    /* "pgenlib.pyx":983
+    /* "pgenlib.pyx":1094
  *         # if hap_maj == True, allele_int32_out must have at least 2 * sample_ct
  *         #   rows, variant_idx_ct columns
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
   }
 
-  /* "pgenlib.pyx":985
+  /* "pgenlib.pyx":1096
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_11 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_11;
 
-  /* "pgenlib.pyx":986
+  /* "pgenlib.pyx":1097
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_12 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_12;
 
-  /* "pgenlib.pyx":987
+  /* "pgenlib.pyx":1098
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  */
   __pyx_t_13 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_13;
 
-  /* "pgenlib.pyx":988
+  /* "pgenlib.pyx":1099
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  */
   __pyx_t_11 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_11;
 
-  /* "pgenlib.pyx":989
+  /* "pgenlib.pyx":1100
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  */
   __pyx_t_11 = __pyx_v_self->_pgv.phasepresent;
   __pyx_v_phasepresent = __pyx_t_11;
 
-  /* "pgenlib.pyx":990
+  /* "pgenlib.pyx":1101
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_11 = __pyx_v_self->_pgv.phaseinfo;
   __pyx_v_phaseinfo = __pyx_t_11;
 
-  /* "pgenlib.pyx":991
+  /* "pgenlib.pyx":1102
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int32_t* main_data_ptr
  */
   __pyx_v_variant_idx_ct = (__pyx_v_variant_idx_end - __pyx_v_variant_idx_start);
 
-  /* "pgenlib.pyx":992
+  /* "pgenlib.pyx":1103
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int32_t* main_data_ptr
  *         cdef uint32_t variant_idx
  */
   __pyx_t_14 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_14;
 
-  /* "pgenlib.pyx":996
+  /* "pgenlib.pyx":1107
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if hap_maj == 0:             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_10 = ((__pyx_v_hap_maj == 0) != 0);
   if (__pyx_t_10) {
 
-    /* "pgenlib.pyx":997
+    /* "pgenlib.pyx":1108
  *         cdef PglErr reterr
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  */
     __pyx_t_10 = (((__pyx_v_allele_int32_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_10)) {
 
-      /* "pgenlib.pyx":998
+      /* "pgenlib.pyx":1109
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 998, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1109, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 998, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1109, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 998, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 998, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__12); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 998, __pyx_L1_error)
+      __PYX_ERR(0, 1109, __pyx_L1_error)
 
-      /* "pgenlib.pyx":997
+      /* "pgenlib.pyx":1108
  *         cdef PglErr reterr
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  */
     }
 
-    /* "pgenlib.pyx":999
+    /* "pgenlib.pyx":1110
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     __pyx_t_10 = (((__pyx_v_allele_int32_out->dimensions[1]) < (2 * __pyx_v_subset_size)) != 0);
     if (unlikely(__pyx_t_10)) {
 
-      /* "pgenlib.pyx":1000
+      /* "pgenlib.pyx":1111
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")             # <<<<<<<<<<<<<<
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1111, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_range_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_range_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1111, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1111, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1111, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1111, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1111, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1111, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1000, __pyx_L1_error)
+      __PYX_ERR(0, 1111, __pyx_L1_error)
 
-      /* "pgenlib.pyx":999
+      /* "pgenlib.pyx":1110
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     }
 
-    /* "pgenlib.pyx":1001
+    /* "pgenlib.pyx":1112
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_14 = __pyx_v_variant_idx_end;
     __pyx_t_15 = __pyx_t_14;
     for (__pyx_t_16 = __pyx_v_variant_idx_start; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
       __pyx_v_variant_idx = __pyx_t_16;
 
-      /* "pgenlib.pyx":1002
+      /* "pgenlib.pyx":1113
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGetMP(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_pgrp, (&__pyx_v_self->_pgv));
 
-      /* "pgenlib.pyx":1003
+      /* "pgenlib.pyx":1114
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_range() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  */
       __pyx_t_10 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_10)) {
 
-        /* "pgenlib.pyx":1004
+        /* "pgenlib.pyx":1115
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  */
-        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1004, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1115, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_variant_idx_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_variant_idx_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_read_alleles_range_error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1004, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_read_alleles_range_error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1115, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1004, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1115, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1004, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1115, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_Raise(__pyx_t_2, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __PYX_ERR(0, 1004, __pyx_L1_error)
+        __PYX_ERR(0, 1115, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1003
+        /* "pgenlib.pyx":1114
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_range() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  */
       }
 
-      /* "pgenlib.pyx":1005
+      /* "pgenlib.pyx":1116
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_range() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))             # <<<<<<<<<<<<<<
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *             return
  */
       __pyx_t_17 = (__pyx_v_variant_idx - __pyx_v_variant_idx_start);
@@ -15432,704 +18153,704 @@
       if (unlikely(__pyx_t_17 >= (size_t)__pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_8 = 0;
       if (__pyx_t_18 < 0) {
         __pyx_t_18 += __pyx_pybuffernd_allele_int32_out.diminfo[1].shape;
         if (unlikely(__pyx_t_18 < 0)) __pyx_t_8 = 1;
       } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_allele_int32_out.diminfo[1].shape)) __pyx_t_8 = 1;
       if (unlikely(__pyx_t_8 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_8);
-        __PYX_ERR(0, 1005, __pyx_L1_error)
+        __PYX_ERR(0, 1116, __pyx_L1_error)
       }
       __pyx_v_main_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_allele_int32_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1006
+      /* "pgenlib.pyx":1117
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_range() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         if variant_idx_start >= variant_idx_end:
  */
       plink2::GenoarrMPToAlleleCodesMinus9((&__pyx_v_self->_pgv), __pyx_v_subset_size, NULL, __pyx_v_main_data_ptr);
     }
 
-    /* "pgenlib.pyx":1007
+    /* "pgenlib.pyx":1118
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_alleles_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":996
+    /* "pgenlib.pyx":1107
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if hap_maj == 0:             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":1008
+  /* "pgenlib.pyx":1119
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *             return
  *         if variant_idx_start >= variant_idx_end:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  */
   __pyx_t_10 = ((__pyx_v_variant_idx_start >= __pyx_v_variant_idx_end) != 0);
   if (unlikely(__pyx_t_10)) {
 
-    /* "pgenlib.pyx":1009
+    /* "pgenlib.pyx":1120
  *             return
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_alleles_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")             # <<<<<<<<<<<<<<
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  */
-    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1120, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1120, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_range_variant_idx_s, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_range_variant_idx_s, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1120, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u__10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u__13); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1120, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1120, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1120, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1120, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1120, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1120, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1009, __pyx_L1_error)
+    __PYX_ERR(0, 1120, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1008
+    /* "pgenlib.pyx":1119
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *             return
  *         if variant_idx_start >= variant_idx_end:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  */
   }
 
-  /* "pgenlib.pyx":1010
+  /* "pgenlib.pyx":1121
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_alleles_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if allele_int32_out.shape[0] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  */
   __pyx_t_10 = (((__pyx_v_allele_int32_out->dimensions[0]) < (2 * __pyx_v_subset_size)) != 0);
   if (unlikely(__pyx_t_10)) {
 
-    /* "pgenlib.pyx":1011
+    /* "pgenlib.pyx":1122
  *             raise RuntimeError("read_alleles_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")             # <<<<<<<<<<<<<<
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
-    __pyx_t_2 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1011, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Haplotype_major_read_alleles_ran, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Haplotype_major_read_alleles_ran, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1011, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1011, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u_and_row_count_should_be_twice_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1011, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u_and_row_count_should_be_twice_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1011, __pyx_L1_error)
+    __PYX_ERR(0, 1122, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1010
+    /* "pgenlib.pyx":1121
  *         if variant_idx_start >= variant_idx_end:
  *             raise RuntimeError("read_alleles_range() variant_idx_start >= variant_idx_end (" + str(variant_idx_start) + ", " + str(variant_idx_end) + ")")
  *         if allele_int32_out.shape[0] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  */
   }
 
-  /* "pgenlib.pyx":1012
+  /* "pgenlib.pyx":1123
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  */
   __pyx_t_10 = (((__pyx_v_allele_int32_out->dimensions[1]) < __pyx_v_variant_idx_ct) != 0);
   if (unlikely(__pyx_t_10)) {
 
-    /* "pgenlib.pyx":1013
+    /* "pgenlib.pyx":1124
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *         if allele_idx_offsets != NULL:
  */
-    __pyx_t_2 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1013, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Haplotype_major_read_alleles_ran_2, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Haplotype_major_read_alleles_ran_2, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1013, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1013, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1013, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1013, __pyx_L1_error)
+    __PYX_ERR(0, 1124, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1012
+    /* "pgenlib.pyx":1123
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  */
   }
 
-  /* "pgenlib.pyx":1014
+  /* "pgenlib.pyx":1125
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets             # <<<<<<<<<<<<<<
  *         if allele_idx_offsets != NULL:
  *             if allele_idx_offsets[variant_idx_end] - allele_idx_offsets[variant_idx_start] != (variant_idx_end - variant_idx_start) * k1LU * 2:
  */
   __pyx_t_11 = (__pyx_v_self->_info_ptr[0]).allele_idx_offsets;
   __pyx_v_allele_idx_offsets = __pyx_t_11;
 
-  /* "pgenlib.pyx":1015
+  /* "pgenlib.pyx":1126
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *         if allele_idx_offsets != NULL:             # <<<<<<<<<<<<<<
  *             if allele_idx_offsets[variant_idx_end] - allele_idx_offsets[variant_idx_start] != (variant_idx_end - variant_idx_start) * k1LU * 2:
  *                 raise RuntimeError("Haplotype-major read_alleles_range() doesn't support multiallelic variants yet.")
  */
   __pyx_t_10 = ((__pyx_v_allele_idx_offsets != NULL) != 0);
   if (__pyx_t_10) {
 
-    /* "pgenlib.pyx":1016
+    /* "pgenlib.pyx":1127
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *         if allele_idx_offsets != NULL:
  *             if allele_idx_offsets[variant_idx_end] - allele_idx_offsets[variant_idx_start] != (variant_idx_end - variant_idx_start) * k1LU * 2:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Haplotype-major read_alleles_range() doesn't support multiallelic variants yet.")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
     __pyx_t_10 = ((((__pyx_v_allele_idx_offsets[__pyx_v_variant_idx_end]) - (__pyx_v_allele_idx_offsets[__pyx_v_variant_idx_start])) != (((__pyx_v_variant_idx_end - __pyx_v_variant_idx_start) * plink2::k1LU) * 2)) != 0);
     if (unlikely(__pyx_t_10)) {
 
-      /* "pgenlib.pyx":1017
+      /* "pgenlib.pyx":1128
  *         if allele_idx_offsets != NULL:
  *             if allele_idx_offsets[variant_idx_end] - allele_idx_offsets[variant_idx_start] != (variant_idx_end - variant_idx_start) * k1LU * 2:
  *                 raise RuntimeError("Haplotype-major read_alleles_range() doesn't support multiallelic variants yet.")             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  */
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1017, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1128, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1017, __pyx_L1_error)
+      __PYX_ERR(0, 1128, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1016
+      /* "pgenlib.pyx":1127
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *         if allele_idx_offsets != NULL:
  *             if allele_idx_offsets[variant_idx_end] - allele_idx_offsets[variant_idx_start] != (variant_idx_end - variant_idx_start) * k1LU * 2:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Haplotype-major read_alleles_range() doesn't support multiallelic variants yet.")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
     }
 
-    /* "pgenlib.pyx":1015
+    /* "pgenlib.pyx":1126
  *             raise RuntimeError("Haplotype-major read_alleles_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *         if allele_idx_offsets != NULL:             # <<<<<<<<<<<<<<
  *             if allele_idx_offsets[variant_idx_end] - allele_idx_offsets[variant_idx_start] != (variant_idx_end - variant_idx_start) * k1LU * 2:
  *                 raise RuntimeError("Haplotype-major read_alleles_range() doesn't support multiallelic variants yet.")
  */
   }
 
-  /* "pgenlib.pyx":1018
+  /* "pgenlib.pyx":1129
  *             if allele_idx_offsets[variant_idx_end] - allele_idx_offsets[variant_idx_start] != (variant_idx_end - variant_idx_start) * k1LU * 2:
  *                 raise RuntimeError("Haplotype-major read_alleles_range() doesn't support multiallelic variants yet.")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  */
   __pyx_v_variant_batch_ct = plink2::DivUp(__pyx_v_variant_idx_ct, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":1019
+  /* "pgenlib.pyx":1130
  *                 raise RuntimeError("Haplotype-major read_alleles_range() doesn't support multiallelic variants yet.")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  */
   __pyx_v_variant_batch_size = plink2::kPglNypTransposeBatch;
 
-  /* "pgenlib.pyx":1020
+  /* "pgenlib.pyx":1131
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  */
   __pyx_v_variant_batch_sizel = plink2::DivUp(__pyx_v_variant_batch_size, plink2::kBitsPerWord);
 
-  /* "pgenlib.pyx":1021
+  /* "pgenlib.pyx":1132
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *         cdef uint32_t variant_idx_offset = variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)
  */
   __pyx_v_variant_idx_offset = __pyx_v_variant_idx_start;
 
-  /* "pgenlib.pyx":1022
+  /* "pgenlib.pyx":1133
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  */
   __pyx_v_sample_ctaw2 = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWordD2));
 
-  /* "pgenlib.pyx":1023
+  /* "pgenlib.pyx":1134
  *         cdef uint32_t variant_idx_offset = variant_idx_start
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  */
   __pyx_v_sample_ctaw = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWord));
 
-  /* "pgenlib.pyx":1024
+  /* "pgenlib.pyx":1135
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  */
   __pyx_v_sample_batch_ct = plink2::DivUp(__pyx_v_subset_size, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":1025
+  /* "pgenlib.pyx":1136
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf
  */
   __pyx_t_19 = __pyx_v_self->_transpose_batch_buf;
   __pyx_v_transpose_batch_buf = __pyx_t_19;
 
-  /* "pgenlib.pyx":1026
+  /* "pgenlib.pyx":1137
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  */
   __pyx_t_11 = __pyx_v_self->_multivar_vmaj_geno_buf;
   __pyx_v_multivar_vmaj_geno_buf = __pyx_t_11;
 
-  /* "pgenlib.pyx":1027
+  /* "pgenlib.pyx":1138
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* multivar_smaj_phaseinfo_batch_buf = self._multivar_smaj_phaseinfo_batch_buf
  */
   __pyx_t_11 = __pyx_v_self->_multivar_vmaj_phaseinfo_buf;
   __pyx_v_multivar_vmaj_phaseinfo_buf = __pyx_t_11;
 
-  /* "pgenlib.pyx":1028
+  /* "pgenlib.pyx":1139
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_phaseinfo_batch_buf = self._multivar_smaj_phaseinfo_batch_buf
  *         cdef uintptr_t* vmaj_geno_iter
  */
   __pyx_t_11 = __pyx_v_self->_multivar_smaj_geno_batch_buf;
   __pyx_v_multivar_smaj_geno_batch_buf = __pyx_t_11;
 
-  /* "pgenlib.pyx":1029
+  /* "pgenlib.pyx":1140
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* multivar_smaj_phaseinfo_batch_buf = self._multivar_smaj_phaseinfo_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* vmaj_geno_iter
  *         cdef uintptr_t* vmaj_phaseinfo_iter
  */
   __pyx_t_11 = __pyx_v_self->_multivar_smaj_phaseinfo_batch_buf;
   __pyx_v_multivar_smaj_phaseinfo_batch_buf = __pyx_t_11;
 
-  /* "pgenlib.pyx":1040
+  /* "pgenlib.pyx":1151
  *         cdef uint32_t phasepresent_ct
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):             # <<<<<<<<<<<<<<
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  */
   __pyx_t_14 = __pyx_v_variant_batch_ct;
   __pyx_t_15 = __pyx_t_14;
   for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
     __pyx_v_variant_batch_idx = __pyx_t_16;
 
-    /* "pgenlib.pyx":1041
+    /* "pgenlib.pyx":1152
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  */
     __pyx_t_10 = ((__pyx_v_variant_batch_idx == (__pyx_v_variant_batch_ct - 1)) != 0);
     if (__pyx_t_10) {
 
-      /* "pgenlib.pyx":1042
+      /* "pgenlib.pyx":1153
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  */
       __pyx_t_20 = (__pyx_v_variant_idx_ct - 1);
       if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(0, 1042, __pyx_L1_error)
+        __PYX_ERR(0, 1153, __pyx_L1_error)
       }
       __pyx_v_variant_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_20, plink2::kPglNypTransposeBatch)));
 
-      /* "pgenlib.pyx":1043
+      /* "pgenlib.pyx":1154
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)             # <<<<<<<<<<<<<<
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  */
       __pyx_v_variant_batch_sizel = plink2::DivUp(__pyx_v_variant_batch_size, plink2::kBitsPerWord);
 
-      /* "pgenlib.pyx":1041
+      /* "pgenlib.pyx":1152
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  */
     }
 
-    /* "pgenlib.pyx":1044
+    /* "pgenlib.pyx":1155
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *             vmaj_geno_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for uii in range(variant_batch_size):
  */
     __pyx_v_vmaj_geno_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":1045
+    /* "pgenlib.pyx":1156
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf             # <<<<<<<<<<<<<<
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  */
     __pyx_v_vmaj_phaseinfo_iter = __pyx_v_multivar_vmaj_phaseinfo_buf;
 
-    /* "pgenlib.pyx":1046
+    /* "pgenlib.pyx":1157
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for uii in range(variant_batch_size):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_21 = __pyx_v_variant_batch_size;
     __pyx_t_22 = __pyx_t_21;
     for (__pyx_t_23 = 0; __pyx_t_23 < __pyx_t_22; __pyx_t_23+=1) {
       __pyx_v_uii = __pyx_t_23;
 
-      /* "pgenlib.pyx":1047
+      /* "pgenlib.pyx":1158
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(uii + variant_idx_offset) + " read_alleles_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGetP(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, (__pyx_v_uii + __pyx_v_variant_idx_offset), __pyx_v_pgrp, __pyx_v_vmaj_geno_iter, __pyx_v_phasepresent, __pyx_v_vmaj_phaseinfo_iter, (&__pyx_v_phasepresent_ct));
 
-      /* "pgenlib.pyx":1048
+      /* "pgenlib.pyx":1159
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("variant_idx " + str(uii + variant_idx_offset) + " read_alleles_range() error " + str(reterr))
  *                 if phasepresent_ct == 0:
  */
       __pyx_t_10 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_10)) {
 
-        /* "pgenlib.pyx":1049
+        /* "pgenlib.pyx":1160
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(uii + variant_idx_offset) + " read_alleles_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 if phasepresent_ct == 0:
  *                     ZeroWArr(sample_ctaw, vmaj_phaseinfo_iter)
  */
-        __pyx_t_2 = __Pyx_PyInt_From_uint32_t((__pyx_v_uii + __pyx_v_variant_idx_offset)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyInt_From_uint32_t((__pyx_v_uii + __pyx_v_variant_idx_offset)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1160, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1049, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1160, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_variant_idx_2, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_variant_idx_2, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1160, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u_read_alleles_range_error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1049, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_kp_u_read_alleles_range_error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1160, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1160, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1160, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1160, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1160, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 1049, __pyx_L1_error)
+        __PYX_ERR(0, 1160, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1048
+        /* "pgenlib.pyx":1159
  *             for uii in range(variant_batch_size):
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, uii + variant_idx_offset, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("variant_idx " + str(uii + variant_idx_offset) + " read_alleles_range() error " + str(reterr))
  *                 if phasepresent_ct == 0:
  */
       }
 
-      /* "pgenlib.pyx":1050
+      /* "pgenlib.pyx":1161
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(uii + variant_idx_offset) + " read_alleles_range() error " + str(reterr))
  *                 if phasepresent_ct == 0:             # <<<<<<<<<<<<<<
  *                     ZeroWArr(sample_ctaw, vmaj_phaseinfo_iter)
  *                 # else:
  */
       __pyx_t_10 = ((__pyx_v_phasepresent_ct == 0) != 0);
       if (__pyx_t_10) {
 
-        /* "pgenlib.pyx":1051
+        /* "pgenlib.pyx":1162
  *                     raise RuntimeError("variant_idx " + str(uii + variant_idx_offset) + " read_alleles_range() error " + str(reterr))
  *                 if phasepresent_ct == 0:
  *                     ZeroWArr(sample_ctaw, vmaj_phaseinfo_iter)             # <<<<<<<<<<<<<<
  *                 # else:
  *                     # BitvecAnd(phasepresent, sample_ctaw, vmaj_phaseinfo_iter)
  */
         plink2::ZeroWArr(__pyx_v_sample_ctaw, __pyx_v_vmaj_phaseinfo_iter);
 
-        /* "pgenlib.pyx":1050
+        /* "pgenlib.pyx":1161
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(uii + variant_idx_offset) + " read_alleles_range() error " + str(reterr))
  *                 if phasepresent_ct == 0:             # <<<<<<<<<<<<<<
  *                     ZeroWArr(sample_ctaw, vmaj_phaseinfo_iter)
  *                 # else:
  */
       }
 
-      /* "pgenlib.pyx":1054
+      /* "pgenlib.pyx":1165
  *                 # else:
  *                     # BitvecAnd(phasepresent, sample_ctaw, vmaj_phaseinfo_iter)
  *                 vmaj_geno_iter = &(vmaj_geno_iter[sample_ctaw2])             # <<<<<<<<<<<<<<
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[sample_ctaw])
  *             sample_batch_size = kPglNypTransposeBatch
  */
       __pyx_v_vmaj_geno_iter = (&(__pyx_v_vmaj_geno_iter[__pyx_v_sample_ctaw2]));
 
-      /* "pgenlib.pyx":1055
+      /* "pgenlib.pyx":1166
  *                     # BitvecAnd(phasepresent, sample_ctaw, vmaj_phaseinfo_iter)
  *                 vmaj_geno_iter = &(vmaj_geno_iter[sample_ctaw2])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[sample_ctaw])             # <<<<<<<<<<<<<<
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  */
       __pyx_v_vmaj_phaseinfo_iter = (&(__pyx_v_vmaj_phaseinfo_iter[__pyx_v_sample_ctaw]));
     }
 
-    /* "pgenlib.pyx":1056
+    /* "pgenlib.pyx":1167
  *                 vmaj_geno_iter = &(vmaj_geno_iter[sample_ctaw2])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[sample_ctaw])
  *             sample_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  */
     __pyx_v_sample_batch_size = plink2::kPglNypTransposeBatch;
 
-    /* "pgenlib.pyx":1057
+    /* "pgenlib.pyx":1168
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[sample_ctaw])
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_geno_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  */
     __pyx_v_vmaj_geno_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":1058
+    /* "pgenlib.pyx":1169
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf             # <<<<<<<<<<<<<<
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  */
     __pyx_v_vmaj_phaseinfo_iter = __pyx_v_multivar_vmaj_phaseinfo_buf;
 
-    /* "pgenlib.pyx":1059
+    /* "pgenlib.pyx":1170
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for sample_batch_idx in range(sample_batch_ct):             # <<<<<<<<<<<<<<
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  */
     __pyx_t_21 = __pyx_v_sample_batch_ct;
     __pyx_t_22 = __pyx_t_21;
     for (__pyx_t_23 = 0; __pyx_t_23 < __pyx_t_22; __pyx_t_23+=1) {
       __pyx_v_sample_batch_idx = __pyx_t_23;
 
-      /* "pgenlib.pyx":1060
+      /* "pgenlib.pyx":1171
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  */
       __pyx_t_10 = ((__pyx_v_sample_batch_idx == (__pyx_v_sample_batch_ct - 1)) != 0);
       if (__pyx_t_10) {
 
-        /* "pgenlib.pyx":1061
+        /* "pgenlib.pyx":1172
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  *                 smaj_phaseinfo_iter = multivar_smaj_phaseinfo_batch_buf
  */
         __pyx_t_20 = (__pyx_v_subset_size - 1);
         if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-          __PYX_ERR(0, 1061, __pyx_L1_error)
+          __PYX_ERR(0, 1172, __pyx_L1_error)
         }
         __pyx_v_sample_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_20, plink2::kPglNypTransposeBatch)));
 
-        /* "pgenlib.pyx":1060
+        /* "pgenlib.pyx":1171
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  */
       }
 
-      /* "pgenlib.pyx":1062
+      /* "pgenlib.pyx":1173
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *                 smaj_phaseinfo_iter = multivar_smaj_phaseinfo_batch_buf
  *                 TransposeNypblock(vmaj_geno_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_geno_iter, transpose_batch_buf)
  */
       __pyx_v_smaj_geno_iter = __pyx_v_multivar_smaj_geno_batch_buf;
 
-      /* "pgenlib.pyx":1063
+      /* "pgenlib.pyx":1174
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  *                 smaj_phaseinfo_iter = multivar_smaj_phaseinfo_batch_buf             # <<<<<<<<<<<<<<
  *                 TransposeNypblock(vmaj_geno_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_geno_iter, transpose_batch_buf)
  *                 # todo: skip bitblock transpose when all phasepresent_ct values
  */
       __pyx_v_smaj_phaseinfo_iter = __pyx_v_multivar_smaj_phaseinfo_batch_buf;
 
-      /* "pgenlib.pyx":1064
+      /* "pgenlib.pyx":1175
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  *                 smaj_phaseinfo_iter = multivar_smaj_phaseinfo_batch_buf
  *                 TransposeNypblock(vmaj_geno_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_geno_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 # todo: skip bitblock transpose when all phasepresent_ct values
  *                 #       are zero, etc.
  */
       plink2::TransposeNypblock(__pyx_v_vmaj_geno_iter, __pyx_v_sample_ctaw2, plink2::kPglNypTransposeWords, __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_geno_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":1067
+      /* "pgenlib.pyx":1178
  *                 # todo: skip bitblock transpose when all phasepresent_ct values
  *                 #       are zero, etc.
  *                 TransposeBitblock(vmaj_phaseinfo_iter, sample_ctaw, <uint32_t>(kPglNypTransposeWords // 2), variant_batch_size, sample_batch_size, smaj_phaseinfo_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 for uii in range(sample_batch_size):
  *                     # bugfix (11 Mar 2023): first index was incorrect
  */
       plink2::TransposeBitblock(__pyx_v_vmaj_phaseinfo_iter, __pyx_v_sample_ctaw, ((uint32_t)__Pyx_div_long(plink2::kPglNypTransposeWords, 2)), __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_phaseinfo_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":1068
+      /* "pgenlib.pyx":1179
  *                 #       are zero, etc.
  *                 TransposeBitblock(vmaj_phaseinfo_iter, sample_ctaw, <uint32_t>(kPglNypTransposeWords // 2), variant_batch_size, sample_batch_size, smaj_phaseinfo_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):             # <<<<<<<<<<<<<<
  *                     # bugfix (11 Mar 2023): first index was incorrect
  *                     main_data_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch), variant_batch_idx * kPglNypTransposeBatch]))
  */
       __pyx_t_24 = __pyx_v_sample_batch_size;
       __pyx_t_25 = __pyx_t_24;
       for (__pyx_t_26 = 0; __pyx_t_26 < __pyx_t_25; __pyx_t_26+=1) {
         __pyx_v_uii = __pyx_t_26;
 
-        /* "pgenlib.pyx":1070
+        /* "pgenlib.pyx":1181
  *                 for uii in range(sample_batch_size):
  *                     # bugfix (11 Mar 2023): first index was incorrect
  *                     main_data_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch), variant_batch_idx * kPglNypTransposeBatch]))             # <<<<<<<<<<<<<<
  *                     main_data1_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch) + 1, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)
  */
         __pyx_t_18 = (2 * (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch)));
@@ -16138,19 +18859,19 @@
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_pybuffernd_allele_int32_out.diminfo[0].shape;
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_8 = 0;
         } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_8 = 0;
         if (unlikely(__pyx_t_17 >= (size_t)__pyx_pybuffernd_allele_int32_out.diminfo[1].shape)) __pyx_t_8 = 1;
         if (unlikely(__pyx_t_8 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_8);
-          __PYX_ERR(0, 1070, __pyx_L1_error)
+          __PYX_ERR(0, 1181, __pyx_L1_error)
         }
         __pyx_v_main_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_allele_int32_out.diminfo[1].strides))));
 
-        /* "pgenlib.pyx":1071
+        /* "pgenlib.pyx":1182
  *                     # bugfix (11 Mar 2023): first index was incorrect
  *                     main_data_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch), variant_batch_idx * kPglNypTransposeBatch]))
  *                     main_data1_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch) + 1, variant_batch_idx * kPglNypTransposeBatch]))             # <<<<<<<<<<<<<<
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])
  */
         __pyx_t_18 = ((2 * (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch))) + 1);
@@ -16159,87 +18880,87 @@
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_pybuffernd_allele_int32_out.diminfo[0].shape;
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_8 = 0;
         } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_8 = 0;
         if (unlikely(__pyx_t_17 >= (size_t)__pyx_pybuffernd_allele_int32_out.diminfo[1].shape)) __pyx_t_8 = 1;
         if (unlikely(__pyx_t_8 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_8);
-          __PYX_ERR(0, 1071, __pyx_L1_error)
+          __PYX_ERR(0, 1182, __pyx_L1_error)
         }
         __pyx_v_main_data1_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_allele_int32_out.diminfo[1].strides))));
 
-        /* "pgenlib.pyx":1072
+        /* "pgenlib.pyx":1183
  *                     main_data_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch), variant_batch_idx * kPglNypTransposeBatch]))
  *                     main_data1_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch) + 1, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)             # <<<<<<<<<<<<<<
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  */
         plink2::GenoarrPhasedToHapCodes(__pyx_v_smaj_geno_iter, __pyx_v_smaj_phaseinfo_iter, __pyx_v_variant_batch_size, __pyx_v_main_data_ptr, __pyx_v_main_data1_ptr);
 
-        /* "pgenlib.pyx":1073
+        /* "pgenlib.pyx":1184
  *                     main_data1_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch) + 1, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])
  */
         __pyx_v_smaj_geno_iter = (&(__pyx_v_smaj_geno_iter[plink2::kPglNypTransposeWords]));
 
-        /* "pgenlib.pyx":1074
+        /* "pgenlib.pyx":1185
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])             # <<<<<<<<<<<<<<
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  */
         __pyx_v_smaj_phaseinfo_iter = (&(__pyx_v_smaj_phaseinfo_iter[__Pyx_div_long(plink2::kPglNypTransposeWords, 2)]));
       }
 
-      /* "pgenlib.pyx":1075
+      /* "pgenlib.pyx":1186
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *             variant_idx_offset += kPglNypTransposeBatch
  */
       __pyx_v_vmaj_geno_iter = (&(__pyx_v_vmaj_geno_iter[plink2::kPglNypTransposeWords]));
 
-      /* "pgenlib.pyx":1076
+      /* "pgenlib.pyx":1187
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[kPglNypTransposeWords // 2])             # <<<<<<<<<<<<<<
  *             variant_idx_offset += kPglNypTransposeBatch
  *         return
  */
       __pyx_v_vmaj_phaseinfo_iter = (&(__pyx_v_vmaj_phaseinfo_iter[__Pyx_div_long(plink2::kPglNypTransposeWords, 2)]));
     }
 
-    /* "pgenlib.pyx":1077
+    /* "pgenlib.pyx":1188
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *             variant_idx_offset += kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     __pyx_v_variant_idx_offset = (__pyx_v_variant_idx_offset + plink2::kPglNypTransposeBatch);
   }
 
-  /* "pgenlib.pyx":1078
+  /* "pgenlib.pyx":1189
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *             variant_idx_offset += kPglNypTransposeBatch
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":978
+  /* "pgenlib.pyx":1089
  * 
  * 
  *     cpdef read_alleles_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 
@@ -16306,61 +19027,61 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx_start)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx_end)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_range", 0, 3, 4, 1); __PYX_ERR(0, 978, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_range", 0, 3, 4, 1); __PYX_ERR(0, 1089, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_int32_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_range", 0, 3, 4, 2); __PYX_ERR(0, 978, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_range", 0, 3, 4, 2); __PYX_ERR(0, 1089, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_hap_maj);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_range") < 0)) __PYX_ERR(0, 978, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_range") < 0)) __PYX_ERR(0, 1089, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_variant_idx_start = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx_start == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 978, __pyx_L3_error)
-    __pyx_v_variant_idx_end = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_variant_idx_end == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 978, __pyx_L3_error)
+    __pyx_v_variant_idx_start = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx_start == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1089, __pyx_L3_error)
+    __pyx_v_variant_idx_end = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_variant_idx_end == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1089, __pyx_L3_error)
     __pyx_v_allele_int32_out = ((PyArrayObject *)values[2]);
     if (values[3]) {
-      __pyx_v_hap_maj = __Pyx_PyObject_IsTrue(values[3]); if (unlikely((__pyx_v_hap_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 978, __pyx_L3_error)
+      __pyx_v_hap_maj = __Pyx_PyObject_IsTrue(values[3]); if (unlikely((__pyx_v_hap_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1089, __pyx_L3_error)
     } else {
       __pyx_v_hap_maj = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_alleles_range", 0, 3, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 978, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_alleles_range", 0, 3, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1089, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_alleles_range", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 978, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 1089, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_22read_alleles_range(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_allele_int32_out, __pyx_v_hap_maj);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -16381,21 +19102,21 @@
   __Pyx_RefNannySetupContext("read_alleles_range", 0);
   __pyx_pybuffer_allele_int32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32_out.refcount = 0;
   __pyx_pybuffernd_allele_int32_out.data = NULL;
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 978, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1089, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_out.diminfo[1].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_out.diminfo[1].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[1];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.hap_maj = __pyx_v_hap_maj;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_alleles_range(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_allele_int32_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 978, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_alleles_range(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_allele_int32_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -16413,15 +19134,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1081
+/* "pgenlib.pyx":1192
  * 
  * 
  *     cpdef read_alleles_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 
@@ -16508,36 +19229,36 @@
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   __pyx_pybuffer_allele_int32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32_out.refcount = 0;
   __pyx_pybuffernd_allele_int32_out.data = NULL;
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1192, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1192, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_out.diminfo[1].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_out.diminfo[1].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[1];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_25read_alleles_list)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyBool_FromLong(__pyx_v_hap_maj); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1081, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyBool_FromLong(__pyx_v_hap_maj); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_5)) {
@@ -16547,45 +19268,45 @@
             __Pyx_DECREF_SET(__pyx_t_4, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, ((PyObject *)__pyx_v_variant_idxs), ((PyObject *)__pyx_v_allele_int32_out), __pyx_t_3};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1192, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, ((PyObject *)__pyx_v_variant_idxs), ((PyObject *)__pyx_v_allele_int32_out), __pyx_t_3};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1192, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1192, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_5) {
             __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
           }
           __Pyx_INCREF(((PyObject *)__pyx_v_variant_idxs));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_variant_idxs));
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, ((PyObject *)__pyx_v_variant_idxs));
           __Pyx_INCREF(((PyObject *)__pyx_v_allele_int32_out));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_allele_int32_out));
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, ((PyObject *)__pyx_v_allele_int32_out));
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_3);
           __pyx_t_3 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1081, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1192, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -16600,360 +19321,360 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1086
+  /* "pgenlib.pyx":1197
  *         # if hap_maj == True, allele_int32_out must have at least 2 * sample_ct
  *         #   rows, variant_idx_ct columns
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
   __pyx_t_8 = (__pyx_v_self->_info_ptr[0]).raw_variant_ct;
   __pyx_v_raw_variant_ct = __pyx_t_8;
 
-  /* "pgenlib.pyx":1087
+  /* "pgenlib.pyx":1198
  *         #   rows, variant_idx_ct columns
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_9 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_9;
 
-  /* "pgenlib.pyx":1088
+  /* "pgenlib.pyx":1199
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_10 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_10;
 
-  /* "pgenlib.pyx":1089
+  /* "pgenlib.pyx":1200
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  */
   __pyx_t_11 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_11;
 
-  /* "pgenlib.pyx":1090
+  /* "pgenlib.pyx":1201
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  */
   __pyx_t_9 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_9;
 
-  /* "pgenlib.pyx":1091
+  /* "pgenlib.pyx":1202
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  */
   __pyx_t_9 = __pyx_v_self->_pgv.phasepresent;
   __pyx_v_phasepresent = __pyx_t_9;
 
-  /* "pgenlib.pyx":1092
+  /* "pgenlib.pyx":1203
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_9 = __pyx_v_self->_pgv.phaseinfo;
   __pyx_v_phaseinfo = __pyx_t_9;
 
-  /* "pgenlib.pyx":1093
+  /* "pgenlib.pyx":1204
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int32_t* main_data_ptr
  */
   __pyx_v_variant_idx_ct = ((uint32_t)(__pyx_v_variant_idxs->dimensions[0]));
 
-  /* "pgenlib.pyx":1094
+  /* "pgenlib.pyx":1205
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int32_t* main_data_ptr
  *         cdef uint32_t variant_list_idx
  */
   __pyx_t_8 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_8;
 
-  /* "pgenlib.pyx":1099
+  /* "pgenlib.pyx":1210
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if hap_maj == 0:             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_12 = ((__pyx_v_hap_maj == 0) != 0);
   if (__pyx_t_12) {
 
-    /* "pgenlib.pyx":1100
+    /* "pgenlib.pyx":1211
  *         cdef PglErr reterr
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  */
     __pyx_t_12 = (((__pyx_v_allele_int32_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_12)) {
 
-      /* "pgenlib.pyx":1101
+      /* "pgenlib.pyx":1212
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1101, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_list, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_list, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1101, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1101, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1101, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1101, __pyx_L1_error)
+      __PYX_ERR(0, 1212, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1100
+      /* "pgenlib.pyx":1211
  *         cdef PglErr reterr
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  */
     }
 
-    /* "pgenlib.pyx":1102
+    /* "pgenlib.pyx":1213
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     __pyx_t_12 = (((__pyx_v_allele_int32_out->dimensions[1]) < (2 * __pyx_v_subset_size)) != 0);
     if (unlikely(__pyx_t_12)) {
 
-      /* "pgenlib.pyx":1103
+      /* "pgenlib.pyx":1214
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")             # <<<<<<<<<<<<<<
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1103, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_list_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_list_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1103, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1103, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1103, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1103, __pyx_L1_error)
+      __PYX_ERR(0, 1214, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1102
+      /* "pgenlib.pyx":1213
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     }
 
-    /* "pgenlib.pyx":1104
+    /* "pgenlib.pyx":1215
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             for variant_list_idx in range(variant_idx_ct):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_8 = __pyx_v_variant_idx_ct;
     __pyx_t_13 = __pyx_t_8;
     for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_variant_list_idx = __pyx_t_14;
 
-      /* "pgenlib.pyx":1105
+      /* "pgenlib.pyx":1216
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_15 = __pyx_v_variant_list_idx;
       __pyx_t_6 = -1;
       if (unlikely(__pyx_t_15 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_6 = 0;
       if (unlikely(__pyx_t_6 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_6);
-        __PYX_ERR(0, 1105, __pyx_L1_error)
+        __PYX_ERR(0, 1216, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":1106
+      /* "pgenlib.pyx":1217
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  */
       __pyx_t_12 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_12)) {
 
-        /* "pgenlib.pyx":1107
+        /* "pgenlib.pyx":1218
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1107, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1218, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_list_variant_index, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_list_variant_index, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1107, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1218, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1107, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1218, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1107, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1218, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 1107, __pyx_L1_error)
+        __PYX_ERR(0, 1218, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1106
+        /* "pgenlib.pyx":1217
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  */
       }
 
-      /* "pgenlib.pyx":1108
+      /* "pgenlib.pyx":1219
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGetMP(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_pgrp, (&__pyx_v_self->_pgv));
 
-      /* "pgenlib.pyx":1109
+      /* "pgenlib.pyx":1220
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  */
       __pyx_t_12 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_12)) {
 
-        /* "pgenlib.pyx":1110
+        /* "pgenlib.pyx":1221
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  */
-        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1221, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1110, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1221, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_list_error, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_list_error, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1221, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1110, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1221, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_Raise(__pyx_t_4, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __PYX_ERR(0, 1110, __pyx_L1_error)
+        __PYX_ERR(0, 1221, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1109
+        /* "pgenlib.pyx":1220
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  */
       }
 
-      /* "pgenlib.pyx":1111
+      /* "pgenlib.pyx":1222
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))             # <<<<<<<<<<<<<<
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *             return
  */
       __pyx_t_15 = __pyx_v_variant_list_idx;
@@ -16962,699 +19683,699 @@
       if (unlikely(__pyx_t_15 >= (size_t)__pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_6 = 0;
       if (__pyx_t_16 < 0) {
         __pyx_t_16 += __pyx_pybuffernd_allele_int32_out.diminfo[1].shape;
         if (unlikely(__pyx_t_16 < 0)) __pyx_t_6 = 1;
       } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_allele_int32_out.diminfo[1].shape)) __pyx_t_6 = 1;
       if (unlikely(__pyx_t_6 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_6);
-        __PYX_ERR(0, 1111, __pyx_L1_error)
+        __PYX_ERR(0, 1222, __pyx_L1_error)
       }
       __pyx_v_main_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_allele_int32_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1112
+      /* "pgenlib.pyx":1223
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  */
       plink2::GenoarrMPToAlleleCodesMinus9((&__pyx_v_self->_pgv), __pyx_v_subset_size, NULL, __pyx_v_main_data_ptr);
     }
 
-    /* "pgenlib.pyx":1113
+    /* "pgenlib.pyx":1224
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":1099
+    /* "pgenlib.pyx":1210
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if hap_maj == 0:             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":1114
+  /* "pgenlib.pyx":1225
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *             return
  *         if allele_int32_out.shape[0] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  */
   __pyx_t_12 = (((__pyx_v_allele_int32_out->dimensions[0]) < (2 * __pyx_v_subset_size)) != 0);
   if (unlikely(__pyx_t_12)) {
 
-    /* "pgenlib.pyx":1115
+    /* "pgenlib.pyx":1226
  *             return
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")             # <<<<<<<<<<<<<<
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
-    __pyx_t_4 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Haplotype_major_read_alleles_lis, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Haplotype_major_read_alleles_lis, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_and_row_count_should_be_twice_t); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_and_row_count_should_be_twice_t); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1115, __pyx_L1_error)
+    __PYX_ERR(0, 1226, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1114
+    /* "pgenlib.pyx":1225
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, NULL, main_data_ptr)
  *             return
  *         if allele_int32_out.shape[0] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  */
   }
 
-  /* "pgenlib.pyx":1116
+  /* "pgenlib.pyx":1227
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   __pyx_t_12 = (((__pyx_v_allele_int32_out->dimensions[1]) < __pyx_v_variant_idx_ct) != 0);
   if (unlikely(__pyx_t_12)) {
 
-    /* "pgenlib.pyx":1117
+    /* "pgenlib.pyx":1228
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  */
-    __pyx_t_4 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1228, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1117, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1228, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Haplotype_major_read_alleles_lis_2, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Haplotype_major_read_alleles_lis_2, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1228, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1117, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1228, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1228, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1117, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1228, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1228, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u__9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1117, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u__12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1228, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1228, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1117, __pyx_L1_error)
+    __PYX_ERR(0, 1228, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1116
+    /* "pgenlib.pyx":1227
  *         if allele_int32_out.shape[0] < 2 * subset_size:
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; current sample subset has size " + str(subset_size) + ", and row count should be twice that)")
  *         if allele_int32_out.shape[1] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  */
   }
 
-  /* "pgenlib.pyx":1118
+  /* "pgenlib.pyx":1229
  *         if allele_int32_out.shape[1] < variant_idx_ct:
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  */
   __pyx_v_variant_batch_ct = plink2::DivUp(__pyx_v_variant_idx_ct, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":1119
+  /* "pgenlib.pyx":1230
  *             raise RuntimeError("Haplotype-major read_alleles_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  */
   __pyx_v_variant_batch_size = plink2::kPglNypTransposeBatch;
 
-  /* "pgenlib.pyx":1120
+  /* "pgenlib.pyx":1231
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)
  */
   __pyx_v_variant_batch_sizel = plink2::DivUp(__pyx_v_variant_batch_size, plink2::kBitsPerWord);
 
-  /* "pgenlib.pyx":1121
+  /* "pgenlib.pyx":1232
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  */
   __pyx_v_sample_ctaw2 = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWordD2));
 
-  /* "pgenlib.pyx":1122
+  /* "pgenlib.pyx":1233
  *         cdef uint32_t variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  */
   __pyx_v_sample_ctaw = (plink2::kWordsPerVec * plink2::DivUp(__pyx_v_subset_size, plink2::kBitsPerWord));
 
-  /* "pgenlib.pyx":1123
+  /* "pgenlib.pyx":1234
  *         cdef uint32_t sample_ctaw2 = kWordsPerVec * DivUp(subset_size, kBitsPerWordD2)
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  */
   __pyx_v_sample_batch_ct = plink2::DivUp(__pyx_v_subset_size, plink2::kPglNypTransposeBatch);
 
-  /* "pgenlib.pyx":1124
+  /* "pgenlib.pyx":1235
  *         cdef uint32_t sample_ctaw = kWordsPerVec * DivUp(subset_size, kBitsPerWord)
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf
  */
   __pyx_t_17 = __pyx_v_self->_transpose_batch_buf;
   __pyx_v_transpose_batch_buf = __pyx_t_17;
 
-  /* "pgenlib.pyx":1125
+  /* "pgenlib.pyx":1236
  *         cdef uint32_t sample_batch_ct = DivUp(subset_size, kPglNypTransposeBatch)
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  */
   __pyx_t_9 = __pyx_v_self->_multivar_vmaj_geno_buf;
   __pyx_v_multivar_vmaj_geno_buf = __pyx_t_9;
 
-  /* "pgenlib.pyx":1126
+  /* "pgenlib.pyx":1237
  *         cdef VecW* transpose_batch_buf = self._transpose_batch_buf
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* multivar_smaj_phaseinfo_batch_buf = self._multivar_smaj_phaseinfo_batch_buf
  */
   __pyx_t_9 = __pyx_v_self->_multivar_vmaj_phaseinfo_buf;
   __pyx_v_multivar_vmaj_phaseinfo_buf = __pyx_t_9;
 
-  /* "pgenlib.pyx":1127
+  /* "pgenlib.pyx":1238
  *         cdef uintptr_t* multivar_vmaj_geno_buf = self._multivar_vmaj_geno_buf
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* multivar_smaj_phaseinfo_batch_buf = self._multivar_smaj_phaseinfo_batch_buf
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  */
   __pyx_t_9 = __pyx_v_self->_multivar_smaj_geno_batch_buf;
   __pyx_v_multivar_smaj_geno_batch_buf = __pyx_t_9;
 
-  /* "pgenlib.pyx":1128
+  /* "pgenlib.pyx":1239
  *         cdef uintptr_t* multivar_vmaj_phaseinfo_buf = self._multivar_vmaj_phaseinfo_buf
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* multivar_smaj_phaseinfo_batch_buf = self._multivar_smaj_phaseinfo_batch_buf             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *         cdef uintptr_t* vmaj_geno_iter
  */
   __pyx_t_9 = __pyx_v_self->_multivar_smaj_phaseinfo_batch_buf;
   __pyx_v_multivar_smaj_phaseinfo_batch_buf = __pyx_t_9;
 
-  /* "pgenlib.pyx":1129
+  /* "pgenlib.pyx":1240
  *         cdef uintptr_t* multivar_smaj_geno_batch_buf = self._multivar_smaj_geno_batch_buf
  *         cdef uintptr_t* multivar_smaj_phaseinfo_batch_buf = self._multivar_smaj_phaseinfo_batch_buf
  *         cdef uintptr_t* allele_idx_offsets = self._info_ptr[0].allele_idx_offsets             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* vmaj_geno_iter
  *         cdef uintptr_t* vmaj_phaseinfo_iter
  */
   __pyx_t_9 = (__pyx_v_self->_info_ptr[0]).allele_idx_offsets;
   __pyx_v_allele_idx_offsets = __pyx_t_9;
 
-  /* "pgenlib.pyx":1140
+  /* "pgenlib.pyx":1251
  *         cdef uint32_t phasepresent_ct
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):             # <<<<<<<<<<<<<<
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  */
   __pyx_t_8 = __pyx_v_variant_batch_ct;
   __pyx_t_13 = __pyx_t_8;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_variant_batch_idx = __pyx_t_14;
 
-    /* "pgenlib.pyx":1141
+    /* "pgenlib.pyx":1252
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  */
     __pyx_t_12 = ((__pyx_v_variant_batch_idx == (__pyx_v_variant_batch_ct - 1)) != 0);
     if (__pyx_t_12) {
 
-      /* "pgenlib.pyx":1142
+      /* "pgenlib.pyx":1253
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  */
       __pyx_t_18 = (__pyx_v_variant_idx_ct - 1);
       if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(0, 1142, __pyx_L1_error)
+        __PYX_ERR(0, 1253, __pyx_L1_error)
       }
       __pyx_v_variant_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_18, plink2::kPglNypTransposeBatch)));
 
-      /* "pgenlib.pyx":1143
+      /* "pgenlib.pyx":1254
  *             if variant_batch_idx == (variant_batch_ct - 1):
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)             # <<<<<<<<<<<<<<
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  */
       __pyx_v_variant_batch_sizel = plink2::DivUp(__pyx_v_variant_batch_size, plink2::kBitsPerWord);
 
-      /* "pgenlib.pyx":1141
+      /* "pgenlib.pyx":1252
  *         cdef uint32_t uii
  *         for variant_batch_idx in range(variant_batch_ct):
  *             if variant_batch_idx == (variant_batch_ct - 1):             # <<<<<<<<<<<<<<
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  */
     }
 
-    /* "pgenlib.pyx":1144
+    /* "pgenlib.pyx":1255
  *                 variant_batch_size = 1 + <uint32_t>((variant_idx_ct - 1) % kPglNypTransposeBatch)
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *             vmaj_geno_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for variant_list_idx in range(variant_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch + variant_batch_size):
  */
     __pyx_v_vmaj_geno_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":1145
+    /* "pgenlib.pyx":1256
  *                 variant_batch_sizel = DivUp(variant_batch_size, kBitsPerWord)
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf             # <<<<<<<<<<<<<<
  *             for variant_list_idx in range(variant_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch + variant_batch_size):
  *                 variant_idx = variant_idxs[variant_list_idx]
  */
     __pyx_v_vmaj_phaseinfo_iter = __pyx_v_multivar_vmaj_phaseinfo_buf;
 
-    /* "pgenlib.pyx":1146
+    /* "pgenlib.pyx":1257
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for variant_list_idx in range(variant_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch + variant_batch_size):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_19 = ((__pyx_v_variant_batch_idx * plink2::kPglNypTransposeBatch) + __pyx_v_variant_batch_size);
     __pyx_t_20 = __pyx_t_19;
     for (__pyx_t_21 = (__pyx_v_variant_batch_idx * plink2::kPglNypTransposeBatch); __pyx_t_21 < __pyx_t_20; __pyx_t_21+=1) {
       __pyx_v_variant_list_idx = __pyx_t_21;
 
-      /* "pgenlib.pyx":1147
+      /* "pgenlib.pyx":1258
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for variant_list_idx in range(variant_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch + variant_batch_size):
  *                 variant_idx = variant_idxs[variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_15 = __pyx_v_variant_list_idx;
       __pyx_t_6 = -1;
       if (unlikely(__pyx_t_15 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_6 = 0;
       if (unlikely(__pyx_t_6 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_6);
-        __PYX_ERR(0, 1147, __pyx_L1_error)
+        __PYX_ERR(0, 1258, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":1148
+      /* "pgenlib.pyx":1259
  *             for variant_list_idx in range(variant_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch + variant_batch_size):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 if allele_idx_offsets != NULL:
  */
       __pyx_t_12 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_12)) {
 
-        /* "pgenlib.pyx":1149
+        /* "pgenlib.pyx":1260
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 if allele_idx_offsets != NULL:
  *                     if allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx] != 2:
  */
-        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1260, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1149, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1260, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_list_variant_index, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_list_variant_index, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1260, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_only); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1149, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_only); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1260, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1260, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1149, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1260, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1260, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1149, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1260, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1260, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_Raise(__pyx_t_4, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __PYX_ERR(0, 1149, __pyx_L1_error)
+        __PYX_ERR(0, 1260, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1148
+        /* "pgenlib.pyx":1259
  *             for variant_list_idx in range(variant_batch_idx * kPglNypTransposeBatch, variant_batch_idx * kPglNypTransposeBatch + variant_batch_size):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 if allele_idx_offsets != NULL:
  */
       }
 
-      /* "pgenlib.pyx":1150
+      /* "pgenlib.pyx":1261
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 if allele_idx_offsets != NULL:             # <<<<<<<<<<<<<<
  *                     if allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx] != 2:
  *                         raise RuntimeError("Haplotype-major read_alleles_list() doesn't support multiallelic variants yet.")
  */
       __pyx_t_12 = ((__pyx_v_allele_idx_offsets != NULL) != 0);
       if (__pyx_t_12) {
 
-        /* "pgenlib.pyx":1151
+        /* "pgenlib.pyx":1262
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 if allele_idx_offsets != NULL:
  *                     if allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx] != 2:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("Haplotype-major read_alleles_list() doesn't support multiallelic variants yet.")
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  */
         __pyx_t_12 = ((((__pyx_v_allele_idx_offsets[(__pyx_v_variant_idx + 1)]) - (__pyx_v_allele_idx_offsets[__pyx_v_variant_idx])) != 2) != 0);
         if (unlikely(__pyx_t_12)) {
 
-          /* "pgenlib.pyx":1152
+          /* "pgenlib.pyx":1263
  *                 if allele_idx_offsets != NULL:
  *                     if allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx] != 2:
  *                         raise RuntimeError("Haplotype-major read_alleles_list() doesn't support multiallelic variants yet.")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  *                 if reterr != kPglRetSuccess:
  */
-          __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1152, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1263, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_Raise(__pyx_t_4, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __PYX_ERR(0, 1152, __pyx_L1_error)
+          __PYX_ERR(0, 1263, __pyx_L1_error)
 
-          /* "pgenlib.pyx":1151
+          /* "pgenlib.pyx":1262
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 if allele_idx_offsets != NULL:
  *                     if allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx] != 2:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("Haplotype-major read_alleles_list() doesn't support multiallelic variants yet.")
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  */
         }
 
-        /* "pgenlib.pyx":1150
+        /* "pgenlib.pyx":1261
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 if allele_idx_offsets != NULL:             # <<<<<<<<<<<<<<
  *                     if allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx] != 2:
  *                         raise RuntimeError("Haplotype-major read_alleles_list() doesn't support multiallelic variants yet.")
  */
       }
 
-      /* "pgenlib.pyx":1153
+      /* "pgenlib.pyx":1264
  *                     if allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx] != 2:
  *                         raise RuntimeError("Haplotype-major read_alleles_list() doesn't support multiallelic variants yet.")
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGetP(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_pgrp, __pyx_v_vmaj_geno_iter, __pyx_v_phasepresent, __pyx_v_vmaj_phaseinfo_iter, (&__pyx_v_phasepresent_ct));
 
-      /* "pgenlib.pyx":1154
+      /* "pgenlib.pyx":1265
  *                         raise RuntimeError("Haplotype-major read_alleles_list() doesn't support multiallelic variants yet.")
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  *                 if phasepresent_ct == 0:
  */
       __pyx_t_12 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_12)) {
 
-        /* "pgenlib.pyx":1155
+        /* "pgenlib.pyx":1266
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 if phasepresent_ct == 0:
  *                     ZeroWArr(sample_ctaw, vmaj_phaseinfo_iter)
  */
-        __pyx_t_4 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1155, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1266, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1155, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1266, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_list_error, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1155, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_list_error, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1266, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1155, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1266, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_Raise(__pyx_t_2, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __PYX_ERR(0, 1155, __pyx_L1_error)
+        __PYX_ERR(0, 1266, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1154
+        /* "pgenlib.pyx":1265
  *                         raise RuntimeError("Haplotype-major read_alleles_list() doesn't support multiallelic variants yet.")
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  *                 if phasepresent_ct == 0:
  */
       }
 
-      /* "pgenlib.pyx":1156
+      /* "pgenlib.pyx":1267
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  *                 if phasepresent_ct == 0:             # <<<<<<<<<<<<<<
  *                     ZeroWArr(sample_ctaw, vmaj_phaseinfo_iter)
  *                 # else:
  */
       __pyx_t_12 = ((__pyx_v_phasepresent_ct == 0) != 0);
       if (__pyx_t_12) {
 
-        /* "pgenlib.pyx":1157
+        /* "pgenlib.pyx":1268
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  *                 if phasepresent_ct == 0:
  *                     ZeroWArr(sample_ctaw, vmaj_phaseinfo_iter)             # <<<<<<<<<<<<<<
  *                 # else:
  *                     # BitvecAnd(phasepresent, sample_ctaw, vmaj_phaseinfo_iter)
  */
         plink2::ZeroWArr(__pyx_v_sample_ctaw, __pyx_v_vmaj_phaseinfo_iter);
 
-        /* "pgenlib.pyx":1156
+        /* "pgenlib.pyx":1267
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_list() error " + str(reterr))
  *                 if phasepresent_ct == 0:             # <<<<<<<<<<<<<<
  *                     ZeroWArr(sample_ctaw, vmaj_phaseinfo_iter)
  *                 # else:
  */
       }
 
-      /* "pgenlib.pyx":1160
+      /* "pgenlib.pyx":1271
  *                 # else:
  *                     # BitvecAnd(phasepresent, sample_ctaw, vmaj_phaseinfo_iter)
  *                 vmaj_geno_iter = &(vmaj_geno_iter[sample_ctaw2])             # <<<<<<<<<<<<<<
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[sample_ctaw])
  *             sample_batch_size = kPglNypTransposeBatch
  */
       __pyx_v_vmaj_geno_iter = (&(__pyx_v_vmaj_geno_iter[__pyx_v_sample_ctaw2]));
 
-      /* "pgenlib.pyx":1161
+      /* "pgenlib.pyx":1272
  *                     # BitvecAnd(phasepresent, sample_ctaw, vmaj_phaseinfo_iter)
  *                 vmaj_geno_iter = &(vmaj_geno_iter[sample_ctaw2])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[sample_ctaw])             # <<<<<<<<<<<<<<
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  */
       __pyx_v_vmaj_phaseinfo_iter = (&(__pyx_v_vmaj_phaseinfo_iter[__pyx_v_sample_ctaw]));
     }
 
-    /* "pgenlib.pyx":1162
+    /* "pgenlib.pyx":1273
  *                 vmaj_geno_iter = &(vmaj_geno_iter[sample_ctaw2])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[sample_ctaw])
  *             sample_batch_size = kPglNypTransposeBatch             # <<<<<<<<<<<<<<
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  */
     __pyx_v_sample_batch_size = plink2::kPglNypTransposeBatch;
 
-    /* "pgenlib.pyx":1163
+    /* "pgenlib.pyx":1274
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[sample_ctaw])
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_geno_iter = multivar_vmaj_geno_buf             # <<<<<<<<<<<<<<
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  */
     __pyx_v_vmaj_geno_iter = __pyx_v_multivar_vmaj_geno_buf;
 
-    /* "pgenlib.pyx":1164
+    /* "pgenlib.pyx":1275
  *             sample_batch_size = kPglNypTransposeBatch
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf             # <<<<<<<<<<<<<<
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  */
     __pyx_v_vmaj_phaseinfo_iter = __pyx_v_multivar_vmaj_phaseinfo_buf;
 
-    /* "pgenlib.pyx":1165
+    /* "pgenlib.pyx":1276
  *             vmaj_geno_iter = multivar_vmaj_geno_buf
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for sample_batch_idx in range(sample_batch_ct):             # <<<<<<<<<<<<<<
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  */
     __pyx_t_19 = __pyx_v_sample_batch_ct;
     __pyx_t_20 = __pyx_t_19;
     for (__pyx_t_21 = 0; __pyx_t_21 < __pyx_t_20; __pyx_t_21+=1) {
       __pyx_v_sample_batch_idx = __pyx_t_21;
 
-      /* "pgenlib.pyx":1166
+      /* "pgenlib.pyx":1277
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  */
       __pyx_t_12 = ((__pyx_v_sample_batch_idx == (__pyx_v_sample_batch_ct - 1)) != 0);
       if (__pyx_t_12) {
 
-        /* "pgenlib.pyx":1167
+        /* "pgenlib.pyx":1278
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)             # <<<<<<<<<<<<<<
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  *                 smaj_phaseinfo_iter = multivar_smaj_phaseinfo_batch_buf
  */
         __pyx_t_18 = (__pyx_v_subset_size - 1);
         if (unlikely(plink2::kPglNypTransposeBatch == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-          __PYX_ERR(0, 1167, __pyx_L1_error)
+          __PYX_ERR(0, 1278, __pyx_L1_error)
         }
         __pyx_v_sample_batch_size = (1 + ((uint32_t)__Pyx_mod_long(__pyx_t_18, plink2::kPglNypTransposeBatch)));
 
-        /* "pgenlib.pyx":1166
+        /* "pgenlib.pyx":1277
  *             vmaj_phaseinfo_iter = multivar_vmaj_phaseinfo_buf
  *             for sample_batch_idx in range(sample_batch_ct):
  *                 if sample_batch_idx == sample_batch_ct - 1:             # <<<<<<<<<<<<<<
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  */
       }
 
-      /* "pgenlib.pyx":1168
+      /* "pgenlib.pyx":1279
  *                 if sample_batch_idx == sample_batch_ct - 1:
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf             # <<<<<<<<<<<<<<
  *                 smaj_phaseinfo_iter = multivar_smaj_phaseinfo_batch_buf
  *                 TransposeNypblock(vmaj_geno_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_geno_iter, transpose_batch_buf)
  */
       __pyx_v_smaj_geno_iter = __pyx_v_multivar_smaj_geno_batch_buf;
 
-      /* "pgenlib.pyx":1169
+      /* "pgenlib.pyx":1280
  *                     sample_batch_size = 1 + <uint32_t>((subset_size - 1) % kPglNypTransposeBatch)
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  *                 smaj_phaseinfo_iter = multivar_smaj_phaseinfo_batch_buf             # <<<<<<<<<<<<<<
  *                 TransposeNypblock(vmaj_geno_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_geno_iter, transpose_batch_buf)
  *                 # todo: skip bitblock transpose when all phasepresent_ct values
  */
       __pyx_v_smaj_phaseinfo_iter = __pyx_v_multivar_smaj_phaseinfo_batch_buf;
 
-      /* "pgenlib.pyx":1170
+      /* "pgenlib.pyx":1281
  *                 smaj_geno_iter = multivar_smaj_geno_batch_buf
  *                 smaj_phaseinfo_iter = multivar_smaj_phaseinfo_batch_buf
  *                 TransposeNypblock(vmaj_geno_iter, sample_ctaw2, kPglNypTransposeWords, variant_batch_size, sample_batch_size, smaj_geno_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 # todo: skip bitblock transpose when all phasepresent_ct values
  *                 #       are zero, etc.
  */
       plink2::TransposeNypblock(__pyx_v_vmaj_geno_iter, __pyx_v_sample_ctaw2, plink2::kPglNypTransposeWords, __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_geno_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":1173
+      /* "pgenlib.pyx":1284
  *                 # todo: skip bitblock transpose when all phasepresent_ct values
  *                 #       are zero, etc.
  *                 TransposeBitblock(vmaj_phaseinfo_iter, sample_ctaw, <uint32_t>(kPglNypTransposeWords // 2), variant_batch_size, sample_batch_size, smaj_phaseinfo_iter, transpose_batch_buf)             # <<<<<<<<<<<<<<
  *                 for uii in range(sample_batch_size):
  *                     main_data_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch), variant_batch_idx * kPglNypTransposeBatch]))
  */
       plink2::TransposeBitblock(__pyx_v_vmaj_phaseinfo_iter, __pyx_v_sample_ctaw, ((uint32_t)__Pyx_div_long(plink2::kPglNypTransposeWords, 2)), __pyx_v_variant_batch_size, __pyx_v_sample_batch_size, __pyx_v_smaj_phaseinfo_iter, __pyx_v_transpose_batch_buf);
 
-      /* "pgenlib.pyx":1174
+      /* "pgenlib.pyx":1285
  *                 #       are zero, etc.
  *                 TransposeBitblock(vmaj_phaseinfo_iter, sample_ctaw, <uint32_t>(kPglNypTransposeWords // 2), variant_batch_size, sample_batch_size, smaj_phaseinfo_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):             # <<<<<<<<<<<<<<
  *                     main_data_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch), variant_batch_idx * kPglNypTransposeBatch]))
  *                     main_data1_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch) + 1, variant_batch_idx * kPglNypTransposeBatch]))
  */
       __pyx_t_22 = __pyx_v_sample_batch_size;
       __pyx_t_23 = __pyx_t_22;
       for (__pyx_t_24 = 0; __pyx_t_24 < __pyx_t_23; __pyx_t_24+=1) {
         __pyx_v_uii = __pyx_t_24;
 
-        /* "pgenlib.pyx":1175
+        /* "pgenlib.pyx":1286
  *                 TransposeBitblock(vmaj_phaseinfo_iter, sample_ctaw, <uint32_t>(kPglNypTransposeWords // 2), variant_batch_size, sample_batch_size, smaj_phaseinfo_iter, transpose_batch_buf)
  *                 for uii in range(sample_batch_size):
  *                     main_data_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch), variant_batch_idx * kPglNypTransposeBatch]))             # <<<<<<<<<<<<<<
  *                     main_data1_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch) + 1, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)
  */
         __pyx_t_16 = (2 * (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch)));
@@ -17663,19 +20384,19 @@
         if (__pyx_t_16 < 0) {
           __pyx_t_16 += __pyx_pybuffernd_allele_int32_out.diminfo[0].shape;
           if (unlikely(__pyx_t_16 < 0)) __pyx_t_6 = 0;
         } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_6 = 0;
         if (unlikely(__pyx_t_15 >= (size_t)__pyx_pybuffernd_allele_int32_out.diminfo[1].shape)) __pyx_t_6 = 1;
         if (unlikely(__pyx_t_6 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_6);
-          __PYX_ERR(0, 1175, __pyx_L1_error)
+          __PYX_ERR(0, 1286, __pyx_L1_error)
         }
         __pyx_v_main_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_allele_int32_out.diminfo[1].strides))));
 
-        /* "pgenlib.pyx":1176
+        /* "pgenlib.pyx":1287
  *                 for uii in range(sample_batch_size):
  *                     main_data_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch), variant_batch_idx * kPglNypTransposeBatch]))
  *                     main_data1_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch) + 1, variant_batch_idx * kPglNypTransposeBatch]))             # <<<<<<<<<<<<<<
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])
  */
         __pyx_t_16 = ((2 * (__pyx_v_uii + (__pyx_v_sample_batch_idx * plink2::kPglNypTransposeBatch))) + 1);
@@ -17684,78 +20405,78 @@
         if (__pyx_t_16 < 0) {
           __pyx_t_16 += __pyx_pybuffernd_allele_int32_out.diminfo[0].shape;
           if (unlikely(__pyx_t_16 < 0)) __pyx_t_6 = 0;
         } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_6 = 0;
         if (unlikely(__pyx_t_15 >= (size_t)__pyx_pybuffernd_allele_int32_out.diminfo[1].shape)) __pyx_t_6 = 1;
         if (unlikely(__pyx_t_6 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_6);
-          __PYX_ERR(0, 1176, __pyx_L1_error)
+          __PYX_ERR(0, 1287, __pyx_L1_error)
         }
         __pyx_v_main_data1_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_allele_int32_out.diminfo[1].strides))));
 
-        /* "pgenlib.pyx":1177
+        /* "pgenlib.pyx":1288
  *                     main_data_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch), variant_batch_idx * kPglNypTransposeBatch]))
  *                     main_data1_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch) + 1, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)             # <<<<<<<<<<<<<<
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  */
         plink2::GenoarrPhasedToHapCodes(__pyx_v_smaj_geno_iter, __pyx_v_smaj_phaseinfo_iter, __pyx_v_variant_batch_size, __pyx_v_main_data_ptr, __pyx_v_main_data1_ptr);
 
-        /* "pgenlib.pyx":1178
+        /* "pgenlib.pyx":1289
  *                     main_data1_ptr = <int32_t*>(&(allele_int32_out[2 * (uii + sample_batch_idx * kPglNypTransposeBatch) + 1, variant_batch_idx * kPglNypTransposeBatch]))
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])
  */
         __pyx_v_smaj_geno_iter = (&(__pyx_v_smaj_geno_iter[plink2::kPglNypTransposeWords]));
 
-        /* "pgenlib.pyx":1179
+        /* "pgenlib.pyx":1290
  *                     GenoarrPhasedToHapCodes(smaj_geno_iter, smaj_phaseinfo_iter, variant_batch_size, main_data_ptr, main_data1_ptr)
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])             # <<<<<<<<<<<<<<
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  */
         __pyx_v_smaj_phaseinfo_iter = (&(__pyx_v_smaj_phaseinfo_iter[__Pyx_div_long(plink2::kPglNypTransposeWords, 2)]));
       }
 
-      /* "pgenlib.pyx":1180
+      /* "pgenlib.pyx":1291
  *                     smaj_geno_iter = &(smaj_geno_iter[kPglNypTransposeWords])
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])             # <<<<<<<<<<<<<<
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *         return
  */
       __pyx_v_vmaj_geno_iter = (&(__pyx_v_vmaj_geno_iter[plink2::kPglNypTransposeWords]));
 
-      /* "pgenlib.pyx":1181
+      /* "pgenlib.pyx":1292
  *                     smaj_phaseinfo_iter = &(smaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[kPglNypTransposeWords // 2])             # <<<<<<<<<<<<<<
  *         return
  * 
  */
       __pyx_v_vmaj_phaseinfo_iter = (&(__pyx_v_vmaj_phaseinfo_iter[__Pyx_div_long(plink2::kPglNypTransposeWords, 2)]));
     }
   }
 
-  /* "pgenlib.pyx":1182
+  /* "pgenlib.pyx":1293
  *                 vmaj_geno_iter = &(vmaj_geno_iter[kPglNypTransposeWords])
  *                 vmaj_phaseinfo_iter = &(vmaj_phaseinfo_iter[kPglNypTransposeWords // 2])
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1081
+  /* "pgenlib.pyx":1192
  * 
  * 
  *     cpdef read_alleles_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 
@@ -17819,54 +20540,54 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idxs)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_int32_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_list", 0, 2, 3, 1); __PYX_ERR(0, 1081, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_list", 0, 2, 3, 1); __PYX_ERR(0, 1192, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_hap_maj);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_list") < 0)) __PYX_ERR(0, 1081, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_list") < 0)) __PYX_ERR(0, 1192, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_variant_idxs = ((PyArrayObject *)values[0]);
     __pyx_v_allele_int32_out = ((PyArrayObject *)values[1]);
     if (values[2]) {
-      __pyx_v_hap_maj = __Pyx_PyObject_IsTrue(values[2]); if (unlikely((__pyx_v_hap_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1081, __pyx_L3_error)
+      __pyx_v_hap_maj = __Pyx_PyObject_IsTrue(values[2]); if (unlikely((__pyx_v_hap_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1192, __pyx_L3_error)
     } else {
       __pyx_v_hap_maj = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_alleles_list", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1081, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_alleles_list", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1192, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_alleles_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_variant_idxs), __pyx_ptype_5numpy_ndarray, 1, "variant_idxs", 0))) __PYX_ERR(0, 1081, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 1081, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_variant_idxs), __pyx_ptype_5numpy_ndarray, 1, "variant_idxs", 0))) __PYX_ERR(0, 1192, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 1192, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_24read_alleles_list(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idxs, __pyx_v_allele_int32_out, __pyx_v_hap_maj);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -17893,26 +20614,26 @@
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   __pyx_pybuffer_allele_int32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32_out.refcount = 0;
   __pyx_pybuffernd_allele_int32_out.data = NULL;
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1192, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1081, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1192, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_out.diminfo[1].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_out.diminfo[1].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[1];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.hap_maj = __pyx_v_hap_maj;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_alleles_list(__pyx_v_self, __pyx_v_variant_idxs, __pyx_v_allele_int32_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_alleles_list(__pyx_v_self, __pyx_v_variant_idxs, __pyx_v_allele_int32_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -17932,15 +20653,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1185
+/* "pgenlib.pyx":1296
  * 
  * 
  *     cpdef read_alleles_and_phasepresent_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 
@@ -17995,40 +20716,40 @@
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   __pyx_pybuffer_phasepresent_out.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent_out.refcount = 0;
   __pyx_pybuffernd_phasepresent_out.data = NULL;
   __pyx_pybuffernd_phasepresent_out.rcbuffer = &__pyx_pybuffer_phasepresent_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1185, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1296, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_out.diminfo[1].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_out.diminfo[1].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1185, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1296, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent_out.diminfo[0].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent_out.diminfo[0].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_phasepresent_out.diminfo[1].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_phasepresent_out.diminfo[1].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[1];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_and_phasepresent_ra); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1185, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_and_phasepresent_ra); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1296, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_27read_alleles_and_phasepresent_range)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1296, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1185, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1296, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = __Pyx_PyBool_FromLong(__pyx_v_hap_maj); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1185, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyBool_FromLong(__pyx_v_hap_maj); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1296, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_6 = __pyx_t_1; __pyx_t_7 = NULL;
         __pyx_t_8 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_7)) {
@@ -18038,35 +20759,35 @@
             __Pyx_DECREF_SET(__pyx_t_6, function);
             __pyx_t_8 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_6)) {
           PyObject *__pyx_temp[6] = {__pyx_t_7, __pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_allele_int32_out), ((PyObject *)__pyx_v_phasepresent_out), __pyx_t_5};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 5+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1185, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 5+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1296, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
           PyObject *__pyx_temp[6] = {__pyx_t_7, __pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_allele_int32_out), ((PyObject *)__pyx_v_phasepresent_out), __pyx_t_5};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 5+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1185, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_8, 5+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1296, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         {
-          __pyx_t_9 = PyTuple_New(5+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1185, __pyx_L1_error)
+          __pyx_t_9 = PyTuple_New(5+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1296, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           if (__pyx_t_7) {
             __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
@@ -18078,15 +20799,15 @@
           __Pyx_GIVEREF(((PyObject *)__pyx_v_phasepresent_out));
           PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_8, ((PyObject *)__pyx_v_phasepresent_out));
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_9, 4+__pyx_t_8, __pyx_t_5);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1185, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1296, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         }
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -18101,428 +20822,428 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1190
+  /* "pgenlib.pyx":1301
  *         # if hap_maj == True, allele_int32_out must have at least 2 * sample_ct
  *         #   rows, variant_idx_ct columns
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
   __pyx_t_10 = ((__pyx_v_variant_idx_end > (__pyx_v_self->_info_ptr[0]).raw_variant_ct) != 0);
   if (unlikely(__pyx_t_10)) {
 
-    /* "pgenlib.pyx":1191
+    /* "pgenlib.pyx":1302
  *         #   rows, variant_idx_ct columns
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_range_variant_idx_e, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_range_variant_idx_e, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1191, __pyx_L1_error)
+    __PYX_ERR(0, 1302, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1190
+    /* "pgenlib.pyx":1301
  *         # if hap_maj == True, allele_int32_out must have at least 2 * sample_ct
  *         #   rows, variant_idx_ct columns
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
   }
 
-  /* "pgenlib.pyx":1192
+  /* "pgenlib.pyx":1303
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_11 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_11;
 
-  /* "pgenlib.pyx":1193
+  /* "pgenlib.pyx":1304
  *             raise RuntimeError("read_alleles_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  */
   __pyx_t_12 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_12;
 
-  /* "pgenlib.pyx":1194
+  /* "pgenlib.pyx":1305
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_13 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_13;
 
-  /* "pgenlib.pyx":1195
+  /* "pgenlib.pyx":1306
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int32_t* main_data_ptr
  */
   __pyx_v_variant_idx_ct = (__pyx_v_variant_idx_end - __pyx_v_variant_idx_start);
 
-  /* "pgenlib.pyx":1196
+  /* "pgenlib.pyx":1307
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int32_t* main_data_ptr
  *         cdef unsigned char* phasepresent_data_ptr
  */
   __pyx_t_14 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_14;
 
-  /* "pgenlib.pyx":1201
+  /* "pgenlib.pyx":1312
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if hap_maj == 0:             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_10 = ((__pyx_v_hap_maj == 0) != 0);
   if (__pyx_t_10) {
 
-    /* "pgenlib.pyx":1202
+    /* "pgenlib.pyx":1313
  *         cdef PglErr reterr
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  */
     __pyx_t_10 = (((__pyx_v_allele_int32_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_10)) {
 
-      /* "pgenlib.pyx":1203
+      /* "pgenlib.pyx":1314
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1203, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1314, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1203, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1314, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1203, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1314, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1203, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__12); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1314, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1203, __pyx_L1_error)
+      __PYX_ERR(0, 1314, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1202
+      /* "pgenlib.pyx":1313
  *         cdef PglErr reterr
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  */
     }
 
-    /* "pgenlib.pyx":1204
+    /* "pgenlib.pyx":1315
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  */
     __pyx_t_10 = (((__pyx_v_phasepresent_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_10)) {
 
-      /* "pgenlib.pyx":1205
+      /* "pgenlib.pyx":1316
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_phasepresent_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_phasepresent_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1205, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1316, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1205, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idx_end_variant_idx_sta); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1316, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1205, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1316, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1205, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1316, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1205, __pyx_L1_error)
+      __PYX_ERR(0, 1316, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1204
+      /* "pgenlib.pyx":1315
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  */
     }
 
-    /* "pgenlib.pyx":1206
+    /* "pgenlib.pyx":1317
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:
  */
     __pyx_t_10 = (((__pyx_v_allele_int32_out->dimensions[1]) < (2 * __pyx_v_subset_size)) != 0);
     if (unlikely(__pyx_t_10)) {
 
-      /* "pgenlib.pyx":1207
+      /* "pgenlib.pyx":1318
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")             # <<<<<<<<<<<<<<
  *             if phasepresent_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1207, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1207, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1207, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1207, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1207, __pyx_L1_error)
+      __PYX_ERR(0, 1318, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1206
+      /* "pgenlib.pyx":1317
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":1208
+    /* "pgenlib.pyx":1319
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     __pyx_t_10 = (((__pyx_v_phasepresent_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_10)) {
 
-      /* "pgenlib.pyx":1209
+      /* "pgenlib.pyx":1320
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1209, __pyx_L1_error)
+      __PYX_ERR(0, 1320, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1208
+      /* "pgenlib.pyx":1319
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  */
     }
 
-    /* "pgenlib.pyx":1210
+    /* "pgenlib.pyx":1321
  *             if phasepresent_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_14 = __pyx_v_variant_idx_end;
     __pyx_t_15 = __pyx_t_14;
     for (__pyx_t_16 = __pyx_v_variant_idx_start; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
       __pyx_v_variant_idx = __pyx_t_16;
 
-      /* "pgenlib.pyx":1211
+      /* "pgenlib.pyx":1322
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() phasepresent_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_and_phasepresent_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGetMP(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_pgrp, (&__pyx_v_self->_pgv));
 
-      /* "pgenlib.pyx":1212
+      /* "pgenlib.pyx":1323
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_and_phasepresent_range() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  */
       __pyx_t_10 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_10)) {
 
-        /* "pgenlib.pyx":1213
+        /* "pgenlib.pyx":1324
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_and_phasepresent_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[(variant_idx - variant_idx_start), 0]))
  */
-        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1213, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1324, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1213, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1324, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_variant_idx_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1213, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_variant_idx_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1324, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_read_alleles_and_phasepresent_r); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1213, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_read_alleles_and_phasepresent_r); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1324, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1213, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1324, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1213, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1324, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1213, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1324, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1213, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1324, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_Raise(__pyx_t_2, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __PYX_ERR(0, 1213, __pyx_L1_error)
+        __PYX_ERR(0, 1324, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1212
+        /* "pgenlib.pyx":1323
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_and_phasepresent_range() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  */
       }
 
-      /* "pgenlib.pyx":1214
+      /* "pgenlib.pyx":1325
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_and_phasepresent_range() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))             # <<<<<<<<<<<<<<
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[(variant_idx - variant_idx_start), 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  */
       __pyx_t_17 = (__pyx_v_variant_idx - __pyx_v_variant_idx_start);
@@ -18531,19 +21252,19 @@
       if (unlikely(__pyx_t_17 >= (size_t)__pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_8 = 0;
       if (__pyx_t_18 < 0) {
         __pyx_t_18 += __pyx_pybuffernd_allele_int32_out.diminfo[1].shape;
         if (unlikely(__pyx_t_18 < 0)) __pyx_t_8 = 1;
       } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_allele_int32_out.diminfo[1].shape)) __pyx_t_8 = 1;
       if (unlikely(__pyx_t_8 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_8);
-        __PYX_ERR(0, 1214, __pyx_L1_error)
+        __PYX_ERR(0, 1325, __pyx_L1_error)
       }
       __pyx_v_main_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_allele_int32_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1215
+      /* "pgenlib.pyx":1326
  *                     raise RuntimeError("variant_idx " + str(variant_idx) + " read_alleles_and_phasepresent_range() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[(variant_idx - variant_idx_start), 0]))             # <<<<<<<<<<<<<<
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *             return
  */
       __pyx_t_17 = (__pyx_v_variant_idx - __pyx_v_variant_idx_start);
@@ -18552,62 +21273,62 @@
       if (unlikely(__pyx_t_17 >= (size_t)__pyx_pybuffernd_phasepresent_out.diminfo[0].shape)) __pyx_t_8 = 0;
       if (__pyx_t_18 < 0) {
         __pyx_t_18 += __pyx_pybuffernd_phasepresent_out.diminfo[1].shape;
         if (unlikely(__pyx_t_18 < 0)) __pyx_t_8 = 1;
       } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_phasepresent_out.diminfo[1].shape)) __pyx_t_8 = 1;
       if (unlikely(__pyx_t_8 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_8);
-        __PYX_ERR(0, 1215, __pyx_L1_error)
+        __PYX_ERR(0, 1326, __pyx_L1_error)
       }
       __pyx_v_phasepresent_data_ptr = ((unsigned char *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_uint8_t *, __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_phasepresent_out.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_phasepresent_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1216
+      /* "pgenlib.pyx":1327
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[(variant_idx - variant_idx_start), 0]))
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[(variant_idx - variant_idx_start), 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         raise RuntimeError("read_alleles_and_phasepresent_range() does not support hap_maj == 1 yet.")
  */
       plink2::GenoarrMPToAlleleCodesMinus9((&__pyx_v_self->_pgv), __pyx_v_subset_size, __pyx_v_phasepresent_data_ptr, __pyx_v_main_data_ptr);
     }
 
-    /* "pgenlib.pyx":1217
+    /* "pgenlib.pyx":1328
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[(variant_idx - variant_idx_start), 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         raise RuntimeError("read_alleles_and_phasepresent_range() does not support hap_maj == 1 yet.")
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":1201
+    /* "pgenlib.pyx":1312
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if hap_maj == 0:             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_range() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; (variant_idx_end - variant_idx_start) is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":1218
+  /* "pgenlib.pyx":1329
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *             return
  *         raise RuntimeError("read_alleles_and_phasepresent_range() does not support hap_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1218, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_Raise(__pyx_t_2, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __PYX_ERR(0, 1218, __pyx_L1_error)
+  __PYX_ERR(0, 1329, __pyx_L1_error)
 
-  /* "pgenlib.pyx":1185
+  /* "pgenlib.pyx":1296
  * 
  * 
  *     cpdef read_alleles_and_phasepresent_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 
@@ -18679,70 +21400,70 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx_start)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx_end)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_range", 0, 4, 5, 1); __PYX_ERR(0, 1185, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_range", 0, 4, 5, 1); __PYX_ERR(0, 1296, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_int32_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_range", 0, 4, 5, 2); __PYX_ERR(0, 1185, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_range", 0, 4, 5, 2); __PYX_ERR(0, 1296, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_phasepresent_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_range", 0, 4, 5, 3); __PYX_ERR(0, 1185, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_range", 0, 4, 5, 3); __PYX_ERR(0, 1296, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_hap_maj);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_and_phasepresent_range") < 0)) __PYX_ERR(0, 1185, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_and_phasepresent_range") < 0)) __PYX_ERR(0, 1296, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_variant_idx_start = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx_start == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1185, __pyx_L3_error)
-    __pyx_v_variant_idx_end = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_variant_idx_end == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1185, __pyx_L3_error)
+    __pyx_v_variant_idx_start = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx_start == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1296, __pyx_L3_error)
+    __pyx_v_variant_idx_end = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_variant_idx_end == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1296, __pyx_L3_error)
     __pyx_v_allele_int32_out = ((PyArrayObject *)values[2]);
     __pyx_v_phasepresent_out = ((PyArrayObject *)values[3]);
     if (values[4]) {
-      __pyx_v_hap_maj = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_hap_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1185, __pyx_L3_error)
+      __pyx_v_hap_maj = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_hap_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1296, __pyx_L3_error)
     } else {
       __pyx_v_hap_maj = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_range", 0, 4, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1185, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_range", 0, 4, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1296, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_alleles_and_phasepresent_range", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 1185, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent_out), __pyx_ptype_5numpy_ndarray, 1, "phasepresent_out", 0))) __PYX_ERR(0, 1185, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 1296, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent_out), __pyx_ptype_5numpy_ndarray, 1, "phasepresent_out", 0))) __PYX_ERR(0, 1296, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_26read_alleles_and_phasepresent_range(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_allele_int32_out, __pyx_v_phasepresent_out, __pyx_v_hap_maj);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -18769,26 +21490,26 @@
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   __pyx_pybuffer_phasepresent_out.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent_out.refcount = 0;
   __pyx_pybuffernd_phasepresent_out.data = NULL;
   __pyx_pybuffernd_phasepresent_out.rcbuffer = &__pyx_pybuffer_phasepresent_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1185, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1296, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_out.diminfo[1].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_out.diminfo[1].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1185, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1296, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent_out.diminfo[0].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent_out.diminfo[0].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_phasepresent_out.diminfo[1].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_phasepresent_out.diminfo[1].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[1];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.hap_maj = __pyx_v_hap_maj;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_alleles_and_phasepresent_range(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_allele_int32_out, __pyx_v_phasepresent_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1185, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_alleles_and_phasepresent_range(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_allele_int32_out, __pyx_v_phasepresent_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -18808,15 +21529,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1221
+/* "pgenlib.pyx":1332
  * 
  * 
  *     cpdef read_alleles_and_phasepresent_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, np.ndarray[np.uint8_t,cast=True,mode="c",ndim=2] phasepresent_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 
@@ -18880,41 +21601,41 @@
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   __pyx_pybuffer_phasepresent_out.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent_out.refcount = 0;
   __pyx_pybuffernd_phasepresent_out.data = NULL;
   __pyx_pybuffernd_phasepresent_out.rcbuffer = &__pyx_pybuffer_phasepresent_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1221, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1332, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1221, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1332, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_out.diminfo[1].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_out.diminfo[1].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1221, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1332, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent_out.diminfo[0].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent_out.diminfo[0].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_phasepresent_out.diminfo[1].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_phasepresent_out.diminfo[1].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[1];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_and_phasepresent_li); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1221, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_alleles_and_phasepresent_li); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_29read_alleles_and_phasepresent_list)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyBool_FromLong(__pyx_v_hap_maj); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1221, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyBool_FromLong(__pyx_v_hap_maj); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1332, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_5)) {
@@ -18924,31 +21645,31 @@
             __Pyx_DECREF_SET(__pyx_t_4, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[5] = {__pyx_t_5, ((PyObject *)__pyx_v_variant_idxs), ((PyObject *)__pyx_v_allele_int32_out), ((PyObject *)__pyx_v_phasepresent_out), __pyx_t_3};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1221, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1332, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[5] = {__pyx_t_5, ((PyObject *)__pyx_v_variant_idxs), ((PyObject *)__pyx_v_allele_int32_out), ((PyObject *)__pyx_v_phasepresent_out), __pyx_t_3};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1221, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1332, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(4+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1221, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(4+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1332, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_5) {
             __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
           }
           __Pyx_INCREF(((PyObject *)__pyx_v_variant_idxs));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_variant_idxs));
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, ((PyObject *)__pyx_v_variant_idxs));
@@ -18957,15 +21678,15 @@
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, ((PyObject *)__pyx_v_allele_int32_out));
           __Pyx_INCREF(((PyObject *)__pyx_v_phasepresent_out));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_phasepresent_out));
           PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, ((PyObject *)__pyx_v_phasepresent_out));
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_6, __pyx_t_3);
           __pyx_t_3 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1221, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1332, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -18980,472 +21701,472 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1226
+  /* "pgenlib.pyx":1337
  *         # if hap_maj == True, allele_int32_out must have at least 2 * sample_ct
  *         #   rows, variant_idx_ct columns
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
   __pyx_t_8 = (__pyx_v_self->_info_ptr[0]).raw_variant_ct;
   __pyx_v_raw_variant_ct = __pyx_t_8;
 
-  /* "pgenlib.pyx":1227
+  /* "pgenlib.pyx":1338
  *         #   rows, variant_idx_ct columns
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_9 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_9;
 
-  /* "pgenlib.pyx":1228
+  /* "pgenlib.pyx":1339
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_10 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_10;
 
-  /* "pgenlib.pyx":1229
+  /* "pgenlib.pyx":1340
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  */
   __pyx_t_11 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_11;
 
-  /* "pgenlib.pyx":1230
+  /* "pgenlib.pyx":1341
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  */
   __pyx_t_9 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_9;
 
-  /* "pgenlib.pyx":1231
+  /* "pgenlib.pyx":1342
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  */
   __pyx_t_9 = __pyx_v_self->_pgv.phasepresent;
   __pyx_v_phasepresent = __pyx_t_9;
 
-  /* "pgenlib.pyx":1232
+  /* "pgenlib.pyx":1343
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_9 = __pyx_v_self->_pgv.phaseinfo;
   __pyx_v_phaseinfo = __pyx_t_9;
 
-  /* "pgenlib.pyx":1233
+  /* "pgenlib.pyx":1344
  *         cdef uintptr_t* phasepresent = self._pgv.phasepresent
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef int32_t* main_data_ptr
  */
   __pyx_v_variant_idx_ct = ((uint32_t)(__pyx_v_variant_idxs->dimensions[0]));
 
-  /* "pgenlib.pyx":1234
+  /* "pgenlib.pyx":1345
  *         cdef uintptr_t* phaseinfo = self._pgv.phaseinfo
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef int32_t* main_data_ptr
  *         cdef unsigned char* phasepresent_data_ptr
  */
   __pyx_t_8 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_8;
 
-  /* "pgenlib.pyx":1240
+  /* "pgenlib.pyx":1351
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if hap_maj == 0:             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_12 = ((__pyx_v_hap_maj == 0) != 0);
   if (__pyx_t_12) {
 
-    /* "pgenlib.pyx":1241
+    /* "pgenlib.pyx":1352
  *         cdef PglErr reterr
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  */
     __pyx_t_12 = (((__pyx_v_allele_int32_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_12)) {
 
-      /* "pgenlib.pyx":1242
+      /* "pgenlib.pyx":1353
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1353, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1353, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1353, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1353, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1353, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1353, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1353, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1353, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1242, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1353, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1242, __pyx_L1_error)
+      __PYX_ERR(0, 1353, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1241
+      /* "pgenlib.pyx":1352
  *         cdef PglErr reterr
  *         if hap_maj == 0:
  *             if allele_int32_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  */
     }
 
-    /* "pgenlib.pyx":1243
+    /* "pgenlib.pyx":1354
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  */
     __pyx_t_12 = (((__pyx_v_phasepresent_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_12)) {
 
-      /* "pgenlib.pyx":1244
+      /* "pgenlib.pyx":1355
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_phasepresent_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_phasepresent_out->dimensions[0])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1355, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1355, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_6, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_6, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1355, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1355, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1355, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1355, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1355, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__12); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1355, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1244, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1355, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1244, __pyx_L1_error)
+      __PYX_ERR(0, 1355, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1243
+      /* "pgenlib.pyx":1354
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if phasepresent_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  */
     }
 
-    /* "pgenlib.pyx":1245
+    /* "pgenlib.pyx":1356
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:
  */
     __pyx_t_12 = (((__pyx_v_allele_int32_out->dimensions[1]) < (2 * __pyx_v_subset_size)) != 0);
     if (unlikely(__pyx_t_12)) {
 
-      /* "pgenlib.pyx":1246
+      /* "pgenlib.pyx":1357
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")             # <<<<<<<<<<<<<<
  *             if phasepresent_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few columns (" + str(phasepresent_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_allele_int32_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_7, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_7, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_and_column_count_should_be_twic_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1246, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1246, __pyx_L1_error)
+      __PYX_ERR(0, 1357, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1245
+      /* "pgenlib.pyx":1356
  *             if phasepresent_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few rows (" + str(phasepresent_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if allele_int32_out.shape[1] < 2 * subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":1247
+    /* "pgenlib.pyx":1358
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few columns (" + str(phasepresent_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     __pyx_t_12 = (((__pyx_v_phasepresent_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_12)) {
 
-      /* "pgenlib.pyx":1248
+      /* "pgenlib.pyx":1359
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few columns (" + str(phasepresent_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  */
-      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_phasepresent_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1248, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_phasepresent_out->dimensions[1])); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1248, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1359, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_8, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1248, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_alleles_and_p_8, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1248, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1359, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1248, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1248, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1359, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1248, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1248, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__12); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1359, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1248, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1248, __pyx_L1_error)
+      __PYX_ERR(0, 1359, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1247
+      /* "pgenlib.pyx":1358
  *             if allele_int32_out.shape[1] < 2 * subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few columns (" + str(allele_int32_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ", and column count should be twice that)")
  *             if phasepresent_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few columns (" + str(phasepresent_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     }
 
-    /* "pgenlib.pyx":1249
+    /* "pgenlib.pyx":1360
  *             if phasepresent_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few columns (" + str(phasepresent_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_8 = __pyx_v_variant_idx_ct;
     __pyx_t_13 = __pyx_t_8;
     for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_variant_list_idx = __pyx_t_14;
 
-      /* "pgenlib.pyx":1250
+      /* "pgenlib.pyx":1361
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() phasepresent_out buffer has too few columns (" + str(phasepresent_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_15 = __pyx_v_variant_list_idx;
       __pyx_t_6 = -1;
       if (unlikely(__pyx_t_15 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_6 = 0;
       if (unlikely(__pyx_t_6 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_6);
-        __PYX_ERR(0, 1250, __pyx_L1_error)
+        __PYX_ERR(0, 1361, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":1251
+      /* "pgenlib.pyx":1362
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  */
       __pyx_t_12 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_12)) {
 
-        /* "pgenlib.pyx":1252
+        /* "pgenlib.pyx":1363
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1252, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1363, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_li_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_li_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1252, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1363, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1252, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1363, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1252, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1363, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1252, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 1252, __pyx_L1_error)
+        __PYX_ERR(0, 1363, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1251
+        /* "pgenlib.pyx":1362
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  */
       }
 
-      /* "pgenlib.pyx":1253
+      /* "pgenlib.pyx":1364
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGetMP(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_pgrp, (&__pyx_v_self->_pgv));
 
-      /* "pgenlib.pyx":1254
+      /* "pgenlib.pyx":1365
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  */
       __pyx_t_12 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_12)) {
 
-        /* "pgenlib.pyx":1255
+        /* "pgenlib.pyx":1366
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[variant_list_idx, 0]))
  */
-        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1255, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1366, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1255, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1366, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_li_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1255, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_alleles_and_phasepresent_li_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1366, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1255, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1366, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_Raise(__pyx_t_4, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __PYX_ERR(0, 1255, __pyx_L1_error)
+        __PYX_ERR(0, 1366, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1254
+        /* "pgenlib.pyx":1365
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGetMP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  */
       }
 
-      /* "pgenlib.pyx":1256
+      /* "pgenlib.pyx":1367
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))             # <<<<<<<<<<<<<<
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[variant_list_idx, 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  */
       __pyx_t_15 = __pyx_v_variant_list_idx;
@@ -19454,19 +22175,19 @@
       if (unlikely(__pyx_t_15 >= (size_t)__pyx_pybuffernd_allele_int32_out.diminfo[0].shape)) __pyx_t_6 = 0;
       if (__pyx_t_16 < 0) {
         __pyx_t_16 += __pyx_pybuffernd_allele_int32_out.diminfo[1].shape;
         if (unlikely(__pyx_t_16 < 0)) __pyx_t_6 = 1;
       } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_allele_int32_out.diminfo[1].shape)) __pyx_t_6 = 1;
       if (unlikely(__pyx_t_6 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_6);
-        __PYX_ERR(0, 1256, __pyx_L1_error)
+        __PYX_ERR(0, 1367, __pyx_L1_error)
       }
       __pyx_v_main_data_ptr = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_allele_int32_out.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_allele_int32_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1257
+      /* "pgenlib.pyx":1368
  *                     raise RuntimeError("read_alleles_and_phasepresent_list() error " + str(reterr))
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[variant_list_idx, 0]))             # <<<<<<<<<<<<<<
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *             return
  */
       __pyx_t_15 = __pyx_v_variant_list_idx;
@@ -19475,62 +22196,62 @@
       if (unlikely(__pyx_t_15 >= (size_t)__pyx_pybuffernd_phasepresent_out.diminfo[0].shape)) __pyx_t_6 = 0;
       if (__pyx_t_16 < 0) {
         __pyx_t_16 += __pyx_pybuffernd_phasepresent_out.diminfo[1].shape;
         if (unlikely(__pyx_t_16 < 0)) __pyx_t_6 = 1;
       } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_phasepresent_out.diminfo[1].shape)) __pyx_t_6 = 1;
       if (unlikely(__pyx_t_6 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_6);
-        __PYX_ERR(0, 1257, __pyx_L1_error)
+        __PYX_ERR(0, 1368, __pyx_L1_error)
       }
       __pyx_v_phasepresent_data_ptr = ((unsigned char *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_uint8_t *, __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_phasepresent_out.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_phasepresent_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1258
+      /* "pgenlib.pyx":1369
  *                 main_data_ptr = <int32_t*>(&(allele_int32_out[variant_list_idx, 0]))
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[variant_list_idx, 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         raise RuntimeError("read_alleles_and_phasepresent_list() does not support hap_maj == 1 yet.")
  */
       plink2::GenoarrMPToAlleleCodesMinus9((&__pyx_v_self->_pgv), __pyx_v_subset_size, __pyx_v_phasepresent_data_ptr, __pyx_v_main_data_ptr);
     }
 
-    /* "pgenlib.pyx":1259
+    /* "pgenlib.pyx":1370
  *                 phasepresent_data_ptr = <unsigned char*>(&(phasepresent_out[variant_list_idx, 0]))
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         raise RuntimeError("read_alleles_and_phasepresent_list() does not support hap_maj == 1 yet.")
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":1240
+    /* "pgenlib.pyx":1351
  *         cdef uint32_t variant_idx
  *         cdef PglErr reterr
  *         if hap_maj == 0:             # <<<<<<<<<<<<<<
  *             if allele_int32_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_alleles_and_phasepresent_list() allele_int32_out buffer has too few rows (" + str(allele_int32_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":1260
+  /* "pgenlib.pyx":1371
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *             return
  *         raise RuntimeError("read_alleles_and_phasepresent_list() does not support hap_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1260, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1371, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_Raise(__pyx_t_4, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __PYX_ERR(0, 1260, __pyx_L1_error)
+  __PYX_ERR(0, 1371, __pyx_L1_error)
 
-  /* "pgenlib.pyx":1221
+  /* "pgenlib.pyx":1332
  * 
  * 
  *     cpdef read_alleles_and_phasepresent_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_out, np.ndarray[np.uint8_t,cast=True,mode="c",ndim=2] phasepresent_out, bint hap_maj = 0):             # <<<<<<<<<<<<<<
  *         # if hap_maj == False, allele_int32_out must have at least
  *         #   variant_idx_ct rows, 2 * sample_ct columns
  */
 
@@ -19599,31 +22320,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idxs)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_int32_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_list", 0, 3, 4, 1); __PYX_ERR(0, 1221, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_list", 0, 3, 4, 1); __PYX_ERR(0, 1332, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_phasepresent_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_list", 0, 3, 4, 2); __PYX_ERR(0, 1221, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_list", 0, 3, 4, 2); __PYX_ERR(0, 1332, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_hap_maj);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_and_phasepresent_list") < 0)) __PYX_ERR(0, 1221, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_alleles_and_phasepresent_list") < 0)) __PYX_ERR(0, 1332, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
@@ -19632,30 +22353,30 @@
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_variant_idxs = ((PyArrayObject *)values[0]);
     __pyx_v_allele_int32_out = ((PyArrayObject *)values[1]);
     __pyx_v_phasepresent_out = ((PyArrayObject *)values[2]);
     if (values[3]) {
-      __pyx_v_hap_maj = __Pyx_PyObject_IsTrue(values[3]); if (unlikely((__pyx_v_hap_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1221, __pyx_L3_error)
+      __pyx_v_hap_maj = __Pyx_PyObject_IsTrue(values[3]); if (unlikely((__pyx_v_hap_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1332, __pyx_L3_error)
     } else {
       __pyx_v_hap_maj = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_list", 0, 3, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1221, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_alleles_and_phasepresent_list", 0, 3, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1332, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_alleles_and_phasepresent_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_variant_idxs), __pyx_ptype_5numpy_ndarray, 1, "variant_idxs", 0))) __PYX_ERR(0, 1221, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 1221, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent_out), __pyx_ptype_5numpy_ndarray, 1, "phasepresent_out", 0))) __PYX_ERR(0, 1221, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_variant_idxs), __pyx_ptype_5numpy_ndarray, 1, "variant_idxs", 0))) __PYX_ERR(0, 1332, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_out), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_out", 0))) __PYX_ERR(0, 1332, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent_out), __pyx_ptype_5numpy_ndarray, 1, "phasepresent_out", 0))) __PYX_ERR(0, 1332, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_28read_alleles_and_phasepresent_list(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idxs, __pyx_v_allele_int32_out, __pyx_v_phasepresent_out, __pyx_v_hap_maj);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -19688,31 +22409,31 @@
   __pyx_pybuffernd_allele_int32_out.rcbuffer = &__pyx_pybuffer_allele_int32_out;
   __pyx_pybuffer_phasepresent_out.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent_out.refcount = 0;
   __pyx_pybuffernd_phasepresent_out.data = NULL;
   __pyx_pybuffernd_phasepresent_out.rcbuffer = &__pyx_pybuffer_phasepresent_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1221, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1332, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1221, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1332, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_out.diminfo[0].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_out.diminfo[0].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_out.diminfo[1].strides = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_out.diminfo[1].shape = __pyx_pybuffernd_allele_int32_out.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1221, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1332, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent_out.diminfo[0].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent_out.diminfo[0].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_phasepresent_out.diminfo[1].strides = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_phasepresent_out.diminfo[1].shape = __pyx_pybuffernd_phasepresent_out.rcbuffer->pybuffer.shape[1];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.hap_maj = __pyx_v_hap_maj;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_alleles_and_phasepresent_list(__pyx_v_self, __pyx_v_variant_idxs, __pyx_v_allele_int32_out, __pyx_v_phasepresent_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1221, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_alleles_and_phasepresent_list(__pyx_v_self, __pyx_v_variant_idxs, __pyx_v_allele_int32_out, __pyx_v_phasepresent_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -19734,15 +22455,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1263
+/* "pgenlib.pyx":1374
  * 
  * 
  *     cdef read_dosages_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -19792,170 +22513,170 @@
   }
   __pyx_pybuffer_floatarr_out.pybuffer.buf = NULL;
   __pyx_pybuffer_floatarr_out.refcount = 0;
   __pyx_pybuffernd_floatarr_out.data = NULL;
   __pyx_pybuffernd_floatarr_out.rcbuffer = &__pyx_pybuffer_floatarr_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1263, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1374, __pyx_L1_error)
   }
   __pyx_pybuffernd_floatarr_out.diminfo[0].strides = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_floatarr_out.diminfo[0].shape = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_floatarr_out.diminfo[1].strides = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_floatarr_out.diminfo[1].shape = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":1264
+  /* "pgenlib.pyx":1375
  * 
  *     cdef read_dosages_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_1 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_1;
 
-  /* "pgenlib.pyx":1265
+  /* "pgenlib.pyx":1376
  *     cdef read_dosages_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_2 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_2;
 
-  /* "pgenlib.pyx":1266
+  /* "pgenlib.pyx":1377
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  */
   __pyx_t_3 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_3;
 
-  /* "pgenlib.pyx":1267
+  /* "pgenlib.pyx":1378
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  */
   __pyx_t_1 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_1;
 
-  /* "pgenlib.pyx":1268
+  /* "pgenlib.pyx":1379
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present             # <<<<<<<<<<<<<<
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  */
   __pyx_t_1 = __pyx_v_self->_pgv.dosage_present;
   __pyx_v_dosage_present = __pyx_t_1;
 
-  /* "pgenlib.pyx":1269
+  /* "pgenlib.pyx":1380
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_4 = __pyx_v_self->_pgv.dosage_main;
   __pyx_v_dosage_main = __pyx_t_4;
 
-  /* "pgenlib.pyx":1270
+  /* "pgenlib.pyx":1381
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef float* data32_ptr
  */
   __pyx_v_variant_idx_ct = (__pyx_v_variant_idx_end - __pyx_v_variant_idx_start);
 
-  /* "pgenlib.pyx":1271
+  /* "pgenlib.pyx":1382
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef float* data32_ptr
  *         cdef uint32_t variant_idx
  */
   __pyx_t_5 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_5;
 
-  /* "pgenlib.pyx":1276
+  /* "pgenlib.pyx":1387
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  */
   __pyx_t_6 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_6) {
 
-    /* "pgenlib.pyx":1277
+    /* "pgenlib.pyx":1388
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             for variant_idx in range(variant_idx_start, variant_idx_end):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_5 = __pyx_v_variant_idx_end;
     __pyx_t_7 = __pyx_t_5;
     for (__pyx_t_8 = __pyx_v_variant_idx_start; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
       __pyx_v_variant_idx = __pyx_t_8;
 
-      /* "pgenlib.pyx":1278
+      /* "pgenlib.pyx":1389
  *         if sample_maj == 0:
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1D(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, (&__pyx_v_dosage_ct));
 
-      /* "pgenlib.pyx":1279
+      /* "pgenlib.pyx":1390
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  *                 data32_ptr = <float*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  */
       __pyx_t_6 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_6)) {
 
-        /* "pgenlib.pyx":1280
+        /* "pgenlib.pyx":1391
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data32_ptr = <float*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  */
-        __pyx_t_9 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1280, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1391, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1280, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1391, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_range_error, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1280, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_range_error, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1391, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-        __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1280, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1391, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __Pyx_Raise(__pyx_t_10, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-        __PYX_ERR(0, 1280, __pyx_L1_error)
+        __PYX_ERR(0, 1391, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1279
+        /* "pgenlib.pyx":1390
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  *                 data32_ptr = <float*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  */
       }
 
-      /* "pgenlib.pyx":1281
+      /* "pgenlib.pyx":1392
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  *                 data32_ptr = <float*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))             # <<<<<<<<<<<<<<
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  *             return
  */
       __pyx_t_11 = (__pyx_v_variant_idx - __pyx_v_variant_idx_start);
@@ -19964,62 +22685,62 @@
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_floatarr_out.diminfo[0].shape)) __pyx_t_13 = 0;
       if (__pyx_t_12 < 0) {
         __pyx_t_12 += __pyx_pybuffernd_floatarr_out.diminfo[1].shape;
         if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 1;
       } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_floatarr_out.diminfo[1].shape)) __pyx_t_13 = 1;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        __PYX_ERR(0, 1281, __pyx_L1_error)
+        __PYX_ERR(0, 1392, __pyx_L1_error)
       }
       __pyx_v_data32_ptr = ((float *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_floatarr_out.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_floatarr_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1282
+      /* "pgenlib.pyx":1393
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  *                 data32_ptr = <float*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         raise RuntimeError("read_dosages_range() does not support sample_maj == 1 yet.")
  */
       plink2::Dosage16ToFloatsMinus9(__pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, __pyx_v_subset_size, __pyx_v_dosage_ct, __pyx_v_data32_ptr);
     }
 
-    /* "pgenlib.pyx":1283
+    /* "pgenlib.pyx":1394
  *                 data32_ptr = <float*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         raise RuntimeError("read_dosages_range() does not support sample_maj == 1 yet.")
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":1276
+    /* "pgenlib.pyx":1387
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  */
   }
 
-  /* "pgenlib.pyx":1284
+  /* "pgenlib.pyx":1395
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  *             return
  *         raise RuntimeError("read_dosages_range() does not support sample_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1284, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1395, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_Raise(__pyx_t_10, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __PYX_ERR(0, 1284, __pyx_L1_error)
+  __PYX_ERR(0, 1395, __pyx_L1_error)
 
-  /* "pgenlib.pyx":1263
+  /* "pgenlib.pyx":1374
  * 
  * 
  *     cdef read_dosages_range_internal32(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -20040,15 +22761,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1287
+/* "pgenlib.pyx":1398
  * 
  * 
  *     cdef read_dosages_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -20098,170 +22819,170 @@
   }
   __pyx_pybuffer_floatarr_out.pybuffer.buf = NULL;
   __pyx_pybuffer_floatarr_out.refcount = 0;
   __pyx_pybuffernd_floatarr_out.data = NULL;
   __pyx_pybuffernd_floatarr_out.rcbuffer = &__pyx_pybuffer_floatarr_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1287, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1398, __pyx_L1_error)
   }
   __pyx_pybuffernd_floatarr_out.diminfo[0].strides = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_floatarr_out.diminfo[0].shape = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_floatarr_out.diminfo[1].strides = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_floatarr_out.diminfo[1].shape = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":1288
+  /* "pgenlib.pyx":1399
  * 
  *     cdef read_dosages_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_1 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_1;
 
-  /* "pgenlib.pyx":1289
+  /* "pgenlib.pyx":1400
  *     cdef read_dosages_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_2 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_2;
 
-  /* "pgenlib.pyx":1290
+  /* "pgenlib.pyx":1401
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  */
   __pyx_t_3 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_3;
 
-  /* "pgenlib.pyx":1291
+  /* "pgenlib.pyx":1402
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  */
   __pyx_t_1 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_1;
 
-  /* "pgenlib.pyx":1292
+  /* "pgenlib.pyx":1403
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present             # <<<<<<<<<<<<<<
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  */
   __pyx_t_1 = __pyx_v_self->_pgv.dosage_present;
   __pyx_v_dosage_present = __pyx_t_1;
 
-  /* "pgenlib.pyx":1293
+  /* "pgenlib.pyx":1404
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_4 = __pyx_v_self->_pgv.dosage_main;
   __pyx_v_dosage_main = __pyx_t_4;
 
-  /* "pgenlib.pyx":1294
+  /* "pgenlib.pyx":1405
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef double* data64_ptr
  */
   __pyx_v_variant_idx_ct = (__pyx_v_variant_idx_end - __pyx_v_variant_idx_start);
 
-  /* "pgenlib.pyx":1295
+  /* "pgenlib.pyx":1406
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = variant_idx_end - variant_idx_start
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef double* data64_ptr
  *         cdef uint32_t variant_idx
  */
   __pyx_t_5 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_5;
 
-  /* "pgenlib.pyx":1300
+  /* "pgenlib.pyx":1411
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  */
   __pyx_t_6 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_6) {
 
-    /* "pgenlib.pyx":1301
+    /* "pgenlib.pyx":1412
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             for variant_idx in range(variant_idx_start, variant_idx_end):             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_5 = __pyx_v_variant_idx_end;
     __pyx_t_7 = __pyx_t_5;
     for (__pyx_t_8 = __pyx_v_variant_idx_start; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
       __pyx_v_variant_idx = __pyx_t_8;
 
-      /* "pgenlib.pyx":1302
+      /* "pgenlib.pyx":1413
  *         if sample_maj == 0:
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1D(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, (&__pyx_v_dosage_ct));
 
-      /* "pgenlib.pyx":1303
+      /* "pgenlib.pyx":1414
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  *                 data64_ptr = <double*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  */
       __pyx_t_6 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_6)) {
 
-        /* "pgenlib.pyx":1304
+        /* "pgenlib.pyx":1415
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data64_ptr = <double*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)
  */
-        __pyx_t_9 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1304, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1415, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1304, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1415, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_range_error, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1304, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_range_error, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1415, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-        __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1304, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1415, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __Pyx_Raise(__pyx_t_10, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-        __PYX_ERR(0, 1304, __pyx_L1_error)
+        __PYX_ERR(0, 1415, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1303
+        /* "pgenlib.pyx":1414
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  *                 data64_ptr = <double*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  */
       }
 
-      /* "pgenlib.pyx":1305
+      /* "pgenlib.pyx":1416
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  *                 data64_ptr = <double*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))             # <<<<<<<<<<<<<<
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)
  *             return
  */
       __pyx_t_11 = (__pyx_v_variant_idx - __pyx_v_variant_idx_start);
@@ -20270,62 +22991,62 @@
       if (unlikely(__pyx_t_11 >= (size_t)__pyx_pybuffernd_floatarr_out.diminfo[0].shape)) __pyx_t_13 = 0;
       if (__pyx_t_12 < 0) {
         __pyx_t_12 += __pyx_pybuffernd_floatarr_out.diminfo[1].shape;
         if (unlikely(__pyx_t_12 < 0)) __pyx_t_13 = 1;
       } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_floatarr_out.diminfo[1].shape)) __pyx_t_13 = 1;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        __PYX_ERR(0, 1305, __pyx_L1_error)
+        __PYX_ERR(0, 1416, __pyx_L1_error)
       }
       __pyx_v_data64_ptr = ((double *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_floatarr_out.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_floatarr_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1306
+      /* "pgenlib.pyx":1417
  *                     raise RuntimeError("read_dosages_range() error " + str(reterr))
  *                 data64_ptr = <double*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         raise RuntimeError("read_dosages_range() does not support sample_maj == 1 yet.")
  */
       plink2::Dosage16ToDoublesMinus9(__pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, __pyx_v_subset_size, __pyx_v_dosage_ct, __pyx_v_data64_ptr);
     }
 
-    /* "pgenlib.pyx":1307
+    /* "pgenlib.pyx":1418
  *                 data64_ptr = <double*>(&(floatarr_out[(variant_idx - variant_idx_start), 0]))
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         raise RuntimeError("read_dosages_range() does not support sample_maj == 1 yet.")
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":1300
+    /* "pgenlib.pyx":1411
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             for variant_idx in range(variant_idx_start, variant_idx_end):
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  */
   }
 
-  /* "pgenlib.pyx":1308
+  /* "pgenlib.pyx":1419
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)
  *             return
  *         raise RuntimeError("read_dosages_range() does not support sample_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1308, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_Raise(__pyx_t_10, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __PYX_ERR(0, 1308, __pyx_L1_error)
+  __PYX_ERR(0, 1419, __pyx_L1_error)
 
-  /* "pgenlib.pyx":1287
+  /* "pgenlib.pyx":1398
  * 
  * 
  *     cdef read_dosages_range_internal64(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -20346,15 +23067,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1311
+/* "pgenlib.pyx":1422
  * 
  * 
  *     cpdef read_dosages_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -20394,25 +23115,25 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_dosages_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_dosages_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1422, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_31read_dosages_range)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1311, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1422, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1311, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1422, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1311, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1422, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_v_sample_maj); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1311, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_v_sample_maj); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1422, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_7 = __pyx_t_1; __pyx_t_8 = NULL;
         __pyx_t_9 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
           __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
           if (likely(__pyx_t_8)) {
@@ -20422,37 +23143,37 @@
             __Pyx_DECREF_SET(__pyx_t_7, function);
             __pyx_t_9 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_7)) {
           PyObject *__pyx_temp[6] = {__pyx_t_8, __pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_floatarr_out), __pyx_t_5, __pyx_t_6};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_9, 5+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_9, 5+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1422, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
           PyObject *__pyx_temp[6] = {__pyx_t_8, __pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_floatarr_out), __pyx_t_5, __pyx_t_6};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_9, 5+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_9, 5+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1422, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         } else
         #endif
         {
-          __pyx_t_10 = PyTuple_New(5+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1311, __pyx_L1_error)
+          __pyx_t_10 = PyTuple_New(5+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1422, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           if (__pyx_t_8) {
             __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
@@ -20464,15 +23185,15 @@
           PyTuple_SET_ITEM(__pyx_t_10, 3+__pyx_t_9, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_6);
           PyTuple_SET_ITEM(__pyx_t_10, 4+__pyx_t_9, __pyx_t_6);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
           __pyx_t_5 = 0;
           __pyx_t_6 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1422, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -20487,188 +23208,188 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1312
+  /* "pgenlib.pyx":1423
  * 
  *     cpdef read_dosages_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.dtype == np.float32:
  */
   __pyx_t_11 = ((__pyx_v_variant_idx_end > (__pyx_v_self->_info_ptr[0]).raw_variant_ct) != 0);
   if (unlikely(__pyx_t_11)) {
 
-    /* "pgenlib.pyx":1313
+    /* "pgenlib.pyx":1424
  *     cpdef read_dosages_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_range_internal32(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_end); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_range_variant_idx_e, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_range_variant_idx_e, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_only); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t((__pyx_v_self->_info_ptr[0]).raw_variant_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1313, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1313, __pyx_L1_error)
+    __PYX_ERR(0, 1424, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1312
+    /* "pgenlib.pyx":1423
  * 
  *     cpdef read_dosages_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("read_dosages_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.dtype == np.float32:
  */
   }
 
-  /* "pgenlib.pyx":1314
+  /* "pgenlib.pyx":1425
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             self.read_dosages_range_internal32(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1314, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1314, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1314, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1314, __pyx_L1_error)
+  __pyx_t_7 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1425, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1314, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1425, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (__pyx_t_11) {
 
-    /* "pgenlib.pyx":1315
+    /* "pgenlib.pyx":1426
  *             raise RuntimeError("read_dosages_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_range_internal32(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         elif floatarr_out.dtype == np.float64:
  *             self.read_dosages_range_internal64(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  */
     __pyx_t_12.__pyx_n = 2;
     __pyx_t_12.allele_idx = __pyx_v_allele_idx;
     __pyx_t_12.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_7 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_dosages_range_internal32(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_floatarr_out), &__pyx_t_12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1315, __pyx_L1_error)
+    __pyx_t_7 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_dosages_range_internal32(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_floatarr_out), &__pyx_t_12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1426, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "pgenlib.pyx":1314
+    /* "pgenlib.pyx":1425
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             self.read_dosages_range_internal32(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:
  */
     goto __pyx_L4;
   }
 
-  /* "pgenlib.pyx":1316
+  /* "pgenlib.pyx":1427
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_range_internal32(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             self.read_dosages_range_internal64(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  *         else:
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1316, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1427, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1316, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1427, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1427, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_7, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1316, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_7, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1427, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1316, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1427, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (likely(__pyx_t_11)) {
 
-    /* "pgenlib.pyx":1317
+    /* "pgenlib.pyx":1428
  *             self.read_dosages_range_internal32(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:
  *             self.read_dosages_range_internal64(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         else:
  *             raise RuntimeError("Invalid read_dosages_range() floatarr_out array element type (float32 or float64 expected).")
  */
     __pyx_t_13.__pyx_n = 2;
     __pyx_t_13.allele_idx = __pyx_v_allele_idx;
     __pyx_t_13.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_dosages_range_internal64(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_floatarr_out), &__pyx_t_13); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1317, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_dosages_range_internal64(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, ((PyArrayObject *)__pyx_v_floatarr_out), &__pyx_t_13); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1428, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pgenlib.pyx":1316
+    /* "pgenlib.pyx":1427
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_range_internal32(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             self.read_dosages_range_internal64(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  *         else:
  */
     goto __pyx_L4;
   }
 
-  /* "pgenlib.pyx":1319
+  /* "pgenlib.pyx":1430
  *             self.read_dosages_range_internal64(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  *         else:
  *             raise RuntimeError("Invalid read_dosages_range() floatarr_out array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   /*else*/ {
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1319, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1430, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1319, __pyx_L1_error)
+    __PYX_ERR(0, 1430, __pyx_L1_error)
   }
   __pyx_L4:;
 
-  /* "pgenlib.pyx":1320
+  /* "pgenlib.pyx":1431
  *         else:
  *             raise RuntimeError("Invalid read_dosages_range() floatarr_out array element type (float32 or float64 expected).")
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1311
+  /* "pgenlib.pyx":1422
  * 
  * 
  *     cpdef read_dosages_range(self, uint32_t variant_idx_start, uint32_t variant_idx_end, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if variant_idx_end > self._info_ptr[0].raw_variant_ct:
  *             raise RuntimeError("read_dosages_range() variant_idx_end too large (" + str(variant_idx_end) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  */
 
@@ -20730,21 +23451,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx_start)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx_end)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_dosages_range", 0, 3, 5, 1); __PYX_ERR(0, 1311, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_dosages_range", 0, 3, 5, 1); __PYX_ERR(0, 1422, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_floatarr_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_dosages_range", 0, 3, 5, 2); __PYX_ERR(0, 1311, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_dosages_range", 0, 3, 5, 2); __PYX_ERR(0, 1422, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_idx);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -20752,52 +23473,52 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sample_maj);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_dosages_range") < 0)) __PYX_ERR(0, 1311, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_dosages_range") < 0)) __PYX_ERR(0, 1422, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_variant_idx_start = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx_start == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
-    __pyx_v_variant_idx_end = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_variant_idx_end == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
+    __pyx_v_variant_idx_start = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx_start == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1422, __pyx_L3_error)
+    __pyx_v_variant_idx_end = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_variant_idx_end == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1422, __pyx_L3_error)
     __pyx_v_floatarr_out = ((PyArrayObject *)values[2]);
     if (values[3]) {
-      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[3]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
+      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[3]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1422, __pyx_L3_error)
     } else {
       __pyx_v_allele_idx = ((uint32_t)1);
     }
     if (values[4]) {
-      __pyx_v_sample_maj = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_sample_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
+      __pyx_v_sample_maj = __Pyx_PyObject_IsTrue(values[4]); if (unlikely((__pyx_v_sample_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1422, __pyx_L3_error)
     } else {
       __pyx_v_sample_maj = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_dosages_range", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1311, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_dosages_range", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1422, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_dosages_range", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr_out), __pyx_ptype_5numpy_ndarray, 1, "floatarr_out", 0))) __PYX_ERR(0, 1311, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr_out), __pyx_ptype_5numpy_ndarray, 1, "floatarr_out", 0))) __PYX_ERR(0, 1422, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_30read_dosages_range(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_floatarr_out, __pyx_v_allele_idx, __pyx_v_sample_maj);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -20814,15 +23535,15 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_dosages_range", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.allele_idx = __pyx_v_allele_idx;
   __pyx_t_2.sample_maj = __pyx_v_sample_maj;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_dosages_range(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_floatarr_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_dosages_range(__pyx_v_self, __pyx_v_variant_idx_start, __pyx_v_variant_idx_end, __pyx_v_floatarr_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -20831,15 +23552,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1323
+/* "pgenlib.pyx":1434
  * 
  * 
  *     cdef read_dosages_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -20898,369 +23619,369 @@
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   __pyx_pybuffer_floatarr_out.pybuffer.buf = NULL;
   __pyx_pybuffer_floatarr_out.refcount = 0;
   __pyx_pybuffernd_floatarr_out.data = NULL;
   __pyx_pybuffernd_floatarr_out.rcbuffer = &__pyx_pybuffer_floatarr_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1323, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1434, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1323, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1434, __pyx_L1_error)
   }
   __pyx_pybuffernd_floatarr_out.diminfo[0].strides = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_floatarr_out.diminfo[0].shape = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_floatarr_out.diminfo[1].strides = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_floatarr_out.diminfo[1].shape = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":1324
+  /* "pgenlib.pyx":1435
  * 
  *     cdef read_dosages_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
   __pyx_t_1 = (__pyx_v_self->_info_ptr[0]).raw_variant_ct;
   __pyx_v_raw_variant_ct = __pyx_t_1;
 
-  /* "pgenlib.pyx":1325
+  /* "pgenlib.pyx":1436
  *     cdef read_dosages_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_2 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_2;
 
-  /* "pgenlib.pyx":1326
+  /* "pgenlib.pyx":1437
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_3 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_3;
 
-  /* "pgenlib.pyx":1327
+  /* "pgenlib.pyx":1438
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  */
   __pyx_t_4 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_4;
 
-  /* "pgenlib.pyx":1328
+  /* "pgenlib.pyx":1439
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  */
   __pyx_t_2 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_2;
 
-  /* "pgenlib.pyx":1329
+  /* "pgenlib.pyx":1440
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present             # <<<<<<<<<<<<<<
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  */
   __pyx_t_2 = __pyx_v_self->_pgv.dosage_present;
   __pyx_v_dosage_present = __pyx_t_2;
 
-  /* "pgenlib.pyx":1330
+  /* "pgenlib.pyx":1441
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_5 = __pyx_v_self->_pgv.dosage_main;
   __pyx_v_dosage_main = __pyx_t_5;
 
-  /* "pgenlib.pyx":1331
+  /* "pgenlib.pyx":1442
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef float* data32_ptr
  */
   __pyx_v_variant_idx_ct = ((uint32_t)(__pyx_v_variant_idxs->dimensions[0]));
 
-  /* "pgenlib.pyx":1332
+  /* "pgenlib.pyx":1443
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef float* data32_ptr
  *         cdef uint32_t variant_list_idx
  */
   __pyx_t_1 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_1;
 
-  /* "pgenlib.pyx":1338
+  /* "pgenlib.pyx":1449
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_6 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_6) {
 
-    /* "pgenlib.pyx":1339
+    /* "pgenlib.pyx":1450
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if floatarr_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:
  */
     __pyx_t_6 = (((__pyx_v_floatarr_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_6)) {
 
-      /* "pgenlib.pyx":1340
+      /* "pgenlib.pyx":1451
  *         if sample_maj == 0:
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if floatarr_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1340, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1340, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_dosages_list, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1340, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_dosages_list, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1340, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1340, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1340, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1340, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1340, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1340, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_Raise(__pyx_t_7, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __PYX_ERR(0, 1340, __pyx_L1_error)
+      __PYX_ERR(0, 1451, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1339
+      /* "pgenlib.pyx":1450
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if floatarr_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":1341
+    /* "pgenlib.pyx":1452
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     __pyx_t_6 = (((__pyx_v_floatarr_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_6)) {
 
-      /* "pgenlib.pyx":1342
+      /* "pgenlib.pyx":1453
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  */
-      __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1342, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1342, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_dosages_list_2, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1342, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_dosages_list_2, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1342, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1342, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1342, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_9, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1342, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_9, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1342, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1342, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_7, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __PYX_ERR(0, 1342, __pyx_L1_error)
+      __PYX_ERR(0, 1453, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1341
+      /* "pgenlib.pyx":1452
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     }
 
-    /* "pgenlib.pyx":1343
+    /* "pgenlib.pyx":1454
  *             if floatarr_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_1 = __pyx_v_variant_idx_ct;
     __pyx_t_10 = __pyx_t_1;
     for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
       __pyx_v_variant_list_idx = __pyx_t_11;
 
-      /* "pgenlib.pyx":1344
+      /* "pgenlib.pyx":1455
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_12 = __pyx_v_variant_list_idx;
       __pyx_t_13 = -1;
       if (unlikely(__pyx_t_12 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_13 = 0;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        __PYX_ERR(0, 1344, __pyx_L1_error)
+        __PYX_ERR(0, 1455, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":1345
+      /* "pgenlib.pyx":1456
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  */
       __pyx_t_6 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_6)) {
 
-        /* "pgenlib.pyx":1346
+        /* "pgenlib.pyx":1457
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1346, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1346, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_list_variant_index, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1346, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_list_variant_index, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_only); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1346, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_only); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1346, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1346, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1346, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1346, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1346, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __Pyx_Raise(__pyx_t_7, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __PYX_ERR(0, 1346, __pyx_L1_error)
+        __PYX_ERR(0, 1457, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1345
+        /* "pgenlib.pyx":1456
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  */
       }
 
-      /* "pgenlib.pyx":1347
+      /* "pgenlib.pyx":1458
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1D(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, (&__pyx_v_dosage_ct));
 
-      /* "pgenlib.pyx":1348
+      /* "pgenlib.pyx":1459
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data32_ptr = <float*>(&(floatarr_out[variant_list_idx, 0]))
  */
       __pyx_t_6 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_6)) {
 
-        /* "pgenlib.pyx":1349
+        /* "pgenlib.pyx":1460
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data32_ptr = <float*>(&(floatarr_out[variant_list_idx, 0]))
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  */
-        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1349, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1349, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1349, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1349, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_9, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __PYX_ERR(0, 1349, __pyx_L1_error)
+        __PYX_ERR(0, 1460, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1348
+        /* "pgenlib.pyx":1459
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data32_ptr = <float*>(&(floatarr_out[variant_list_idx, 0]))
  */
       }
 
-      /* "pgenlib.pyx":1350
+      /* "pgenlib.pyx":1461
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data32_ptr = <float*>(&(floatarr_out[variant_list_idx, 0]))             # <<<<<<<<<<<<<<
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  *             return
  */
       __pyx_t_12 = __pyx_v_variant_list_idx;
@@ -21269,62 +23990,62 @@
       if (unlikely(__pyx_t_12 >= (size_t)__pyx_pybuffernd_floatarr_out.diminfo[0].shape)) __pyx_t_13 = 0;
       if (__pyx_t_14 < 0) {
         __pyx_t_14 += __pyx_pybuffernd_floatarr_out.diminfo[1].shape;
         if (unlikely(__pyx_t_14 < 0)) __pyx_t_13 = 1;
       } else if (unlikely(__pyx_t_14 >= __pyx_pybuffernd_floatarr_out.diminfo[1].shape)) __pyx_t_13 = 1;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        __PYX_ERR(0, 1350, __pyx_L1_error)
+        __PYX_ERR(0, 1461, __pyx_L1_error)
       }
       __pyx_v_data32_ptr = ((float *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_floatarr_out.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_floatarr_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1351
+      /* "pgenlib.pyx":1462
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data32_ptr = <float*>(&(floatarr_out[variant_list_idx, 0]))
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         raise RuntimeError("read_dosages_list() does not support sample_maj == 1 yet.")
  */
       plink2::Dosage16ToFloatsMinus9(__pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, __pyx_v_subset_size, __pyx_v_dosage_ct, __pyx_v_data32_ptr);
     }
 
-    /* "pgenlib.pyx":1352
+    /* "pgenlib.pyx":1463
  *                 data32_ptr = <float*>(&(floatarr_out[variant_list_idx, 0]))
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         raise RuntimeError("read_dosages_list() does not support sample_maj == 1 yet.")
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":1338
+    /* "pgenlib.pyx":1449
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":1353
+  /* "pgenlib.pyx":1464
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  *             return
  *         raise RuntimeError("read_dosages_list() does not support sample_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1353, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1464, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_Raise(__pyx_t_9, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __PYX_ERR(0, 1353, __pyx_L1_error)
+  __PYX_ERR(0, 1464, __pyx_L1_error)
 
-  /* "pgenlib.pyx":1323
+  /* "pgenlib.pyx":1434
  * 
  * 
  *     cdef read_dosages_list_internal32(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -21348,15 +24069,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1356
+/* "pgenlib.pyx":1467
  * 
  * 
  *     cdef read_dosages_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -21415,369 +24136,369 @@
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   __pyx_pybuffer_floatarr_out.pybuffer.buf = NULL;
   __pyx_pybuffer_floatarr_out.refcount = 0;
   __pyx_pybuffernd_floatarr_out.data = NULL;
   __pyx_pybuffernd_floatarr_out.rcbuffer = &__pyx_pybuffer_floatarr_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1356, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1467, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1356, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1467, __pyx_L1_error)
   }
   __pyx_pybuffernd_floatarr_out.diminfo[0].strides = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_floatarr_out.diminfo[0].shape = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_floatarr_out.diminfo[1].strides = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_floatarr_out.diminfo[1].shape = __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":1357
+  /* "pgenlib.pyx":1468
  * 
  *     cdef read_dosages_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
   __pyx_t_1 = (__pyx_v_self->_info_ptr[0]).raw_variant_ct;
   __pyx_v_raw_variant_ct = __pyx_t_1;
 
-  /* "pgenlib.pyx":1358
+  /* "pgenlib.pyx":1469
  *     cdef read_dosages_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_2 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_2;
 
-  /* "pgenlib.pyx":1359
+  /* "pgenlib.pyx":1470
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  */
   __pyx_t_3 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_3;
 
-  /* "pgenlib.pyx":1360
+  /* "pgenlib.pyx":1471
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  */
   __pyx_t_4 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_4;
 
-  /* "pgenlib.pyx":1361
+  /* "pgenlib.pyx":1472
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  */
   __pyx_t_2 = __pyx_v_self->_pgv.genovec;
   __pyx_v_genovec = __pyx_t_2;
 
-  /* "pgenlib.pyx":1362
+  /* "pgenlib.pyx":1473
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present             # <<<<<<<<<<<<<<
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  */
   __pyx_t_2 = __pyx_v_self->_pgv.dosage_present;
   __pyx_v_dosage_present = __pyx_t_2;
 
-  /* "pgenlib.pyx":1363
+  /* "pgenlib.pyx":1474
  *         cdef uintptr_t* genovec = self._pgv.genovec
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_5 = __pyx_v_self->_pgv.dosage_main;
   __pyx_v_dosage_main = __pyx_t_5;
 
-  /* "pgenlib.pyx":1364
+  /* "pgenlib.pyx":1475
  *         cdef uintptr_t* dosage_present = self._pgv.dosage_present
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef double* data64_ptr
  */
   __pyx_v_variant_idx_ct = ((uint32_t)(__pyx_v_variant_idxs->dimensions[0]));
 
-  /* "pgenlib.pyx":1365
+  /* "pgenlib.pyx":1476
  *         cdef uint16_t* dosage_main = self._pgv.dosage_main
  *         cdef uint32_t variant_idx_ct = <uint32_t>variant_idxs.shape[0]
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef double* data64_ptr
  *         cdef uint32_t variant_list_idx
  */
   __pyx_t_1 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_1;
 
-  /* "pgenlib.pyx":1371
+  /* "pgenlib.pyx":1482
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   __pyx_t_6 = ((__pyx_v_sample_maj == 0) != 0);
   if (__pyx_t_6) {
 
-    /* "pgenlib.pyx":1372
+    /* "pgenlib.pyx":1483
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if floatarr_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:
  */
     __pyx_t_6 = (((__pyx_v_floatarr_out->dimensions[0]) < __pyx_v_variant_idx_ct) != 0);
     if (unlikely(__pyx_t_6)) {
 
-      /* "pgenlib.pyx":1373
+      /* "pgenlib.pyx":1484
  *         if sample_maj == 0:
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")             # <<<<<<<<<<<<<<
  *             if floatarr_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  */
-      __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1373, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[0])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1484, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1373, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1484, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_dosages_list, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1373, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_dosages_list, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1484, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1373, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_variant_idxs_length_is); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1484, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1373, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1484, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1373, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1484, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1373, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1484, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1373, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1484, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1373, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1484, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_Raise(__pyx_t_7, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __PYX_ERR(0, 1373, __pyx_L1_error)
+      __PYX_ERR(0, 1484, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1372
+      /* "pgenlib.pyx":1483
  *         cdef PglErr reterr
  *         if sample_maj == 0:
  *             if floatarr_out.shape[0] < variant_idx_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:
  */
     }
 
-    /* "pgenlib.pyx":1374
+    /* "pgenlib.pyx":1485
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     __pyx_t_6 = (((__pyx_v_floatarr_out->dimensions[1]) < __pyx_v_subset_size) != 0);
     if (unlikely(__pyx_t_6)) {
 
-      /* "pgenlib.pyx":1375
+      /* "pgenlib.pyx":1486
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")             # <<<<<<<<<<<<<<
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  */
-      __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_floatarr_out->dimensions[1])); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1486, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1486, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_dosages_list_2, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Variant_major_read_dosages_list_2, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1486, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_current_sample_subset_has_size); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1486, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_subset_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1486, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1486, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_9, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_9, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1486, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u__12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1486, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1375, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1486, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_7, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __PYX_ERR(0, 1375, __pyx_L1_error)
+      __PYX_ERR(0, 1486, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1374
+      /* "pgenlib.pyx":1485
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  *             if floatarr_out.shape[1] < subset_size:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  */
     }
 
-    /* "pgenlib.pyx":1376
+    /* "pgenlib.pyx":1487
  *             if floatarr_out.shape[1] < subset_size:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):             # <<<<<<<<<<<<<<
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  */
     __pyx_t_1 = __pyx_v_variant_idx_ct;
     __pyx_t_10 = __pyx_t_1;
     for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
       __pyx_v_variant_list_idx = __pyx_t_11;
 
-      /* "pgenlib.pyx":1377
+      /* "pgenlib.pyx":1488
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few columns (" + str(floatarr_out.shape[1]) + "; current sample subset has size " + str(subset_size) + ")")
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]             # <<<<<<<<<<<<<<
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  */
       __pyx_t_12 = __pyx_v_variant_list_idx;
       __pyx_t_13 = -1;
       if (unlikely(__pyx_t_12 >= (size_t)__pyx_pybuffernd_variant_idxs.diminfo[0].shape)) __pyx_t_13 = 0;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        __PYX_ERR(0, 1377, __pyx_L1_error)
+        __PYX_ERR(0, 1488, __pyx_L1_error)
       }
       __pyx_v_variant_idx = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_variant_idxs.diminfo[0].strides));
 
-      /* "pgenlib.pyx":1378
+      /* "pgenlib.pyx":1489
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  */
       __pyx_t_6 = ((__pyx_v_variant_idx >= __pyx_v_raw_variant_ct) != 0);
       if (unlikely(__pyx_t_6)) {
 
-        /* "pgenlib.pyx":1379
+        /* "pgenlib.pyx":1490
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1490, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1490, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_list_variant_index, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_dosages_list_variant_index, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1490, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_only); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_only); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1490, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_uint32_t(__pyx_v_raw_variant_ct); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1490, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1490, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1490, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_t_7, __pyx_kp_u_in_file_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1490, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1379, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1490, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         __Pyx_Raise(__pyx_t_7, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __PYX_ERR(0, 1379, __pyx_L1_error)
+        __PYX_ERR(0, 1490, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1378
+        /* "pgenlib.pyx":1489
  *             for variant_list_idx in range(variant_idx_ct):
  *                 variant_idx = variant_idxs[variant_list_idx]
  *                 if variant_idx >= raw_variant_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  */
       }
 
-      /* "pgenlib.pyx":1380
+      /* "pgenlib.pyx":1491
  *                 if variant_idx >= raw_variant_ct:
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGet1D(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_allele_idx, __pyx_v_pgrp, __pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, (&__pyx_v_dosage_ct));
 
-      /* "pgenlib.pyx":1381
+      /* "pgenlib.pyx":1492
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data64_ptr = <double*>(&(floatarr_out[variant_list_idx, 0]))
  */
       __pyx_t_6 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_6)) {
 
-        /* "pgenlib.pyx":1382
+        /* "pgenlib.pyx":1493
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 data64_ptr = <double*>(&(floatarr_out[variant_list_idx, 0]))
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)
  */
-        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1382, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1493, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1382, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1493, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1382, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_kp_u_read_range_error, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1493, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1382, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1493, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_Raise(__pyx_t_9, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __PYX_ERR(0, 1382, __pyx_L1_error)
+        __PYX_ERR(0, 1493, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1381
+        /* "pgenlib.pyx":1492
  *                     raise RuntimeError("read_dosages_list() variant index too large (" + str(variant_idx) + "; only " + str(raw_variant_ct) + " in file)")
  *                 reterr = PgrGet1D(subset_include_vec, subset_index, subset_size, variant_idx, allele_idx, pgrp, genovec, dosage_present, dosage_main, &dosage_ct)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data64_ptr = <double*>(&(floatarr_out[variant_list_idx, 0]))
  */
       }
 
-      /* "pgenlib.pyx":1383
+      /* "pgenlib.pyx":1494
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data64_ptr = <double*>(&(floatarr_out[variant_list_idx, 0]))             # <<<<<<<<<<<<<<
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)
  *             return
  */
       __pyx_t_12 = __pyx_v_variant_list_idx;
@@ -21786,62 +24507,62 @@
       if (unlikely(__pyx_t_12 >= (size_t)__pyx_pybuffernd_floatarr_out.diminfo[0].shape)) __pyx_t_13 = 0;
       if (__pyx_t_14 < 0) {
         __pyx_t_14 += __pyx_pybuffernd_floatarr_out.diminfo[1].shape;
         if (unlikely(__pyx_t_14 < 0)) __pyx_t_13 = 1;
       } else if (unlikely(__pyx_t_14 >= __pyx_pybuffernd_floatarr_out.diminfo[1].shape)) __pyx_t_13 = 1;
       if (unlikely(__pyx_t_13 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_13);
-        __PYX_ERR(0, 1383, __pyx_L1_error)
+        __PYX_ERR(0, 1494, __pyx_L1_error)
       }
       __pyx_v_data64_ptr = ((double *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_floatarr_out.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_floatarr_out.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_floatarr_out.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1384
+      /* "pgenlib.pyx":1495
  *                     raise RuntimeError("read_range() error " + str(reterr))
  *                 data64_ptr = <double*>(&(floatarr_out[variant_list_idx, 0]))
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)             # <<<<<<<<<<<<<<
  *             return
  *         raise RuntimeError("read_dosages_list() does not support sample_maj == 1 yet.")
  */
       plink2::Dosage16ToDoublesMinus9(__pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, __pyx_v_subset_size, __pyx_v_dosage_ct, __pyx_v_data64_ptr);
     }
 
-    /* "pgenlib.pyx":1385
+    /* "pgenlib.pyx":1496
  *                 data64_ptr = <double*>(&(floatarr_out[variant_list_idx, 0]))
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)
  *             return             # <<<<<<<<<<<<<<
  *         raise RuntimeError("read_dosages_list() does not support sample_maj == 1 yet.")
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":1371
+    /* "pgenlib.pyx":1482
  *         cdef uint32_t dosage_ct
  *         cdef PglErr reterr
  *         if sample_maj == 0:             # <<<<<<<<<<<<<<
  *             if floatarr_out.shape[0] < variant_idx_ct:
  *                 raise RuntimeError("Variant-major read_dosages_list() floatarr_out buffer has too few rows (" + str(floatarr_out.shape[0]) + "; variant_idxs length is " + str(variant_idx_ct) + ")")
  */
   }
 
-  /* "pgenlib.pyx":1386
+  /* "pgenlib.pyx":1497
  *                 Dosage16ToDoublesMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data64_ptr)
  *             return
  *         raise RuntimeError("read_dosages_list() does not support sample_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1497, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_Raise(__pyx_t_9, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __PYX_ERR(0, 1386, __pyx_L1_error)
+  __PYX_ERR(0, 1497, __pyx_L1_error)
 
-  /* "pgenlib.pyx":1356
+  /* "pgenlib.pyx":1467
  * 
  * 
  *     cdef read_dosages_list_internal64(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray[np.float64_t,mode="c",ndim=2] floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         cdef uint32_t raw_variant_ct = self._info_ptr[0].raw_variant_ct
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  */
 
@@ -21865,15 +24586,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1389
+/* "pgenlib.pyx":1500
  * 
  * 
  *     cpdef read_dosages_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_list_internal32(variant_idxs, floatarr_out, allele_idx, sample_maj)
  */
 
@@ -21910,33 +24631,33 @@
   }
   __pyx_pybuffer_variant_idxs.pybuffer.buf = NULL;
   __pyx_pybuffer_variant_idxs.refcount = 0;
   __pyx_pybuffernd_variant_idxs.data = NULL;
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1389, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1500, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_dosages_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_read_dosages_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1500, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_33read_dosages_list)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1389, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1500, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_sample_maj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1389, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_sample_maj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1500, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
         __pyx_t_7 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
           if (likely(__pyx_t_6)) {
@@ -21946,33 +24667,33 @@
             __Pyx_DECREF_SET(__pyx_t_5, function);
             __pyx_t_7 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[5] = {__pyx_t_6, ((PyObject *)__pyx_v_variant_idxs), ((PyObject *)__pyx_v_floatarr_out), __pyx_t_3, __pyx_t_4};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1389, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1500, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
           PyObject *__pyx_temp[5] = {__pyx_t_6, ((PyObject *)__pyx_v_variant_idxs), ((PyObject *)__pyx_v_floatarr_out), __pyx_t_3, __pyx_t_4};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1389, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1500, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         {
-          __pyx_t_8 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1389, __pyx_L1_error)
+          __pyx_t_8 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1500, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           if (__pyx_t_6) {
             __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
           }
           __Pyx_INCREF(((PyObject *)__pyx_v_variant_idxs));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_variant_idxs));
           PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, ((PyObject *)__pyx_v_variant_idxs));
@@ -21981,15 +24702,15 @@
           PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, ((PyObject *)__pyx_v_floatarr_out));
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_8, 3+__pyx_t_7, __pyx_t_4);
           __pyx_t_3 = 0;
           __pyx_t_4 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1389, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1500, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -22004,132 +24725,132 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1390
+  /* "pgenlib.pyx":1501
  * 
  *     cpdef read_dosages_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if floatarr_out.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             self.read_dosages_list_internal32(variant_idxs, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1390, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1390, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1390, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1390, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1390, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_9) {
 
-    /* "pgenlib.pyx":1391
+    /* "pgenlib.pyx":1502
  *     cpdef read_dosages_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_list_internal32(variant_idxs, floatarr_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         elif floatarr_out.dtype == np.float64:
  *             self.read_dosages_list_internal64(variant_idxs, floatarr_out, allele_idx, sample_maj)
  */
     __pyx_t_10.__pyx_n = 2;
     __pyx_t_10.allele_idx = __pyx_v_allele_idx;
     __pyx_t_10.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_dosages_list_internal32(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_floatarr_out), &__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1391, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_dosages_list_internal32(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_floatarr_out), &__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1502, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pgenlib.pyx":1390
+    /* "pgenlib.pyx":1501
  * 
  *     cpdef read_dosages_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):
  *         if floatarr_out.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             self.read_dosages_list_internal32(variant_idxs, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:
  */
     goto __pyx_L3;
   }
 
-  /* "pgenlib.pyx":1392
+  /* "pgenlib.pyx":1503
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_list_internal32(variant_idxs, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             self.read_dosages_list_internal64(variant_idxs, floatarr_out, allele_idx, sample_maj)
  *         else:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1392, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_out), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1503, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1392, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1503, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1392, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1503, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1392, __pyx_L1_error)
+  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1503, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1392, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1503, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (likely(__pyx_t_9)) {
 
-    /* "pgenlib.pyx":1393
+    /* "pgenlib.pyx":1504
  *             self.read_dosages_list_internal32(variant_idxs, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:
  *             self.read_dosages_list_internal64(variant_idxs, floatarr_out, allele_idx, sample_maj)             # <<<<<<<<<<<<<<
  *         else:
  *             raise RuntimeError("Invalid read_dosages_list() floatarr_out array element type (float32 or float64 expected).")
  */
     __pyx_t_11.__pyx_n = 2;
     __pyx_t_11.allele_idx = __pyx_v_allele_idx;
     __pyx_t_11.sample_maj = __pyx_v_sample_maj;
-    __pyx_t_5 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_dosages_list_internal64(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_floatarr_out), &__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1393, __pyx_L1_error)
+    __pyx_t_5 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->read_dosages_list_internal64(__pyx_v_self, ((PyArrayObject *)__pyx_v_variant_idxs), ((PyArrayObject *)__pyx_v_floatarr_out), &__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1504, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "pgenlib.pyx":1392
+    /* "pgenlib.pyx":1503
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_list_internal32(variant_idxs, floatarr_out, allele_idx, sample_maj)
  *         elif floatarr_out.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             self.read_dosages_list_internal64(variant_idxs, floatarr_out, allele_idx, sample_maj)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "pgenlib.pyx":1395
+  /* "pgenlib.pyx":1506
  *             self.read_dosages_list_internal64(variant_idxs, floatarr_out, allele_idx, sample_maj)
  *         else:
  *             raise RuntimeError("Invalid read_dosages_list() floatarr_out array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   /*else*/ {
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1395, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1506, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_Raise(__pyx_t_5, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 1395, __pyx_L1_error)
+    __PYX_ERR(0, 1506, __pyx_L1_error)
   }
   __pyx_L3:;
 
-  /* "pgenlib.pyx":1396
+  /* "pgenlib.pyx":1507
  *         else:
  *             raise RuntimeError("Invalid read_dosages_list() floatarr_out array element type (float32 or float64 expected).")
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cpdef count(self, uint32_t variant_idx, np.ndarray[np.uint32_t,mode="c"] genocount_uint32_out, object allele_idx = 1):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1389
+  /* "pgenlib.pyx":1500
  * 
  * 
  *     cpdef read_dosages_list(self, np.ndarray[np.uint32_t] variant_idxs, np.ndarray floatarr_out, uint32_t allele_idx = 1, bint sample_maj = 0):             # <<<<<<<<<<<<<<
  *         if floatarr_out.dtype == np.float32:
  *             self.read_dosages_list_internal32(variant_idxs, floatarr_out, allele_idx, sample_maj)
  */
 
@@ -22195,15 +24916,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idxs)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_floatarr_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_dosages_list", 0, 2, 4, 1); __PYX_ERR(0, 1389, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_dosages_list", 0, 2, 4, 1); __PYX_ERR(0, 1500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_idx);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -22211,15 +24932,15 @@
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sample_maj);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_dosages_list") < 0)) __PYX_ERR(0, 1389, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_dosages_list") < 0)) __PYX_ERR(0, 1500, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
@@ -22228,34 +24949,34 @@
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_variant_idxs = ((PyArrayObject *)values[0]);
     __pyx_v_floatarr_out = ((PyArrayObject *)values[1]);
     if (values[2]) {
-      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[2]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1389, __pyx_L3_error)
+      __pyx_v_allele_idx = __Pyx_PyInt_As_uint32_t(values[2]); if (unlikely((__pyx_v_allele_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1500, __pyx_L3_error)
     } else {
       __pyx_v_allele_idx = ((uint32_t)1);
     }
     if (values[3]) {
-      __pyx_v_sample_maj = __Pyx_PyObject_IsTrue(values[3]); if (unlikely((__pyx_v_sample_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1389, __pyx_L3_error)
+      __pyx_v_sample_maj = __Pyx_PyObject_IsTrue(values[3]); if (unlikely((__pyx_v_sample_maj == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1500, __pyx_L3_error)
     } else {
       __pyx_v_sample_maj = ((int)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_dosages_list", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1389, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_dosages_list", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1500, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.read_dosages_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_variant_idxs), __pyx_ptype_5numpy_ndarray, 1, "variant_idxs", 0))) __PYX_ERR(0, 1389, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr_out), __pyx_ptype_5numpy_ndarray, 1, "floatarr_out", 0))) __PYX_ERR(0, 1389, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_variant_idxs), __pyx_ptype_5numpy_ndarray, 1, "variant_idxs", 0))) __PYX_ERR(0, 1500, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr_out), __pyx_ptype_5numpy_ndarray, 1, "floatarr_out", 0))) __PYX_ERR(0, 1500, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_32read_dosages_list(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idxs, __pyx_v_floatarr_out, __pyx_v_allele_idx, __pyx_v_sample_maj);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -22276,22 +24997,22 @@
   __Pyx_RefNannySetupContext("read_dosages_list", 0);
   __pyx_pybuffer_variant_idxs.pybuffer.buf = NULL;
   __pyx_pybuffer_variant_idxs.refcount = 0;
   __pyx_pybuffernd_variant_idxs.data = NULL;
   __pyx_pybuffernd_variant_idxs.rcbuffer = &__pyx_pybuffer_variant_idxs;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1389, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer, (PyObject*)__pyx_v_variant_idxs, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1500, __pyx_L1_error)
   }
   __pyx_pybuffernd_variant_idxs.diminfo[0].strides = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_variant_idxs.diminfo[0].shape = __pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer.shape[0];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.allele_idx = __pyx_v_allele_idx;
   __pyx_t_2.sample_maj = __pyx_v_sample_maj;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_dosages_list(__pyx_v_self, __pyx_v_variant_idxs, __pyx_v_floatarr_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->read_dosages_list(__pyx_v_self, __pyx_v_variant_idxs, __pyx_v_floatarr_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1500, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -22309,15 +25030,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_variant_idxs.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1398
+/* "pgenlib.pyx":1509
  *         return
  * 
  *     cpdef count(self, uint32_t variant_idx, np.ndarray[np.uint32_t,mode="c"] genocount_uint32_out, object allele_idx = 1):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -22378,31 +25099,31 @@
   __Pyx_INCREF(__pyx_v_allele_idx);
   __pyx_pybuffer_genocount_uint32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_genocount_uint32_out.refcount = 0;
   __pyx_pybuffernd_genocount_uint32_out.data = NULL;
   __pyx_pybuffernd_genocount_uint32_out.rcbuffer = &__pyx_pybuffer_genocount_uint32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_genocount_uint32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1398, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_genocount_uint32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1509, __pyx_L1_error)
   }
   __pyx_pybuffernd_genocount_uint32_out.diminfo[0].strides = __pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_genocount_uint32_out.diminfo[0].shape = __pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer.shape[0];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1398, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1509, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_35count)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1398, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyInt_From_uint32_t(__pyx_v_variant_idx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1509, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_5)) {
@@ -22412,45 +25133,45 @@
             __Pyx_DECREF_SET(__pyx_t_4, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_t_3, ((PyObject *)__pyx_v_genocount_uint32_out), __pyx_v_allele_idx};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1398, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1509, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_t_3, ((PyObject *)__pyx_v_genocount_uint32_out), __pyx_v_allele_idx};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1398, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1509, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1398, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1509, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_5) {
             __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_t_3);
           __Pyx_INCREF(((PyObject *)__pyx_v_genocount_uint32_out));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_genocount_uint32_out));
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, ((PyObject *)__pyx_v_genocount_uint32_out));
           __Pyx_INCREF(__pyx_v_allele_idx);
           __Pyx_GIVEREF(__pyx_v_allele_idx);
           PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_v_allele_idx);
           __pyx_t_3 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1398, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1509, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -22465,800 +25186,800 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1399
+  /* "pgenlib.pyx":1510
  * 
  *     cpdef count(self, uint32_t variant_idx, np.ndarray[np.uint32_t,mode="c"] genocount_uint32_out, object allele_idx = 1):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec             # <<<<<<<<<<<<<<
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef uint32_t subset_size = self._subset_size
  */
   __pyx_t_8 = __pyx_v_self->_subset_include_vec;
   __pyx_v_subset_include_vec = __pyx_t_8;
 
-  /* "pgenlib.pyx":1400
+  /* "pgenlib.pyx":1511
  *     cpdef count(self, uint32_t variant_idx, np.ndarray[np.uint32_t,mode="c"] genocount_uint32_out, object allele_idx = 1):
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  */
   __pyx_t_9 = __pyx_v_self->_subset_index;
   __pyx_v_subset_index = __pyx_t_9;
 
-  /* "pgenlib.pyx":1401
+  /* "pgenlib.pyx":1512
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef uint32_t subset_size = self._subset_size             # <<<<<<<<<<<<<<
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uint32_t* data_ptr = <uint32_t*>(&(genocount_uint32_out[0]))
  */
   __pyx_t_10 = __pyx_v_self->_subset_size;
   __pyx_v_subset_size = __pyx_t_10;
 
-  /* "pgenlib.pyx":1402
+  /* "pgenlib.pyx":1513
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef PgenReaderStruct* pgrp = self._state_ptr             # <<<<<<<<<<<<<<
  *         cdef uint32_t* data_ptr = <uint32_t*>(&(genocount_uint32_out[0]))
  *         cdef uintptr_t* allele_idx_offsets
  */
   __pyx_t_11 = __pyx_v_self->_state_ptr;
   __pyx_v_pgrp = __pyx_t_11;
 
-  /* "pgenlib.pyx":1403
+  /* "pgenlib.pyx":1514
  *         cdef uint32_t subset_size = self._subset_size
  *         cdef PgenReaderStruct* pgrp = self._state_ptr
  *         cdef uint32_t* data_ptr = <uint32_t*>(&(genocount_uint32_out[0]))             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* allele_idx_offsets
  *         cdef uintptr_t* genovec
  */
   __pyx_t_12 = 0;
   __pyx_t_6 = -1;
   if (__pyx_t_12 < 0) {
     __pyx_t_12 += __pyx_pybuffernd_genocount_uint32_out.diminfo[0].shape;
     if (unlikely(__pyx_t_12 < 0)) __pyx_t_6 = 0;
   } else if (unlikely(__pyx_t_12 >= __pyx_pybuffernd_genocount_uint32_out.diminfo[0].shape)) __pyx_t_6 = 0;
   if (unlikely(__pyx_t_6 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_6);
-    __PYX_ERR(0, 1403, __pyx_L1_error)
+    __PYX_ERR(0, 1514, __pyx_L1_error)
   }
   __pyx_v_data_ptr = ((uint32_t *)(&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_genocount_uint32_out.diminfo[0].strides))));
 
-  /* "pgenlib.pyx":1415
+  /* "pgenlib.pyx":1526
  *         cdef uintptr_t ac1
  *         cdef PglErr reterr
  *         if allele_idx is None:             # <<<<<<<<<<<<<<
  *             allele_ct = 2
  *             allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  */
   __pyx_t_13 = (__pyx_v_allele_idx == Py_None);
   __pyx_t_14 = (__pyx_t_13 != 0);
   if (__pyx_t_14) {
 
-    /* "pgenlib.pyx":1416
+    /* "pgenlib.pyx":1527
  *         cdef PglErr reterr
  *         if allele_idx is None:
  *             allele_ct = 2             # <<<<<<<<<<<<<<
  *             allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *             if allele_idx_offsets != NULL:
  */
     __pyx_v_allele_ct = 2;
 
-    /* "pgenlib.pyx":1417
+    /* "pgenlib.pyx":1528
  *         if allele_idx is None:
  *             allele_ct = 2
  *             allele_idx_offsets = self._info_ptr[0].allele_idx_offsets             # <<<<<<<<<<<<<<
  *             if allele_idx_offsets != NULL:
  *                 allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]
  */
     __pyx_t_8 = (__pyx_v_self->_info_ptr[0]).allele_idx_offsets;
     __pyx_v_allele_idx_offsets = __pyx_t_8;
 
-    /* "pgenlib.pyx":1418
+    /* "pgenlib.pyx":1529
  *             allele_ct = 2
  *             allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *             if allele_idx_offsets != NULL:             # <<<<<<<<<<<<<<
  *                 allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]
  *             if allele_ct > 2:
  */
     __pyx_t_14 = ((__pyx_v_allele_idx_offsets != NULL) != 0);
     if (__pyx_t_14) {
 
-      /* "pgenlib.pyx":1419
+      /* "pgenlib.pyx":1530
  *             allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *             if allele_idx_offsets != NULL:
  *                 allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]             # <<<<<<<<<<<<<<
  *             if allele_ct > 2:
  *                 # Multiallelic special case.
  */
       __pyx_v_allele_ct = ((__pyx_v_allele_idx_offsets[(__pyx_v_variant_idx + 1)]) - (__pyx_v_allele_idx_offsets[__pyx_v_variant_idx]));
 
-      /* "pgenlib.pyx":1418
+      /* "pgenlib.pyx":1529
  *             allele_ct = 2
  *             allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  *             if allele_idx_offsets != NULL:             # <<<<<<<<<<<<<<
  *                 allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]
  *             if allele_ct > 2:
  */
     }
 
-    /* "pgenlib.pyx":1420
+    /* "pgenlib.pyx":1531
  *             if allele_idx_offsets != NULL:
  *                 allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]
  *             if allele_ct > 2:             # <<<<<<<<<<<<<<
  *                 # Multiallelic special case.
  *                 type_ct = (allele_ct * (allele_ct + 1)) >> 1
  */
     __pyx_t_14 = ((__pyx_v_allele_ct > 2) != 0);
     if (__pyx_t_14) {
 
-      /* "pgenlib.pyx":1422
+      /* "pgenlib.pyx":1533
  *             if allele_ct > 2:
  *                 # Multiallelic special case.
  *                 type_ct = (allele_ct * (allele_ct + 1)) >> 1             # <<<<<<<<<<<<<<
- *                 if genocount_uint32_out.shape[0] <= type_ct:
+ *                 if <uintptr_t>(genocount_uint32_out.shape[0]) <= type_ct:
  *                     raise RuntimeError("count() genocount_uint32_out buffer is too small for multiallelic variant")
  */
       __pyx_v_type_ct = ((__pyx_v_allele_ct * (__pyx_v_allele_ct + 1)) >> 1);
 
-      /* "pgenlib.pyx":1423
+      /* "pgenlib.pyx":1534
  *                 # Multiallelic special case.
  *                 type_ct = (allele_ct * (allele_ct + 1)) >> 1
- *                 if genocount_uint32_out.shape[0] <= type_ct:             # <<<<<<<<<<<<<<
+ *                 if <uintptr_t>(genocount_uint32_out.shape[0]) <= type_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("count() genocount_uint32_out buffer is too small for multiallelic variant")
  *                 reterr = PgrGetM(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  */
-      __pyx_t_14 = (((__pyx_v_genocount_uint32_out->dimensions[0]) <= __pyx_v_type_ct) != 0);
+      __pyx_t_14 = ((((uintptr_t)(__pyx_v_genocount_uint32_out->dimensions[0])) <= __pyx_v_type_ct) != 0);
       if (unlikely(__pyx_t_14)) {
 
-        /* "pgenlib.pyx":1424
+        /* "pgenlib.pyx":1535
  *                 type_ct = (allele_ct * (allele_ct + 1)) >> 1
- *                 if genocount_uint32_out.shape[0] <= type_ct:
+ *                 if <uintptr_t>(genocount_uint32_out.shape[0]) <= type_ct:
  *                     raise RuntimeError("count() genocount_uint32_out buffer is too small for multiallelic variant")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGetM(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  */
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1424, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1535, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 1424, __pyx_L1_error)
+        __PYX_ERR(0, 1535, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1423
+        /* "pgenlib.pyx":1534
  *                 # Multiallelic special case.
  *                 type_ct = (allele_ct * (allele_ct + 1)) >> 1
- *                 if genocount_uint32_out.shape[0] <= type_ct:             # <<<<<<<<<<<<<<
+ *                 if <uintptr_t>(genocount_uint32_out.shape[0]) <= type_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("count() genocount_uint32_out buffer is too small for multiallelic variant")
  *                 reterr = PgrGetM(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  */
       }
 
-      /* "pgenlib.pyx":1425
- *                 if genocount_uint32_out.shape[0] <= type_ct:
+      /* "pgenlib.pyx":1536
+ *                 if <uintptr_t>(genocount_uint32_out.shape[0]) <= type_ct:
  *                     raise RuntimeError("count() genocount_uint32_out buffer is too small for multiallelic variant")
  *                 reterr = PgrGetM(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("count() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::PgrGetM(__pyx_v_subset_include_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_pgrp, (&__pyx_v_self->_pgv));
 
-      /* "pgenlib.pyx":1426
+      /* "pgenlib.pyx":1537
  *                     raise RuntimeError("count() genocount_uint32_out buffer is too small for multiallelic variant")
  *                 reterr = PgrGetM(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("count() error " + str(reterr))
  *                 genovec = self._pgv.genovec
  */
       __pyx_t_14 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_14)) {
 
-        /* "pgenlib.pyx":1427
+        /* "pgenlib.pyx":1538
  *                 reterr = PgrGetM(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("count() error " + str(reterr))             # <<<<<<<<<<<<<<
  *                 genovec = self._pgv.genovec
  *                 ZeroTrailingNyps(subset_size, genovec)
  */
-        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1427, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1538, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1427, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1538, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_count_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1427, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_count_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1538, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1427, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1538, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_Raise(__pyx_t_2, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __PYX_ERR(0, 1427, __pyx_L1_error)
+        __PYX_ERR(0, 1538, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1426
+        /* "pgenlib.pyx":1537
  *                     raise RuntimeError("count() genocount_uint32_out buffer is too small for multiallelic variant")
  *                 reterr = PgrGetM(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("count() error " + str(reterr))
  *                 genovec = self._pgv.genovec
  */
       }
 
-      /* "pgenlib.pyx":1428
+      /* "pgenlib.pyx":1539
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("count() error " + str(reterr))
  *                 genovec = self._pgv.genovec             # <<<<<<<<<<<<<<
  *                 ZeroTrailingNyps(subset_size, genovec)
  *                 GenoarrCountFreqsUnsafe(genovec, subset_size, data_ptr)
  */
       __pyx_t_8 = __pyx_v_self->_pgv.genovec;
       __pyx_v_genovec = __pyx_t_8;
 
-      /* "pgenlib.pyx":1429
+      /* "pgenlib.pyx":1540
  *                     raise RuntimeError("count() error " + str(reterr))
  *                 genovec = self._pgv.genovec
  *                 ZeroTrailingNyps(subset_size, genovec)             # <<<<<<<<<<<<<<
  *                 GenoarrCountFreqsUnsafe(genovec, subset_size, data_ptr)
  *                 data_ptr[type_ct] = data_ptr[3]
  */
       plink2::ZeroTrailingNyps(__pyx_v_subset_size, __pyx_v_genovec);
 
-      /* "pgenlib.pyx":1430
+      /* "pgenlib.pyx":1541
  *                 genovec = self._pgv.genovec
  *                 ZeroTrailingNyps(subset_size, genovec)
  *                 GenoarrCountFreqsUnsafe(genovec, subset_size, data_ptr)             # <<<<<<<<<<<<<<
  *                 data_ptr[type_ct] = data_ptr[3]
  *                 for i in range(3, type_ct):
  */
       plink2::GenoarrCountFreqsUnsafe(__pyx_v_genovec, __pyx_v_subset_size, __pyx_v_data_ptr);
 
-      /* "pgenlib.pyx":1431
+      /* "pgenlib.pyx":1542
  *                 ZeroTrailingNyps(subset_size, genovec)
  *                 GenoarrCountFreqsUnsafe(genovec, subset_size, data_ptr)
  *                 data_ptr[type_ct] = data_ptr[3]             # <<<<<<<<<<<<<<
  *                 for i in range(3, type_ct):
  *                     data_ptr[i] = 0
  */
       (__pyx_v_data_ptr[__pyx_v_type_ct]) = (__pyx_v_data_ptr[3]);
 
-      /* "pgenlib.pyx":1432
+      /* "pgenlib.pyx":1543
  *                 GenoarrCountFreqsUnsafe(genovec, subset_size, data_ptr)
  *                 data_ptr[type_ct] = data_ptr[3]
  *                 for i in range(3, type_ct):             # <<<<<<<<<<<<<<
  *                     data_ptr[i] = 0
  *                 # Now correct for patch_01 and patch_10.
  */
-      __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_type_ct); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1432, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_type_ct); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1543, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1432, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1543, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_int_3);
       __Pyx_GIVEREF(__pyx_int_3);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_int_3);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
       __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1432, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1543, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
         __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_15 = 0;
         __pyx_t_16 = NULL;
       } else {
-        __pyx_t_15 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1432, __pyx_L1_error)
+        __pyx_t_15 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1543, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_16 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1432, __pyx_L1_error)
+        __pyx_t_16 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1543, __pyx_L1_error)
       }
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       for (;;) {
         if (likely(!__pyx_t_16)) {
           if (likely(PyList_CheckExact(__pyx_t_1))) {
             if (__pyx_t_15 >= PyList_GET_SIZE(__pyx_t_1)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1432, __pyx_L1_error)
+            __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1543, __pyx_L1_error)
             #else
-            __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1432, __pyx_L1_error)
+            __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1543, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_2);
             #endif
           } else {
             if (__pyx_t_15 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1432, __pyx_L1_error)
+            __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1543, __pyx_L1_error)
             #else
-            __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1432, __pyx_L1_error)
+            __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1543, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_2);
             #endif
           }
         } else {
           __pyx_t_2 = __pyx_t_16(__pyx_t_1);
           if (unlikely(!__pyx_t_2)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 1432, __pyx_L1_error)
+              else __PYX_ERR(0, 1543, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_2);
         }
         __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
         __pyx_t_2 = 0;
 
-        /* "pgenlib.pyx":1433
+        /* "pgenlib.pyx":1544
  *                 data_ptr[type_ct] = data_ptr[3]
  *                 for i in range(3, type_ct):
  *                     data_ptr[i] = 0             # <<<<<<<<<<<<<<
  *                 # Now correct for patch_01 and patch_10.
  *                 patch_01_ct = self._pgv.patch_01_ct
  */
-        __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1433, __pyx_L1_error)
+        __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1544, __pyx_L1_error)
         (__pyx_v_data_ptr[__pyx_t_17]) = 0;
 
-        /* "pgenlib.pyx":1432
+        /* "pgenlib.pyx":1543
  *                 GenoarrCountFreqsUnsafe(genovec, subset_size, data_ptr)
  *                 data_ptr[type_ct] = data_ptr[3]
  *                 for i in range(3, type_ct):             # <<<<<<<<<<<<<<
  *                     data_ptr[i] = 0
  *                 # Now correct for patch_01 and patch_10.
  */
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "pgenlib.pyx":1435
+      /* "pgenlib.pyx":1546
  *                     data_ptr[i] = 0
  *                 # Now correct for patch_01 and patch_10.
  *                 patch_01_ct = self._pgv.patch_01_ct             # <<<<<<<<<<<<<<
  *                 if patch_01_ct > 0:
  *                     data_ptr[1] -= patch_01_ct
  */
       __pyx_t_10 = __pyx_v_self->_pgv.patch_01_ct;
       __pyx_v_patch_01_ct = __pyx_t_10;
 
-      /* "pgenlib.pyx":1436
+      /* "pgenlib.pyx":1547
  *                 # Now correct for patch_01 and patch_10.
  *                 patch_01_ct = self._pgv.patch_01_ct
  *                 if patch_01_ct > 0:             # <<<<<<<<<<<<<<
  *                     data_ptr[1] -= patch_01_ct
  *                     patch_01_vals = self._pgv.patch_01_vals
  */
       __pyx_t_14 = ((__pyx_v_patch_01_ct > 0) != 0);
       if (__pyx_t_14) {
 
-        /* "pgenlib.pyx":1437
+        /* "pgenlib.pyx":1548
  *                 patch_01_ct = self._pgv.patch_01_ct
  *                 if patch_01_ct > 0:
  *                     data_ptr[1] -= patch_01_ct             # <<<<<<<<<<<<<<
  *                     patch_01_vals = self._pgv.patch_01_vals
  *                     # could special-case allele_ct == 3, etc.
  */
         __pyx_t_18 = 1;
         (__pyx_v_data_ptr[__pyx_t_18]) = ((__pyx_v_data_ptr[__pyx_t_18]) - __pyx_v_patch_01_ct);
 
-        /* "pgenlib.pyx":1438
+        /* "pgenlib.pyx":1549
  *                 if patch_01_ct > 0:
  *                     data_ptr[1] -= patch_01_ct
  *                     patch_01_vals = self._pgv.patch_01_vals             # <<<<<<<<<<<<<<
  *                     # could special-case allele_ct == 3, etc.
  *                     for i in range(patch_01_ct):
  */
         __pyx_t_19 = __pyx_v_self->_pgv.patch_01_vals;
         __pyx_v_patch_01_vals = __pyx_t_19;
 
-        /* "pgenlib.pyx":1440
+        /* "pgenlib.pyx":1551
  *                     patch_01_vals = self._pgv.patch_01_vals
  *                     # could special-case allele_ct == 3, etc.
  *                     for i in range(patch_01_ct):             # <<<<<<<<<<<<<<
  *                         ac1 = patch_01_vals[i]
  *                         data_ptr[(ac1 * (ac1 + 1)) >> 1] += 1
  */
-        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_patch_01_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1440, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_patch_01_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1551, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1440, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1551, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
           __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_15 = 0;
           __pyx_t_16 = NULL;
         } else {
-          __pyx_t_15 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1440, __pyx_L1_error)
+          __pyx_t_15 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1551, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_16 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1440, __pyx_L1_error)
+          __pyx_t_16 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1551, __pyx_L1_error)
         }
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         for (;;) {
           if (likely(!__pyx_t_16)) {
             if (likely(PyList_CheckExact(__pyx_t_1))) {
               if (__pyx_t_15 >= PyList_GET_SIZE(__pyx_t_1)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1440, __pyx_L1_error)
+              __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1551, __pyx_L1_error)
               #else
-              __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1440, __pyx_L1_error)
+              __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1551, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_2);
               #endif
             } else {
               if (__pyx_t_15 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1440, __pyx_L1_error)
+              __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1551, __pyx_L1_error)
               #else
-              __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1440, __pyx_L1_error)
+              __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1551, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_2);
               #endif
             }
           } else {
             __pyx_t_2 = __pyx_t_16(__pyx_t_1);
             if (unlikely(!__pyx_t_2)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 1440, __pyx_L1_error)
+                else __PYX_ERR(0, 1551, __pyx_L1_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_2);
           }
           __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
           __pyx_t_2 = 0;
 
-          /* "pgenlib.pyx":1441
+          /* "pgenlib.pyx":1552
  *                     # could special-case allele_ct == 3, etc.
  *                     for i in range(patch_01_ct):
  *                         ac1 = patch_01_vals[i]             # <<<<<<<<<<<<<<
  *                         data_ptr[(ac1 * (ac1 + 1)) >> 1] += 1
  *                 patch_10_ct = self._pgv.patch_10_ct
  */
-          __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1441, __pyx_L1_error)
+          __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1552, __pyx_L1_error)
           __pyx_v_ac1 = (__pyx_v_patch_01_vals[__pyx_t_17]);
 
-          /* "pgenlib.pyx":1442
+          /* "pgenlib.pyx":1553
  *                     for i in range(patch_01_ct):
  *                         ac1 = patch_01_vals[i]
  *                         data_ptr[(ac1 * (ac1 + 1)) >> 1] += 1             # <<<<<<<<<<<<<<
  *                 patch_10_ct = self._pgv.patch_10_ct
  *                 if patch_10_ct > 0:
  */
           __pyx_t_20 = ((__pyx_v_ac1 * (__pyx_v_ac1 + 1)) >> 1);
           (__pyx_v_data_ptr[__pyx_t_20]) = ((__pyx_v_data_ptr[__pyx_t_20]) + 1);
 
-          /* "pgenlib.pyx":1440
+          /* "pgenlib.pyx":1551
  *                     patch_01_vals = self._pgv.patch_01_vals
  *                     # could special-case allele_ct == 3, etc.
  *                     for i in range(patch_01_ct):             # <<<<<<<<<<<<<<
  *                         ac1 = patch_01_vals[i]
  *                         data_ptr[(ac1 * (ac1 + 1)) >> 1] += 1
  */
         }
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "pgenlib.pyx":1436
+        /* "pgenlib.pyx":1547
  *                 # Now correct for patch_01 and patch_10.
  *                 patch_01_ct = self._pgv.patch_01_ct
  *                 if patch_01_ct > 0:             # <<<<<<<<<<<<<<
  *                     data_ptr[1] -= patch_01_ct
  *                     patch_01_vals = self._pgv.patch_01_vals
  */
       }
 
-      /* "pgenlib.pyx":1443
+      /* "pgenlib.pyx":1554
  *                         ac1 = patch_01_vals[i]
  *                         data_ptr[(ac1 * (ac1 + 1)) >> 1] += 1
  *                 patch_10_ct = self._pgv.patch_10_ct             # <<<<<<<<<<<<<<
  *                 if patch_10_ct > 0:
  *                     data_ptr[2] -= patch_10_ct
  */
       __pyx_t_10 = __pyx_v_self->_pgv.patch_10_ct;
       __pyx_v_patch_10_ct = __pyx_t_10;
 
-      /* "pgenlib.pyx":1444
+      /* "pgenlib.pyx":1555
  *                         data_ptr[(ac1 * (ac1 + 1)) >> 1] += 1
  *                 patch_10_ct = self._pgv.patch_10_ct
  *                 if patch_10_ct > 0:             # <<<<<<<<<<<<<<
  *                     data_ptr[2] -= patch_10_ct
  *                     patch_10_vals = self._pgv.patch_10_vals
  */
       __pyx_t_14 = ((__pyx_v_patch_10_ct > 0) != 0);
       if (__pyx_t_14) {
 
-        /* "pgenlib.pyx":1445
+        /* "pgenlib.pyx":1556
  *                 patch_10_ct = self._pgv.patch_10_ct
  *                 if patch_10_ct > 0:
  *                     data_ptr[2] -= patch_10_ct             # <<<<<<<<<<<<<<
  *                     patch_10_vals = self._pgv.patch_10_vals
  *                     for i in range(patch_10_ct):
  */
         __pyx_t_18 = 2;
         (__pyx_v_data_ptr[__pyx_t_18]) = ((__pyx_v_data_ptr[__pyx_t_18]) - __pyx_v_patch_10_ct);
 
-        /* "pgenlib.pyx":1446
+        /* "pgenlib.pyx":1557
  *                 if patch_10_ct > 0:
  *                     data_ptr[2] -= patch_10_ct
  *                     patch_10_vals = self._pgv.patch_10_vals             # <<<<<<<<<<<<<<
  *                     for i in range(patch_10_ct):
  *                         ac0 = patch_10_vals[2*i]
  */
         __pyx_t_19 = __pyx_v_self->_pgv.patch_10_vals;
         __pyx_v_patch_10_vals = __pyx_t_19;
 
-        /* "pgenlib.pyx":1447
+        /* "pgenlib.pyx":1558
  *                     data_ptr[2] -= patch_10_ct
  *                     patch_10_vals = self._pgv.patch_10_vals
  *                     for i in range(patch_10_ct):             # <<<<<<<<<<<<<<
  *                         ac0 = patch_10_vals[2*i]
  *                         ac1 = patch_10_vals[2*i+1]
  */
-        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_patch_10_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1447, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_patch_10_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1447, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
           __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_15 = 0;
           __pyx_t_16 = NULL;
         } else {
-          __pyx_t_15 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1447, __pyx_L1_error)
+          __pyx_t_15 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1558, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_16 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1447, __pyx_L1_error)
+          __pyx_t_16 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1558, __pyx_L1_error)
         }
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         for (;;) {
           if (likely(!__pyx_t_16)) {
             if (likely(PyList_CheckExact(__pyx_t_1))) {
               if (__pyx_t_15 >= PyList_GET_SIZE(__pyx_t_1)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1447, __pyx_L1_error)
+              __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1558, __pyx_L1_error)
               #else
-              __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1447, __pyx_L1_error)
+              __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1558, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_2);
               #endif
             } else {
               if (__pyx_t_15 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1447, __pyx_L1_error)
+              __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_15); __Pyx_INCREF(__pyx_t_2); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 1558, __pyx_L1_error)
               #else
-              __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1447, __pyx_L1_error)
+              __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1558, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_2);
               #endif
             }
           } else {
             __pyx_t_2 = __pyx_t_16(__pyx_t_1);
             if (unlikely(!__pyx_t_2)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 1447, __pyx_L1_error)
+                else __PYX_ERR(0, 1558, __pyx_L1_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_2);
           }
           __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
           __pyx_t_2 = 0;
 
-          /* "pgenlib.pyx":1448
+          /* "pgenlib.pyx":1559
  *                     patch_10_vals = self._pgv.patch_10_vals
  *                     for i in range(patch_10_ct):
  *                         ac0 = patch_10_vals[2*i]             # <<<<<<<<<<<<<<
  *                         ac1 = patch_10_vals[2*i+1]
  *                         data_ptr[ac0 + ((ac1 * (ac1 + 1)) >> 1)] += 1
  */
-          __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1448, __pyx_L1_error)
+          __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1559, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_t_2); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1448, __pyx_L1_error)
+          __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_t_2); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1559, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           __pyx_v_ac0 = (__pyx_v_patch_10_vals[__pyx_t_17]);
 
-          /* "pgenlib.pyx":1449
+          /* "pgenlib.pyx":1560
  *                     for i in range(patch_10_ct):
  *                         ac0 = patch_10_vals[2*i]
  *                         ac1 = patch_10_vals[2*i+1]             # <<<<<<<<<<<<<<
  *                         data_ptr[ac0 + ((ac1 * (ac1 + 1)) >> 1)] += 1
  *                 return
  */
-          __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1449, __pyx_L1_error)
+          __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1560, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1449, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_2, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1560, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1449, __pyx_L1_error)
+          __pyx_t_17 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1560, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __pyx_v_ac1 = (__pyx_v_patch_10_vals[__pyx_t_17]);
 
-          /* "pgenlib.pyx":1450
+          /* "pgenlib.pyx":1561
  *                         ac0 = patch_10_vals[2*i]
  *                         ac1 = patch_10_vals[2*i+1]
  *                         data_ptr[ac0 + ((ac1 * (ac1 + 1)) >> 1)] += 1             # <<<<<<<<<<<<<<
  *                 return
  *             allele_idx = 1
  */
           __pyx_t_20 = (__pyx_v_ac0 + ((__pyx_v_ac1 * (__pyx_v_ac1 + 1)) >> 1));
           (__pyx_v_data_ptr[__pyx_t_20]) = ((__pyx_v_data_ptr[__pyx_t_20]) + 1);
 
-          /* "pgenlib.pyx":1447
+          /* "pgenlib.pyx":1558
  *                     data_ptr[2] -= patch_10_ct
  *                     patch_10_vals = self._pgv.patch_10_vals
  *                     for i in range(patch_10_ct):             # <<<<<<<<<<<<<<
  *                         ac0 = patch_10_vals[2*i]
  *                         ac1 = patch_10_vals[2*i+1]
  */
         }
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "pgenlib.pyx":1444
+        /* "pgenlib.pyx":1555
  *                         data_ptr[(ac1 * (ac1 + 1)) >> 1] += 1
  *                 patch_10_ct = self._pgv.patch_10_ct
  *                 if patch_10_ct > 0:             # <<<<<<<<<<<<<<
  *                     data_ptr[2] -= patch_10_ct
  *                     patch_10_vals = self._pgv.patch_10_vals
  */
       }
 
-      /* "pgenlib.pyx":1451
+      /* "pgenlib.pyx":1562
  *                         ac1 = patch_10_vals[2*i+1]
  *                         data_ptr[ac0 + ((ac1 * (ac1 + 1)) >> 1)] += 1
  *                 return             # <<<<<<<<<<<<<<
  *             allele_idx = 1
  *         reterr = PgrGetCounts(subset_include_vec, self._subset_include_interleaved_vec, subset_index, subset_size, variant_idx, pgrp, data_ptr)
  */
       __Pyx_XDECREF(__pyx_r);
       __pyx_r = Py_None; __Pyx_INCREF(Py_None);
       goto __pyx_L0;
 
-      /* "pgenlib.pyx":1420
+      /* "pgenlib.pyx":1531
  *             if allele_idx_offsets != NULL:
  *                 allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]
  *             if allele_ct > 2:             # <<<<<<<<<<<<<<
  *                 # Multiallelic special case.
  *                 type_ct = (allele_ct * (allele_ct + 1)) >> 1
  */
     }
 
-    /* "pgenlib.pyx":1452
+    /* "pgenlib.pyx":1563
  *                         data_ptr[ac0 + ((ac1 * (ac1 + 1)) >> 1)] += 1
  *                 return
  *             allele_idx = 1             # <<<<<<<<<<<<<<
  *         reterr = PgrGetCounts(subset_include_vec, self._subset_include_interleaved_vec, subset_index, subset_size, variant_idx, pgrp, data_ptr)
  *         if reterr != kPglRetSuccess:
  */
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_DECREF_SET(__pyx_v_allele_idx, __pyx_int_1);
 
-    /* "pgenlib.pyx":1415
+    /* "pgenlib.pyx":1526
  *         cdef uintptr_t ac1
  *         cdef PglErr reterr
  *         if allele_idx is None:             # <<<<<<<<<<<<<<
  *             allele_ct = 2
  *             allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
  */
   }
 
-  /* "pgenlib.pyx":1453
+  /* "pgenlib.pyx":1564
  *                 return
  *             allele_idx = 1
  *         reterr = PgrGetCounts(subset_include_vec, self._subset_include_interleaved_vec, subset_index, subset_size, variant_idx, pgrp, data_ptr)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("count() error " + str(reterr))
  */
   __pyx_v_reterr = plink2::PgrGetCounts(__pyx_v_subset_include_vec, __pyx_v_self->_subset_include_interleaved_vec, __pyx_v_subset_index, __pyx_v_subset_size, __pyx_v_variant_idx, __pyx_v_pgrp, __pyx_v_data_ptr);
 
-  /* "pgenlib.pyx":1454
+  /* "pgenlib.pyx":1565
  *             allele_idx = 1
  *         reterr = PgrGetCounts(subset_include_vec, self._subset_include_interleaved_vec, subset_index, subset_size, variant_idx, pgrp, data_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("count() error " + str(reterr))
  *         if allele_idx != 0:
  */
   __pyx_t_14 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_14)) {
 
-    /* "pgenlib.pyx":1455
+    /* "pgenlib.pyx":1566
  *         reterr = PgrGetCounts(subset_include_vec, self._subset_include_interleaved_vec, subset_index, subset_size, variant_idx, pgrp, data_ptr)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("count() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         if allele_idx != 0:
  *             return
  */
-    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1455, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1455, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_count_error, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1455, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_count_error, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1455, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1455, __pyx_L1_error)
+    __PYX_ERR(0, 1566, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1454
+    /* "pgenlib.pyx":1565
  *             allele_idx = 1
  *         reterr = PgrGetCounts(subset_include_vec, self._subset_include_interleaved_vec, subset_index, subset_size, variant_idx, pgrp, data_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("count() error " + str(reterr))
  *         if allele_idx != 0:
  */
   }
 
-  /* "pgenlib.pyx":1456
+  /* "pgenlib.pyx":1567
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("count() error " + str(reterr))
  *         if allele_idx != 0:             # <<<<<<<<<<<<<<
  *             return
  *         cdef uint32_t tmp = data_ptr[0]
  */
-  __pyx_t_4 = __Pyx_PyInt_NeObjC(__pyx_v_allele_idx, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1456, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_NeObjC(__pyx_v_allele_idx, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1456, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (__pyx_t_14) {
 
-    /* "pgenlib.pyx":1457
+    /* "pgenlib.pyx":1568
  *             raise RuntimeError("count() error " + str(reterr))
  *         if allele_idx != 0:
  *             return             # <<<<<<<<<<<<<<
  *         cdef uint32_t tmp = data_ptr[0]
  *         data_ptr[0] = data_ptr[2]
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "pgenlib.pyx":1456
+    /* "pgenlib.pyx":1567
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("count() error " + str(reterr))
  *         if allele_idx != 0:             # <<<<<<<<<<<<<<
  *             return
  *         cdef uint32_t tmp = data_ptr[0]
  */
   }
 
-  /* "pgenlib.pyx":1458
+  /* "pgenlib.pyx":1569
  *         if allele_idx != 0:
  *             return
  *         cdef uint32_t tmp = data_ptr[0]             # <<<<<<<<<<<<<<
  *         data_ptr[0] = data_ptr[2]
  *         data_ptr[2] = tmp
  */
   __pyx_v_tmp = (__pyx_v_data_ptr[0]);
 
-  /* "pgenlib.pyx":1459
+  /* "pgenlib.pyx":1570
  *             return
  *         cdef uint32_t tmp = data_ptr[0]
  *         data_ptr[0] = data_ptr[2]             # <<<<<<<<<<<<<<
  *         data_ptr[2] = tmp
  *         return
  */
   (__pyx_v_data_ptr[0]) = (__pyx_v_data_ptr[2]);
 
-  /* "pgenlib.pyx":1460
+  /* "pgenlib.pyx":1571
  *         cdef uint32_t tmp = data_ptr[0]
  *         data_ptr[0] = data_ptr[2]
  *         data_ptr[2] = tmp             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   (__pyx_v_data_ptr[2]) = __pyx_v_tmp;
 
-  /* "pgenlib.pyx":1461
+  /* "pgenlib.pyx":1572
  *         data_ptr[0] = data_ptr[2]
  *         data_ptr[2] = tmp
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1398
+  /* "pgenlib.pyx":1509
  *         return
  * 
  *     cpdef count(self, uint32_t variant_idx, np.ndarray[np.uint32_t,mode="c"] genocount_uint32_out, object allele_idx = 1):             # <<<<<<<<<<<<<<
  *         cdef const uintptr_t* subset_include_vec = self._subset_include_vec
  *         cdef PgrSampleSubsetIndexStruct subset_index = self._subset_index
  */
 
@@ -23323,49 +26044,49 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_idx)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_genocount_uint32_out)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("count", 0, 2, 3, 1); __PYX_ERR(0, 1398, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("count", 0, 2, 3, 1); __PYX_ERR(0, 1509, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_idx);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "count") < 0)) __PYX_ERR(0, 1398, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "count") < 0)) __PYX_ERR(0, 1509, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1398, __pyx_L3_error)
+    __pyx_v_variant_idx = __Pyx_PyInt_As_uint32_t(values[0]); if (unlikely((__pyx_v_variant_idx == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1509, __pyx_L3_error)
     __pyx_v_genocount_uint32_out = ((PyArrayObject *)values[1]);
     __pyx_v_allele_idx = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("count", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1398, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("count", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1509, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.count", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_genocount_uint32_out), __pyx_ptype_5numpy_ndarray, 1, "genocount_uint32_out", 0))) __PYX_ERR(0, 1398, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_genocount_uint32_out), __pyx_ptype_5numpy_ndarray, 1, "genocount_uint32_out", 0))) __PYX_ERR(0, 1509, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_34count(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_variant_idx, __pyx_v_genocount_uint32_out, __pyx_v_allele_idx);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -23386,21 +26107,21 @@
   __Pyx_RefNannySetupContext("count", 0);
   __pyx_pybuffer_genocount_uint32_out.pybuffer.buf = NULL;
   __pyx_pybuffer_genocount_uint32_out.refcount = 0;
   __pyx_pybuffernd_genocount_uint32_out.data = NULL;
   __pyx_pybuffernd_genocount_uint32_out.rcbuffer = &__pyx_pybuffer_genocount_uint32_out;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_genocount_uint32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1398, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer, (PyObject*)__pyx_v_genocount_uint32_out, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1509, __pyx_L1_error)
   }
   __pyx_pybuffernd_genocount_uint32_out.diminfo[0].strides = __pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_genocount_uint32_out.diminfo[0].shape = __pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer.shape[0];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.allele_idx = __pyx_v_allele_idx;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->count(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_genocount_uint32_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1398, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->count(__pyx_v_self, __pyx_v_variant_idx, __pyx_v_genocount_uint32_out, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1509, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -23418,15 +26139,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_genocount_uint32_out.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1464
+/* "pgenlib.pyx":1575
  * 
  * 
  *     cpdef change_sample_subset(self, object sample_subset = None):             # <<<<<<<<<<<<<<
  *         if sample_subset is not None:
  *             self.set_sample_subset_internal(sample_subset)
  */
 
@@ -23456,15 +26177,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_change_sample_subset); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1464, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_change_sample_subset); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1575, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_37change_sample_subset)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -23473,15 +26194,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_sample_subset) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_sample_subset);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1464, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1575, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -23494,81 +26215,81 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1465
+  /* "pgenlib.pyx":1576
  * 
  *     cpdef change_sample_subset(self, object sample_subset = None):
  *         if sample_subset is not None:             # <<<<<<<<<<<<<<
  *             self.set_sample_subset_internal(sample_subset)
  *         else:
  */
   __pyx_t_5 = (__pyx_v_sample_subset != Py_None);
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "pgenlib.pyx":1466
+    /* "pgenlib.pyx":1577
  *     cpdef change_sample_subset(self, object sample_subset = None):
  *         if sample_subset is not None:
  *             self.set_sample_subset_internal(sample_subset)             # <<<<<<<<<<<<<<
  *         else:
  *             PgrClearSampleSubsetIndex(self._state_ptr, &(self._subset_index))
  */
-    if (!(likely(((__pyx_v_sample_subset) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_sample_subset, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1466, __pyx_L1_error)
-    __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->set_sample_subset_internal(__pyx_v_self, ((PyArrayObject *)__pyx_v_sample_subset)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1466, __pyx_L1_error)
+    if (!(likely(((__pyx_v_sample_subset) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_sample_subset, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1577, __pyx_L1_error)
+    __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->set_sample_subset_internal(__pyx_v_self, ((PyArrayObject *)__pyx_v_sample_subset)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1577, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "pgenlib.pyx":1465
+    /* "pgenlib.pyx":1576
  * 
  *     cpdef change_sample_subset(self, object sample_subset = None):
  *         if sample_subset is not None:             # <<<<<<<<<<<<<<
  *             self.set_sample_subset_internal(sample_subset)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "pgenlib.pyx":1468
+  /* "pgenlib.pyx":1579
  *             self.set_sample_subset_internal(sample_subset)
  *         else:
  *             PgrClearSampleSubsetIndex(self._state_ptr, &(self._subset_index))             # <<<<<<<<<<<<<<
  *             self._subset_size = self._info_ptr[0].raw_sample_ct
  *         return
  */
   /*else*/ {
     plink2::PgrClearSampleSubsetIndex(__pyx_v_self->_state_ptr, (&__pyx_v_self->_subset_index));
 
-    /* "pgenlib.pyx":1469
+    /* "pgenlib.pyx":1580
  *         else:
  *             PgrClearSampleSubsetIndex(self._state_ptr, &(self._subset_index))
  *             self._subset_size = self._info_ptr[0].raw_sample_ct             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     __pyx_t_7 = (__pyx_v_self->_info_ptr[0]).raw_sample_ct;
     __pyx_v_self->_subset_size = __pyx_t_7;
   }
   __pyx_L3:;
 
-  /* "pgenlib.pyx":1470
+  /* "pgenlib.pyx":1581
  *             PgrClearSampleSubsetIndex(self._state_ptr, &(self._subset_index))
  *             self._subset_size = self._info_ptr[0].raw_sample_ct
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1464
+  /* "pgenlib.pyx":1575
  * 
  * 
  *     cpdef change_sample_subset(self, object sample_subset = None):             # <<<<<<<<<<<<<<
  *         if sample_subset is not None:
  *             self.set_sample_subset_internal(sample_subset)
  */
 
@@ -23614,29 +26335,29 @@
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sample_subset);
           if (value) { values[0] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "change_sample_subset") < 0)) __PYX_ERR(0, 1464, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "change_sample_subset") < 0)) __PYX_ERR(0, 1575, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_sample_subset = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("change_sample_subset", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1464, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("change_sample_subset", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1575, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.change_sample_subset", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_36change_sample_subset(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_sample_subset);
 
@@ -23653,15 +26374,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("change_sample_subset", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.sample_subset = __pyx_v_sample_subset;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->change_sample_subset(__pyx_v_self, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1464, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenReader->change_sample_subset(__pyx_v_self, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1575, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -23670,15 +26391,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1473
+/* "pgenlib.pyx":1584
  * 
  * 
  *     cpdef close(self):             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:
  */
 
@@ -23701,15 +26422,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_close); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1473, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_close); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1584, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_39close)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -23718,15 +26439,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1473, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1584, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -23739,280 +26460,280 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1474
+  /* "pgenlib.pyx":1585
  * 
  *     cpdef close(self):
  *         cdef PglErr reterr = kPglRetSuccess             # <<<<<<<<<<<<<<
  *         if self._info_ptr:
  *             CleanupPgfi(self._info_ptr, &reterr)
  */
   __pyx_v_reterr = plink2::kPglRetSuccess;
 
-  /* "pgenlib.pyx":1475
+  /* "pgenlib.pyx":1586
  *     cpdef close(self):
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:             # <<<<<<<<<<<<<<
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:
  */
   __pyx_t_5 = (__pyx_v_self->_info_ptr != 0);
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":1476
+    /* "pgenlib.pyx":1587
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:
  *             CleanupPgfi(self._info_ptr, &reterr)             # <<<<<<<<<<<<<<
  *             if self._info_ptr[0].vrtypes:
  *                 aligned_free(self._info_ptr[0].vrtypes)
  */
     (void)(plink2::CleanupPgfi(__pyx_v_self->_info_ptr, (&__pyx_v_reterr)));
 
-    /* "pgenlib.pyx":1477
+    /* "pgenlib.pyx":1588
  *         if self._info_ptr:
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:
  */
     __pyx_t_5 = ((__pyx_v_self->_info_ptr[0]).vrtypes != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":1478
+      /* "pgenlib.pyx":1589
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:
  *                 aligned_free(self._info_ptr[0].vrtypes)             # <<<<<<<<<<<<<<
  *             if self._info_ptr[0].allele_idx_offsets:
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  */
       plink2::aligned_free((__pyx_v_self->_info_ptr[0]).vrtypes);
 
-      /* "pgenlib.pyx":1477
+      /* "pgenlib.pyx":1588
  *         if self._info_ptr:
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:
  */
     }
 
-    /* "pgenlib.pyx":1479
+    /* "pgenlib.pyx":1590
  *             if self._info_ptr[0].vrtypes:
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:
  */
     __pyx_t_5 = ((__pyx_v_self->_info_ptr[0]).allele_idx_offsets != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":1480
+      /* "pgenlib.pyx":1591
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)             # <<<<<<<<<<<<<<
  *             if self._info_ptr[0].nonref_flags:
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  */
       plink2::aligned_free((__pyx_v_self->_info_ptr[0]).allele_idx_offsets);
 
-      /* "pgenlib.pyx":1479
+      /* "pgenlib.pyx":1590
  *             if self._info_ptr[0].vrtypes:
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:
  */
     }
 
-    /* "pgenlib.pyx":1481
+    /* "pgenlib.pyx":1592
  *             if self._info_ptr[0].allele_idx_offsets:
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:
  */
     __pyx_t_5 = ((__pyx_v_self->_info_ptr[0]).nonref_flags != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":1482
+      /* "pgenlib.pyx":1593
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:
  *                 aligned_free(self._info_ptr[0].nonref_flags)             # <<<<<<<<<<<<<<
  *             if self._state_ptr:
  *                 CleanupPgr(self._state_ptr, &reterr)
  */
       plink2::aligned_free((__pyx_v_self->_info_ptr[0]).nonref_flags);
 
-      /* "pgenlib.pyx":1481
+      /* "pgenlib.pyx":1592
  *             if self._info_ptr[0].allele_idx_offsets:
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:
  */
     }
 
-    /* "pgenlib.pyx":1483
+    /* "pgenlib.pyx":1594
  *             if self._info_ptr[0].nonref_flags:
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:             # <<<<<<<<<<<<<<
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):
  */
     __pyx_t_5 = (__pyx_v_self->_state_ptr != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":1484
+      /* "pgenlib.pyx":1595
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:
  *                 CleanupPgr(self._state_ptr, &reterr)             # <<<<<<<<<<<<<<
  *                 if PgrGetFreadBuf(self._state_ptr):
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  */
       (void)(plink2::CleanupPgr(__pyx_v_self->_state_ptr, (&__pyx_v_reterr)));
 
-      /* "pgenlib.pyx":1485
+      /* "pgenlib.pyx":1596
  *             if self._state_ptr:
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):             # <<<<<<<<<<<<<<
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  *                 PyMem_Free(self._state_ptr)
  */
       __pyx_t_5 = (plink2::PgrGetFreadBuf(__pyx_v_self->_state_ptr) != 0);
       if (__pyx_t_5) {
 
-        /* "pgenlib.pyx":1486
+        /* "pgenlib.pyx":1597
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))             # <<<<<<<<<<<<<<
  *                 PyMem_Free(self._state_ptr)
  *                 self._state_ptr = NULL
  */
         plink2::aligned_free(plink2::PgrGetFreadBuf(__pyx_v_self->_state_ptr));
 
-        /* "pgenlib.pyx":1485
+        /* "pgenlib.pyx":1596
  *             if self._state_ptr:
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):             # <<<<<<<<<<<<<<
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  *                 PyMem_Free(self._state_ptr)
  */
       }
 
-      /* "pgenlib.pyx":1487
+      /* "pgenlib.pyx":1598
  *                 if PgrGetFreadBuf(self._state_ptr):
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  *                 PyMem_Free(self._state_ptr)             # <<<<<<<<<<<<<<
  *                 self._state_ptr = NULL
  *             PyMem_Free(self._info_ptr)
  */
       PyMem_Free(__pyx_v_self->_state_ptr);
 
-      /* "pgenlib.pyx":1488
+      /* "pgenlib.pyx":1599
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  *                 PyMem_Free(self._state_ptr)
  *                 self._state_ptr = NULL             # <<<<<<<<<<<<<<
  *             PyMem_Free(self._info_ptr)
  *             self._info_ptr = NULL
  */
       __pyx_v_self->_state_ptr = NULL;
 
-      /* "pgenlib.pyx":1483
+      /* "pgenlib.pyx":1594
  *             if self._info_ptr[0].nonref_flags:
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:             # <<<<<<<<<<<<<<
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):
  */
     }
 
-    /* "pgenlib.pyx":1489
+    /* "pgenlib.pyx":1600
  *                 PyMem_Free(self._state_ptr)
  *                 self._state_ptr = NULL
  *             PyMem_Free(self._info_ptr)             # <<<<<<<<<<<<<<
  *             self._info_ptr = NULL
  *             if reterr != kPglRetSuccess:
  */
     PyMem_Free(__pyx_v_self->_info_ptr);
 
-    /* "pgenlib.pyx":1490
+    /* "pgenlib.pyx":1601
  *                 self._state_ptr = NULL
  *             PyMem_Free(self._info_ptr)
  *             self._info_ptr = NULL             # <<<<<<<<<<<<<<
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("close() error " + str(reterr))
  */
     __pyx_v_self->_info_ptr = NULL;
 
-    /* "pgenlib.pyx":1491
+    /* "pgenlib.pyx":1602
  *             PyMem_Free(self._info_ptr)
  *             self._info_ptr = NULL
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("close() error " + str(reterr))
  *         return
  */
     __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":1492
+      /* "pgenlib.pyx":1603
  *             self._info_ptr = NULL
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("close() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-      __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1492, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1603, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1492, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1603, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_close_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1492, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_close_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1603, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1492, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1603, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1492, __pyx_L1_error)
+      __PYX_ERR(0, 1603, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1491
+      /* "pgenlib.pyx":1602
  *             PyMem_Free(self._info_ptr)
  *             self._info_ptr = NULL
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("close() error " + str(reterr))
  *         return
  */
     }
 
-    /* "pgenlib.pyx":1475
+    /* "pgenlib.pyx":1586
  *     cpdef close(self):
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:             # <<<<<<<<<<<<<<
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:
  */
   }
 
-  /* "pgenlib.pyx":1493
+  /* "pgenlib.pyx":1604
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("close() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1473
+  /* "pgenlib.pyx":1584
  * 
  * 
  *     cpdef close(self):             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:
  */
 
@@ -24048,15 +26769,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("close", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_close(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1473, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader_close(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1584, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -24065,15 +26786,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1496
+/* "pgenlib.pyx":1607
  * 
  * 
  *     cpdef __exit__(self, exc_type, exc_val, exc_tb):             # <<<<<<<<<<<<<<
  *         self.close()
  *         return
  */
 
@@ -24096,15 +26817,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_exit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1496, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_exit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1607, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenReader_41__exit__)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         __pyx_t_5 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
@@ -24116,43 +26837,43 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_5 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1496, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1607, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_2);
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1496, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1607, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_2);
         } else
         #endif
         {
-          __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1496, __pyx_L1_error)
+          __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1607, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           if (__pyx_t_4) {
             __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
           }
           __Pyx_INCREF(__pyx_v_exc_type);
           __Pyx_GIVEREF(__pyx_v_exc_type);
           PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_exc_type);
           __Pyx_INCREF(__pyx_v_exc_val);
           __Pyx_GIVEREF(__pyx_v_exc_val);
           PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_exc_val);
           __Pyx_INCREF(__pyx_v_exc_tb);
           __Pyx_GIVEREF(__pyx_v_exc_tb);
           PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_5, __pyx_v_exc_tb);
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1496, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1607, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -24167,37 +26888,37 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1497
+  /* "pgenlib.pyx":1608
  * 
  *     cpdef __exit__(self, exc_type, exc_val, exc_tb):
  *         self.close()             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->close(__pyx_v_self, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1497, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenReader *)__pyx_v_self->__pyx_vtab)->close(__pyx_v_self, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pgenlib.pyx":1498
+  /* "pgenlib.pyx":1609
  *     cpdef __exit__(self, exc_type, exc_val, exc_tb):
  *         self.close()
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1496
+  /* "pgenlib.pyx":1607
  * 
  * 
  *     cpdef __exit__(self, exc_type, exc_val, exc_tb):             # <<<<<<<<<<<<<<
  *         self.close()
  *         return
  */
 
@@ -24249,40 +26970,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exc_type)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exc_val)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 1); __PYX_ERR(0, 1496, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 1); __PYX_ERR(0, 1607, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exc_tb)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 2); __PYX_ERR(0, 1496, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 2); __PYX_ERR(0, 1607, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__exit__") < 0)) __PYX_ERR(0, 1496, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__exit__") < 0)) __PYX_ERR(0, 1607, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_exc_type = values[0];
     __pyx_v_exc_val = values[1];
     __pyx_v_exc_tb = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1496, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1607, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenReader.__exit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_7pgenlib_10PgenReader_40__exit__(((struct __pyx_obj_7pgenlib_PgenReader *)__pyx_v_self), __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb);
 
@@ -24296,15 +27017,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__exit__", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader___exit__(__pyx_v_self, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1496, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenReader___exit__(__pyx_v_self, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -24313,15 +27034,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1501
+/* "pgenlib.pyx":1612
  * 
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:
  */
 
@@ -24338,219 +27059,219 @@
 
 static void __pyx_pf_7pgenlib_10PgenReader_42__dealloc__(struct __pyx_obj_7pgenlib_PgenReader *__pyx_v_self) {
   plink2::PglErr __pyx_v_reterr;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "pgenlib.pyx":1502
+  /* "pgenlib.pyx":1613
  * 
  *     def __dealloc__(self):
  *         cdef PglErr reterr = kPglRetSuccess             # <<<<<<<<<<<<<<
  *         if self._info_ptr:
  *             CleanupPgfi(self._info_ptr, &reterr)
  */
   __pyx_v_reterr = plink2::kPglRetSuccess;
 
-  /* "pgenlib.pyx":1503
+  /* "pgenlib.pyx":1614
  *     def __dealloc__(self):
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:             # <<<<<<<<<<<<<<
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:
  */
   __pyx_t_1 = (__pyx_v_self->_info_ptr != 0);
   if (__pyx_t_1) {
 
-    /* "pgenlib.pyx":1504
+    /* "pgenlib.pyx":1615
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:
  *             CleanupPgfi(self._info_ptr, &reterr)             # <<<<<<<<<<<<<<
  *             if self._info_ptr[0].vrtypes:
  *                 aligned_free(self._info_ptr[0].vrtypes)
  */
     (void)(plink2::CleanupPgfi(__pyx_v_self->_info_ptr, (&__pyx_v_reterr)));
 
-    /* "pgenlib.pyx":1505
+    /* "pgenlib.pyx":1616
  *         if self._info_ptr:
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:
  */
     __pyx_t_1 = ((__pyx_v_self->_info_ptr[0]).vrtypes != 0);
     if (__pyx_t_1) {
 
-      /* "pgenlib.pyx":1506
+      /* "pgenlib.pyx":1617
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:
  *                 aligned_free(self._info_ptr[0].vrtypes)             # <<<<<<<<<<<<<<
  *             if self._info_ptr[0].allele_idx_offsets:
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  */
       plink2::aligned_free((__pyx_v_self->_info_ptr[0]).vrtypes);
 
-      /* "pgenlib.pyx":1505
+      /* "pgenlib.pyx":1616
  *         if self._info_ptr:
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:
  */
     }
 
-    /* "pgenlib.pyx":1507
+    /* "pgenlib.pyx":1618
  *             if self._info_ptr[0].vrtypes:
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:
  */
     __pyx_t_1 = ((__pyx_v_self->_info_ptr[0]).allele_idx_offsets != 0);
     if (__pyx_t_1) {
 
-      /* "pgenlib.pyx":1508
+      /* "pgenlib.pyx":1619
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)             # <<<<<<<<<<<<<<
  *             if self._info_ptr[0].nonref_flags:
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  */
       plink2::aligned_free((__pyx_v_self->_info_ptr[0]).allele_idx_offsets);
 
-      /* "pgenlib.pyx":1507
+      /* "pgenlib.pyx":1618
  *             if self._info_ptr[0].vrtypes:
  *                 aligned_free(self._info_ptr[0].vrtypes)
  *             if self._info_ptr[0].allele_idx_offsets:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:
  */
     }
 
-    /* "pgenlib.pyx":1509
+    /* "pgenlib.pyx":1620
  *             if self._info_ptr[0].allele_idx_offsets:
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:
  */
     __pyx_t_1 = ((__pyx_v_self->_info_ptr[0]).nonref_flags != 0);
     if (__pyx_t_1) {
 
-      /* "pgenlib.pyx":1510
+      /* "pgenlib.pyx":1621
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:
  *                 aligned_free(self._info_ptr[0].nonref_flags)             # <<<<<<<<<<<<<<
  *             if self._state_ptr:
  *                 CleanupPgr(self._state_ptr, &reterr)
  */
       plink2::aligned_free((__pyx_v_self->_info_ptr[0]).nonref_flags);
 
-      /* "pgenlib.pyx":1509
+      /* "pgenlib.pyx":1620
  *             if self._info_ptr[0].allele_idx_offsets:
  *                 aligned_free(self._info_ptr[0].allele_idx_offsets)
  *             if self._info_ptr[0].nonref_flags:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:
  */
     }
 
-    /* "pgenlib.pyx":1511
+    /* "pgenlib.pyx":1622
  *             if self._info_ptr[0].nonref_flags:
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:             # <<<<<<<<<<<<<<
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):
  */
     __pyx_t_1 = (__pyx_v_self->_state_ptr != 0);
     if (__pyx_t_1) {
 
-      /* "pgenlib.pyx":1512
+      /* "pgenlib.pyx":1623
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:
  *                 CleanupPgr(self._state_ptr, &reterr)             # <<<<<<<<<<<<<<
  *                 if PgrGetFreadBuf(self._state_ptr):
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  */
       (void)(plink2::CleanupPgr(__pyx_v_self->_state_ptr, (&__pyx_v_reterr)));
 
-      /* "pgenlib.pyx":1513
+      /* "pgenlib.pyx":1624
  *             if self._state_ptr:
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):             # <<<<<<<<<<<<<<
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  *                 PyMem_Free(self._state_ptr)
  */
       __pyx_t_1 = (plink2::PgrGetFreadBuf(__pyx_v_self->_state_ptr) != 0);
       if (__pyx_t_1) {
 
-        /* "pgenlib.pyx":1514
+        /* "pgenlib.pyx":1625
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))             # <<<<<<<<<<<<<<
  *                 PyMem_Free(self._state_ptr)
  *             PyMem_Free(self._info_ptr)
  */
         plink2::aligned_free(plink2::PgrGetFreadBuf(__pyx_v_self->_state_ptr));
 
-        /* "pgenlib.pyx":1513
+        /* "pgenlib.pyx":1624
  *             if self._state_ptr:
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):             # <<<<<<<<<<<<<<
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  *                 PyMem_Free(self._state_ptr)
  */
       }
 
-      /* "pgenlib.pyx":1515
+      /* "pgenlib.pyx":1626
  *                 if PgrGetFreadBuf(self._state_ptr):
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  *                 PyMem_Free(self._state_ptr)             # <<<<<<<<<<<<<<
  *             PyMem_Free(self._info_ptr)
  *         return
  */
       PyMem_Free(__pyx_v_self->_state_ptr);
 
-      /* "pgenlib.pyx":1511
+      /* "pgenlib.pyx":1622
  *             if self._info_ptr[0].nonref_flags:
  *                 aligned_free(self._info_ptr[0].nonref_flags)
  *             if self._state_ptr:             # <<<<<<<<<<<<<<
  *                 CleanupPgr(self._state_ptr, &reterr)
  *                 if PgrGetFreadBuf(self._state_ptr):
  */
     }
 
-    /* "pgenlib.pyx":1516
+    /* "pgenlib.pyx":1627
  *                     aligned_free(PgrGetFreadBuf(self._state_ptr))
  *                 PyMem_Free(self._state_ptr)
  *             PyMem_Free(self._info_ptr)             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     PyMem_Free(__pyx_v_self->_info_ptr);
 
-    /* "pgenlib.pyx":1503
+    /* "pgenlib.pyx":1614
  *     def __dealloc__(self):
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:             # <<<<<<<<<<<<<<
  *             CleanupPgfi(self._info_ptr, &reterr)
  *             if self._info_ptr[0].vrtypes:
  */
   }
 
-  /* "pgenlib.pyx":1517
+  /* "pgenlib.pyx":1628
  *                 PyMem_Free(self._state_ptr)
  *             PyMem_Free(self._info_ptr)
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1501
+  /* "pgenlib.pyx":1612
  * 
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._info_ptr:
  */
 
@@ -24589,15 +27310,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -24645,15 +27366,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -24668,15 +27389,15 @@
   __Pyx_AddTraceback("pgenlib.PgenReader.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1520
+/* "pgenlib.pyx":1631
  * 
  * 
  * cdef bytes_to_bits_internal(np.ndarray[np.uint8_t,mode="c",cast=True] boolbytes, uint32_t sample_ct, uintptr_t* bitarr):             # <<<<<<<<<<<<<<
  *     BytesToBitsUnsafe(boolbytes, sample_ct, bitarr)
  * 
  */
 
@@ -24692,29 +27413,29 @@
   __Pyx_RefNannySetupContext("bytes_to_bits_internal", 0);
   __pyx_pybuffer_boolbytes.pybuffer.buf = NULL;
   __pyx_pybuffer_boolbytes.refcount = 0;
   __pyx_pybuffernd_boolbytes.data = NULL;
   __pyx_pybuffernd_boolbytes.rcbuffer = &__pyx_pybuffer_boolbytes;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_boolbytes.rcbuffer->pybuffer, (PyObject*)__pyx_v_boolbytes, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1520, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_boolbytes.rcbuffer->pybuffer, (PyObject*)__pyx_v_boolbytes, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1631, __pyx_L1_error)
   }
   __pyx_pybuffernd_boolbytes.diminfo[0].strides = __pyx_pybuffernd_boolbytes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_boolbytes.diminfo[0].shape = __pyx_pybuffernd_boolbytes.rcbuffer->pybuffer.shape[0];
 
-  /* "pgenlib.pyx":1521
+  /* "pgenlib.pyx":1632
  * 
  * cdef bytes_to_bits_internal(np.ndarray[np.uint8_t,mode="c",cast=True] boolbytes, uint32_t sample_ct, uintptr_t* bitarr):
  *     BytesToBitsUnsafe(boolbytes, sample_ct, bitarr)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_AsUString(((PyObject *)__pyx_v_boolbytes)); if (unlikely((!__pyx_t_1) && PyErr_Occurred())) __PYX_ERR(0, 1521, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_AsUString(((PyObject *)__pyx_v_boolbytes)); if (unlikely((!__pyx_t_1) && PyErr_Occurred())) __PYX_ERR(0, 1632, __pyx_L1_error)
   plink2::BytesToBitsUnsafe(__pyx_t_1, __pyx_v_sample_ct, __pyx_v_bitarr);
 
-  /* "pgenlib.pyx":1520
+  /* "pgenlib.pyx":1631
  * 
  * 
  * cdef bytes_to_bits_internal(np.ndarray[np.uint8_t,mode="c",cast=True] boolbytes, uint32_t sample_ct, uintptr_t* bitarr):             # <<<<<<<<<<<<<<
  *     BytesToBitsUnsafe(boolbytes, sample_ct, bitarr)
  * 
  */
 
@@ -24735,15 +27456,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_boolbytes.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1540
+/* "pgenlib.pyx":1651
  *     cdef uint16_t* _dosage_main
  * 
  *     def __cinit__(self, bytes filename, uint32_t sample_ct,             # <<<<<<<<<<<<<<
  *                   object variant_ct = None, object nonref_flags = True,
  *                   uint32_t allele_ct_limit = 2,
  */
 
@@ -24765,25 +27486,25 @@
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_filename,&__pyx_n_s_sample_ct,&__pyx_n_s_variant_ct,&__pyx_n_s_nonref_flags,&__pyx_n_s_allele_ct_limit,&__pyx_n_s_hardcall_phase_present,&__pyx_n_s_dosage_present,&__pyx_n_s_dosage_phase_present,&__pyx_n_s_variant_ct_limit,0};
     PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
 
-    /* "pgenlib.pyx":1541
+    /* "pgenlib.pyx":1652
  * 
  *     def __cinit__(self, bytes filename, uint32_t sample_ct,
  *                   object variant_ct = None, object nonref_flags = True,             # <<<<<<<<<<<<<<
  *                   uint32_t allele_ct_limit = 2,
  *                   bint hardcall_phase_present = False,
  */
     values[2] = ((PyObject *)Py_None);
     values[3] = ((PyObject *)Py_True);
 
-    /* "pgenlib.pyx":1546
+    /* "pgenlib.pyx":1657
  *                   bint dosage_present = False,
  *                   bint dosage_phase_present = False,
  *                   object variant_ct_limit = None):             # <<<<<<<<<<<<<<
  *         cdef PgenWriteMode write_mode = kPgenWriteBackwardSeek
  *         cdef uint32_t cur_variant_ct_limit
  */
     values[8] = ((PyObject *)Py_None);
@@ -24817,15 +27538,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_filename)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sample_ct)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 9, 1); __PYX_ERR(0, 1540, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 9, 1); __PYX_ERR(0, 1651, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_ct);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -24863,15 +27584,15 @@
         case  8:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_variant_ct_limit);
           if (value) { values[8] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 1540, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 1651, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
         CYTHON_FALLTHROUGH;
         case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
         CYTHON_FALLTHROUGH;
@@ -24888,75 +27609,75 @@
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_filename = ((PyObject*)values[0]);
-    __pyx_v_sample_ct = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_sample_ct == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1540, __pyx_L3_error)
+    __pyx_v_sample_ct = __Pyx_PyInt_As_uint32_t(values[1]); if (unlikely((__pyx_v_sample_ct == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1651, __pyx_L3_error)
     __pyx_v_variant_ct = values[2];
     __pyx_v_nonref_flags = values[3];
     if (values[4]) {
-      __pyx_v_allele_ct_limit = __Pyx_PyInt_As_uint32_t(values[4]); if (unlikely((__pyx_v_allele_ct_limit == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1542, __pyx_L3_error)
+      __pyx_v_allele_ct_limit = __Pyx_PyInt_As_uint32_t(values[4]); if (unlikely((__pyx_v_allele_ct_limit == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1653, __pyx_L3_error)
     } else {
       __pyx_v_allele_ct_limit = ((uint32_t)2);
     }
     if (values[5]) {
-      __pyx_v_hardcall_phase_present = __Pyx_PyObject_IsTrue(values[5]); if (unlikely((__pyx_v_hardcall_phase_present == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1543, __pyx_L3_error)
+      __pyx_v_hardcall_phase_present = __Pyx_PyObject_IsTrue(values[5]); if (unlikely((__pyx_v_hardcall_phase_present == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1654, __pyx_L3_error)
     } else {
 
-      /* "pgenlib.pyx":1543
+      /* "pgenlib.pyx":1654
  *                   object variant_ct = None, object nonref_flags = True,
  *                   uint32_t allele_ct_limit = 2,
  *                   bint hardcall_phase_present = False,             # <<<<<<<<<<<<<<
  *                   bint dosage_present = False,
  *                   bint dosage_phase_present = False,
  */
       __pyx_v_hardcall_phase_present = ((int)0);
     }
     if (values[6]) {
-      __pyx_v_dosage_present = __Pyx_PyObject_IsTrue(values[6]); if (unlikely((__pyx_v_dosage_present == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1544, __pyx_L3_error)
+      __pyx_v_dosage_present = __Pyx_PyObject_IsTrue(values[6]); if (unlikely((__pyx_v_dosage_present == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1655, __pyx_L3_error)
     } else {
 
-      /* "pgenlib.pyx":1544
+      /* "pgenlib.pyx":1655
  *                   uint32_t allele_ct_limit = 2,
  *                   bint hardcall_phase_present = False,
  *                   bint dosage_present = False,             # <<<<<<<<<<<<<<
  *                   bint dosage_phase_present = False,
  *                   object variant_ct_limit = None):
  */
       __pyx_v_dosage_present = ((int)0);
     }
     if (values[7]) {
-      __pyx_v_dosage_phase_present = __Pyx_PyObject_IsTrue(values[7]); if (unlikely((__pyx_v_dosage_phase_present == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1545, __pyx_L3_error)
+      __pyx_v_dosage_phase_present = __Pyx_PyObject_IsTrue(values[7]); if (unlikely((__pyx_v_dosage_phase_present == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1656, __pyx_L3_error)
     } else {
 
-      /* "pgenlib.pyx":1545
+      /* "pgenlib.pyx":1656
  *                   bint hardcall_phase_present = False,
  *                   bint dosage_present = False,
  *                   bint dosage_phase_present = False,             # <<<<<<<<<<<<<<
  *                   object variant_ct_limit = None):
  *         cdef PgenWriteMode write_mode = kPgenWriteBackwardSeek
  */
       __pyx_v_dosage_phase_present = ((int)0);
     }
     __pyx_v_variant_ct_limit = values[8];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 9, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1540, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 0, 2, 9, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1651, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenWriter.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_filename), (&PyBytes_Type), 1, "filename", 1))) __PYX_ERR(0, 1540, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_filename), (&PyBytes_Type), 1, "filename", 1))) __PYX_ERR(0, 1651, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter___cinit__(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), __pyx_v_filename, __pyx_v_sample_ct, __pyx_v_variant_ct, __pyx_v_nonref_flags, __pyx_v_allele_ct_limit, __pyx_v_hardcall_phase_present, __pyx_v_dosage_present, __pyx_v_dosage_phase_present, __pyx_v_variant_ct_limit);
 
-  /* "pgenlib.pyx":1540
+  /* "pgenlib.pyx":1651
  *     cdef uint16_t* _dosage_main
  * 
  *     def __cinit__(self, bytes filename, uint32_t sample_ct,             # <<<<<<<<<<<<<<
  *                   object variant_ct = None, object nonref_flags = True,
  *                   uint32_t allele_ct_limit = 2,
  */
 
@@ -24995,111 +27716,111 @@
   PyObject *__pyx_t_6 = NULL;
   long __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "pgenlib.pyx":1547
+  /* "pgenlib.pyx":1658
  *                   bint dosage_phase_present = False,
  *                   object variant_ct_limit = None):
  *         cdef PgenWriteMode write_mode = kPgenWriteBackwardSeek             # <<<<<<<<<<<<<<
  *         cdef uint32_t cur_variant_ct_limit
  *         if variant_ct is not None:
  */
   __pyx_v_write_mode = plink2::kPgenWriteBackwardSeek;
 
-  /* "pgenlib.pyx":1549
+  /* "pgenlib.pyx":1660
  *         cdef PgenWriteMode write_mode = kPgenWriteBackwardSeek
  *         cdef uint32_t cur_variant_ct_limit
  *         if variant_ct is not None:             # <<<<<<<<<<<<<<
  *             # Could also enforce variant_ct >= variant_ct_limit when both are
  *             # provided?
  */
   __pyx_t_1 = (__pyx_v_variant_ct != Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "pgenlib.pyx":1552
+    /* "pgenlib.pyx":1663
  *             # Could also enforce variant_ct >= variant_ct_limit when both are
  *             # provided?
  *             cur_variant_ct_limit = variant_ct             # <<<<<<<<<<<<<<
  *         elif variant_ct_limit is not None:
  *             write_mode = kPgenWriteAndCopy
  */
-    __pyx_t_3 = __Pyx_PyInt_As_uint32_t(__pyx_v_variant_ct); if (unlikely((__pyx_t_3 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1552, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_As_uint32_t(__pyx_v_variant_ct); if (unlikely((__pyx_t_3 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1663, __pyx_L1_error)
     __pyx_v_cur_variant_ct_limit = __pyx_t_3;
 
-    /* "pgenlib.pyx":1549
+    /* "pgenlib.pyx":1660
  *         cdef PgenWriteMode write_mode = kPgenWriteBackwardSeek
  *         cdef uint32_t cur_variant_ct_limit
  *         if variant_ct is not None:             # <<<<<<<<<<<<<<
  *             # Could also enforce variant_ct >= variant_ct_limit when both are
  *             # provided?
  */
     goto __pyx_L3;
   }
 
-  /* "pgenlib.pyx":1553
+  /* "pgenlib.pyx":1664
  *             # provided?
  *             cur_variant_ct_limit = variant_ct
  *         elif variant_ct_limit is not None:             # <<<<<<<<<<<<<<
  *             write_mode = kPgenWriteAndCopy
  *             cur_variant_ct_limit = variant_ct_limit
  */
   __pyx_t_2 = (__pyx_v_variant_ct_limit != Py_None);
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (likely(__pyx_t_1)) {
 
-    /* "pgenlib.pyx":1554
+    /* "pgenlib.pyx":1665
  *             cur_variant_ct_limit = variant_ct
  *         elif variant_ct_limit is not None:
  *             write_mode = kPgenWriteAndCopy             # <<<<<<<<<<<<<<
  *             cur_variant_ct_limit = variant_ct_limit
  *         else:
  */
     __pyx_v_write_mode = plink2::kPgenWriteAndCopy;
 
-    /* "pgenlib.pyx":1555
+    /* "pgenlib.pyx":1666
  *         elif variant_ct_limit is not None:
  *             write_mode = kPgenWriteAndCopy
  *             cur_variant_ct_limit = variant_ct_limit             # <<<<<<<<<<<<<<
  *         else:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct or variant_ct_upper_bound must be provided).")
  */
-    __pyx_t_3 = __Pyx_PyInt_As_uint32_t(__pyx_v_variant_ct_limit); if (unlikely((__pyx_t_3 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1555, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_As_uint32_t(__pyx_v_variant_ct_limit); if (unlikely((__pyx_t_3 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1666, __pyx_L1_error)
     __pyx_v_cur_variant_ct_limit = __pyx_t_3;
 
-    /* "pgenlib.pyx":1553
+    /* "pgenlib.pyx":1664
  *             # provided?
  *             cur_variant_ct_limit = variant_ct
  *         elif variant_ct_limit is not None:             # <<<<<<<<<<<<<<
  *             write_mode = kPgenWriteAndCopy
  *             cur_variant_ct_limit = variant_ct_limit
  */
     goto __pyx_L3;
   }
 
-  /* "pgenlib.pyx":1557
+  /* "pgenlib.pyx":1668
  *             cur_variant_ct_limit = variant_ct_limit
  *         else:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct or variant_ct_upper_bound must be provided).")             # <<<<<<<<<<<<<<
  *         if cur_variant_ct_limit == 0 or cur_variant_ct_limit > kPglMaxVariantCt:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")
  */
   /*else*/ {
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1557, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1668, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1557, __pyx_L1_error)
+    __PYX_ERR(0, 1668, __pyx_L1_error)
   }
   __pyx_L3:;
 
-  /* "pgenlib.pyx":1558
+  /* "pgenlib.pyx":1669
  *         else:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct or variant_ct_upper_bound must be provided).")
  *         if cur_variant_ct_limit == 0 or cur_variant_ct_limit > kPglMaxVariantCt:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")
  *         if dosage_phase_present and not dosage_present:
  */
   __pyx_t_2 = ((__pyx_v_cur_variant_ct_limit == 0) != 0);
@@ -25109,37 +27830,37 @@
     goto __pyx_L5_bool_binop_done;
   }
   __pyx_t_2 = ((__pyx_v_cur_variant_ct_limit > plink2::kPglMaxVariantCt) != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L5_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "pgenlib.pyx":1559
+    /* "pgenlib.pyx":1670
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct or variant_ct_upper_bound must be provided).")
  *         if cur_variant_ct_limit == 0 or cur_variant_ct_limit > kPglMaxVariantCt:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")             # <<<<<<<<<<<<<<
  *         if dosage_phase_present and not dosage_present:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")
  */
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1559, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1670, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1559, __pyx_L1_error)
+    __PYX_ERR(0, 1670, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1558
+    /* "pgenlib.pyx":1669
  *         else:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct or variant_ct_upper_bound must be provided).")
  *         if cur_variant_ct_limit == 0 or cur_variant_ct_limit > kPglMaxVariantCt:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")
  *         if dosage_phase_present and not dosage_present:
  */
   }
 
-  /* "pgenlib.pyx":1560
+  /* "pgenlib.pyx":1671
  *         if cur_variant_ct_limit == 0 or cur_variant_ct_limit > kPglMaxVariantCt:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")
  *         if dosage_phase_present and not dosage_present:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")
  *         if allele_ct_limit != 2:
  */
   __pyx_t_2 = (__pyx_v_dosage_phase_present != 0);
@@ -25149,47 +27870,47 @@
     goto __pyx_L8_bool_binop_done;
   }
   __pyx_t_2 = ((!(__pyx_v_dosage_present != 0)) != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L8_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "pgenlib.pyx":1561
+    /* "pgenlib.pyx":1672
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")
  *         if dosage_phase_present and not dosage_present:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")             # <<<<<<<<<<<<<<
  *         if allele_ct_limit != 2:
  *             if (allele_ct_limit < 2) or (allele_ct_limit > kPglMaxAlleleCt):
  */
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1561, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 1561, __pyx_L1_error)
+    __PYX_ERR(0, 1672, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1560
+    /* "pgenlib.pyx":1671
  *         if cur_variant_ct_limit == 0 or cur_variant_ct_limit > kPglMaxVariantCt:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")
  *         if dosage_phase_present and not dosage_present:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")
  *         if allele_ct_limit != 2:
  */
   }
 
-  /* "pgenlib.pyx":1562
+  /* "pgenlib.pyx":1673
  *         if dosage_phase_present and not dosage_present:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")
  *         if allele_ct_limit != 2:             # <<<<<<<<<<<<<<
  *             if (allele_ct_limit < 2) or (allele_ct_limit > kPglMaxAlleleCt):
  *                 raise RuntimeError("Invalid arguments for PgenWriter constructor (allele_ct_limit must be in [2, 255]).")
  */
   __pyx_t_1 = ((__pyx_v_allele_ct_limit != 2) != 0);
   if (__pyx_t_1) {
 
-    /* "pgenlib.pyx":1563
+    /* "pgenlib.pyx":1674
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")
  *         if allele_ct_limit != 2:
  *             if (allele_ct_limit < 2) or (allele_ct_limit > kPglMaxAlleleCt):             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Invalid arguments for PgenWriter constructor (allele_ct_limit must be in [2, 255]).")
  *             write_mode = kPgenWriteAndCopy
  */
     __pyx_t_2 = ((__pyx_v_allele_ct_limit < 2) != 0);
@@ -25199,698 +27920,698 @@
       goto __pyx_L12_bool_binop_done;
     }
     __pyx_t_2 = ((__pyx_v_allele_ct_limit > plink2::kPglMaxAlleleCt) != 0);
     __pyx_t_1 = __pyx_t_2;
     __pyx_L12_bool_binop_done:;
     if (unlikely(__pyx_t_1)) {
 
-      /* "pgenlib.pyx":1564
+      /* "pgenlib.pyx":1675
  *         if allele_ct_limit != 2:
  *             if (allele_ct_limit < 2) or (allele_ct_limit > kPglMaxAlleleCt):
  *                 raise RuntimeError("Invalid arguments for PgenWriter constructor (allele_ct_limit must be in [2, 255]).")             # <<<<<<<<<<<<<<
  *             write_mode = kPgenWriteAndCopy
  * 
  */
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1564, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1675, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_Raise(__pyx_t_4, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __PYX_ERR(0, 1564, __pyx_L1_error)
+      __PYX_ERR(0, 1675, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1563
+      /* "pgenlib.pyx":1674
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")
  *         if allele_ct_limit != 2:
  *             if (allele_ct_limit < 2) or (allele_ct_limit > kPglMaxAlleleCt):             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("Invalid arguments for PgenWriter constructor (allele_ct_limit must be in [2, 255]).")
  *             write_mode = kPgenWriteAndCopy
  */
     }
 
-    /* "pgenlib.pyx":1565
+    /* "pgenlib.pyx":1676
  *             if (allele_ct_limit < 2) or (allele_ct_limit > kPglMaxAlleleCt):
  *                 raise RuntimeError("Invalid arguments for PgenWriter constructor (allele_ct_limit must be in [2, 255]).")
  *             write_mode = kPgenWriteAndCopy             # <<<<<<<<<<<<<<
  * 
  *         self._state_ptr = <STPgenWriter*>PyMem_Malloc(sizeof(STPgenWriter))
  */
     __pyx_v_write_mode = plink2::kPgenWriteAndCopy;
 
-    /* "pgenlib.pyx":1562
+    /* "pgenlib.pyx":1673
  *         if dosage_phase_present and not dosage_present:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")
  *         if allele_ct_limit != 2:             # <<<<<<<<<<<<<<
  *             if (allele_ct_limit < 2) or (allele_ct_limit > kPglMaxAlleleCt):
  *                 raise RuntimeError("Invalid arguments for PgenWriter constructor (allele_ct_limit must be in [2, 255]).")
  */
   }
 
-  /* "pgenlib.pyx":1567
+  /* "pgenlib.pyx":1678
  *             write_mode = kPgenWriteAndCopy
  * 
  *         self._state_ptr = <STPgenWriter*>PyMem_Malloc(sizeof(STPgenWriter))             # <<<<<<<<<<<<<<
  *         if not self._state_ptr:
  *             raise MemoryError()
  */
   __pyx_v_self->_state_ptr = ((plink2::STPgenWriter *)PyMem_Malloc((sizeof(plink2::STPgenWriter))));
 
-  /* "pgenlib.pyx":1568
+  /* "pgenlib.pyx":1679
  * 
  *         self._state_ptr = <STPgenWriter*>PyMem_Malloc(sizeof(STPgenWriter))
  *         if not self._state_ptr:             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         self._nonref_flags = NULL
  */
   __pyx_t_1 = ((!(__pyx_v_self->_state_ptr != 0)) != 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "pgenlib.pyx":1569
+    /* "pgenlib.pyx":1680
  *         self._state_ptr = <STPgenWriter*>PyMem_Malloc(sizeof(STPgenWriter))
  *         if not self._state_ptr:
  *             raise MemoryError()             # <<<<<<<<<<<<<<
  *         self._nonref_flags = NULL
  *         cdef uint32_t nonref_flags_storage = 0
  */
-    PyErr_NoMemory(); __PYX_ERR(0, 1569, __pyx_L1_error)
+    PyErr_NoMemory(); __PYX_ERR(0, 1680, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1568
+    /* "pgenlib.pyx":1679
  * 
  *         self._state_ptr = <STPgenWriter*>PyMem_Malloc(sizeof(STPgenWriter))
  *         if not self._state_ptr:             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         self._nonref_flags = NULL
  */
   }
 
-  /* "pgenlib.pyx":1570
+  /* "pgenlib.pyx":1681
  *         if not self._state_ptr:
  *             raise MemoryError()
  *         self._nonref_flags = NULL             # <<<<<<<<<<<<<<
  *         cdef uint32_t nonref_flags_storage = 0
  *         cdef uint32_t bitvec_cacheline_ct = DivUp(sample_ct, kBitsPerCacheline)
  */
   __pyx_v_self->_nonref_flags = NULL;
 
-  /* "pgenlib.pyx":1571
+  /* "pgenlib.pyx":1682
  *             raise MemoryError()
  *         self._nonref_flags = NULL
  *         cdef uint32_t nonref_flags_storage = 0             # <<<<<<<<<<<<<<
  *         cdef uint32_t bitvec_cacheline_ct = DivUp(sample_ct, kBitsPerCacheline)
  *         if nonref_flags is not None:
  */
   __pyx_v_nonref_flags_storage = 0;
 
-  /* "pgenlib.pyx":1572
+  /* "pgenlib.pyx":1683
  *         self._nonref_flags = NULL
  *         cdef uint32_t nonref_flags_storage = 0
  *         cdef uint32_t bitvec_cacheline_ct = DivUp(sample_ct, kBitsPerCacheline)             # <<<<<<<<<<<<<<
  *         if nonref_flags is not None:
  *             if type(nonref_flags) == type(True):
  */
   __pyx_v_bitvec_cacheline_ct = plink2::DivUp(__pyx_v_sample_ct, plink2::kBitsPerCacheline);
 
-  /* "pgenlib.pyx":1573
+  /* "pgenlib.pyx":1684
  *         cdef uint32_t nonref_flags_storage = 0
  *         cdef uint32_t bitvec_cacheline_ct = DivUp(sample_ct, kBitsPerCacheline)
  *         if nonref_flags is not None:             # <<<<<<<<<<<<<<
  *             if type(nonref_flags) == type(True):
  *                 if nonref_flags:
  */
   __pyx_t_1 = (__pyx_v_nonref_flags != Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "pgenlib.pyx":1574
+    /* "pgenlib.pyx":1685
  *         cdef uint32_t bitvec_cacheline_ct = DivUp(sample_ct, kBitsPerCacheline)
  *         if nonref_flags is not None:
  *             if type(nonref_flags) == type(True):             # <<<<<<<<<<<<<<
  *                 if nonref_flags:
  *                     nonref_flags_storage = 2
  */
-    __pyx_t_4 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_nonref_flags)), ((PyObject *)Py_TYPE(Py_True)), Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1574, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1574, __pyx_L1_error)
+    __pyx_t_4 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_nonref_flags)), ((PyObject *)Py_TYPE(Py_True)), Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1685, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1685, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (__pyx_t_2) {
 
-      /* "pgenlib.pyx":1575
+      /* "pgenlib.pyx":1686
  *         if nonref_flags is not None:
  *             if type(nonref_flags) == type(True):
  *                 if nonref_flags:             # <<<<<<<<<<<<<<
  *                     nonref_flags_storage = 2
  *                 else:
  */
-      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_nonref_flags); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1575, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_nonref_flags); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1686, __pyx_L1_error)
       if (__pyx_t_2) {
 
-        /* "pgenlib.pyx":1576
+        /* "pgenlib.pyx":1687
  *             if type(nonref_flags) == type(True):
  *                 if nonref_flags:
  *                     nonref_flags_storage = 2             # <<<<<<<<<<<<<<
  *                 else:
  *                     nonref_flags_storage = 1
  */
         __pyx_v_nonref_flags_storage = 2;
 
-        /* "pgenlib.pyx":1575
+        /* "pgenlib.pyx":1686
  *         if nonref_flags is not None:
  *             if type(nonref_flags) == type(True):
  *                 if nonref_flags:             # <<<<<<<<<<<<<<
  *                     nonref_flags_storage = 2
  *                 else:
  */
         goto __pyx_L17;
       }
 
-      /* "pgenlib.pyx":1578
+      /* "pgenlib.pyx":1689
  *                     nonref_flags_storage = 2
  *                 else:
  *                     nonref_flags_storage = 1             # <<<<<<<<<<<<<<
  *             else:
  *                 nonref_flags_storage = 3
  */
       /*else*/ {
         __pyx_v_nonref_flags_storage = 1;
       }
       __pyx_L17:;
 
-      /* "pgenlib.pyx":1574
+      /* "pgenlib.pyx":1685
  *         cdef uint32_t bitvec_cacheline_ct = DivUp(sample_ct, kBitsPerCacheline)
  *         if nonref_flags is not None:
  *             if type(nonref_flags) == type(True):             # <<<<<<<<<<<<<<
  *                 if nonref_flags:
  *                     nonref_flags_storage = 2
  */
       goto __pyx_L16;
     }
 
-    /* "pgenlib.pyx":1580
+    /* "pgenlib.pyx":1691
  *                     nonref_flags_storage = 1
  *             else:
  *                 nonref_flags_storage = 3             # <<<<<<<<<<<<<<
  *                 if cachealigned_malloc(bitvec_cacheline_ct * kCacheline, &(self._nonref_flags)):
  *                     raise MemoryError()
  */
     /*else*/ {
       __pyx_v_nonref_flags_storage = 3;
 
-      /* "pgenlib.pyx":1581
+      /* "pgenlib.pyx":1692
  *             else:
  *                 nonref_flags_storage = 3
  *                 if cachealigned_malloc(bitvec_cacheline_ct * kCacheline, &(self._nonref_flags)):             # <<<<<<<<<<<<<<
  *                     raise MemoryError()
  *                 bytes_to_bits_internal(nonref_flags, sample_ct, self._nonref_flags)
  */
       __pyx_t_2 = (plink2::cachealigned_malloc((__pyx_v_bitvec_cacheline_ct * plink2::kCacheline), (&__pyx_v_self->_nonref_flags)) != 0);
       if (unlikely(__pyx_t_2)) {
 
-        /* "pgenlib.pyx":1582
+        /* "pgenlib.pyx":1693
  *                 nonref_flags_storage = 3
  *                 if cachealigned_malloc(bitvec_cacheline_ct * kCacheline, &(self._nonref_flags)):
  *                     raise MemoryError()             # <<<<<<<<<<<<<<
  *                 bytes_to_bits_internal(nonref_flags, sample_ct, self._nonref_flags)
  *         cdef const char* fname = <const char*>filename
  */
-        PyErr_NoMemory(); __PYX_ERR(0, 1582, __pyx_L1_error)
+        PyErr_NoMemory(); __PYX_ERR(0, 1693, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1581
+        /* "pgenlib.pyx":1692
  *             else:
  *                 nonref_flags_storage = 3
  *                 if cachealigned_malloc(bitvec_cacheline_ct * kCacheline, &(self._nonref_flags)):             # <<<<<<<<<<<<<<
  *                     raise MemoryError()
  *                 bytes_to_bits_internal(nonref_flags, sample_ct, self._nonref_flags)
  */
       }
 
-      /* "pgenlib.pyx":1583
+      /* "pgenlib.pyx":1694
  *                 if cachealigned_malloc(bitvec_cacheline_ct * kCacheline, &(self._nonref_flags)):
  *                     raise MemoryError()
  *                 bytes_to_bits_internal(nonref_flags, sample_ct, self._nonref_flags)             # <<<<<<<<<<<<<<
  *         cdef const char* fname = <const char*>filename
  *         cdef PgenGlobalFlags phase_dosage_gflags = kfPgenGlobal0
  */
-      if (!(likely(((__pyx_v_nonref_flags) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_nonref_flags, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1583, __pyx_L1_error)
-      __pyx_t_4 = __pyx_f_7pgenlib_bytes_to_bits_internal(((PyArrayObject *)__pyx_v_nonref_flags), __pyx_v_sample_ct, __pyx_v_self->_nonref_flags); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1583, __pyx_L1_error)
+      if (!(likely(((__pyx_v_nonref_flags) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_nonref_flags, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1694, __pyx_L1_error)
+      __pyx_t_4 = __pyx_f_7pgenlib_bytes_to_bits_internal(((PyArrayObject *)__pyx_v_nonref_flags), __pyx_v_sample_ct, __pyx_v_self->_nonref_flags); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1694, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __pyx_L16:;
 
-    /* "pgenlib.pyx":1573
+    /* "pgenlib.pyx":1684
  *         cdef uint32_t nonref_flags_storage = 0
  *         cdef uint32_t bitvec_cacheline_ct = DivUp(sample_ct, kBitsPerCacheline)
  *         if nonref_flags is not None:             # <<<<<<<<<<<<<<
  *             if type(nonref_flags) == type(True):
  *                 if nonref_flags:
  */
   }
 
-  /* "pgenlib.pyx":1584
+  /* "pgenlib.pyx":1695
  *                     raise MemoryError()
  *                 bytes_to_bits_internal(nonref_flags, sample_ct, self._nonref_flags)
  *         cdef const char* fname = <const char*>filename             # <<<<<<<<<<<<<<
  *         cdef PgenGlobalFlags phase_dosage_gflags = kfPgenGlobal0
  *         if hardcall_phase_present:
  */
   if (unlikely(__pyx_v_filename == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-    __PYX_ERR(0, 1584, __pyx_L1_error)
+    __PYX_ERR(0, 1695, __pyx_L1_error)
   }
-  __pyx_t_5 = __Pyx_PyBytes_AsString(__pyx_v_filename); if (unlikely((!__pyx_t_5) && PyErr_Occurred())) __PYX_ERR(0, 1584, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyBytes_AsString(__pyx_v_filename); if (unlikely((!__pyx_t_5) && PyErr_Occurred())) __PYX_ERR(0, 1695, __pyx_L1_error)
   __pyx_v_fname = ((char const *)__pyx_t_5);
 
-  /* "pgenlib.pyx":1585
+  /* "pgenlib.pyx":1696
  *                 bytes_to_bits_internal(nonref_flags, sample_ct, self._nonref_flags)
  *         cdef const char* fname = <const char*>filename
  *         cdef PgenGlobalFlags phase_dosage_gflags = kfPgenGlobal0             # <<<<<<<<<<<<<<
  *         if hardcall_phase_present:
  *             phase_dosage_gflags |= kfPgenGlobalHardcallPhasePresent
  */
   __pyx_v_phase_dosage_gflags = plink2::kfPgenGlobal0;
 
-  /* "pgenlib.pyx":1586
+  /* "pgenlib.pyx":1697
  *         cdef const char* fname = <const char*>filename
  *         cdef PgenGlobalFlags phase_dosage_gflags = kfPgenGlobal0
  *         if hardcall_phase_present:             # <<<<<<<<<<<<<<
  *             phase_dosage_gflags |= kfPgenGlobalHardcallPhasePresent
  *         if dosage_present:
  */
   __pyx_t_2 = (__pyx_v_hardcall_phase_present != 0);
   if (__pyx_t_2) {
 
-    /* "pgenlib.pyx":1587
+    /* "pgenlib.pyx":1698
  *         cdef PgenGlobalFlags phase_dosage_gflags = kfPgenGlobal0
  *         if hardcall_phase_present:
  *             phase_dosage_gflags |= kfPgenGlobalHardcallPhasePresent             # <<<<<<<<<<<<<<
  *         if dosage_present:
  *             phase_dosage_gflags |= kfPgenGlobalDosagePresent
  */
     __pyx_v_phase_dosage_gflags = (__pyx_v_phase_dosage_gflags | plink2::kfPgenGlobalHardcallPhasePresent);
 
-    /* "pgenlib.pyx":1586
+    /* "pgenlib.pyx":1697
  *         cdef const char* fname = <const char*>filename
  *         cdef PgenGlobalFlags phase_dosage_gflags = kfPgenGlobal0
  *         if hardcall_phase_present:             # <<<<<<<<<<<<<<
  *             phase_dosage_gflags |= kfPgenGlobalHardcallPhasePresent
  *         if dosage_present:
  */
   }
 
-  /* "pgenlib.pyx":1588
+  /* "pgenlib.pyx":1699
  *         if hardcall_phase_present:
  *             phase_dosage_gflags |= kfPgenGlobalHardcallPhasePresent
  *         if dosage_present:             # <<<<<<<<<<<<<<
  *             phase_dosage_gflags |= kfPgenGlobalDosagePresent
  *         self._phase_dosage_gflags = phase_dosage_gflags
  */
   __pyx_t_2 = (__pyx_v_dosage_present != 0);
   if (__pyx_t_2) {
 
-    /* "pgenlib.pyx":1589
+    /* "pgenlib.pyx":1700
  *             phase_dosage_gflags |= kfPgenGlobalHardcallPhasePresent
  *         if dosage_present:
  *             phase_dosage_gflags |= kfPgenGlobalDosagePresent             # <<<<<<<<<<<<<<
  *         self._phase_dosage_gflags = phase_dosage_gflags
  *         assert not dosage_phase_present
  */
     __pyx_v_phase_dosage_gflags = (__pyx_v_phase_dosage_gflags | plink2::kfPgenGlobalDosagePresent);
 
-    /* "pgenlib.pyx":1588
+    /* "pgenlib.pyx":1699
  *         if hardcall_phase_present:
  *             phase_dosage_gflags |= kfPgenGlobalHardcallPhasePresent
  *         if dosage_present:             # <<<<<<<<<<<<<<
  *             phase_dosage_gflags |= kfPgenGlobalDosagePresent
  *         self._phase_dosage_gflags = phase_dosage_gflags
  */
   }
 
-  /* "pgenlib.pyx":1590
+  /* "pgenlib.pyx":1701
  *         if dosage_present:
  *             phase_dosage_gflags |= kfPgenGlobalDosagePresent
  *         self._phase_dosage_gflags = phase_dosage_gflags             # <<<<<<<<<<<<<<
  *         assert not dosage_phase_present
  * 
  */
   __pyx_v_self->_phase_dosage_gflags = __pyx_v_phase_dosage_gflags;
 
-  /* "pgenlib.pyx":1591
+  /* "pgenlib.pyx":1702
  *             phase_dosage_gflags |= kfPgenGlobalDosagePresent
  *         self._phase_dosage_gflags = phase_dosage_gflags
  *         assert not dosage_phase_present             # <<<<<<<<<<<<<<
  * 
  *         cdef uintptr_t alloc_cacheline_ct
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(!Py_OptimizeFlag)) {
     if (unlikely(!((!(__pyx_v_dosage_phase_present != 0)) != 0))) {
       PyErr_SetNone(PyExc_AssertionError);
-      __PYX_ERR(0, 1591, __pyx_L1_error)
+      __PYX_ERR(0, 1702, __pyx_L1_error)
     }
   }
   #endif
 
-  /* "pgenlib.pyx":1595
+  /* "pgenlib.pyx":1706
  *         cdef uintptr_t alloc_cacheline_ct
  *         cdef uint32_t max_vrec_len
  *         cdef PglErr reterr = SpgwInitPhase1(fname, NULL, self._nonref_flags, cur_variant_ct_limit, sample_ct, allele_ct_limit, write_mode, phase_dosage_gflags, nonref_flags_storage, self._state_ptr, &alloc_cacheline_ct, &max_vrec_len)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("SpgwInitPhase1() error " + str(reterr))
  */
   __pyx_v_reterr = plink2::SpgwInitPhase1(__pyx_v_fname, NULL, __pyx_v_self->_nonref_flags, __pyx_v_cur_variant_ct_limit, __pyx_v_sample_ct, __pyx_v_allele_ct_limit, __pyx_v_write_mode, __pyx_v_phase_dosage_gflags, __pyx_v_nonref_flags_storage, __pyx_v_self->_state_ptr, (&__pyx_v_alloc_cacheline_ct), (&__pyx_v_max_vrec_len));
 
-  /* "pgenlib.pyx":1596
+  /* "pgenlib.pyx":1707
  *         cdef uint32_t max_vrec_len
  *         cdef PglErr reterr = SpgwInitPhase1(fname, NULL, self._nonref_flags, cur_variant_ct_limit, sample_ct, allele_ct_limit, write_mode, phase_dosage_gflags, nonref_flags_storage, self._state_ptr, &alloc_cacheline_ct, &max_vrec_len)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("SpgwInitPhase1() error " + str(reterr))
  *         cdef uint32_t genovec_cacheline_ct = DivUp(sample_ct, kNypsPerCacheline)
  */
   __pyx_t_2 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_2)) {
 
-    /* "pgenlib.pyx":1597
+    /* "pgenlib.pyx":1708
  *         cdef PglErr reterr = SpgwInitPhase1(fname, NULL, self._nonref_flags, cur_variant_ct_limit, sample_ct, allele_ct_limit, write_mode, phase_dosage_gflags, nonref_flags_storage, self._state_ptr, &alloc_cacheline_ct, &max_vrec_len)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("SpgwInitPhase1() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         cdef uint32_t genovec_cacheline_ct = DivUp(sample_ct, kNypsPerCacheline)
  *         cdef uint32_t patch_01_vals_cacheline_ct = DivUp(sample_ct * sizeof(AlleleCode), kCacheline)
  */
-    __pyx_t_4 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1597, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1708, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1597, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1708, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_SpgwInitPhase1_error, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1597, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_SpgwInitPhase1_error, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1708, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1597, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1708, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 1597, __pyx_L1_error)
+    __PYX_ERR(0, 1708, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1596
+    /* "pgenlib.pyx":1707
  *         cdef uint32_t max_vrec_len
  *         cdef PglErr reterr = SpgwInitPhase1(fname, NULL, self._nonref_flags, cur_variant_ct_limit, sample_ct, allele_ct_limit, write_mode, phase_dosage_gflags, nonref_flags_storage, self._state_ptr, &alloc_cacheline_ct, &max_vrec_len)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("SpgwInitPhase1() error " + str(reterr))
  *         cdef uint32_t genovec_cacheline_ct = DivUp(sample_ct, kNypsPerCacheline)
  */
   }
 
-  /* "pgenlib.pyx":1598
+  /* "pgenlib.pyx":1709
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("SpgwInitPhase1() error " + str(reterr))
  *         cdef uint32_t genovec_cacheline_ct = DivUp(sample_ct, kNypsPerCacheline)             # <<<<<<<<<<<<<<
  *         cdef uint32_t patch_01_vals_cacheline_ct = DivUp(sample_ct * sizeof(AlleleCode), kCacheline)
  *         cdef uint32_t patch_10_vals_cacheline_ct = DivUp(sample_ct * 2 * sizeof(AlleleCode), kCacheline)
  */
   __pyx_v_genovec_cacheline_ct = plink2::DivUp(__pyx_v_sample_ct, plink2::kNypsPerCacheline);
 
-  /* "pgenlib.pyx":1599
+  /* "pgenlib.pyx":1710
  *             raise RuntimeError("SpgwInitPhase1() error " + str(reterr))
  *         cdef uint32_t genovec_cacheline_ct = DivUp(sample_ct, kNypsPerCacheline)
  *         cdef uint32_t patch_01_vals_cacheline_ct = DivUp(sample_ct * sizeof(AlleleCode), kCacheline)             # <<<<<<<<<<<<<<
  *         cdef uint32_t patch_10_vals_cacheline_ct = DivUp(sample_ct * 2 * sizeof(AlleleCode), kCacheline)
  *         cdef uint32_t dosage_main_cacheline_ct = DivUp(sample_ct, (2 * kInt32PerCacheline))
  */
   __pyx_v_patch_01_vals_cacheline_ct = plink2::DivUp((__pyx_v_sample_ct * (sizeof(plink2::AlleleCode))), plink2::kCacheline);
 
-  /* "pgenlib.pyx":1600
+  /* "pgenlib.pyx":1711
  *         cdef uint32_t genovec_cacheline_ct = DivUp(sample_ct, kNypsPerCacheline)
  *         cdef uint32_t patch_01_vals_cacheline_ct = DivUp(sample_ct * sizeof(AlleleCode), kCacheline)
  *         cdef uint32_t patch_10_vals_cacheline_ct = DivUp(sample_ct * 2 * sizeof(AlleleCode), kCacheline)             # <<<<<<<<<<<<<<
  *         cdef uint32_t dosage_main_cacheline_ct = DivUp(sample_ct, (2 * kInt32PerCacheline))
  *         cdef unsigned char* spgw_alloc
  */
   __pyx_v_patch_10_vals_cacheline_ct = plink2::DivUp(((__pyx_v_sample_ct * 2) * (sizeof(plink2::AlleleCode))), plink2::kCacheline);
 
-  /* "pgenlib.pyx":1601
+  /* "pgenlib.pyx":1712
  *         cdef uint32_t patch_01_vals_cacheline_ct = DivUp(sample_ct * sizeof(AlleleCode), kCacheline)
  *         cdef uint32_t patch_10_vals_cacheline_ct = DivUp(sample_ct * 2 * sizeof(AlleleCode), kCacheline)
  *         cdef uint32_t dosage_main_cacheline_ct = DivUp(sample_ct, (2 * kInt32PerCacheline))             # <<<<<<<<<<<<<<
  *         cdef unsigned char* spgw_alloc
  *         if cachealigned_malloc((alloc_cacheline_ct + genovec_cacheline_ct + 5 * bitvec_cacheline_ct + patch_01_vals_cacheline_ct + patch_10_vals_cacheline_ct + dosage_main_cacheline_ct) * kCacheline, &spgw_alloc):
  */
   __pyx_v_dosage_main_cacheline_ct = plink2::DivUp(__pyx_v_sample_ct, (2 * plink2::kInt32PerCacheline));
 
-  /* "pgenlib.pyx":1603
+  /* "pgenlib.pyx":1714
  *         cdef uint32_t dosage_main_cacheline_ct = DivUp(sample_ct, (2 * kInt32PerCacheline))
  *         cdef unsigned char* spgw_alloc
  *         if cachealigned_malloc((alloc_cacheline_ct + genovec_cacheline_ct + 5 * bitvec_cacheline_ct + patch_01_vals_cacheline_ct + patch_10_vals_cacheline_ct + dosage_main_cacheline_ct) * kCacheline, &spgw_alloc):             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         SpgwInitPhase2(max_vrec_len, self._state_ptr, spgw_alloc)
  */
   __pyx_t_2 = (plink2::cachealigned_malloc(((((((__pyx_v_alloc_cacheline_ct + __pyx_v_genovec_cacheline_ct) + (5 * __pyx_v_bitvec_cacheline_ct)) + __pyx_v_patch_01_vals_cacheline_ct) + __pyx_v_patch_10_vals_cacheline_ct) + __pyx_v_dosage_main_cacheline_ct) * plink2::kCacheline), (&__pyx_v_spgw_alloc)) != 0);
   if (unlikely(__pyx_t_2)) {
 
-    /* "pgenlib.pyx":1604
+    /* "pgenlib.pyx":1715
  *         cdef unsigned char* spgw_alloc
  *         if cachealigned_malloc((alloc_cacheline_ct + genovec_cacheline_ct + 5 * bitvec_cacheline_ct + patch_01_vals_cacheline_ct + patch_10_vals_cacheline_ct + dosage_main_cacheline_ct) * kCacheline, &spgw_alloc):
  *             raise MemoryError()             # <<<<<<<<<<<<<<
  *         SpgwInitPhase2(max_vrec_len, self._state_ptr, spgw_alloc)
  *         cdef unsigned char* spgw_alloc_iter = &(spgw_alloc[alloc_cacheline_ct * kCacheline])
  */
-    PyErr_NoMemory(); __PYX_ERR(0, 1604, __pyx_L1_error)
+    PyErr_NoMemory(); __PYX_ERR(0, 1715, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1603
+    /* "pgenlib.pyx":1714
  *         cdef uint32_t dosage_main_cacheline_ct = DivUp(sample_ct, (2 * kInt32PerCacheline))
  *         cdef unsigned char* spgw_alloc
  *         if cachealigned_malloc((alloc_cacheline_ct + genovec_cacheline_ct + 5 * bitvec_cacheline_ct + patch_01_vals_cacheline_ct + patch_10_vals_cacheline_ct + dosage_main_cacheline_ct) * kCacheline, &spgw_alloc):             # <<<<<<<<<<<<<<
  *             raise MemoryError()
  *         SpgwInitPhase2(max_vrec_len, self._state_ptr, spgw_alloc)
  */
   }
 
-  /* "pgenlib.pyx":1605
+  /* "pgenlib.pyx":1716
  *         if cachealigned_malloc((alloc_cacheline_ct + genovec_cacheline_ct + 5 * bitvec_cacheline_ct + patch_01_vals_cacheline_ct + patch_10_vals_cacheline_ct + dosage_main_cacheline_ct) * kCacheline, &spgw_alloc):
  *             raise MemoryError()
  *         SpgwInitPhase2(max_vrec_len, self._state_ptr, spgw_alloc)             # <<<<<<<<<<<<<<
  *         cdef unsigned char* spgw_alloc_iter = &(spgw_alloc[alloc_cacheline_ct * kCacheline])
  *         self._allele_ct_limit = allele_ct_limit
  */
   plink2::SpgwInitPhase2(__pyx_v_max_vrec_len, __pyx_v_self->_state_ptr, __pyx_v_spgw_alloc);
 
-  /* "pgenlib.pyx":1606
+  /* "pgenlib.pyx":1717
  *             raise MemoryError()
  *         SpgwInitPhase2(max_vrec_len, self._state_ptr, spgw_alloc)
  *         cdef unsigned char* spgw_alloc_iter = &(spgw_alloc[alloc_cacheline_ct * kCacheline])             # <<<<<<<<<<<<<<
  *         self._allele_ct_limit = allele_ct_limit
  *         self._genovec = <uintptr_t*>(spgw_alloc_iter)
  */
   __pyx_v_spgw_alloc_iter = (&(__pyx_v_spgw_alloc[(__pyx_v_alloc_cacheline_ct * plink2::kCacheline)]));
 
-  /* "pgenlib.pyx":1607
+  /* "pgenlib.pyx":1718
  *         SpgwInitPhase2(max_vrec_len, self._state_ptr, spgw_alloc)
  *         cdef unsigned char* spgw_alloc_iter = &(spgw_alloc[alloc_cacheline_ct * kCacheline])
  *         self._allele_ct_limit = allele_ct_limit             # <<<<<<<<<<<<<<
  *         self._genovec = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[genovec_cacheline_ct * kCacheline])
  */
   __pyx_v_self->_allele_ct_limit = __pyx_v_allele_ct_limit;
 
-  /* "pgenlib.pyx":1608
+  /* "pgenlib.pyx":1719
  *         cdef unsigned char* spgw_alloc_iter = &(spgw_alloc[alloc_cacheline_ct * kCacheline])
  *         self._allele_ct_limit = allele_ct_limit
  *         self._genovec = <uintptr_t*>(spgw_alloc_iter)             # <<<<<<<<<<<<<<
  *         spgw_alloc_iter = &(spgw_alloc_iter[genovec_cacheline_ct * kCacheline])
  * 
  */
   __pyx_v_self->_genovec = ((uintptr_t *)__pyx_v_spgw_alloc_iter);
 
-  /* "pgenlib.pyx":1609
+  /* "pgenlib.pyx":1720
  *         self._allele_ct_limit = allele_ct_limit
  *         self._genovec = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[genovec_cacheline_ct * kCacheline])             # <<<<<<<<<<<<<<
  * 
  *         # Can't skimp on patch_{01,10}_{set,vals} allocations even when
  */
   __pyx_v_spgw_alloc_iter = (&(__pyx_v_spgw_alloc_iter[(__pyx_v_genovec_cacheline_ct * plink2::kCacheline)]));
 
-  /* "pgenlib.pyx":1615
+  /* "pgenlib.pyx":1726
  *         # works.
  *         # Could skimp on dosage/phase, but that doesn't gain us much.
  *         self._patch_01_set = <uintptr_t*>(spgw_alloc_iter)             # <<<<<<<<<<<<<<
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._patch_01_vals = <AlleleCode*>(spgw_alloc_iter)
  */
   __pyx_v_self->_patch_01_set = ((uintptr_t *)__pyx_v_spgw_alloc_iter);
 
-  /* "pgenlib.pyx":1616
+  /* "pgenlib.pyx":1727
  *         # Could skimp on dosage/phase, but that doesn't gain us much.
  *         self._patch_01_set = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])             # <<<<<<<<<<<<<<
  *         self._patch_01_vals = <AlleleCode*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_01_vals_cacheline_ct * kCacheline])
  */
   __pyx_v_spgw_alloc_iter = (&(__pyx_v_spgw_alloc_iter[(__pyx_v_bitvec_cacheline_ct * plink2::kCacheline)]));
 
-  /* "pgenlib.pyx":1617
+  /* "pgenlib.pyx":1728
  *         self._patch_01_set = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._patch_01_vals = <AlleleCode*>(spgw_alloc_iter)             # <<<<<<<<<<<<<<
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_01_vals_cacheline_ct * kCacheline])
  *         self._patch_10_set = <uintptr_t*>(spgw_alloc_iter)
  */
   __pyx_v_self->_patch_01_vals = ((plink2::AlleleCode *)__pyx_v_spgw_alloc_iter);
 
-  /* "pgenlib.pyx":1618
+  /* "pgenlib.pyx":1729
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._patch_01_vals = <AlleleCode*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_01_vals_cacheline_ct * kCacheline])             # <<<<<<<<<<<<<<
  *         self._patch_10_set = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  */
   __pyx_v_spgw_alloc_iter = (&(__pyx_v_spgw_alloc_iter[(__pyx_v_patch_01_vals_cacheline_ct * plink2::kCacheline)]));
 
-  /* "pgenlib.pyx":1619
+  /* "pgenlib.pyx":1730
  *         self._patch_01_vals = <AlleleCode*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_01_vals_cacheline_ct * kCacheline])
  *         self._patch_10_set = <uintptr_t*>(spgw_alloc_iter)             # <<<<<<<<<<<<<<
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._patch_10_vals = <AlleleCode*>(spgw_alloc_iter)
  */
   __pyx_v_self->_patch_10_set = ((uintptr_t *)__pyx_v_spgw_alloc_iter);
 
-  /* "pgenlib.pyx":1620
+  /* "pgenlib.pyx":1731
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_01_vals_cacheline_ct * kCacheline])
  *         self._patch_10_set = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])             # <<<<<<<<<<<<<<
  *         self._patch_10_vals = <AlleleCode*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_10_vals_cacheline_ct * kCacheline])
  */
   __pyx_v_spgw_alloc_iter = (&(__pyx_v_spgw_alloc_iter[(__pyx_v_bitvec_cacheline_ct * plink2::kCacheline)]));
 
-  /* "pgenlib.pyx":1621
+  /* "pgenlib.pyx":1732
  *         self._patch_10_set = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._patch_10_vals = <AlleleCode*>(spgw_alloc_iter)             # <<<<<<<<<<<<<<
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_10_vals_cacheline_ct * kCacheline])
  *         self._phasepresent = <uintptr_t*>(spgw_alloc_iter)
  */
   __pyx_v_self->_patch_10_vals = ((plink2::AlleleCode *)__pyx_v_spgw_alloc_iter);
 
-  /* "pgenlib.pyx":1622
+  /* "pgenlib.pyx":1733
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._patch_10_vals = <AlleleCode*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_10_vals_cacheline_ct * kCacheline])             # <<<<<<<<<<<<<<
  *         self._phasepresent = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  */
   __pyx_v_spgw_alloc_iter = (&(__pyx_v_spgw_alloc_iter[(__pyx_v_patch_10_vals_cacheline_ct * plink2::kCacheline)]));
 
-  /* "pgenlib.pyx":1623
+  /* "pgenlib.pyx":1734
  *         self._patch_10_vals = <AlleleCode*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_10_vals_cacheline_ct * kCacheline])
  *         self._phasepresent = <uintptr_t*>(spgw_alloc_iter)             # <<<<<<<<<<<<<<
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._phaseinfo = <uintptr_t*>(spgw_alloc_iter)
  */
   __pyx_v_self->_phasepresent = ((uintptr_t *)__pyx_v_spgw_alloc_iter);
 
-  /* "pgenlib.pyx":1624
+  /* "pgenlib.pyx":1735
  *         spgw_alloc_iter = &(spgw_alloc_iter[patch_10_vals_cacheline_ct * kCacheline])
  *         self._phasepresent = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])             # <<<<<<<<<<<<<<
  *         self._phaseinfo = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  */
   __pyx_v_spgw_alloc_iter = (&(__pyx_v_spgw_alloc_iter[(__pyx_v_bitvec_cacheline_ct * plink2::kCacheline)]));
 
-  /* "pgenlib.pyx":1625
+  /* "pgenlib.pyx":1736
  *         self._phasepresent = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._phaseinfo = <uintptr_t*>(spgw_alloc_iter)             # <<<<<<<<<<<<<<
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._dosage_present = <uintptr_t*>(spgw_alloc_iter)
  */
   __pyx_v_self->_phaseinfo = ((uintptr_t *)__pyx_v_spgw_alloc_iter);
 
-  /* "pgenlib.pyx":1626
+  /* "pgenlib.pyx":1737
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._phaseinfo = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])             # <<<<<<<<<<<<<<
  *         self._dosage_present = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  */
   __pyx_v_spgw_alloc_iter = (&(__pyx_v_spgw_alloc_iter[(__pyx_v_bitvec_cacheline_ct * plink2::kCacheline)]));
 
-  /* "pgenlib.pyx":1627
+  /* "pgenlib.pyx":1738
  *         self._phaseinfo = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._dosage_present = <uintptr_t*>(spgw_alloc_iter)             # <<<<<<<<<<<<<<
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._dosage_main = <uint16_t*>(spgw_alloc_iter)
  */
   __pyx_v_self->_dosage_present = ((uintptr_t *)__pyx_v_spgw_alloc_iter);
 
-  /* "pgenlib.pyx":1628
+  /* "pgenlib.pyx":1739
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._dosage_present = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])             # <<<<<<<<<<<<<<
  *         self._dosage_main = <uint16_t*>(spgw_alloc_iter)
  *         # bugfix (16 Apr 2023): SpgwAppendBiallelicGenovec[Hphase] assumes
  */
   __pyx_v_spgw_alloc_iter = (&(__pyx_v_spgw_alloc_iter[(__pyx_v_bitvec_cacheline_ct * plink2::kCacheline)]));
 
-  /* "pgenlib.pyx":1629
+  /* "pgenlib.pyx":1740
  *         self._dosage_present = <uintptr_t*>(spgw_alloc_iter)
  *         spgw_alloc_iter = &(spgw_alloc_iter[bitvec_cacheline_ct * kCacheline])
  *         self._dosage_main = <uint16_t*>(spgw_alloc_iter)             # <<<<<<<<<<<<<<
  *         # bugfix (16 Apr 2023): SpgwAppendBiallelicGenovec[Hphase] assumes
  *         # trailing bits are clear
  */
   __pyx_v_self->_dosage_main = ((uint16_t *)__pyx_v_spgw_alloc_iter);
 
-  /* "pgenlib.pyx":1632
+  /* "pgenlib.pyx":1743
  *         # bugfix (16 Apr 2023): SpgwAppendBiallelicGenovec[Hphase] assumes
  *         # trailing bits are clear
  *         self._genovec[(sample_ct - 1) // kBitsPerWordD2] = 0             # <<<<<<<<<<<<<<
  *         self._phasepresent[(sample_ct - 1) // kBitsPerWord] = 0
  *         return
  */
   __pyx_t_7 = (__pyx_v_sample_ct - 1);
   if (unlikely(plink2::kBitsPerWordD2 == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-    __PYX_ERR(0, 1632, __pyx_L1_error)
+    __PYX_ERR(0, 1743, __pyx_L1_error)
   }
   else if (sizeof(long) == sizeof(long) && (!(((int)-1) > 0)) && unlikely(plink2::kBitsPerWordD2 == (int)-1)  && unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_7))) {
     PyErr_SetString(PyExc_OverflowError, "value too large to perform division");
-    __PYX_ERR(0, 1632, __pyx_L1_error)
+    __PYX_ERR(0, 1743, __pyx_L1_error)
   }
   (__pyx_v_self->_genovec[__Pyx_div_long(__pyx_t_7, plink2::kBitsPerWordD2)]) = 0;
 
-  /* "pgenlib.pyx":1633
+  /* "pgenlib.pyx":1744
  *         # trailing bits are clear
  *         self._genovec[(sample_ct - 1) // kBitsPerWordD2] = 0
  *         self._phasepresent[(sample_ct - 1) // kBitsPerWord] = 0             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   __pyx_t_7 = (__pyx_v_sample_ct - 1);
   if (unlikely(plink2::kBitsPerWord == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-    __PYX_ERR(0, 1633, __pyx_L1_error)
+    __PYX_ERR(0, 1744, __pyx_L1_error)
   }
   else if (sizeof(long) == sizeof(long) && (!(((int)-1) > 0)) && unlikely(plink2::kBitsPerWord == (int)-1)  && unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_7))) {
     PyErr_SetString(PyExc_OverflowError, "value too large to perform division");
-    __PYX_ERR(0, 1633, __pyx_L1_error)
+    __PYX_ERR(0, 1744, __pyx_L1_error)
   }
   (__pyx_v_self->_phasepresent[__Pyx_div_long(__pyx_t_7, plink2::kBitsPerWord)]) = 0;
 
-  /* "pgenlib.pyx":1634
+  /* "pgenlib.pyx":1745
  *         self._genovec[(sample_ct - 1) // kBitsPerWordD2] = 0
  *         self._phasepresent[(sample_ct - 1) // kBitsPerWord] = 0
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1540
+  /* "pgenlib.pyx":1651
  *     cdef uint16_t* _dosage_main
  * 
  *     def __cinit__(self, bytes filename, uint32_t sample_ct,             # <<<<<<<<<<<<<<
  *                   object variant_ct = None, object nonref_flags = True,
  *                   uint32_t allele_ct_limit = 2,
  */
 
@@ -25901,15 +28622,15 @@
   __Pyx_AddTraceback("pgenlib.PgenWriter.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1637
+/* "pgenlib.pyx":1748
  * 
  * 
  *     cpdef __enter__(self):             # <<<<<<<<<<<<<<
  *         return self
  * 
  */
 
@@ -25930,15 +28651,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1637, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1748, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_3__enter__)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -25947,15 +28668,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1637, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1748, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -25968,27 +28689,27 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1638
+  /* "pgenlib.pyx":1749
  * 
  *     cpdef __enter__(self):
  *         return self             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_self));
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1637
+  /* "pgenlib.pyx":1748
  * 
  * 
  *     cpdef __enter__(self):             # <<<<<<<<<<<<<<
  *         return self
  * 
  */
 
@@ -26024,15 +28745,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__enter__", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter___enter__(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1637, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter___enter__(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1748, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -26041,15 +28762,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1641
+/* "pgenlib.pyx":1752
  * 
  * 
  *     cpdef append_biallelic(self, np.ndarray[np.int8_t,mode="c"] geno_int8):             # <<<<<<<<<<<<<<
  *         cdef int8_t* genobytes = &(geno_int8[0])
  *         BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  */
 
@@ -26074,27 +28795,27 @@
   __Pyx_RefNannySetupContext("append_biallelic", 0);
   __pyx_pybuffer_geno_int8.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int8.refcount = 0;
   __pyx_pybuffernd_geno_int8.data = NULL;
   __pyx_pybuffernd_geno_int8.rcbuffer = &__pyx_pybuffer_geno_int8;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1641, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1752, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int8.diminfo[0].strides = __pyx_pybuffernd_geno_int8.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int8.diminfo[0].shape = __pyx_pybuffernd_geno_int8.rcbuffer->pybuffer.shape[0];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_biallelic); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_biallelic); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1752, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_5append_biallelic)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -26103,15 +28824,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_geno_int8)) : __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)__pyx_v_geno_int8));
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1641, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1752, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -26124,104 +28845,104 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1642
+  /* "pgenlib.pyx":1753
  * 
  *     cpdef append_biallelic(self, np.ndarray[np.int8_t,mode="c"] geno_int8):
  *         cdef int8_t* genobytes = &(geno_int8[0])             # <<<<<<<<<<<<<<
  *         BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  */
   __pyx_t_5 = 0;
   __pyx_t_6 = -1;
   if (__pyx_t_5 < 0) {
     __pyx_t_5 += __pyx_pybuffernd_geno_int8.diminfo[0].shape;
     if (unlikely(__pyx_t_5 < 0)) __pyx_t_6 = 0;
   } else if (unlikely(__pyx_t_5 >= __pyx_pybuffernd_geno_int8.diminfo[0].shape)) __pyx_t_6 = 0;
   if (unlikely(__pyx_t_6 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_6);
-    __PYX_ERR(0, 1642, __pyx_L1_error)
+    __PYX_ERR(0, 1753, __pyx_L1_error)
   }
   __pyx_v_genobytes = (&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_geno_int8.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_geno_int8.diminfo[0].strides)));
 
-  /* "pgenlib.pyx":1643
+  /* "pgenlib.pyx":1754
  *     cpdef append_biallelic(self, np.ndarray[np.int8_t,mode="c"] geno_int8):
  *         cdef int8_t* genobytes = &(geno_int8[0])
  *         BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  *         if reterr != kPglRetSuccess:
  */
   plink2::BytesToGenoarrUnsafe(__pyx_v_genobytes, plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr), __pyx_v_self->_genovec);
 
-  /* "pgenlib.pyx":1644
+  /* "pgenlib.pyx":1755
  *         cdef int8_t* genobytes = &(geno_int8[0])
  *         BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_biallelic() error " + str(reterr))
  */
   __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovec(__pyx_v_self->_genovec, __pyx_v_self->_state_ptr);
 
-  /* "pgenlib.pyx":1645
+  /* "pgenlib.pyx":1756
  *         BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_biallelic() error " + str(reterr))
  *         return
  */
   __pyx_t_7 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_7)) {
 
-    /* "pgenlib.pyx":1646
+    /* "pgenlib.pyx":1757
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_biallelic() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1646, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1646, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_biallelic_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1646, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_biallelic_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1646, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1646, __pyx_L1_error)
+    __PYX_ERR(0, 1757, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1645
+    /* "pgenlib.pyx":1756
  *         BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_biallelic() error " + str(reterr))
  *         return
  */
   }
 
-  /* "pgenlib.pyx":1647
+  /* "pgenlib.pyx":1758
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_biallelic() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1641
+  /* "pgenlib.pyx":1752
  * 
  * 
  *     cpdef append_biallelic(self, np.ndarray[np.int8_t,mode="c"] geno_int8):             # <<<<<<<<<<<<<<
  *         cdef int8_t* genobytes = &(geno_int8[0])
  *         BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  */
 
@@ -26253,15 +28974,15 @@
 static PyObject *__pyx_pw_7pgenlib_10PgenWriter_5append_biallelic(PyObject *__pyx_v_self, PyObject *__pyx_v_geno_int8) {
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("append_biallelic (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int8), __pyx_ptype_5numpy_ndarray, 1, "geno_int8", 0))) __PYX_ERR(0, 1641, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int8), __pyx_ptype_5numpy_ndarray, 1, "geno_int8", 0))) __PYX_ERR(0, 1752, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter_4append_biallelic(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), ((PyArrayObject *)__pyx_v_geno_int8));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -26281,19 +29002,19 @@
   __Pyx_RefNannySetupContext("append_biallelic", 0);
   __pyx_pybuffer_geno_int8.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int8.refcount = 0;
   __pyx_pybuffernd_geno_int8.data = NULL;
   __pyx_pybuffernd_geno_int8.rcbuffer = &__pyx_pybuffer_geno_int8;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1641, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1752, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int8.diminfo[0].strides = __pyx_pybuffernd_geno_int8.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int8.diminfo[0].shape = __pyx_pybuffernd_geno_int8.rcbuffer->pybuffer.shape[0];
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_append_biallelic(__pyx_v_self, __pyx_v_geno_int8, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_append_biallelic(__pyx_v_self, __pyx_v_geno_int8, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1752, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -26311,15 +29032,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_geno_int8.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1650
+/* "pgenlib.pyx":1761
  * 
  * 
  *     cpdef append_alleles(self, np.ndarray[np.int32_t,mode="c"] allele_int32, bint all_phased = False, object allele_ct = None):             # <<<<<<<<<<<<<<
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  */
 
@@ -26372,31 +29093,31 @@
   }
   __pyx_pybuffer_allele_int32.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32.refcount = 0;
   __pyx_pybuffernd_allele_int32.data = NULL;
   __pyx_pybuffernd_allele_int32.rcbuffer = &__pyx_pybuffer_allele_int32;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1650, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1761, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32.diminfo[0].strides = __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32.diminfo[0].shape = __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.shape[0];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_alleles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1650, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_alleles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1761, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_7append_alleles)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyBool_FromLong(__pyx_v_all_phased); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1650, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyBool_FromLong(__pyx_v_all_phased); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1761, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_5)) {
@@ -26406,45 +29127,45 @@
             __Pyx_DECREF_SET(__pyx_t_4, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, ((PyObject *)__pyx_v_allele_int32), __pyx_t_3, __pyx_v_allele_ct};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1761, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, ((PyObject *)__pyx_v_allele_int32), __pyx_t_3, __pyx_v_allele_ct};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1761, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1650, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1761, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_5) {
             __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
           }
           __Pyx_INCREF(((PyObject *)__pyx_v_allele_int32));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_allele_int32));
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, ((PyObject *)__pyx_v_allele_int32));
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
           __Pyx_INCREF(__pyx_v_allele_ct);
           __Pyx_GIVEREF(__pyx_v_allele_ct);
           PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_v_allele_ct);
           __pyx_t_3 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1761, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -26459,369 +29180,369 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1651
+  /* "pgenlib.pyx":1762
  * 
  *     cpdef append_alleles(self, np.ndarray[np.int32_t,mode="c"] allele_int32, bint all_phased = False, object allele_ct = None):
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  */
   __pyx_t_8 = 0;
   __pyx_t_6 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_pybuffernd_allele_int32.diminfo[0].shape;
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_6 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_pybuffernd_allele_int32.diminfo[0].shape)) __pyx_t_6 = 0;
   if (unlikely(__pyx_t_6 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_6);
-    __PYX_ERR(0, 1651, __pyx_L1_error)
+    __PYX_ERR(0, 1762, __pyx_L1_error)
   }
   __pyx_v_allele_codes = ((int32_t *)(&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_allele_int32.diminfo[0].strides))));
 
-  /* "pgenlib.pyx":1652
+  /* "pgenlib.pyx":1763
  *     cpdef append_alleles(self, np.ndarray[np.int32_t,mode="c"] allele_int32, bint all_phased = False, object allele_ct = None):
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)             # <<<<<<<<<<<<<<
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec
  */
   __pyx_v_sample_ct = plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr);
 
-  /* "pgenlib.pyx":1653
+  /* "pgenlib.pyx":1764
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  */
   __pyx_t_9 = __pyx_v_self->_allele_ct_limit;
   __pyx_v_allele_ct_limit = __pyx_t_9;
 
-  /* "pgenlib.pyx":1654
+  /* "pgenlib.pyx":1765
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  */
   __pyx_t_10 = __pyx_v_self->_genovec;
   __pyx_v_genovec = __pyx_t_10;
 
-  /* "pgenlib.pyx":1655
+  /* "pgenlib.pyx":1766
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* patch_01_set = self._patch_01_set             # <<<<<<<<<<<<<<
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  */
   __pyx_t_10 = __pyx_v_self->_patch_01_set;
   __pyx_v_patch_01_set = __pyx_t_10;
 
-  /* "pgenlib.pyx":1656
+  /* "pgenlib.pyx":1767
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  */
   __pyx_t_11 = __pyx_v_self->_patch_01_vals;
   __pyx_v_patch_01_vals = __pyx_t_11;
 
-  /* "pgenlib.pyx":1657
+  /* "pgenlib.pyx":1768
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set             # <<<<<<<<<<<<<<
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  *         cdef uintptr_t* phaseinfo = NULL
  */
   __pyx_t_10 = __pyx_v_self->_patch_10_set;
   __pyx_v_patch_10_set = __pyx_t_10;
 
-  /* "pgenlib.pyx":1658
+  /* "pgenlib.pyx":1769
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phaseinfo = NULL
  *         if all_phased:
  */
   __pyx_t_11 = __pyx_v_self->_patch_10_vals;
   __pyx_v_patch_10_vals = __pyx_t_11;
 
-  /* "pgenlib.pyx":1659
+  /* "pgenlib.pyx":1770
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  *         cdef uintptr_t* phaseinfo = NULL             # <<<<<<<<<<<<<<
  *         if all_phased:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  */
   __pyx_v_phaseinfo = NULL;
 
-  /* "pgenlib.pyx":1660
+  /* "pgenlib.pyx":1771
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  *         cdef uintptr_t* phaseinfo = NULL
  *         if all_phased:             # <<<<<<<<<<<<<<
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *                 raise RuntimeError("append_alleles called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")
  */
   __pyx_t_12 = (__pyx_v_all_phased != 0);
   if (__pyx_t_12) {
 
-    /* "pgenlib.pyx":1661
+    /* "pgenlib.pyx":1772
  *         cdef uintptr_t* phaseinfo = NULL
  *         if all_phased:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_alleles called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")
  *             phaseinfo = self._phaseinfo
  */
     __pyx_t_12 = (((__pyx_v_self->_phase_dosage_gflags & plink2::kfPgenGlobalHardcallPhasePresent) == 0) != 0);
     if (unlikely(__pyx_t_12)) {
 
-      /* "pgenlib.pyx":1662
+      /* "pgenlib.pyx":1773
  *         if all_phased:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *                 raise RuntimeError("append_alleles called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")             # <<<<<<<<<<<<<<
  *             phaseinfo = self._phaseinfo
  *         cdef uint32_t patch_01_ct
  */
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1662, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1662, __pyx_L1_error)
+      __PYX_ERR(0, 1773, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1661
+      /* "pgenlib.pyx":1772
  *         cdef uintptr_t* phaseinfo = NULL
  *         if all_phased:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_alleles called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")
  *             phaseinfo = self._phaseinfo
  */
     }
 
-    /* "pgenlib.pyx":1663
+    /* "pgenlib.pyx":1774
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *                 raise RuntimeError("append_alleles called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")
  *             phaseinfo = self._phaseinfo             # <<<<<<<<<<<<<<
  *         cdef uint32_t patch_01_ct
  *         cdef uint32_t patch_10_ct
  */
     __pyx_t_10 = __pyx_v_self->_phaseinfo;
     __pyx_v_phaseinfo = __pyx_t_10;
 
-    /* "pgenlib.pyx":1660
+    /* "pgenlib.pyx":1771
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  *         cdef uintptr_t* phaseinfo = NULL
  *         if all_phased:             # <<<<<<<<<<<<<<
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *                 raise RuntimeError("append_alleles called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")
  */
   }
 
-  /* "pgenlib.pyx":1666
+  /* "pgenlib.pyx":1777
  *         cdef uint32_t patch_01_ct
  *         cdef uint32_t patch_10_ct
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, phaseinfo)             # <<<<<<<<<<<<<<
  *         if observed_allele_ct == -1:
  *             raise RuntimeError("append_alleles called with invalid allele codes")
  */
   __pyx_v_observed_allele_ct = plink2::ConvertMultiAlleleCodesUnsafe(__pyx_v_allele_codes, NULL, __pyx_v_sample_ct, __pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, (&__pyx_v_patch_01_ct), (&__pyx_v_patch_10_ct), NULL, __pyx_v_phaseinfo);
 
-  /* "pgenlib.pyx":1667
+  /* "pgenlib.pyx":1778
  *         cdef uint32_t patch_10_ct
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, phaseinfo)
  *         if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_alleles called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  */
   __pyx_t_12 = ((__pyx_v_observed_allele_ct == -1L) != 0);
   if (unlikely(__pyx_t_12)) {
 
-    /* "pgenlib.pyx":1668
+    /* "pgenlib.pyx":1779
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, phaseinfo)
  *         if observed_allele_ct == -1:
  *             raise RuntimeError("append_alleles called with invalid allele codes")             # <<<<<<<<<<<<<<
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1668, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1668, __pyx_L1_error)
+    __PYX_ERR(0, 1779, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1667
+    /* "pgenlib.pyx":1778
  *         cdef uint32_t patch_10_ct
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, phaseinfo)
  *         if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_alleles called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  */
   }
 
-  /* "pgenlib.pyx":1669
+  /* "pgenlib.pyx":1780
  *         if observed_allele_ct == -1:
  *             raise RuntimeError("append_alleles called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)             # <<<<<<<<<<<<<<
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_alleles called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  */
   __pyx_v_write_allele_ct = ((uint32_t)__pyx_v_observed_allele_ct);
 
-  /* "pgenlib.pyx":1670
+  /* "pgenlib.pyx":1781
  *             raise RuntimeError("append_alleles called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_alleles called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:
  */
   __pyx_t_12 = ((__pyx_v_write_allele_ct > __pyx_v_allele_ct_limit) != 0);
   if (unlikely(__pyx_t_12)) {
 
-    /* "pgenlib.pyx":1671
+    /* "pgenlib.pyx":1782
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_alleles called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")             # <<<<<<<<<<<<<<
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1671, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1782, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1671, __pyx_L1_error)
+    __PYX_ERR(0, 1782, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1670
+    /* "pgenlib.pyx":1781
  *             raise RuntimeError("append_alleles called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_alleles called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:
  */
   }
 
-  /* "pgenlib.pyx":1672
+  /* "pgenlib.pyx":1783
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_alleles called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:             # <<<<<<<<<<<<<<
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")
  */
   __pyx_t_12 = (__pyx_v_allele_ct != Py_None);
   __pyx_t_13 = (__pyx_t_12 != 0);
   if (__pyx_t_13) {
 
-    /* "pgenlib.pyx":1673
+    /* "pgenlib.pyx":1784
  *             raise RuntimeError("append_alleles called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_write_allele_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_write_allele_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1784, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PyObject_RichCompare(__pyx_v_allele_ct, __pyx_t_1, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    __pyx_t_2 = PyObject_RichCompare(__pyx_v_allele_ct, __pyx_t_1, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1784, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1784, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (unlikely(__pyx_t_13)) {
 
-      /* "pgenlib.pyx":1674
+      /* "pgenlib.pyx":1785
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")             # <<<<<<<<<<<<<<
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_alleles called with allele_ct > allele_ct_limit")
  */
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1674, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1785, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1674, __pyx_L1_error)
+      __PYX_ERR(0, 1785, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1673
+      /* "pgenlib.pyx":1784
  *             raise RuntimeError("append_alleles called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:
  */
     }
 
-    /* "pgenlib.pyx":1675
+    /* "pgenlib.pyx":1786
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_alleles called with allele_ct > allele_ct_limit")
  *             write_allele_ct = allele_ct
  */
-    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_ct_limit); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1675, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_ct_limit); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyObject_RichCompare(__pyx_v_allele_ct, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1675, __pyx_L1_error)
+    __pyx_t_1 = PyObject_RichCompare(__pyx_v_allele_ct, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1675, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (unlikely(__pyx_t_13)) {
 
-      /* "pgenlib.pyx":1676
+      /* "pgenlib.pyx":1787
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_alleles called with allele_ct > allele_ct_limit")             # <<<<<<<<<<<<<<
  *             write_allele_ct = allele_ct
  *         cdef PglErr reterr
  */
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1676, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1787, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1676, __pyx_L1_error)
+      __PYX_ERR(0, 1787, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1675
+      /* "pgenlib.pyx":1786
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_alleles called with allele_ct > allele_ct_limit")
  *             write_allele_ct = allele_ct
  */
     }
 
-    /* "pgenlib.pyx":1677
+    /* "pgenlib.pyx":1788
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_alleles called with allele_ct > allele_ct_limit")
  *             write_allele_ct = allele_ct             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr
  *         if not all_phased:
  */
-    __pyx_t_9 = __Pyx_PyInt_As_uint32_t(__pyx_v_allele_ct); if (unlikely((__pyx_t_9 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1677, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_As_uint32_t(__pyx_v_allele_ct); if (unlikely((__pyx_t_9 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1788, __pyx_L1_error)
     __pyx_v_write_allele_ct = __pyx_t_9;
 
-    /* "pgenlib.pyx":1672
+    /* "pgenlib.pyx":1783
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_alleles called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:             # <<<<<<<<<<<<<<
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")
  */
   }
 
-  /* "pgenlib.pyx":1679
+  /* "pgenlib.pyx":1790
  *             write_allele_ct = allele_ct
  *         cdef PglErr reterr
  *         if not all_phased:             # <<<<<<<<<<<<<<
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                 reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)
  */
   __pyx_t_13 = ((!(__pyx_v_all_phased != 0)) != 0);
   if (__pyx_t_13) {
 
-    /* "pgenlib.pyx":1680
+    /* "pgenlib.pyx":1791
  *         cdef PglErr reterr
  *         if not all_phased:
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                 reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)
  *             else:
  */
     __pyx_t_12 = ((__pyx_v_patch_01_ct == 0) != 0);
@@ -26831,56 +29552,56 @@
       goto __pyx_L12_bool_binop_done;
     }
     __pyx_t_12 = ((__pyx_v_patch_10_ct == 0) != 0);
     __pyx_t_13 = __pyx_t_12;
     __pyx_L12_bool_binop_done:;
     if (__pyx_t_13) {
 
-      /* "pgenlib.pyx":1681
+      /* "pgenlib.pyx":1792
  *         if not all_phased:
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                 reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)             # <<<<<<<<<<<<<<
  *             else:
  *                 reterr = SpgwAppendMultiallelicSparse(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  */
       __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovec(__pyx_v_genovec, __pyx_v_self->_state_ptr);
 
-      /* "pgenlib.pyx":1680
+      /* "pgenlib.pyx":1791
  *         cdef PglErr reterr
  *         if not all_phased:
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                 reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)
  *             else:
  */
       goto __pyx_L11;
     }
 
-    /* "pgenlib.pyx":1683
+    /* "pgenlib.pyx":1794
  *                 reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)
  *             else:
  *                 reterr = SpgwAppendMultiallelicSparse(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *         else:
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):
  */
     /*else*/ {
       __pyx_v_reterr = plink2::SpgwAppendMultiallelicSparse(__pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, __pyx_v_write_allele_ct, __pyx_v_patch_01_ct, __pyx_v_patch_10_ct, __pyx_v_self->_state_ptr);
     }
     __pyx_L11:;
 
-    /* "pgenlib.pyx":1679
+    /* "pgenlib.pyx":1790
  *             write_allele_ct = allele_ct
  *         cdef PglErr reterr
  *         if not all_phased:             # <<<<<<<<<<<<<<
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                 reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)
  */
     goto __pyx_L10;
   }
 
-  /* "pgenlib.pyx":1685
+  /* "pgenlib.pyx":1796
  *                 reterr = SpgwAppendMultiallelicSparse(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *         else:
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                 reterr = SpgwAppendBiallelicGenovecHphase(genovec, NULL, phaseinfo, self._state_ptr)
  *             else:
  */
   /*else*/ {
@@ -26891,100 +29612,100 @@
       goto __pyx_L15_bool_binop_done;
     }
     __pyx_t_12 = ((__pyx_v_patch_10_ct == 0) != 0);
     __pyx_t_13 = __pyx_t_12;
     __pyx_L15_bool_binop_done:;
     if (__pyx_t_13) {
 
-      /* "pgenlib.pyx":1686
+      /* "pgenlib.pyx":1797
  *         else:
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                 reterr = SpgwAppendBiallelicGenovecHphase(genovec, NULL, phaseinfo, self._state_ptr)             # <<<<<<<<<<<<<<
  *             else:
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  */
       __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovecHphase(__pyx_v_genovec, NULL, __pyx_v_phaseinfo, __pyx_v_self->_state_ptr);
 
-      /* "pgenlib.pyx":1685
+      /* "pgenlib.pyx":1796
  *                 reterr = SpgwAppendMultiallelicSparse(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *         else:
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                 reterr = SpgwAppendBiallelicGenovecHphase(genovec, NULL, phaseinfo, self._state_ptr)
  *             else:
  */
       goto __pyx_L14;
     }
 
-    /* "pgenlib.pyx":1688
+    /* "pgenlib.pyx":1799
  *                 reterr = SpgwAppendBiallelicGenovecHphase(genovec, NULL, phaseinfo, self._state_ptr)
  *             else:
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_alleles() error " + str(reterr))
  */
     /*else*/ {
       __pyx_v_reterr = plink2::SpgwAppendMultiallelicGenovecHphase(__pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, NULL, __pyx_v_phaseinfo, __pyx_v_write_allele_ct, __pyx_v_patch_01_ct, __pyx_v_patch_10_ct, __pyx_v_self->_state_ptr);
     }
     __pyx_L14:;
   }
   __pyx_L10:;
 
-  /* "pgenlib.pyx":1689
+  /* "pgenlib.pyx":1800
  *             else:
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_alleles() error " + str(reterr))
  *         return
  */
   __pyx_t_13 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_13)) {
 
-    /* "pgenlib.pyx":1690
+    /* "pgenlib.pyx":1801
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_alleles() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1690, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1690, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_alleles_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1690, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_alleles_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1690, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1690, __pyx_L1_error)
+    __PYX_ERR(0, 1801, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1689
+    /* "pgenlib.pyx":1800
  *             else:
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_alleles() error " + str(reterr))
  *         return
  */
   }
 
-  /* "pgenlib.pyx":1691
+  /* "pgenlib.pyx":1802
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_alleles() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1650
+  /* "pgenlib.pyx":1761
  * 
  * 
  *     cpdef append_alleles(self, np.ndarray[np.int32_t,mode="c"] allele_int32, bint all_phased = False, object allele_ct = None):             # <<<<<<<<<<<<<<
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  */
 
@@ -27057,44 +29778,44 @@
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_ct);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "append_alleles") < 0)) __PYX_ERR(0, 1650, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "append_alleles") < 0)) __PYX_ERR(0, 1761, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_allele_int32 = ((PyArrayObject *)values[0]);
     if (values[1]) {
-      __pyx_v_all_phased = __Pyx_PyObject_IsTrue(values[1]); if (unlikely((__pyx_v_all_phased == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1650, __pyx_L3_error)
+      __pyx_v_all_phased = __Pyx_PyObject_IsTrue(values[1]); if (unlikely((__pyx_v_all_phased == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1761, __pyx_L3_error)
     } else {
       __pyx_v_all_phased = ((int)0);
     }
     __pyx_v_allele_ct = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("append_alleles", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1650, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("append_alleles", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1761, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenWriter.append_alleles", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32), __pyx_ptype_5numpy_ndarray, 1, "allele_int32", 0))) __PYX_ERR(0, 1650, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32), __pyx_ptype_5numpy_ndarray, 1, "allele_int32", 0))) __PYX_ERR(0, 1761, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter_6append_alleles(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), __pyx_v_allele_int32, __pyx_v_all_phased, __pyx_v_allele_ct);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -27115,22 +29836,22 @@
   __Pyx_RefNannySetupContext("append_alleles", 0);
   __pyx_pybuffer_allele_int32.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32.refcount = 0;
   __pyx_pybuffernd_allele_int32.data = NULL;
   __pyx_pybuffernd_allele_int32.rcbuffer = &__pyx_pybuffer_allele_int32;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1650, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1761, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32.diminfo[0].strides = __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32.diminfo[0].shape = __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.shape[0];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.all_phased = __pyx_v_all_phased;
   __pyx_t_2.allele_ct = __pyx_v_allele_ct;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenWriter->append_alleles(__pyx_v_self, __pyx_v_allele_int32, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1650, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenWriter->append_alleles(__pyx_v_self, __pyx_v_allele_int32, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1761, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -27148,15 +29869,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_allele_int32.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1694
+/* "pgenlib.pyx":1805
  * 
  * 
  *     cpdef append_partially_phased(self, np.ndarray[np.int32_t,mode="c"] allele_int32, np.ndarray[np.uint8_t,cast=True] phasepresent, object allele_ct = None):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  */
 
@@ -27212,32 +29933,32 @@
   __pyx_pybuffernd_allele_int32.rcbuffer = &__pyx_pybuffer_allele_int32;
   __pyx_pybuffer_phasepresent.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent.refcount = 0;
   __pyx_pybuffernd_phasepresent.data = NULL;
   __pyx_pybuffernd_phasepresent.rcbuffer = &__pyx_pybuffer_phasepresent;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1694, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1805, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32.diminfo[0].strides = __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32.diminfo[0].shape = __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1694, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1805, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent.diminfo[0].strides = __pyx_pybuffernd_phasepresent.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent.diminfo[0].shape = __pyx_pybuffernd_phasepresent.rcbuffer->pybuffer.shape[0];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_partially_phased); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1694, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_partially_phased); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1805, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_9append_partially_phased)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         __pyx_t_5 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
@@ -27249,43 +29970,43 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_5 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[4] = {__pyx_t_4, ((PyObject *)__pyx_v_allele_int32), ((PyObject *)__pyx_v_phasepresent), __pyx_v_allele_ct};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1694, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1805, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_2);
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[4] = {__pyx_t_4, ((PyObject *)__pyx_v_allele_int32), ((PyObject *)__pyx_v_phasepresent), __pyx_v_allele_ct};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1694, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1805, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_2);
         } else
         #endif
         {
-          __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1694, __pyx_L1_error)
+          __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1805, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           if (__pyx_t_4) {
             __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
           }
           __Pyx_INCREF(((PyObject *)__pyx_v_allele_int32));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_allele_int32));
           PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, ((PyObject *)__pyx_v_allele_int32));
           __Pyx_INCREF(((PyObject *)__pyx_v_phasepresent));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_phasepresent));
           PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, ((PyObject *)__pyx_v_phasepresent));
           __Pyx_INCREF(__pyx_v_allele_ct);
           __Pyx_GIVEREF(__pyx_v_allele_ct);
           PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_5, __pyx_v_allele_ct);
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1694, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1805, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -27300,360 +30021,360 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1695
+  /* "pgenlib.pyx":1806
  * 
  *     cpdef append_partially_phased(self, np.ndarray[np.int32_t,mode="c"] allele_int32, np.ndarray[np.uint8_t,cast=True] phasepresent, object allele_ct = None):
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  */
   __pyx_t_7 = (((__pyx_v_self->_phase_dosage_gflags & plink2::kfPgenGlobalHardcallPhasePresent) == 0) != 0);
   if (unlikely(__pyx_t_7)) {
 
-    /* "pgenlib.pyx":1696
+    /* "pgenlib.pyx":1807
  *     cpdef append_partially_phased(self, np.ndarray[np.int32_t,mode="c"] allele_int32, np.ndarray[np.uint8_t,cast=True] phasepresent, object allele_ct = None):
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased cannot be called when PgenWriter was constructed with hardcall_phase_present False")             # <<<<<<<<<<<<<<
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  *         cdef unsigned char* phasepresent_bytes = <unsigned char*>(&(phasepresent[0]))
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__36, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1807, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1696, __pyx_L1_error)
+    __PYX_ERR(0, 1807, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1695
+    /* "pgenlib.pyx":1806
  * 
  *     cpdef append_partially_phased(self, np.ndarray[np.int32_t,mode="c"] allele_int32, np.ndarray[np.uint8_t,cast=True] phasepresent, object allele_ct = None):
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  */
   }
 
-  /* "pgenlib.pyx":1697
+  /* "pgenlib.pyx":1808
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))             # <<<<<<<<<<<<<<
  *         cdef unsigned char* phasepresent_bytes = <unsigned char*>(&(phasepresent[0]))
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  */
   __pyx_t_8 = 0;
   __pyx_t_5 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_pybuffernd_allele_int32.diminfo[0].shape;
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_5 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_pybuffernd_allele_int32.diminfo[0].shape)) __pyx_t_5 = 0;
   if (unlikely(__pyx_t_5 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_5);
-    __PYX_ERR(0, 1697, __pyx_L1_error)
+    __PYX_ERR(0, 1808, __pyx_L1_error)
   }
   __pyx_v_allele_codes = ((int32_t *)(&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_allele_int32.diminfo[0].strides))));
 
-  /* "pgenlib.pyx":1698
+  /* "pgenlib.pyx":1809
  *             raise RuntimeError("append_partially_phased cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  *         cdef unsigned char* phasepresent_bytes = <unsigned char*>(&(phasepresent[0]))             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  */
   __pyx_t_8 = 0;
   __pyx_t_5 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_pybuffernd_phasepresent.diminfo[0].shape;
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_5 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_pybuffernd_phasepresent.diminfo[0].shape)) __pyx_t_5 = 0;
   if (unlikely(__pyx_t_5 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_5);
-    __PYX_ERR(0, 1698, __pyx_L1_error)
+    __PYX_ERR(0, 1809, __pyx_L1_error)
   }
   __pyx_v_phasepresent_bytes = ((unsigned char *)(&(*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint8_t *, __pyx_pybuffernd_phasepresent.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_phasepresent.diminfo[0].strides))));
 
-  /* "pgenlib.pyx":1699
+  /* "pgenlib.pyx":1810
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  *         cdef unsigned char* phasepresent_bytes = <unsigned char*>(&(phasepresent[0]))
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)             # <<<<<<<<<<<<<<
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec
  */
   __pyx_v_sample_ct = plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr);
 
-  /* "pgenlib.pyx":1700
+  /* "pgenlib.pyx":1811
  *         cdef unsigned char* phasepresent_bytes = <unsigned char*>(&(phasepresent[0]))
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* phasepresent_buf = self._phasepresent
  */
   __pyx_t_9 = __pyx_v_self->_allele_ct_limit;
   __pyx_v_allele_ct_limit = __pyx_t_9;
 
-  /* "pgenlib.pyx":1701
+  /* "pgenlib.pyx":1812
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phasepresent_buf = self._phasepresent
  *         cdef uintptr_t* phaseinfo = self._phaseinfo
  */
   __pyx_t_10 = __pyx_v_self->_genovec;
   __pyx_v_genovec = __pyx_t_10;
 
-  /* "pgenlib.pyx":1702
+  /* "pgenlib.pyx":1813
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* phasepresent_buf = self._phasepresent             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phaseinfo = self._phaseinfo
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  */
   __pyx_t_10 = __pyx_v_self->_phasepresent;
   __pyx_v_phasepresent_buf = __pyx_t_10;
 
-  /* "pgenlib.pyx":1703
+  /* "pgenlib.pyx":1814
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* phasepresent_buf = self._phasepresent
  *         cdef uintptr_t* phaseinfo = self._phaseinfo             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  */
   __pyx_t_10 = __pyx_v_self->_phaseinfo;
   __pyx_v_phaseinfo = __pyx_t_10;
 
-  /* "pgenlib.pyx":1704
+  /* "pgenlib.pyx":1815
  *         cdef uintptr_t* phasepresent_buf = self._phasepresent
  *         cdef uintptr_t* phaseinfo = self._phaseinfo
  *         cdef uintptr_t* patch_01_set = self._patch_01_set             # <<<<<<<<<<<<<<
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  */
   __pyx_t_10 = __pyx_v_self->_patch_01_set;
   __pyx_v_patch_01_set = __pyx_t_10;
 
-  /* "pgenlib.pyx":1705
+  /* "pgenlib.pyx":1816
  *         cdef uintptr_t* phaseinfo = self._phaseinfo
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  */
   __pyx_t_11 = __pyx_v_self->_patch_01_vals;
   __pyx_v_patch_01_vals = __pyx_t_11;
 
-  /* "pgenlib.pyx":1706
+  /* "pgenlib.pyx":1817
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set             # <<<<<<<<<<<<<<
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  *         cdef uint32_t patch_01_ct
  */
   __pyx_t_10 = __pyx_v_self->_patch_10_set;
   __pyx_v_patch_10_set = __pyx_t_10;
 
-  /* "pgenlib.pyx":1707
+  /* "pgenlib.pyx":1818
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals             # <<<<<<<<<<<<<<
  *         cdef uint32_t patch_01_ct
  *         cdef uint32_t patch_10_ct
  */
   __pyx_t_11 = __pyx_v_self->_patch_10_vals;
   __pyx_v_patch_10_vals = __pyx_t_11;
 
-  /* "pgenlib.pyx":1710
+  /* "pgenlib.pyx":1821
  *         cdef uint32_t patch_01_ct
  *         cdef uint32_t patch_10_ct
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)             # <<<<<<<<<<<<<<
  *         if observed_allele_ct == -1:
  *             raise RuntimeError("append_partially_phased called with invalid allele codes")
  */
   __pyx_v_observed_allele_ct = plink2::ConvertMultiAlleleCodesUnsafe(__pyx_v_allele_codes, __pyx_v_phasepresent_bytes, __pyx_v_sample_ct, __pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, (&__pyx_v_patch_01_ct), (&__pyx_v_patch_10_ct), __pyx_v_phasepresent_buf, __pyx_v_phaseinfo);
 
-  /* "pgenlib.pyx":1711
+  /* "pgenlib.pyx":1822
  *         cdef uint32_t patch_10_ct
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  *         if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  */
   __pyx_t_7 = ((__pyx_v_observed_allele_ct == -1L) != 0);
   if (unlikely(__pyx_t_7)) {
 
-    /* "pgenlib.pyx":1712
+    /* "pgenlib.pyx":1823
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  *         if observed_allele_ct == -1:
  *             raise RuntimeError("append_partially_phased called with invalid allele codes")             # <<<<<<<<<<<<<<
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1712, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__37, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1823, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1712, __pyx_L1_error)
+    __PYX_ERR(0, 1823, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1711
+    /* "pgenlib.pyx":1822
  *         cdef uint32_t patch_10_ct
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  *         if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  */
   }
 
-  /* "pgenlib.pyx":1713
+  /* "pgenlib.pyx":1824
  *         if observed_allele_ct == -1:
  *             raise RuntimeError("append_partially_phased called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)             # <<<<<<<<<<<<<<
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  */
   __pyx_v_write_allele_ct = ((uint32_t)__pyx_v_observed_allele_ct);
 
-  /* "pgenlib.pyx":1714
+  /* "pgenlib.pyx":1825
  *             raise RuntimeError("append_partially_phased called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:
  */
   __pyx_t_7 = ((__pyx_v_write_allele_ct > __pyx_v_allele_ct_limit) != 0);
   if (unlikely(__pyx_t_7)) {
 
-    /* "pgenlib.pyx":1715
+    /* "pgenlib.pyx":1826
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")             # <<<<<<<<<<<<<<
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1715, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__38, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1715, __pyx_L1_error)
+    __PYX_ERR(0, 1826, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1714
+    /* "pgenlib.pyx":1825
  *             raise RuntimeError("append_partially_phased called with invalid allele codes")
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:
  */
   }
 
-  /* "pgenlib.pyx":1716
+  /* "pgenlib.pyx":1827
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:             # <<<<<<<<<<<<<<
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")
  */
   __pyx_t_7 = (__pyx_v_allele_ct != Py_None);
   __pyx_t_12 = (__pyx_t_7 != 0);
   if (__pyx_t_12) {
 
-    /* "pgenlib.pyx":1717
+    /* "pgenlib.pyx":1828
  *             raise RuntimeError("append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:
  */
-    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_write_allele_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1717, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_uint32_t(__pyx_v_write_allele_ct); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1828, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PyObject_RichCompare(__pyx_v_allele_ct, __pyx_t_1, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1717, __pyx_L1_error)
+    __pyx_t_2 = PyObject_RichCompare(__pyx_v_allele_ct, __pyx_t_1, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1828, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 1717, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 1828, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (unlikely(__pyx_t_12)) {
 
-      /* "pgenlib.pyx":1718
+      /* "pgenlib.pyx":1829
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")             # <<<<<<<<<<<<<<
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased called with allele_ct > allele_ct_limit")
  */
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__36, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1829, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1718, __pyx_L1_error)
+      __PYX_ERR(0, 1829, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1717
+      /* "pgenlib.pyx":1828
  *             raise RuntimeError("append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:
  */
     }
 
-    /* "pgenlib.pyx":1719
+    /* "pgenlib.pyx":1830
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased called with allele_ct > allele_ct_limit")
  *             write_allele_ct = allele_ct
  */
-    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_ct_limit); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_uint32_t(__pyx_v_allele_ct_limit); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1830, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyObject_RichCompare(__pyx_v_allele_ct, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1719, __pyx_L1_error)
+    __pyx_t_1 = PyObject_RichCompare(__pyx_v_allele_ct, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1830, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 1719, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 1830, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (unlikely(__pyx_t_12)) {
 
-      /* "pgenlib.pyx":1720
+      /* "pgenlib.pyx":1831
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased called with allele_ct > allele_ct_limit")             # <<<<<<<<<<<<<<
  *             write_allele_ct = allele_ct
  *         cdef PglErr reterr
  */
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__37, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1720, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__40, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1831, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1720, __pyx_L1_error)
+      __PYX_ERR(0, 1831, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1719
+      /* "pgenlib.pyx":1830
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased called with allele_ct > allele_ct_limit")
  *             write_allele_ct = allele_ct
  */
     }
 
-    /* "pgenlib.pyx":1721
+    /* "pgenlib.pyx":1832
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased called with allele_ct > allele_ct_limit")
  *             write_allele_ct = allele_ct             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr
  *         if (patch_01_ct == 0) and (patch_10_ct == 0):
  */
-    __pyx_t_9 = __Pyx_PyInt_As_uint32_t(__pyx_v_allele_ct); if (unlikely((__pyx_t_9 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1721, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_As_uint32_t(__pyx_v_allele_ct); if (unlikely((__pyx_t_9 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1832, __pyx_L1_error)
     __pyx_v_write_allele_ct = __pyx_t_9;
 
-    /* "pgenlib.pyx":1716
+    /* "pgenlib.pyx":1827
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *         if allele_ct is not None:             # <<<<<<<<<<<<<<
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")
  */
   }
 
-  /* "pgenlib.pyx":1723
+  /* "pgenlib.pyx":1834
  *             write_allele_ct = allele_ct
  *         cdef PglErr reterr
  *         if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *             reterr = SpgwAppendBiallelicGenovecHphase(genovec, phasepresent_buf, phaseinfo, self._state_ptr)
  *         else:
  */
   __pyx_t_7 = ((__pyx_v_patch_01_ct == 0) != 0);
@@ -27663,98 +30384,98 @@
     goto __pyx_L10_bool_binop_done;
   }
   __pyx_t_7 = ((__pyx_v_patch_10_ct == 0) != 0);
   __pyx_t_12 = __pyx_t_7;
   __pyx_L10_bool_binop_done:;
   if (__pyx_t_12) {
 
-    /* "pgenlib.pyx":1724
+    /* "pgenlib.pyx":1835
  *         cdef PglErr reterr
  *         if (patch_01_ct == 0) and (patch_10_ct == 0):
  *             reterr = SpgwAppendBiallelicGenovecHphase(genovec, phasepresent_buf, phaseinfo, self._state_ptr)             # <<<<<<<<<<<<<<
  *         else:
  *             reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  */
     __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovecHphase(__pyx_v_genovec, __pyx_v_phasepresent_buf, __pyx_v_phaseinfo, __pyx_v_self->_state_ptr);
 
-    /* "pgenlib.pyx":1723
+    /* "pgenlib.pyx":1834
  *             write_allele_ct = allele_ct
  *         cdef PglErr reterr
  *         if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *             reterr = SpgwAppendBiallelicGenovecHphase(genovec, phasepresent_buf, phaseinfo, self._state_ptr)
  *         else:
  */
     goto __pyx_L9;
   }
 
-  /* "pgenlib.pyx":1726
+  /* "pgenlib.pyx":1837
  *             reterr = SpgwAppendBiallelicGenovecHphase(genovec, phasepresent_buf, phaseinfo, self._state_ptr)
  *         else:
  *             reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_partially_phased() error " + str(reterr))
  */
   /*else*/ {
     __pyx_v_reterr = plink2::SpgwAppendMultiallelicGenovecHphase(__pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, __pyx_v_phasepresent_buf, __pyx_v_phaseinfo, __pyx_v_write_allele_ct, __pyx_v_patch_01_ct, __pyx_v_patch_10_ct, __pyx_v_self->_state_ptr);
   }
   __pyx_L9:;
 
-  /* "pgenlib.pyx":1727
+  /* "pgenlib.pyx":1838
  *         else:
  *             reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased() error " + str(reterr))
  *         return
  */
   __pyx_t_12 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_12)) {
 
-    /* "pgenlib.pyx":1728
+    /* "pgenlib.pyx":1839
  *             reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_partially_phased() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1728, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1728, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_partially_phased_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1728, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_partially_phased_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1728, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1728, __pyx_L1_error)
+    __PYX_ERR(0, 1839, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1727
+    /* "pgenlib.pyx":1838
  *         else:
  *             reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased() error " + str(reterr))
  *         return
  */
   }
 
-  /* "pgenlib.pyx":1729
+  /* "pgenlib.pyx":1840
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_partially_phased() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1694
+  /* "pgenlib.pyx":1805
  * 
  * 
  *     cpdef append_partially_phased(self, np.ndarray[np.int32_t,mode="c"] allele_int32, np.ndarray[np.uint8_t,cast=True] phasepresent, object allele_ct = None):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  */
 
@@ -27818,25 +30539,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_int32)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_phasepresent)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("append_partially_phased", 0, 2, 3, 1); __PYX_ERR(0, 1694, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("append_partially_phased", 0, 2, 3, 1); __PYX_ERR(0, 1805, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_ct);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "append_partially_phased") < 0)) __PYX_ERR(0, 1694, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "append_partially_phased") < 0)) __PYX_ERR(0, 1805, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -27846,22 +30567,22 @@
     }
     __pyx_v_allele_int32 = ((PyArrayObject *)values[0]);
     __pyx_v_phasepresent = ((PyArrayObject *)values[1]);
     __pyx_v_allele_ct = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("append_partially_phased", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1694, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("append_partially_phased", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1805, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenWriter.append_partially_phased", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32), __pyx_ptype_5numpy_ndarray, 1, "allele_int32", 0))) __PYX_ERR(0, 1694, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent), __pyx_ptype_5numpy_ndarray, 1, "phasepresent", 0))) __PYX_ERR(0, 1694, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32), __pyx_ptype_5numpy_ndarray, 1, "allele_int32", 0))) __PYX_ERR(0, 1805, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent), __pyx_ptype_5numpy_ndarray, 1, "phasepresent", 0))) __PYX_ERR(0, 1805, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter_8append_partially_phased(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), __pyx_v_allele_int32, __pyx_v_phasepresent, __pyx_v_allele_ct);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -27888,26 +30609,26 @@
   __pyx_pybuffernd_allele_int32.rcbuffer = &__pyx_pybuffer_allele_int32;
   __pyx_pybuffer_phasepresent.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent.refcount = 0;
   __pyx_pybuffernd_phasepresent.data = NULL;
   __pyx_pybuffernd_phasepresent.rcbuffer = &__pyx_pybuffer_phasepresent;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1694, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1805, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32.diminfo[0].strides = __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32.diminfo[0].shape = __pyx_pybuffernd_allele_int32.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1694, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1805, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent.diminfo[0].strides = __pyx_pybuffernd_phasepresent.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent.diminfo[0].shape = __pyx_pybuffernd_phasepresent.rcbuffer->pybuffer.shape[0];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.allele_ct = __pyx_v_allele_ct;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenWriter->append_partially_phased(__pyx_v_self, __pyx_v_allele_int32, __pyx_v_phasepresent, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1694, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenWriter->append_partially_phased(__pyx_v_self, __pyx_v_allele_int32, __pyx_v_phasepresent, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -27927,15 +30648,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phasepresent.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1732
+/* "pgenlib.pyx":1843
  * 
  * 
  *     cdef append_dosages_internal32(self, np.ndarray[np.float32_t,mode="c"] floatarr):             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  */
 
@@ -27962,129 +30683,129 @@
   __Pyx_RefNannySetupContext("append_dosages_internal32", 0);
   __pyx_pybuffer_floatarr.pybuffer.buf = NULL;
   __pyx_pybuffer_floatarr.refcount = 0;
   __pyx_pybuffernd_floatarr.data = NULL;
   __pyx_pybuffernd_floatarr.rcbuffer = &__pyx_pybuffer_floatarr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1732, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1843, __pyx_L1_error)
   }
   __pyx_pybuffernd_floatarr.diminfo[0].strides = __pyx_pybuffernd_floatarr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_floatarr.diminfo[0].shape = __pyx_pybuffernd_floatarr.rcbuffer->pybuffer.shape[0];
 
-  /* "pgenlib.pyx":1733
+  /* "pgenlib.pyx":1844
  * 
  *     cdef append_dosages_internal32(self, np.ndarray[np.float32_t,mode="c"] floatarr):
  *         cdef uintptr_t* genovec = self._genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* dosage_present = self._dosage_present
  *         cdef uint16_t* dosage_main = self._dosage_main
  */
   __pyx_t_1 = __pyx_v_self->_genovec;
   __pyx_v_genovec = __pyx_t_1;
 
-  /* "pgenlib.pyx":1734
+  /* "pgenlib.pyx":1845
  *     cdef append_dosages_internal32(self, np.ndarray[np.float32_t,mode="c"] floatarr):
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present             # <<<<<<<<<<<<<<
  *         cdef uint16_t* dosage_main = self._dosage_main
  *         cdef uint32_t dosage_ct
  */
   __pyx_t_1 = __pyx_v_self->_dosage_present;
   __pyx_v_dosage_present = __pyx_t_1;
 
-  /* "pgenlib.pyx":1735
+  /* "pgenlib.pyx":1846
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  *         cdef uint16_t* dosage_main = self._dosage_main             # <<<<<<<<<<<<<<
  *         cdef uint32_t dosage_ct
  *         FloatsToDosage16(<float*>(&(floatarr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  */
   __pyx_t_2 = __pyx_v_self->_dosage_main;
   __pyx_v_dosage_main = __pyx_t_2;
 
-  /* "pgenlib.pyx":1737
+  /* "pgenlib.pyx":1848
  *         cdef uint16_t* dosage_main = self._dosage_main
  *         cdef uint32_t dosage_ct
  *         FloatsToDosage16(<float*>(&(floatarr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:
  */
   __pyx_t_3 = 0;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_pybuffernd_floatarr.diminfo[0].shape;
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_pybuffernd_floatarr.diminfo[0].shape)) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 1737, __pyx_L1_error)
+    __PYX_ERR(0, 1848, __pyx_L1_error)
   }
   plink2::FloatsToDosage16(((float *)(&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_floatarr.rcbuffer->pybuffer.buf, __pyx_t_3, __pyx_pybuffernd_floatarr.diminfo[0].strides)))), plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr), 0x199A, __pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, (&__pyx_v_dosage_ct));
 
-  /* "pgenlib.pyx":1738
+  /* "pgenlib.pyx":1849
  *         cdef uint32_t dosage_ct
  *         FloatsToDosage16(<float*>(&(floatarr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_dosages() error " + str(reterr))
  */
   __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovecDosage16(__pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, __pyx_v_dosage_ct, __pyx_v_self->_state_ptr);
 
-  /* "pgenlib.pyx":1739
+  /* "pgenlib.pyx":1850
  *         FloatsToDosage16(<float*>(&(floatarr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_dosages() error " + str(reterr))
  *         return
  */
   __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":1740
+    /* "pgenlib.pyx":1851
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_dosages() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-    __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_dosages_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_dosages_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 1740, __pyx_L1_error)
+    __PYX_ERR(0, 1851, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1739
+    /* "pgenlib.pyx":1850
  *         FloatsToDosage16(<float*>(&(floatarr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_dosages() error " + str(reterr))
  *         return
  */
   }
 
-  /* "pgenlib.pyx":1741
+  /* "pgenlib.pyx":1852
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_dosages() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cdef append_dosages_internal64(self, np.ndarray[np.float64_t,mode="c"] doublearr):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1732
+  /* "pgenlib.pyx":1843
  * 
  * 
  *     cdef append_dosages_internal32(self, np.ndarray[np.float32_t,mode="c"] floatarr):             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  */
 
@@ -28105,15 +30826,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_floatarr.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1743
+/* "pgenlib.pyx":1854
  *         return
  * 
  *     cdef append_dosages_internal64(self, np.ndarray[np.float64_t,mode="c"] doublearr):             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  */
 
@@ -28140,129 +30861,129 @@
   __Pyx_RefNannySetupContext("append_dosages_internal64", 0);
   __pyx_pybuffer_doublearr.pybuffer.buf = NULL;
   __pyx_pybuffer_doublearr.refcount = 0;
   __pyx_pybuffernd_doublearr.data = NULL;
   __pyx_pybuffernd_doublearr.rcbuffer = &__pyx_pybuffer_doublearr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_doublearr.rcbuffer->pybuffer, (PyObject*)__pyx_v_doublearr, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1743, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_doublearr.rcbuffer->pybuffer, (PyObject*)__pyx_v_doublearr, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1854, __pyx_L1_error)
   }
   __pyx_pybuffernd_doublearr.diminfo[0].strides = __pyx_pybuffernd_doublearr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_doublearr.diminfo[0].shape = __pyx_pybuffernd_doublearr.rcbuffer->pybuffer.shape[0];
 
-  /* "pgenlib.pyx":1744
+  /* "pgenlib.pyx":1855
  * 
  *     cdef append_dosages_internal64(self, np.ndarray[np.float64_t,mode="c"] doublearr):
  *         cdef uintptr_t* genovec = self._genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* dosage_present = self._dosage_present
  *         cdef uint16_t* dosage_main = self._dosage_main
  */
   __pyx_t_1 = __pyx_v_self->_genovec;
   __pyx_v_genovec = __pyx_t_1;
 
-  /* "pgenlib.pyx":1745
+  /* "pgenlib.pyx":1856
  *     cdef append_dosages_internal64(self, np.ndarray[np.float64_t,mode="c"] doublearr):
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present             # <<<<<<<<<<<<<<
  *         cdef uint16_t* dosage_main = self._dosage_main
  *         cdef uint32_t dosage_ct
  */
   __pyx_t_1 = __pyx_v_self->_dosage_present;
   __pyx_v_dosage_present = __pyx_t_1;
 
-  /* "pgenlib.pyx":1746
+  /* "pgenlib.pyx":1857
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  *         cdef uint16_t* dosage_main = self._dosage_main             # <<<<<<<<<<<<<<
  *         cdef uint32_t dosage_ct
  *         DoublesToDosage16(<double*>(&(doublearr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  */
   __pyx_t_2 = __pyx_v_self->_dosage_main;
   __pyx_v_dosage_main = __pyx_t_2;
 
-  /* "pgenlib.pyx":1748
+  /* "pgenlib.pyx":1859
  *         cdef uint16_t* dosage_main = self._dosage_main
  *         cdef uint32_t dosage_ct
  *         DoublesToDosage16(<double*>(&(doublearr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:
  */
   __pyx_t_3 = 0;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_pybuffernd_doublearr.diminfo[0].shape;
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_pybuffernd_doublearr.diminfo[0].shape)) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 1748, __pyx_L1_error)
+    __PYX_ERR(0, 1859, __pyx_L1_error)
   }
   plink2::DoublesToDosage16(((double *)(&(*__Pyx_BufPtrCContig1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_doublearr.rcbuffer->pybuffer.buf, __pyx_t_3, __pyx_pybuffernd_doublearr.diminfo[0].strides)))), plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr), 0x199A, __pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, (&__pyx_v_dosage_ct));
 
-  /* "pgenlib.pyx":1749
+  /* "pgenlib.pyx":1860
  *         cdef uint32_t dosage_ct
  *         DoublesToDosage16(<double*>(&(doublearr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_dosages() error " + str(reterr))
  */
   __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovecDosage16(__pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, __pyx_v_dosage_ct, __pyx_v_self->_state_ptr);
 
-  /* "pgenlib.pyx":1750
+  /* "pgenlib.pyx":1861
  *         DoublesToDosage16(<double*>(&(doublearr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_dosages() error " + str(reterr))
  *         return
  */
   __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":1751
+    /* "pgenlib.pyx":1862
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_dosages() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-    __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1751, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1751, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_dosages_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1751, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_dosages_error, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1751, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_7, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __PYX_ERR(0, 1751, __pyx_L1_error)
+    __PYX_ERR(0, 1862, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1750
+    /* "pgenlib.pyx":1861
  *         DoublesToDosage16(<double*>(&(doublearr[0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *         cdef PglErr reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *         if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_dosages() error " + str(reterr))
  *         return
  */
   }
 
-  /* "pgenlib.pyx":1752
+  /* "pgenlib.pyx":1863
  *         if reterr != kPglRetSuccess:
  *             raise RuntimeError("append_dosages() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cpdef append_dosages(self, np.ndarray floatarr):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1743
+  /* "pgenlib.pyx":1854
  *         return
  * 
  *     cdef append_dosages_internal64(self, np.ndarray[np.float64_t,mode="c"] doublearr):             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  */
 
@@ -28283,15 +31004,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_doublearr.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1754
+/* "pgenlib.pyx":1865
  *         return
  * 
  *     cpdef append_dosages(self, np.ndarray floatarr):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages cannot be called when PgenWriter was constructed with dosage_present False")
  */
 
@@ -28313,15 +31034,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_dosages); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1754, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_dosages); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1865, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_11append_dosages)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -28330,15 +31051,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_floatarr)) : __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)__pyx_v_floatarr));
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1754, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1865, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -28351,158 +31072,158 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1755
+  /* "pgenlib.pyx":1866
  * 
  *     cpdef append_dosages(self, np.ndarray floatarr):
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_dosages cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr.dtype == np.float32:
  */
   __pyx_t_5 = (((__pyx_v_self->_phase_dosage_gflags & plink2::kfPgenGlobalDosagePresent) == 0) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":1756
+    /* "pgenlib.pyx":1867
  *     cpdef append_dosages(self, np.ndarray floatarr):
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages cannot be called when PgenWriter was constructed with dosage_present False")             # <<<<<<<<<<<<<<
  *         if floatarr.dtype == np.float32:
  *             self.append_dosages_internal32(floatarr)
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__38, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1867, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1756, __pyx_L1_error)
+    __PYX_ERR(0, 1867, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1755
+    /* "pgenlib.pyx":1866
  * 
  *     cpdef append_dosages(self, np.ndarray floatarr):
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_dosages cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr.dtype == np.float32:
  */
   }
 
-  /* "pgenlib.pyx":1757
+  /* "pgenlib.pyx":1868
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             self.append_dosages_internal32(floatarr)
  *         elif floatarr.dtype == np.float64:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1757, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1757, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1757, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1757, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1757, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":1758
+    /* "pgenlib.pyx":1869
  *             raise RuntimeError("append_dosages cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr.dtype == np.float32:
  *             self.append_dosages_internal32(floatarr)             # <<<<<<<<<<<<<<
  *         elif floatarr.dtype == np.float64:
  *             self.append_dosages_internal64(floatarr)
  */
-    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->append_dosages_internal32(__pyx_v_self, ((PyArrayObject *)__pyx_v_floatarr)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1758, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->append_dosages_internal32(__pyx_v_self, ((PyArrayObject *)__pyx_v_floatarr)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1869, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pgenlib.pyx":1757
+    /* "pgenlib.pyx":1868
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             self.append_dosages_internal32(floatarr)
  *         elif floatarr.dtype == np.float64:
  */
     goto __pyx_L4;
   }
 
-  /* "pgenlib.pyx":1759
+  /* "pgenlib.pyx":1870
  *         if floatarr.dtype == np.float32:
  *             self.append_dosages_internal32(floatarr)
  *         elif floatarr.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             self.append_dosages_internal64(floatarr)
  *         else:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1759, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1759, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1759, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1759, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1870, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1759, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1870, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (likely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":1760
+    /* "pgenlib.pyx":1871
  *             self.append_dosages_internal32(floatarr)
  *         elif floatarr.dtype == np.float64:
  *             self.append_dosages_internal64(floatarr)             # <<<<<<<<<<<<<<
  *         else:
  *             raise RuntimeError("Invalid append_dosages() dosage array element type (float32 or float64 expected).")
  */
-    __pyx_t_3 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->append_dosages_internal64(__pyx_v_self, ((PyArrayObject *)__pyx_v_floatarr)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1760, __pyx_L1_error)
+    __pyx_t_3 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->append_dosages_internal64(__pyx_v_self, ((PyArrayObject *)__pyx_v_floatarr)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1871, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "pgenlib.pyx":1759
+    /* "pgenlib.pyx":1870
  *         if floatarr.dtype == np.float32:
  *             self.append_dosages_internal32(floatarr)
  *         elif floatarr.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             self.append_dosages_internal64(floatarr)
  *         else:
  */
     goto __pyx_L4;
   }
 
-  /* "pgenlib.pyx":1762
+  /* "pgenlib.pyx":1873
  *             self.append_dosages_internal64(floatarr)
  *         else:
  *             raise RuntimeError("Invalid append_dosages() dosage array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   /*else*/ {
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1762, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1873, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 1762, __pyx_L1_error)
+    __PYX_ERR(0, 1873, __pyx_L1_error)
   }
   __pyx_L4:;
 
-  /* "pgenlib.pyx":1763
+  /* "pgenlib.pyx":1874
  *         else:
  *             raise RuntimeError("Invalid append_dosages() dosage array element type (float32 or float64 expected).")
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1754
+  /* "pgenlib.pyx":1865
  *         return
  * 
  *     cpdef append_dosages(self, np.ndarray floatarr):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages cannot be called when PgenWriter was constructed with dosage_present False")
  */
 
@@ -28525,15 +31246,15 @@
 static PyObject *__pyx_pw_7pgenlib_10PgenWriter_11append_dosages(PyObject *__pyx_v_self, PyObject *__pyx_v_floatarr) {
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("append_dosages (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr), __pyx_ptype_5numpy_ndarray, 1, "floatarr", 0))) __PYX_ERR(0, 1754, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr), __pyx_ptype_5numpy_ndarray, 1, "floatarr", 0))) __PYX_ERR(0, 1865, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter_10append_dosages(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), ((PyArrayObject *)__pyx_v_floatarr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -28546,15 +31267,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("append_dosages", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_append_dosages(__pyx_v_self, __pyx_v_floatarr, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1754, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_append_dosages(__pyx_v_self, __pyx_v_floatarr, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1865, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -28563,15 +31284,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1766
+/* "pgenlib.pyx":1877
  * 
  * 
  *     cpdef append_biallelic_batch(self, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_batch):             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>geno_int8_batch.shape[0]
  *         cdef int8_t* genobytes
  */
 
@@ -28602,27 +31323,27 @@
   __Pyx_RefNannySetupContext("append_biallelic_batch", 0);
   __pyx_pybuffer_geno_int8_batch.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int8_batch.refcount = 0;
   __pyx_pybuffernd_geno_int8_batch.data = NULL;
   __pyx_pybuffernd_geno_int8_batch.rcbuffer = &__pyx_pybuffer_geno_int8_batch;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1766, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1877, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int8_batch.diminfo[0].strides = __pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int8_batch.diminfo[0].shape = __pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_geno_int8_batch.diminfo[1].strides = __pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_geno_int8_batch.diminfo[1].shape = __pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer.shape[1];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_biallelic_batch); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1766, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_biallelic_batch); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_13append_biallelic_batch)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -28631,15 +31352,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_geno_int8_batch)) : __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)__pyx_v_geno_int8_batch));
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1766, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1877, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -28652,36 +31373,36 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1767
+  /* "pgenlib.pyx":1878
  * 
  *     cpdef append_biallelic_batch(self, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_batch):
  *         cdef uint32_t batch_size = <uint32_t>geno_int8_batch.shape[0]             # <<<<<<<<<<<<<<
  *         cdef int8_t* genobytes
  *         cdef uint32_t uii
  */
   __pyx_v_batch_size = ((uint32_t)(__pyx_v_geno_int8_batch->dimensions[0]));
 
-  /* "pgenlib.pyx":1771
+  /* "pgenlib.pyx":1882
  *         cdef uint32_t uii
  *         cdef PglErr reterr
  *         for uii in range(batch_size):             # <<<<<<<<<<<<<<
  *             genobytes = &(geno_int8_batch[uii, 0])
  *             BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  */
   __pyx_t_5 = __pyx_v_batch_size;
   __pyx_t_6 = __pyx_t_5;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
     __pyx_v_uii = __pyx_t_7;
 
-    /* "pgenlib.pyx":1772
+    /* "pgenlib.pyx":1883
  *         cdef PglErr reterr
  *         for uii in range(batch_size):
  *             genobytes = &(geno_int8_batch[uii, 0])             # <<<<<<<<<<<<<<
  *             BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  *             reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  */
     __pyx_t_8 = __pyx_v_uii;
@@ -28690,90 +31411,90 @@
     if (unlikely(__pyx_t_8 >= (size_t)__pyx_pybuffernd_geno_int8_batch.diminfo[0].shape)) __pyx_t_10 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_pybuffernd_geno_int8_batch.diminfo[1].shape;
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_pybuffernd_geno_int8_batch.diminfo[1].shape)) __pyx_t_10 = 1;
     if (unlikely(__pyx_t_10 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_10);
-      __PYX_ERR(0, 1772, __pyx_L1_error)
+      __PYX_ERR(0, 1883, __pyx_L1_error)
     }
     __pyx_v_genobytes = (&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_geno_int8_batch.diminfo[0].strides, __pyx_t_9, __pyx_pybuffernd_geno_int8_batch.diminfo[1].strides)));
 
-    /* "pgenlib.pyx":1773
+    /* "pgenlib.pyx":1884
  *         for uii in range(batch_size):
  *             genobytes = &(geno_int8_batch[uii, 0])
  *             BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)             # <<<<<<<<<<<<<<
  *             reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  *             if reterr != kPglRetSuccess:
  */
     plink2::BytesToGenoarrUnsafe(__pyx_v_genobytes, plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr), __pyx_v_self->_genovec);
 
-    /* "pgenlib.pyx":1774
+    /* "pgenlib.pyx":1885
  *             genobytes = &(geno_int8_batch[uii, 0])
  *             BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  *             reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)             # <<<<<<<<<<<<<<
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_biallelic_batch() error " + str(reterr))
  */
     __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovec(__pyx_v_self->_genovec, __pyx_v_self->_state_ptr);
 
-    /* "pgenlib.pyx":1775
+    /* "pgenlib.pyx":1886
  *             BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  *             reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_biallelic_batch() error " + str(reterr))
  *         return
  */
     __pyx_t_11 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
     if (unlikely(__pyx_t_11)) {
 
-      /* "pgenlib.pyx":1776
+      /* "pgenlib.pyx":1887
  *             reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_biallelic_batch() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-      __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1776, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1887, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1776, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1887, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_biallelic_batch_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1776, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_biallelic_batch_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1887, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1776, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1887, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1776, __pyx_L1_error)
+      __PYX_ERR(0, 1887, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1775
+      /* "pgenlib.pyx":1886
  *             BytesToGenoarrUnsafe(genobytes, SpgwGetSampleCt(self._state_ptr), self._genovec)
  *             reterr = SpgwAppendBiallelicGenovec(self._genovec, self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_biallelic_batch() error " + str(reterr))
  *         return
  */
     }
   }
 
-  /* "pgenlib.pyx":1777
+  /* "pgenlib.pyx":1888
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_biallelic_batch() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1766
+  /* "pgenlib.pyx":1877
  * 
  * 
  *     cpdef append_biallelic_batch(self, np.ndarray[np.int8_t,mode="c",ndim=2] geno_int8_batch):             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>geno_int8_batch.shape[0]
  *         cdef int8_t* genobytes
  */
 
@@ -28805,15 +31526,15 @@
 static PyObject *__pyx_pw_7pgenlib_10PgenWriter_13append_biallelic_batch(PyObject *__pyx_v_self, PyObject *__pyx_v_geno_int8_batch) {
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("append_biallelic_batch (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int8_batch), __pyx_ptype_5numpy_ndarray, 1, "geno_int8_batch", 0))) __PYX_ERR(0, 1766, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_geno_int8_batch), __pyx_ptype_5numpy_ndarray, 1, "geno_int8_batch", 0))) __PYX_ERR(0, 1877, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter_12append_biallelic_batch(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), ((PyArrayObject *)__pyx_v_geno_int8_batch));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -28833,19 +31554,19 @@
   __Pyx_RefNannySetupContext("append_biallelic_batch", 0);
   __pyx_pybuffer_geno_int8_batch.pybuffer.buf = NULL;
   __pyx_pybuffer_geno_int8_batch.refcount = 0;
   __pyx_pybuffernd_geno_int8_batch.data = NULL;
   __pyx_pybuffernd_geno_int8_batch.rcbuffer = &__pyx_pybuffer_geno_int8_batch;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1766, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_geno_int8_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1877, __pyx_L1_error)
   }
   __pyx_pybuffernd_geno_int8_batch.diminfo[0].strides = __pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_geno_int8_batch.diminfo[0].shape = __pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_geno_int8_batch.diminfo[1].strides = __pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_geno_int8_batch.diminfo[1].shape = __pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer.shape[1];
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_append_biallelic_batch(__pyx_v_self, __pyx_v_geno_int8_batch, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1766, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_append_biallelic_batch(__pyx_v_self, __pyx_v_geno_int8_batch, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1877, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -28863,15 +31584,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_geno_int8_batch.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1780
+/* "pgenlib.pyx":1891
  * 
  * 
  *     cpdef append_alleles_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, bint all_phased = False, object allele_cts = None):             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  */
 
@@ -28930,31 +31651,31 @@
   }
   __pyx_pybuffer_allele_int32_batch.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32_batch.refcount = 0;
   __pyx_pybuffernd_allele_int32_batch.data = NULL;
   __pyx_pybuffernd_allele_int32_batch.rcbuffer = &__pyx_pybuffer_allele_int32_batch;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1780, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1891, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_batch.diminfo[0].strides = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_batch.diminfo[0].shape = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_batch.diminfo[1].strides = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.shape[1];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_alleles_batch); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1780, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_alleles_batch); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1891, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_15append_alleles_batch)) {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyBool_FromLong(__pyx_v_all_phased); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1780, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyBool_FromLong(__pyx_v_all_phased); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1891, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_5)) {
@@ -28964,45 +31685,45 @@
             __Pyx_DECREF_SET(__pyx_t_4, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, ((PyObject *)__pyx_v_allele_int32_batch), __pyx_t_3, __pyx_v_allele_cts};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1780, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1891, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
           PyObject *__pyx_temp[4] = {__pyx_t_5, ((PyObject *)__pyx_v_allele_int32_batch), __pyx_t_3, __pyx_v_allele_cts};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1780, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1891, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1780, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1891, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_5) {
             __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
           }
           __Pyx_INCREF(((PyObject *)__pyx_v_allele_int32_batch));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_allele_int32_batch));
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, ((PyObject *)__pyx_v_allele_int32_batch));
           __Pyx_GIVEREF(__pyx_t_3);
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
           __Pyx_INCREF(__pyx_v_allele_cts);
           __Pyx_GIVEREF(__pyx_v_allele_cts);
           PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_v_allele_cts);
           __pyx_t_3 = 0;
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1780, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1891, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -29017,115 +31738,115 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1781
+  /* "pgenlib.pyx":1892
  * 
  *     cpdef append_alleles_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, bint all_phased = False, object allele_cts = None):
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  */
   __pyx_v_batch_size = ((uint32_t)(__pyx_v_allele_int32_batch->dimensions[0]));
 
-  /* "pgenlib.pyx":1782
+  /* "pgenlib.pyx":1893
  *     cpdef append_alleles_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, bint all_phased = False, object allele_cts = None):
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)             # <<<<<<<<<<<<<<
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec
  */
   __pyx_v_sample_ct = plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr);
 
-  /* "pgenlib.pyx":1783
+  /* "pgenlib.pyx":1894
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef int32_t* allele_codes
  */
   __pyx_t_8 = __pyx_v_self->_allele_ct_limit;
   __pyx_v_allele_ct_limit = __pyx_t_8;
 
-  /* "pgenlib.pyx":1784
+  /* "pgenlib.pyx":1895
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec             # <<<<<<<<<<<<<<
  *         cdef int32_t* allele_codes
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  */
   __pyx_t_9 = __pyx_v_self->_genovec;
   __pyx_v_genovec = __pyx_t_9;
 
-  /* "pgenlib.pyx":1786
+  /* "pgenlib.pyx":1897
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef int32_t* allele_codes
  *         cdef uintptr_t* patch_01_set = self._patch_01_set             # <<<<<<<<<<<<<<
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  */
   __pyx_t_9 = __pyx_v_self->_patch_01_set;
   __pyx_v_patch_01_set = __pyx_t_9;
 
-  /* "pgenlib.pyx":1787
+  /* "pgenlib.pyx":1898
  *         cdef int32_t* allele_codes
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  */
   __pyx_t_10 = __pyx_v_self->_patch_01_vals;
   __pyx_v_patch_01_vals = __pyx_t_10;
 
-  /* "pgenlib.pyx":1788
+  /* "pgenlib.pyx":1899
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set             # <<<<<<<<<<<<<<
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  *         cdef uint32_t uii
  */
   __pyx_t_9 = __pyx_v_self->_patch_10_set;
   __pyx_v_patch_10_set = __pyx_t_9;
 
-  /* "pgenlib.pyx":1789
+  /* "pgenlib.pyx":1900
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals             # <<<<<<<<<<<<<<
  *         cdef uint32_t uii
  *         cdef int32_t observed_allele_ct
  */
   __pyx_t_10 = __pyx_v_self->_patch_10_vals;
   __pyx_v_patch_10_vals = __pyx_t_10;
 
-  /* "pgenlib.pyx":1797
+  /* "pgenlib.pyx":1908
  *         cdef uint32_t patch_10_ct
  *         cdef PglErr reterr
  *         if not all_phased:             # <<<<<<<<<<<<<<
  *             for uii in range(batch_size):
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  */
   __pyx_t_11 = ((!(__pyx_v_all_phased != 0)) != 0);
   if (__pyx_t_11) {
 
-    /* "pgenlib.pyx":1798
+    /* "pgenlib.pyx":1909
  *         cdef PglErr reterr
  *         if not all_phased:
  *             for uii in range(batch_size):             # <<<<<<<<<<<<<<
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, NULL)
  */
     __pyx_t_8 = __pyx_v_batch_size;
     __pyx_t_12 = __pyx_t_8;
     for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
       __pyx_v_uii = __pyx_t_13;
 
-      /* "pgenlib.pyx":1799
+      /* "pgenlib.pyx":1910
  *         if not all_phased:
  *             for uii in range(batch_size):
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))             # <<<<<<<<<<<<<<
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, NULL)
  *                 if observed_allele_ct == -1:
  */
       __pyx_t_14 = __pyx_v_uii;
@@ -29134,207 +31855,207 @@
       if (unlikely(__pyx_t_14 >= (size_t)__pyx_pybuffernd_allele_int32_batch.diminfo[0].shape)) __pyx_t_6 = 0;
       if (__pyx_t_15 < 0) {
         __pyx_t_15 += __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape;
         if (unlikely(__pyx_t_15 < 0)) __pyx_t_6 = 1;
       } else if (unlikely(__pyx_t_15 >= __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape)) __pyx_t_6 = 1;
       if (unlikely(__pyx_t_6 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_6);
-        __PYX_ERR(0, 1799, __pyx_L1_error)
+        __PYX_ERR(0, 1910, __pyx_L1_error)
       }
       __pyx_v_allele_codes = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_allele_int32_batch.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_allele_int32_batch.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1800
+      /* "pgenlib.pyx":1911
  *             for uii in range(batch_size):
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, NULL)             # <<<<<<<<<<<<<<
  *                 if observed_allele_ct == -1:
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  */
       __pyx_v_observed_allele_ct = plink2::ConvertMultiAlleleCodesUnsafe(__pyx_v_allele_codes, NULL, __pyx_v_sample_ct, __pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, (&__pyx_v_patch_01_ct), (&__pyx_v_patch_10_ct), NULL, NULL);
 
-      /* "pgenlib.pyx":1801
+      /* "pgenlib.pyx":1912
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, NULL)
  *                 if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  */
       __pyx_t_11 = ((__pyx_v_observed_allele_ct == -1L) != 0);
       if (unlikely(__pyx_t_11)) {
 
-        /* "pgenlib.pyx":1802
+        /* "pgenlib.pyx":1913
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, NULL)
  *                 if observed_allele_ct == -1:
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")             # <<<<<<<<<<<<<<
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:
  */
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__40, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1802, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1913, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 1802, __pyx_L1_error)
+        __PYX_ERR(0, 1913, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1801
+        /* "pgenlib.pyx":1912
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, NULL)
  *                 if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  */
       }
 
-      /* "pgenlib.pyx":1803
+      /* "pgenlib.pyx":1914
  *                 if observed_allele_ct == -1:
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)             # <<<<<<<<<<<<<<
  *                 if write_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  */
       __pyx_v_write_allele_ct = ((uint32_t)__pyx_v_observed_allele_ct);
 
-      /* "pgenlib.pyx":1804
+      /* "pgenlib.pyx":1915
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:
  */
       __pyx_t_11 = ((__pyx_v_write_allele_ct > __pyx_v_allele_ct_limit) != 0);
       if (unlikely(__pyx_t_11)) {
 
-        /* "pgenlib.pyx":1805
+        /* "pgenlib.pyx":1916
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")             # <<<<<<<<<<<<<<
  *                 if allele_cts is not None:
  *                     casted_allele_ct = allele_cts[uii]
  */
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1805, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1916, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 1805, __pyx_L1_error)
+        __PYX_ERR(0, 1916, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1804
+        /* "pgenlib.pyx":1915
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:
  */
       }
 
-      /* "pgenlib.pyx":1806
+      /* "pgenlib.pyx":1917
  *                 if write_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:             # <<<<<<<<<<<<<<
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:
  */
       __pyx_t_11 = (__pyx_v_allele_cts != Py_None);
       __pyx_t_16 = (__pyx_t_11 != 0);
       if (__pyx_t_16) {
 
-        /* "pgenlib.pyx":1807
+        /* "pgenlib.pyx":1918
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:
  *                     casted_allele_ct = allele_cts[uii]             # <<<<<<<<<<<<<<
  *                     if casted_allele_ct < write_allele_ct:
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  */
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_allele_cts, __pyx_v_uii, uint32_t, 0, __Pyx_PyInt_From_uint32_t, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1807, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_allele_cts, __pyx_v_uii, uint32_t, 0, __Pyx_PyInt_From_uint32_t, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1918, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_17 = __Pyx_PyInt_As_uint32_t(__pyx_t_1); if (unlikely((__pyx_t_17 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1807, __pyx_L1_error)
+        __pyx_t_17 = __Pyx_PyInt_As_uint32_t(__pyx_t_1); if (unlikely((__pyx_t_17 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1918, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_v_casted_allele_ct = __pyx_t_17;
 
-        /* "pgenlib.pyx":1808
+        /* "pgenlib.pyx":1919
  *                 if allele_cts is not None:
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:
  */
         __pyx_t_16 = ((__pyx_v_casted_allele_ct < __pyx_v_write_allele_ct) != 0);
         if (unlikely(__pyx_t_16)) {
 
-          /* "pgenlib.pyx":1809
+          /* "pgenlib.pyx":1920
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")             # <<<<<<<<<<<<<<
  *                     if casted_allele_ct > allele_ct_limit:
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  */
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1809, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1920, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_Raise(__pyx_t_1, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __PYX_ERR(0, 1809, __pyx_L1_error)
+          __PYX_ERR(0, 1920, __pyx_L1_error)
 
-          /* "pgenlib.pyx":1808
+          /* "pgenlib.pyx":1919
  *                 if allele_cts is not None:
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:
  */
         }
 
-        /* "pgenlib.pyx":1810
+        /* "pgenlib.pyx":1921
  *                     if casted_allele_ct < write_allele_ct:
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct
  */
         __pyx_t_16 = ((__pyx_v_casted_allele_ct > __pyx_v_allele_ct_limit) != 0);
         if (unlikely(__pyx_t_16)) {
 
-          /* "pgenlib.pyx":1811
+          /* "pgenlib.pyx":1922
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")             # <<<<<<<<<<<<<<
  *                     write_allele_ct = casted_allele_ct
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):
  */
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1811, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1922, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_Raise(__pyx_t_1, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __PYX_ERR(0, 1811, __pyx_L1_error)
+          __PYX_ERR(0, 1922, __pyx_L1_error)
 
-          /* "pgenlib.pyx":1810
+          /* "pgenlib.pyx":1921
  *                     if casted_allele_ct < write_allele_ct:
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct
  */
         }
 
-        /* "pgenlib.pyx":1812
+        /* "pgenlib.pyx":1923
  *                     if casted_allele_ct > allele_ct_limit:
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct             # <<<<<<<<<<<<<<
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                     reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)
  */
         __pyx_v_write_allele_ct = __pyx_v_casted_allele_ct;
 
-        /* "pgenlib.pyx":1806
+        /* "pgenlib.pyx":1917
  *                 if write_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:             # <<<<<<<<<<<<<<
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:
  */
       }
 
-      /* "pgenlib.pyx":1813
+      /* "pgenlib.pyx":1924
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                     reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)
  *                 else:
  */
       __pyx_t_11 = ((__pyx_v_patch_01_ct == 0) != 0);
@@ -29344,143 +32065,143 @@
         goto __pyx_L12_bool_binop_done;
       }
       __pyx_t_11 = ((__pyx_v_patch_10_ct == 0) != 0);
       __pyx_t_16 = __pyx_t_11;
       __pyx_L12_bool_binop_done:;
       if (__pyx_t_16) {
 
-        /* "pgenlib.pyx":1814
+        /* "pgenlib.pyx":1925
  *                     write_allele_ct = casted_allele_ct
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                     reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)             # <<<<<<<<<<<<<<
  *                 else:
  *                     reterr = SpgwAppendMultiallelicSparse(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  */
         __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovec(__pyx_v_genovec, __pyx_v_self->_state_ptr);
 
-        /* "pgenlib.pyx":1813
+        /* "pgenlib.pyx":1924
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                     reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)
  *                 else:
  */
         goto __pyx_L11;
       }
 
-      /* "pgenlib.pyx":1816
+      /* "pgenlib.pyx":1927
  *                     reterr = SpgwAppendBiallelicGenovec(genovec, self._state_ptr)
  *                 else:
  *                     reterr = SpgwAppendMultiallelicSparse(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))
  */
       /*else*/ {
         __pyx_v_reterr = plink2::SpgwAppendMultiallelicSparse(__pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, __pyx_v_write_allele_ct, __pyx_v_patch_01_ct, __pyx_v_patch_10_ct, __pyx_v_self->_state_ptr);
       }
       __pyx_L11:;
 
-      /* "pgenlib.pyx":1817
+      /* "pgenlib.pyx":1928
  *                 else:
  *                     reterr = SpgwAppendMultiallelicSparse(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))
  *         else:
  */
       __pyx_t_16 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_16)) {
 
-        /* "pgenlib.pyx":1818
+        /* "pgenlib.pyx":1929
  *                     reterr = SpgwAppendMultiallelicSparse(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         else:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  */
-        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1818, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1929, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1818, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1929, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_alleles_batch_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1818, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_alleles_batch_error, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1929, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1818, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1929, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_Raise(__pyx_t_2, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __PYX_ERR(0, 1818, __pyx_L1_error)
+        __PYX_ERR(0, 1929, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1817
+        /* "pgenlib.pyx":1928
  *                 else:
  *                     reterr = SpgwAppendMultiallelicSparse(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))
  *         else:
  */
       }
     }
 
-    /* "pgenlib.pyx":1797
+    /* "pgenlib.pyx":1908
  *         cdef uint32_t patch_10_ct
  *         cdef PglErr reterr
  *         if not all_phased:             # <<<<<<<<<<<<<<
  *             for uii in range(batch_size):
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  */
     goto __pyx_L3;
   }
 
-  /* "pgenlib.pyx":1820
+  /* "pgenlib.pyx":1931
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))
  *         else:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_alleles_batch called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")
  *             for uii in range(batch_size):
  */
   /*else*/ {
     __pyx_t_16 = (((__pyx_v_self->_phase_dosage_gflags & plink2::kfPgenGlobalHardcallPhasePresent) == 0) != 0);
     if (unlikely(__pyx_t_16)) {
 
-      /* "pgenlib.pyx":1821
+      /* "pgenlib.pyx":1932
  *         else:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *                 raise RuntimeError("append_alleles_batch called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")             # <<<<<<<<<<<<<<
  *             for uii in range(batch_size):
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  */
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1821, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1821, __pyx_L1_error)
+      __PYX_ERR(0, 1932, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1820
+      /* "pgenlib.pyx":1931
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))
  *         else:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_alleles_batch called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")
  *             for uii in range(batch_size):
  */
     }
 
-    /* "pgenlib.pyx":1822
+    /* "pgenlib.pyx":1933
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *                 raise RuntimeError("append_alleles_batch called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")
  *             for uii in range(batch_size):             # <<<<<<<<<<<<<<
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, self._phaseinfo)
  */
     __pyx_t_8 = __pyx_v_batch_size;
     __pyx_t_12 = __pyx_t_8;
     for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
       __pyx_v_uii = __pyx_t_13;
 
-      /* "pgenlib.pyx":1823
+      /* "pgenlib.pyx":1934
  *                 raise RuntimeError("append_alleles_batch called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")
  *             for uii in range(batch_size):
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))             # <<<<<<<<<<<<<<
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, self._phaseinfo)
  *                 if observed_allele_ct == -1:
  */
       __pyx_t_14 = __pyx_v_uii;
@@ -29489,207 +32210,207 @@
       if (unlikely(__pyx_t_14 >= (size_t)__pyx_pybuffernd_allele_int32_batch.diminfo[0].shape)) __pyx_t_6 = 0;
       if (__pyx_t_15 < 0) {
         __pyx_t_15 += __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape;
         if (unlikely(__pyx_t_15 < 0)) __pyx_t_6 = 1;
       } else if (unlikely(__pyx_t_15 >= __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape)) __pyx_t_6 = 1;
       if (unlikely(__pyx_t_6 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_6);
-        __PYX_ERR(0, 1823, __pyx_L1_error)
+        __PYX_ERR(0, 1934, __pyx_L1_error)
       }
       __pyx_v_allele_codes = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_allele_int32_batch.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_allele_int32_batch.diminfo[1].strides))));
 
-      /* "pgenlib.pyx":1824
+      /* "pgenlib.pyx":1935
  *             for uii in range(batch_size):
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, self._phaseinfo)             # <<<<<<<<<<<<<<
  *                 if observed_allele_ct == -1:
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  */
       __pyx_v_observed_allele_ct = plink2::ConvertMultiAlleleCodesUnsafe(__pyx_v_allele_codes, NULL, __pyx_v_sample_ct, __pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, (&__pyx_v_patch_01_ct), (&__pyx_v_patch_10_ct), NULL, __pyx_v_self->_phaseinfo);
 
-      /* "pgenlib.pyx":1825
+      /* "pgenlib.pyx":1936
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, self._phaseinfo)
  *                 if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  */
       __pyx_t_16 = ((__pyx_v_observed_allele_ct == -1L) != 0);
       if (unlikely(__pyx_t_16)) {
 
-        /* "pgenlib.pyx":1826
+        /* "pgenlib.pyx":1937
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, self._phaseinfo)
  *                 if observed_allele_ct == -1:
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")             # <<<<<<<<<<<<<<
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:
  */
-        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__40, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1826, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1937, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_Raise(__pyx_t_2, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __PYX_ERR(0, 1826, __pyx_L1_error)
+        __PYX_ERR(0, 1937, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1825
+        /* "pgenlib.pyx":1936
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, self._phaseinfo)
  *                 if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  */
       }
 
-      /* "pgenlib.pyx":1827
+      /* "pgenlib.pyx":1938
  *                 if observed_allele_ct == -1:
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)             # <<<<<<<<<<<<<<
  *                 if write_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  */
       __pyx_v_write_allele_ct = ((uint32_t)__pyx_v_observed_allele_ct);
 
-      /* "pgenlib.pyx":1828
+      /* "pgenlib.pyx":1939
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:
  */
       __pyx_t_16 = ((__pyx_v_write_allele_ct > __pyx_v_allele_ct_limit) != 0);
       if (unlikely(__pyx_t_16)) {
 
-        /* "pgenlib.pyx":1829
+        /* "pgenlib.pyx":1940
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")             # <<<<<<<<<<<<<<
  *                 if allele_cts is not None:
  *                     casted_allele_ct = allele_cts[uii]
  */
-        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1829, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1940, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_Raise(__pyx_t_2, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __PYX_ERR(0, 1829, __pyx_L1_error)
+        __PYX_ERR(0, 1940, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1828
+        /* "pgenlib.pyx":1939
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:
  */
       }
 
-      /* "pgenlib.pyx":1830
+      /* "pgenlib.pyx":1941
  *                 if write_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:             # <<<<<<<<<<<<<<
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:
  */
       __pyx_t_16 = (__pyx_v_allele_cts != Py_None);
       __pyx_t_11 = (__pyx_t_16 != 0);
       if (__pyx_t_11) {
 
-        /* "pgenlib.pyx":1831
+        /* "pgenlib.pyx":1942
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:
  *                     casted_allele_ct = allele_cts[uii]             # <<<<<<<<<<<<<<
  *                     if casted_allele_ct < write_allele_ct:
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  */
-        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_allele_cts, __pyx_v_uii, uint32_t, 0, __Pyx_PyInt_From_uint32_t, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1831, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_allele_cts, __pyx_v_uii, uint32_t, 0, __Pyx_PyInt_From_uint32_t, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1942, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_17 = __Pyx_PyInt_As_uint32_t(__pyx_t_2); if (unlikely((__pyx_t_17 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1831, __pyx_L1_error)
+        __pyx_t_17 = __Pyx_PyInt_As_uint32_t(__pyx_t_2); if (unlikely((__pyx_t_17 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1942, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __pyx_v_casted_allele_ct = __pyx_t_17;
 
-        /* "pgenlib.pyx":1832
+        /* "pgenlib.pyx":1943
  *                 if allele_cts is not None:
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:
  */
         __pyx_t_11 = ((__pyx_v_casted_allele_ct < __pyx_v_write_allele_ct) != 0);
         if (unlikely(__pyx_t_11)) {
 
-          /* "pgenlib.pyx":1833
+          /* "pgenlib.pyx":1944
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")             # <<<<<<<<<<<<<<
  *                     if casted_allele_ct > allele_ct_limit:
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  */
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1833, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1944, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 1833, __pyx_L1_error)
+          __PYX_ERR(0, 1944, __pyx_L1_error)
 
-          /* "pgenlib.pyx":1832
+          /* "pgenlib.pyx":1943
  *                 if allele_cts is not None:
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:
  */
         }
 
-        /* "pgenlib.pyx":1834
+        /* "pgenlib.pyx":1945
  *                     if casted_allele_ct < write_allele_ct:
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct
  */
         __pyx_t_11 = ((__pyx_v_casted_allele_ct > __pyx_v_allele_ct_limit) != 0);
         if (unlikely(__pyx_t_11)) {
 
-          /* "pgenlib.pyx":1835
+          /* "pgenlib.pyx":1946
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")             # <<<<<<<<<<<<<<
  *                     write_allele_ct = casted_allele_ct
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):
  */
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1835, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1946, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 1835, __pyx_L1_error)
+          __PYX_ERR(0, 1946, __pyx_L1_error)
 
-          /* "pgenlib.pyx":1834
+          /* "pgenlib.pyx":1945
  *                     if casted_allele_ct < write_allele_ct:
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct
  */
         }
 
-        /* "pgenlib.pyx":1836
+        /* "pgenlib.pyx":1947
  *                     if casted_allele_ct > allele_ct_limit:
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct             # <<<<<<<<<<<<<<
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                     reterr = SpgwAppendBiallelicGenovecHphase(genovec, NULL, self._phaseinfo, self._state_ptr)
  */
         __pyx_v_write_allele_ct = __pyx_v_casted_allele_ct;
 
-        /* "pgenlib.pyx":1830
+        /* "pgenlib.pyx":1941
  *                 if write_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *                 if allele_cts is not None:             # <<<<<<<<<<<<<<
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:
  */
       }
 
-      /* "pgenlib.pyx":1837
+      /* "pgenlib.pyx":1948
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                     reterr = SpgwAppendBiallelicGenovecHphase(genovec, NULL, self._phaseinfo, self._state_ptr)
  *                 else:
  */
       __pyx_t_16 = ((__pyx_v_patch_01_ct == 0) != 0);
@@ -29699,101 +32420,101 @@
         goto __pyx_L24_bool_binop_done;
       }
       __pyx_t_16 = ((__pyx_v_patch_10_ct == 0) != 0);
       __pyx_t_11 = __pyx_t_16;
       __pyx_L24_bool_binop_done:;
       if (__pyx_t_11) {
 
-        /* "pgenlib.pyx":1838
+        /* "pgenlib.pyx":1949
  *                     write_allele_ct = casted_allele_ct
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                     reterr = SpgwAppendBiallelicGenovecHphase(genovec, NULL, self._phaseinfo, self._state_ptr)             # <<<<<<<<<<<<<<
  *                 else:
  *                     reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, self._phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  */
         __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovecHphase(__pyx_v_genovec, NULL, __pyx_v_self->_phaseinfo, __pyx_v_self->_state_ptr);
 
-        /* "pgenlib.pyx":1837
+        /* "pgenlib.pyx":1948
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                     write_allele_ct = casted_allele_ct
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                     reterr = SpgwAppendBiallelicGenovecHphase(genovec, NULL, self._phaseinfo, self._state_ptr)
  *                 else:
  */
         goto __pyx_L23;
       }
 
-      /* "pgenlib.pyx":1840
+      /* "pgenlib.pyx":1951
  *                     reterr = SpgwAppendBiallelicGenovecHphase(genovec, NULL, self._phaseinfo, self._state_ptr)
  *                 else:
  *                     reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, self._phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))
  */
       /*else*/ {
         __pyx_v_reterr = plink2::SpgwAppendMultiallelicGenovecHphase(__pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, NULL, __pyx_v_self->_phaseinfo, __pyx_v_write_allele_ct, __pyx_v_patch_01_ct, __pyx_v_patch_10_ct, __pyx_v_self->_state_ptr);
       }
       __pyx_L23:;
 
-      /* "pgenlib.pyx":1841
+      /* "pgenlib.pyx":1952
  *                 else:
  *                     reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, self._phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))
  *         return
  */
       __pyx_t_11 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_11)) {
 
-        /* "pgenlib.pyx":1842
+        /* "pgenlib.pyx":1953
  *                     reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, self._phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-        __pyx_t_2 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1842, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_alleles_batch_error, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1842, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_alleles_batch_error, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1953, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 1842, __pyx_L1_error)
+        __PYX_ERR(0, 1953, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1841
+        /* "pgenlib.pyx":1952
  *                 else:
  *                     reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, NULL, self._phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))
  *         return
  */
       }
     }
   }
   __pyx_L3:;
 
-  /* "pgenlib.pyx":1843
+  /* "pgenlib.pyx":1954
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("append_alleles_batch() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1780
+  /* "pgenlib.pyx":1891
  * 
  * 
  *     cpdef append_alleles_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, bint all_phased = False, object allele_cts = None):             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  */
 
@@ -29866,44 +32587,44 @@
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_cts);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "append_alleles_batch") < 0)) __PYX_ERR(0, 1780, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "append_alleles_batch") < 0)) __PYX_ERR(0, 1891, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_allele_int32_batch = ((PyArrayObject *)values[0]);
     if (values[1]) {
-      __pyx_v_all_phased = __Pyx_PyObject_IsTrue(values[1]); if (unlikely((__pyx_v_all_phased == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1780, __pyx_L3_error)
+      __pyx_v_all_phased = __Pyx_PyObject_IsTrue(values[1]); if (unlikely((__pyx_v_all_phased == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1891, __pyx_L3_error)
     } else {
       __pyx_v_all_phased = ((int)0);
     }
     __pyx_v_allele_cts = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("append_alleles_batch", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1780, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("append_alleles_batch", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1891, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenWriter.append_alleles_batch", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_batch), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_batch", 0))) __PYX_ERR(0, 1780, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_batch), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_batch", 0))) __PYX_ERR(0, 1891, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter_14append_alleles_batch(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), __pyx_v_allele_int32_batch, __pyx_v_all_phased, __pyx_v_allele_cts);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -29924,22 +32645,22 @@
   __Pyx_RefNannySetupContext("append_alleles_batch", 0);
   __pyx_pybuffer_allele_int32_batch.pybuffer.buf = NULL;
   __pyx_pybuffer_allele_int32_batch.refcount = 0;
   __pyx_pybuffernd_allele_int32_batch.data = NULL;
   __pyx_pybuffernd_allele_int32_batch.rcbuffer = &__pyx_pybuffer_allele_int32_batch;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1780, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1891, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_batch.diminfo[0].strides = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_batch.diminfo[0].shape = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_batch.diminfo[1].strides = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.shape[1];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.all_phased = __pyx_v_all_phased;
   __pyx_t_2.allele_cts = __pyx_v_allele_cts;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenWriter->append_alleles_batch(__pyx_v_self, __pyx_v_allele_int32_batch, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1780, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenWriter->append_alleles_batch(__pyx_v_self, __pyx_v_allele_int32_batch, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1891, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -29957,15 +32678,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1846
+/* "pgenlib.pyx":1957
  * 
  * 
  *     cpdef append_partially_phased_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_batch, object allele_cts = None):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased_batch cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  */
 
@@ -30028,32 +32749,32 @@
   __pyx_pybuffernd_allele_int32_batch.rcbuffer = &__pyx_pybuffer_allele_int32_batch;
   __pyx_pybuffer_phasepresent_batch.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent_batch.refcount = 0;
   __pyx_pybuffernd_phasepresent_batch.data = NULL;
   __pyx_pybuffernd_phasepresent_batch.rcbuffer = &__pyx_pybuffer_phasepresent_batch;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1846, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1957, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_batch.diminfo[0].strides = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_batch.diminfo[0].shape = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_batch.diminfo[1].strides = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1846, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1957, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent_batch.diminfo[0].strides = __pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent_batch.diminfo[0].shape = __pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_phasepresent_batch.diminfo[1].strides = __pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_phasepresent_batch.diminfo[1].shape = __pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer.shape[1];
   /* Check if called by wrapper */
   if (unlikely(__pyx_skip_dispatch)) ;
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_partially_phased_batch); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1846, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_partially_phased_batch); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1957, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_17append_partially_phased_batch)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         __pyx_t_5 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
@@ -30065,43 +32786,43 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_5 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[4] = {__pyx_t_4, ((PyObject *)__pyx_v_allele_int32_batch), ((PyObject *)__pyx_v_phasepresent_batch), __pyx_v_allele_cts};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1846, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1957, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_2);
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[4] = {__pyx_t_4, ((PyObject *)__pyx_v_allele_int32_batch), ((PyObject *)__pyx_v_phasepresent_batch), __pyx_v_allele_cts};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1846, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1957, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_2);
         } else
         #endif
         {
-          __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1846, __pyx_L1_error)
+          __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1957, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           if (__pyx_t_4) {
             __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
           }
           __Pyx_INCREF(((PyObject *)__pyx_v_allele_int32_batch));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_allele_int32_batch));
           PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, ((PyObject *)__pyx_v_allele_int32_batch));
           __Pyx_INCREF(((PyObject *)__pyx_v_phasepresent_batch));
           __Pyx_GIVEREF(((PyObject *)__pyx_v_phasepresent_batch));
           PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, ((PyObject *)__pyx_v_phasepresent_batch));
           __Pyx_INCREF(__pyx_v_allele_cts);
           __Pyx_GIVEREF(__pyx_v_allele_cts);
           PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_5, __pyx_v_allele_cts);
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1846, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1957, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -30116,157 +32837,157 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1847
+  /* "pgenlib.pyx":1958
  * 
  *     cpdef append_partially_phased_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_batch, object allele_cts = None):
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased_batch cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  */
   __pyx_t_7 = (((__pyx_v_self->_phase_dosage_gflags & plink2::kfPgenGlobalHardcallPhasePresent) == 0) != 0);
   if (unlikely(__pyx_t_7)) {
 
-    /* "pgenlib.pyx":1848
+    /* "pgenlib.pyx":1959
  *     cpdef append_partially_phased_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_batch, object allele_cts = None):
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased_batch cannot be called when PgenWriter was constructed with hardcall_phase_present False")             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1848, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1959, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1848, __pyx_L1_error)
+    __PYX_ERR(0, 1959, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1847
+    /* "pgenlib.pyx":1958
  * 
  *     cpdef append_partially_phased_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_batch, object allele_cts = None):
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_partially_phased_batch cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  */
   }
 
-  /* "pgenlib.pyx":1849
+  /* "pgenlib.pyx":1960
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased_batch cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  */
   __pyx_v_batch_size = ((uint32_t)(__pyx_v_allele_int32_batch->dimensions[0]));
 
-  /* "pgenlib.pyx":1850
+  /* "pgenlib.pyx":1961
  *             raise RuntimeError("append_partially_phased_batch cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)             # <<<<<<<<<<<<<<
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec
  */
   __pyx_v_sample_ct = plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr);
 
-  /* "pgenlib.pyx":1851
+  /* "pgenlib.pyx":1962
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  */
   __pyx_t_8 = __pyx_v_self->_allele_ct_limit;
   __pyx_v_allele_ct_limit = __pyx_t_8;
 
-  /* "pgenlib.pyx":1852
+  /* "pgenlib.pyx":1963
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  */
   __pyx_t_9 = __pyx_v_self->_genovec;
   __pyx_v_genovec = __pyx_t_9;
 
-  /* "pgenlib.pyx":1853
+  /* "pgenlib.pyx":1964
  *         cdef uint32_t allele_ct_limit = self._allele_ct_limit
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* patch_01_set = self._patch_01_set             # <<<<<<<<<<<<<<
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  */
   __pyx_t_9 = __pyx_v_self->_patch_01_set;
   __pyx_v_patch_01_set = __pyx_t_9;
 
-  /* "pgenlib.pyx":1854
+  /* "pgenlib.pyx":1965
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  */
   __pyx_t_10 = __pyx_v_self->_patch_01_vals;
   __pyx_v_patch_01_vals = __pyx_t_10;
 
-  /* "pgenlib.pyx":1855
+  /* "pgenlib.pyx":1966
  *         cdef uintptr_t* patch_01_set = self._patch_01_set
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set             # <<<<<<<<<<<<<<
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  *         cdef uintptr_t* phasepresent_buf = self._phasepresent
  */
   __pyx_t_9 = __pyx_v_self->_patch_10_set;
   __pyx_v_patch_10_set = __pyx_t_9;
 
-  /* "pgenlib.pyx":1856
+  /* "pgenlib.pyx":1967
  *         cdef AlleleCode* patch_01_vals = self._patch_01_vals
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phasepresent_buf = self._phasepresent
  *         cdef uintptr_t* phaseinfo = self._phaseinfo
  */
   __pyx_t_10 = __pyx_v_self->_patch_10_vals;
   __pyx_v_patch_10_vals = __pyx_t_10;
 
-  /* "pgenlib.pyx":1857
+  /* "pgenlib.pyx":1968
  *         cdef uintptr_t* patch_10_set = self._patch_10_set
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  *         cdef uintptr_t* phasepresent_buf = self._phasepresent             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* phaseinfo = self._phaseinfo
  *         cdef int32_t* allele_codes
  */
   __pyx_t_9 = __pyx_v_self->_phasepresent;
   __pyx_v_phasepresent_buf = __pyx_t_9;
 
-  /* "pgenlib.pyx":1858
+  /* "pgenlib.pyx":1969
  *         cdef AlleleCode* patch_10_vals = self._patch_10_vals
  *         cdef uintptr_t* phasepresent_buf = self._phasepresent
  *         cdef uintptr_t* phaseinfo = self._phaseinfo             # <<<<<<<<<<<<<<
  *         cdef int32_t* allele_codes
  *         cdef unsigned char* phasepresent_bytes
  */
   __pyx_t_9 = __pyx_v_self->_phaseinfo;
   __pyx_v_phaseinfo = __pyx_t_9;
 
-  /* "pgenlib.pyx":1868
+  /* "pgenlib.pyx":1979
  *         cdef uint32_t patch_10_ct
  *         cdef PglErr reterr
  *         for uii in range(batch_size):             # <<<<<<<<<<<<<<
  *             allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *             phasepresent_bytes = <unsigned char*>(&(phasepresent_batch[uii, 0]))
  */
   __pyx_t_8 = __pyx_v_batch_size;
   __pyx_t_11 = __pyx_t_8;
   for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
     __pyx_v_uii = __pyx_t_12;
 
-    /* "pgenlib.pyx":1869
+    /* "pgenlib.pyx":1980
  *         cdef PglErr reterr
  *         for uii in range(batch_size):
  *             allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))             # <<<<<<<<<<<<<<
  *             phasepresent_bytes = <unsigned char*>(&(phasepresent_batch[uii, 0]))
  *             observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  */
     __pyx_t_13 = __pyx_v_uii;
@@ -30275,19 +32996,19 @@
     if (unlikely(__pyx_t_13 >= (size_t)__pyx_pybuffernd_allele_int32_batch.diminfo[0].shape)) __pyx_t_5 = 0;
     if (__pyx_t_14 < 0) {
       __pyx_t_14 += __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape;
       if (unlikely(__pyx_t_14 < 0)) __pyx_t_5 = 1;
     } else if (unlikely(__pyx_t_14 >= __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape)) __pyx_t_5 = 1;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      __PYX_ERR(0, 1869, __pyx_L1_error)
+      __PYX_ERR(0, 1980, __pyx_L1_error)
     }
     __pyx_v_allele_codes = ((int32_t *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_allele_int32_batch.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_allele_int32_batch.diminfo[1].strides))));
 
-    /* "pgenlib.pyx":1870
+    /* "pgenlib.pyx":1981
  *         for uii in range(batch_size):
  *             allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *             phasepresent_bytes = <unsigned char*>(&(phasepresent_batch[uii, 0]))             # <<<<<<<<<<<<<<
  *             observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  *             if observed_allele_ct == -1:
  */
     __pyx_t_13 = __pyx_v_uii;
@@ -30296,207 +33017,207 @@
     if (unlikely(__pyx_t_13 >= (size_t)__pyx_pybuffernd_phasepresent_batch.diminfo[0].shape)) __pyx_t_5 = 0;
     if (__pyx_t_14 < 0) {
       __pyx_t_14 += __pyx_pybuffernd_phasepresent_batch.diminfo[1].shape;
       if (unlikely(__pyx_t_14 < 0)) __pyx_t_5 = 1;
     } else if (unlikely(__pyx_t_14 >= __pyx_pybuffernd_phasepresent_batch.diminfo[1].shape)) __pyx_t_5 = 1;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      __PYX_ERR(0, 1870, __pyx_L1_error)
+      __PYX_ERR(0, 1981, __pyx_L1_error)
     }
     __pyx_v_phasepresent_bytes = ((unsigned char *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_uint8_t *, __pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_phasepresent_batch.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_phasepresent_batch.diminfo[1].strides))));
 
-    /* "pgenlib.pyx":1871
+    /* "pgenlib.pyx":1982
  *             allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  *             phasepresent_bytes = <unsigned char*>(&(phasepresent_batch[uii, 0]))
  *             observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)             # <<<<<<<<<<<<<<
  *             if observed_allele_ct == -1:
  *                 raise RuntimeError("append_partially_phased_batch called with invalid allele codes")
  */
     __pyx_v_observed_allele_ct = plink2::ConvertMultiAlleleCodesUnsafe(__pyx_v_allele_codes, __pyx_v_phasepresent_bytes, __pyx_v_sample_ct, __pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, (&__pyx_v_patch_01_ct), (&__pyx_v_patch_10_ct), __pyx_v_phasepresent_buf, __pyx_v_phaseinfo);
 
-    /* "pgenlib.pyx":1872
+    /* "pgenlib.pyx":1983
  *             phasepresent_bytes = <unsigned char*>(&(phasepresent_batch[uii, 0]))
  *             observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  *             if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased_batch called with invalid allele codes")
  *             write_allele_ct = <uint32_t>(observed_allele_ct)
  */
     __pyx_t_7 = ((__pyx_v_observed_allele_ct == -1L) != 0);
     if (unlikely(__pyx_t_7)) {
 
-      /* "pgenlib.pyx":1873
+      /* "pgenlib.pyx":1984
  *             observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  *             if observed_allele_ct == -1:
  *                 raise RuntimeError("append_partially_phased_batch called with invalid allele codes")             # <<<<<<<<<<<<<<
  *             write_allele_ct = <uint32_t>(observed_allele_ct)
  *             if write_allele_ct > allele_ct_limit:
  */
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1873, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1984, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1873, __pyx_L1_error)
+      __PYX_ERR(0, 1984, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1872
+      /* "pgenlib.pyx":1983
  *             phasepresent_bytes = <unsigned char*>(&(phasepresent_batch[uii, 0]))
  *             observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  *             if observed_allele_ct == -1:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased_batch called with invalid allele codes")
  *             write_allele_ct = <uint32_t>(observed_allele_ct)
  */
     }
 
-    /* "pgenlib.pyx":1874
+    /* "pgenlib.pyx":1985
  *             if observed_allele_ct == -1:
  *                 raise RuntimeError("append_partially_phased_batch called with invalid allele codes")
  *             write_allele_ct = <uint32_t>(observed_allele_ct)             # <<<<<<<<<<<<<<
  *             if write_allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  */
     __pyx_v_write_allele_ct = ((uint32_t)__pyx_v_observed_allele_ct);
 
-    /* "pgenlib.pyx":1875
+    /* "pgenlib.pyx":1986
  *                 raise RuntimeError("append_partially_phased_batch called with invalid allele codes")
  *             write_allele_ct = <uint32_t>(observed_allele_ct)
  *             if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *             if allele_cts is not None:
  */
     __pyx_t_7 = ((__pyx_v_write_allele_ct > __pyx_v_allele_ct_limit) != 0);
     if (unlikely(__pyx_t_7)) {
 
-      /* "pgenlib.pyx":1876
+      /* "pgenlib.pyx":1987
  *             write_allele_ct = <uint32_t>(observed_allele_ct)
  *             if write_allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")             # <<<<<<<<<<<<<<
  *             if allele_cts is not None:
  *                 casted_allele_ct = allele_cts[uii]
  */
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1876, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__50, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1987, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1876, __pyx_L1_error)
+      __PYX_ERR(0, 1987, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1875
+      /* "pgenlib.pyx":1986
  *                 raise RuntimeError("append_partially_phased_batch called with invalid allele codes")
  *             write_allele_ct = <uint32_t>(observed_allele_ct)
  *             if write_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *             if allele_cts is not None:
  */
     }
 
-    /* "pgenlib.pyx":1877
+    /* "pgenlib.pyx":1988
  *             if write_allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *             if allele_cts is not None:             # <<<<<<<<<<<<<<
  *                 casted_allele_ct = allele_cts[uii]
  *                 if casted_allele_ct < write_allele_ct:
  */
     __pyx_t_7 = (__pyx_v_allele_cts != Py_None);
     __pyx_t_15 = (__pyx_t_7 != 0);
     if (__pyx_t_15) {
 
-      /* "pgenlib.pyx":1878
+      /* "pgenlib.pyx":1989
  *                 raise RuntimeError("append_partially_phased_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *             if allele_cts is not None:
  *                 casted_allele_ct = allele_cts[uii]             # <<<<<<<<<<<<<<
  *                 if casted_allele_ct < write_allele_ct:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  */
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_allele_cts, __pyx_v_uii, uint32_t, 0, __Pyx_PyInt_From_uint32_t, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1878, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_allele_cts, __pyx_v_uii, uint32_t, 0, __Pyx_PyInt_From_uint32_t, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1989, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_16 = __Pyx_PyInt_As_uint32_t(__pyx_t_1); if (unlikely((__pyx_t_16 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1878, __pyx_L1_error)
+      __pyx_t_16 = __Pyx_PyInt_As_uint32_t(__pyx_t_1); if (unlikely((__pyx_t_16 == ((uint32_t)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1989, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_v_casted_allele_ct = __pyx_t_16;
 
-      /* "pgenlib.pyx":1879
+      /* "pgenlib.pyx":1990
  *             if allele_cts is not None:
  *                 casted_allele_ct = allele_cts[uii]
  *                 if casted_allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                 if casted_allele_ct > allele_ct_limit:
  */
       __pyx_t_15 = ((__pyx_v_casted_allele_ct < __pyx_v_write_allele_ct) != 0);
       if (unlikely(__pyx_t_15)) {
 
-        /* "pgenlib.pyx":1880
+        /* "pgenlib.pyx":1991
  *                 casted_allele_ct = allele_cts[uii]
  *                 if casted_allele_ct < write_allele_ct:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")             # <<<<<<<<<<<<<<
  *                 if casted_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  */
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1880, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1991, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 1880, __pyx_L1_error)
+        __PYX_ERR(0, 1991, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1879
+        /* "pgenlib.pyx":1990
  *             if allele_cts is not None:
  *                 casted_allele_ct = allele_cts[uii]
  *                 if casted_allele_ct < write_allele_ct:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                 if casted_allele_ct > allele_ct_limit:
  */
       }
 
-      /* "pgenlib.pyx":1881
+      /* "pgenlib.pyx":1992
  *                 if casted_allele_ct < write_allele_ct:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                 if casted_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                 write_allele_ct = casted_allele_ct
  */
       __pyx_t_15 = ((__pyx_v_casted_allele_ct > __pyx_v_allele_ct_limit) != 0);
       if (unlikely(__pyx_t_15)) {
 
-        /* "pgenlib.pyx":1882
+        /* "pgenlib.pyx":1993
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                 if casted_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")             # <<<<<<<<<<<<<<
  *                 write_allele_ct = casted_allele_ct
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):
  */
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1882, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1993, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __PYX_ERR(0, 1882, __pyx_L1_error)
+        __PYX_ERR(0, 1993, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1881
+        /* "pgenlib.pyx":1992
  *                 if casted_allele_ct < write_allele_ct:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                 if casted_allele_ct > allele_ct_limit:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                 write_allele_ct = casted_allele_ct
  */
       }
 
-      /* "pgenlib.pyx":1883
+      /* "pgenlib.pyx":1994
  *                 if casted_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                 write_allele_ct = casted_allele_ct             # <<<<<<<<<<<<<<
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                 reterr = SpgwAppendBiallelicGenovecHphase(genovec, phasepresent_buf, phaseinfo, self._state_ptr)
  */
       __pyx_v_write_allele_ct = __pyx_v_casted_allele_ct;
 
-      /* "pgenlib.pyx":1877
+      /* "pgenlib.pyx":1988
  *             if write_allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")
  *             if allele_cts is not None:             # <<<<<<<<<<<<<<
  *                 casted_allele_ct = allele_cts[uii]
  *                 if casted_allele_ct < write_allele_ct:
  */
     }
 
-    /* "pgenlib.pyx":1884
+    /* "pgenlib.pyx":1995
  *                     raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                 write_allele_ct = casted_allele_ct
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                 reterr = SpgwAppendBiallelicGenovecHphase(genovec, phasepresent_buf, phaseinfo, self._state_ptr)
  *             else:
  */
     __pyx_t_7 = ((__pyx_v_patch_01_ct == 0) != 0);
@@ -30506,99 +33227,99 @@
       goto __pyx_L12_bool_binop_done;
     }
     __pyx_t_7 = ((__pyx_v_patch_10_ct == 0) != 0);
     __pyx_t_15 = __pyx_t_7;
     __pyx_L12_bool_binop_done:;
     if (__pyx_t_15) {
 
-      /* "pgenlib.pyx":1885
+      /* "pgenlib.pyx":1996
  *                 write_allele_ct = casted_allele_ct
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):
  *                 reterr = SpgwAppendBiallelicGenovecHphase(genovec, phasepresent_buf, phaseinfo, self._state_ptr)             # <<<<<<<<<<<<<<
  *             else:
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  */
       __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovecHphase(__pyx_v_genovec, __pyx_v_phasepresent_buf, __pyx_v_phaseinfo, __pyx_v_self->_state_ptr);
 
-      /* "pgenlib.pyx":1884
+      /* "pgenlib.pyx":1995
  *                     raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  *                 write_allele_ct = casted_allele_ct
  *             if (patch_01_ct == 0) and (patch_10_ct == 0):             # <<<<<<<<<<<<<<
  *                 reterr = SpgwAppendBiallelicGenovecHphase(genovec, phasepresent_buf, phaseinfo, self._state_ptr)
  *             else:
  */
       goto __pyx_L11;
     }
 
-    /* "pgenlib.pyx":1887
+    /* "pgenlib.pyx":1998
  *                 reterr = SpgwAppendBiallelicGenovecHphase(genovec, phasepresent_buf, phaseinfo, self._state_ptr)
  *             else:
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_partially_phased_batch() error " + str(reterr))
  */
     /*else*/ {
       __pyx_v_reterr = plink2::SpgwAppendMultiallelicGenovecHphase(__pyx_v_genovec, __pyx_v_patch_01_set, __pyx_v_patch_01_vals, __pyx_v_patch_10_set, __pyx_v_patch_10_vals, __pyx_v_phasepresent_buf, __pyx_v_phaseinfo, __pyx_v_write_allele_ct, __pyx_v_patch_01_ct, __pyx_v_patch_10_ct, __pyx_v_self->_state_ptr);
     }
     __pyx_L11:;
 
-    /* "pgenlib.pyx":1888
+    /* "pgenlib.pyx":1999
  *             else:
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased_batch() error " + str(reterr))
  *         return
  */
     __pyx_t_15 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
     if (unlikely(__pyx_t_15)) {
 
-      /* "pgenlib.pyx":1889
+      /* "pgenlib.pyx":2000
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_partially_phased_batch() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-      __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1889, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2000, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1889, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2000, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_partially_phased_batch_er, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1889, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_partially_phased_batch_er, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2000, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1889, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2000, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1889, __pyx_L1_error)
+      __PYX_ERR(0, 2000, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1888
+      /* "pgenlib.pyx":1999
  *             else:
  *                 reterr = SpgwAppendMultiallelicGenovecHphase(genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, phasepresent_buf, phaseinfo, write_allele_ct, patch_01_ct, patch_10_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_partially_phased_batch() error " + str(reterr))
  *         return
  */
     }
   }
 
-  /* "pgenlib.pyx":1890
+  /* "pgenlib.pyx":2001
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_partially_phased_batch() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1846
+  /* "pgenlib.pyx":1957
  * 
  * 
  *     cpdef append_partially_phased_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_batch, object allele_cts = None):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased_batch cannot be called when PgenWriter was constructed with hardcall_phase_present False")
  */
 
@@ -30662,25 +33383,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_int32_batch)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_phasepresent_batch)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("append_partially_phased_batch", 0, 2, 3, 1); __PYX_ERR(0, 1846, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("append_partially_phased_batch", 0, 2, 3, 1); __PYX_ERR(0, 1957, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allele_cts);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "append_partially_phased_batch") < 0)) __PYX_ERR(0, 1846, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "append_partially_phased_batch") < 0)) __PYX_ERR(0, 1957, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -30690,22 +33411,22 @@
     }
     __pyx_v_allele_int32_batch = ((PyArrayObject *)values[0]);
     __pyx_v_phasepresent_batch = ((PyArrayObject *)values[1]);
     __pyx_v_allele_cts = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("append_partially_phased_batch", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1846, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("append_partially_phased_batch", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1957, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenWriter.append_partially_phased_batch", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_batch), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_batch", 0))) __PYX_ERR(0, 1846, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent_batch), __pyx_ptype_5numpy_ndarray, 1, "phasepresent_batch", 0))) __PYX_ERR(0, 1846, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_allele_int32_batch), __pyx_ptype_5numpy_ndarray, 1, "allele_int32_batch", 0))) __PYX_ERR(0, 1957, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_phasepresent_batch), __pyx_ptype_5numpy_ndarray, 1, "phasepresent_batch", 0))) __PYX_ERR(0, 1957, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter_16append_partially_phased_batch(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), __pyx_v_allele_int32_batch, __pyx_v_phasepresent_batch, __pyx_v_allele_cts);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -30732,26 +33453,26 @@
   __pyx_pybuffernd_allele_int32_batch.rcbuffer = &__pyx_pybuffer_allele_int32_batch;
   __pyx_pybuffer_phasepresent_batch.pybuffer.buf = NULL;
   __pyx_pybuffer_phasepresent_batch.refcount = 0;
   __pyx_pybuffernd_phasepresent_batch.data = NULL;
   __pyx_pybuffernd_phasepresent_batch.rcbuffer = &__pyx_pybuffer_phasepresent_batch;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1846, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_allele_int32_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1957, __pyx_L1_error)
   }
   __pyx_pybuffernd_allele_int32_batch.diminfo[0].strides = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_allele_int32_batch.diminfo[0].shape = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_allele_int32_batch.diminfo[1].strides = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_allele_int32_batch.diminfo[1].shape = __pyx_pybuffernd_allele_int32_batch.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1846, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_phasepresent_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 1957, __pyx_L1_error)
   }
   __pyx_pybuffernd_phasepresent_batch.diminfo[0].strides = __pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phasepresent_batch.diminfo[0].shape = __pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_phasepresent_batch.diminfo[1].strides = __pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_phasepresent_batch.diminfo[1].shape = __pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer.shape[1];
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.allele_cts = __pyx_v_allele_cts;
-  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenWriter->append_partially_phased_batch(__pyx_v_self, __pyx_v_allele_int32_batch, __pyx_v_phasepresent_batch, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1846, __pyx_L1_error)
+  __pyx_t_1 = __pyx_vtabptr_7pgenlib_PgenWriter->append_partially_phased_batch(__pyx_v_self, __pyx_v_allele_int32_batch, __pyx_v_phasepresent_batch, 1, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1957, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -30771,15 +33492,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phasepresent_batch.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1893
+/* "pgenlib.pyx":2004
  * 
  * 
  *     cdef append_dosages_batch_internal32(self, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_batch):             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>floatarr_batch.shape[0]
  *         cdef uintptr_t* genovec = self._genovec
  */
 
@@ -30812,70 +33533,70 @@
   __Pyx_RefNannySetupContext("append_dosages_batch_internal32", 0);
   __pyx_pybuffer_floatarr_batch.pybuffer.buf = NULL;
   __pyx_pybuffer_floatarr_batch.refcount = 0;
   __pyx_pybuffernd_floatarr_batch.data = NULL;
   __pyx_pybuffernd_floatarr_batch.rcbuffer = &__pyx_pybuffer_floatarr_batch;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1893, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_floatarr_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_floatarr_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2004, __pyx_L1_error)
   }
   __pyx_pybuffernd_floatarr_batch.diminfo[0].strides = __pyx_pybuffernd_floatarr_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_floatarr_batch.diminfo[0].shape = __pyx_pybuffernd_floatarr_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_floatarr_batch.diminfo[1].strides = __pyx_pybuffernd_floatarr_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_floatarr_batch.diminfo[1].shape = __pyx_pybuffernd_floatarr_batch.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":1894
+  /* "pgenlib.pyx":2005
  * 
  *     cdef append_dosages_batch_internal32(self, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_batch):
  *         cdef uint32_t batch_size = <uint32_t>floatarr_batch.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  */
   __pyx_v_batch_size = ((uint32_t)(__pyx_v_floatarr_batch->dimensions[0]));
 
-  /* "pgenlib.pyx":1895
+  /* "pgenlib.pyx":2006
  *     cdef append_dosages_batch_internal32(self, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_batch):
  *         cdef uint32_t batch_size = <uint32_t>floatarr_batch.shape[0]
  *         cdef uintptr_t* genovec = self._genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* dosage_present = self._dosage_present
  *         cdef uint16_t* dosage_main = self._dosage_main
  */
   __pyx_t_1 = __pyx_v_self->_genovec;
   __pyx_v_genovec = __pyx_t_1;
 
-  /* "pgenlib.pyx":1896
+  /* "pgenlib.pyx":2007
  *         cdef uint32_t batch_size = <uint32_t>floatarr_batch.shape[0]
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present             # <<<<<<<<<<<<<<
  *         cdef uint16_t* dosage_main = self._dosage_main
  *         cdef uint32_t dosage_ct
  */
   __pyx_t_1 = __pyx_v_self->_dosage_present;
   __pyx_v_dosage_present = __pyx_t_1;
 
-  /* "pgenlib.pyx":1897
+  /* "pgenlib.pyx":2008
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  *         cdef uint16_t* dosage_main = self._dosage_main             # <<<<<<<<<<<<<<
  *         cdef uint32_t dosage_ct
  *         cdef uint32_t uii
  */
   __pyx_t_2 = __pyx_v_self->_dosage_main;
   __pyx_v_dosage_main = __pyx_t_2;
 
-  /* "pgenlib.pyx":1901
+  /* "pgenlib.pyx":2012
  *         cdef uint32_t uii
  *         cdef PglErr reterr
  *         for uii in range(batch_size):             # <<<<<<<<<<<<<<
  *             FloatsToDosage16(<float*>(&(floatarr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  */
   __pyx_t_3 = __pyx_v_batch_size;
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_uii = __pyx_t_5;
 
-    /* "pgenlib.pyx":1902
+    /* "pgenlib.pyx":2013
  *         cdef PglErr reterr
  *         for uii in range(batch_size):
  *             FloatsToDosage16(<float*>(&(floatarr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)             # <<<<<<<<<<<<<<
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:
  */
     __pyx_t_6 = __pyx_v_uii;
@@ -30884,81 +33605,81 @@
     if (unlikely(__pyx_t_6 >= (size_t)__pyx_pybuffernd_floatarr_batch.diminfo[0].shape)) __pyx_t_8 = 0;
     if (__pyx_t_7 < 0) {
       __pyx_t_7 += __pyx_pybuffernd_floatarr_batch.diminfo[1].shape;
       if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 1;
     } else if (unlikely(__pyx_t_7 >= __pyx_pybuffernd_floatarr_batch.diminfo[1].shape)) __pyx_t_8 = 1;
     if (unlikely(__pyx_t_8 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_8);
-      __PYX_ERR(0, 1902, __pyx_L1_error)
+      __PYX_ERR(0, 2013, __pyx_L1_error)
     }
     plink2::FloatsToDosage16(((float *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_floatarr_batch.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_floatarr_batch.diminfo[0].strides, __pyx_t_7, __pyx_pybuffernd_floatarr_batch.diminfo[1].strides)))), plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr), 0x199A, __pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, (&__pyx_v_dosage_ct));
 
-    /* "pgenlib.pyx":1903
+    /* "pgenlib.pyx":2014
  *         for uii in range(batch_size):
  *             FloatsToDosage16(<float*>(&(floatarr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))
  */
     __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovecDosage16(__pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, __pyx_v_dosage_ct, __pyx_v_self->_state_ptr);
 
-    /* "pgenlib.pyx":1904
+    /* "pgenlib.pyx":2015
  *             FloatsToDosage16(<float*>(&(floatarr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))
  *         return
  */
     __pyx_t_9 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
     if (unlikely(__pyx_t_9)) {
 
-      /* "pgenlib.pyx":1905
+      /* "pgenlib.pyx":2016
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-      __pyx_t_10 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1905, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2016, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1905, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2016, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_dosages_batch_error, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1905, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_dosages_batch_error, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2016, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1905, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2016, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_Raise(__pyx_t_11, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __PYX_ERR(0, 1905, __pyx_L1_error)
+      __PYX_ERR(0, 2016, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1904
+      /* "pgenlib.pyx":2015
  *             FloatsToDosage16(<float*>(&(floatarr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))
  *         return
  */
     }
   }
 
-  /* "pgenlib.pyx":1906
+  /* "pgenlib.pyx":2017
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cdef append_dosages_batch_internal64(self, np.ndarray[np.float64_t,mode="c",ndim=2] doublearr_batch):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1893
+  /* "pgenlib.pyx":2004
  * 
  * 
  *     cdef append_dosages_batch_internal32(self, np.ndarray[np.float32_t,mode="c",ndim=2] floatarr_batch):             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>floatarr_batch.shape[0]
  *         cdef uintptr_t* genovec = self._genovec
  */
 
@@ -30979,15 +33700,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_floatarr_batch.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1908
+/* "pgenlib.pyx":2019
  *         return
  * 
  *     cdef append_dosages_batch_internal64(self, np.ndarray[np.float64_t,mode="c",ndim=2] doublearr_batch):             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>doublearr_batch.shape[0]
  *         cdef uintptr_t* genovec = self._genovec
  */
 
@@ -31020,70 +33741,70 @@
   __Pyx_RefNannySetupContext("append_dosages_batch_internal64", 0);
   __pyx_pybuffer_doublearr_batch.pybuffer.buf = NULL;
   __pyx_pybuffer_doublearr_batch.refcount = 0;
   __pyx_pybuffernd_doublearr_batch.data = NULL;
   __pyx_pybuffernd_doublearr_batch.rcbuffer = &__pyx_pybuffer_doublearr_batch;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_doublearr_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_doublearr_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1908, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_doublearr_batch.rcbuffer->pybuffer, (PyObject*)__pyx_v_doublearr_batch, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2019, __pyx_L1_error)
   }
   __pyx_pybuffernd_doublearr_batch.diminfo[0].strides = __pyx_pybuffernd_doublearr_batch.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_doublearr_batch.diminfo[0].shape = __pyx_pybuffernd_doublearr_batch.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_doublearr_batch.diminfo[1].strides = __pyx_pybuffernd_doublearr_batch.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_doublearr_batch.diminfo[1].shape = __pyx_pybuffernd_doublearr_batch.rcbuffer->pybuffer.shape[1];
 
-  /* "pgenlib.pyx":1909
+  /* "pgenlib.pyx":2020
  * 
  *     cdef append_dosages_batch_internal64(self, np.ndarray[np.float64_t,mode="c",ndim=2] doublearr_batch):
  *         cdef uint32_t batch_size = <uint32_t>doublearr_batch.shape[0]             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  */
   __pyx_v_batch_size = ((uint32_t)(__pyx_v_doublearr_batch->dimensions[0]));
 
-  /* "pgenlib.pyx":1910
+  /* "pgenlib.pyx":2021
  *     cdef append_dosages_batch_internal64(self, np.ndarray[np.float64_t,mode="c",ndim=2] doublearr_batch):
  *         cdef uint32_t batch_size = <uint32_t>doublearr_batch.shape[0]
  *         cdef uintptr_t* genovec = self._genovec             # <<<<<<<<<<<<<<
  *         cdef uintptr_t* dosage_present = self._dosage_present
  *         cdef uint16_t* dosage_main = self._dosage_main
  */
   __pyx_t_1 = __pyx_v_self->_genovec;
   __pyx_v_genovec = __pyx_t_1;
 
-  /* "pgenlib.pyx":1911
+  /* "pgenlib.pyx":2022
  *         cdef uint32_t batch_size = <uint32_t>doublearr_batch.shape[0]
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present             # <<<<<<<<<<<<<<
  *         cdef uint16_t* dosage_main = self._dosage_main
  *         cdef uint32_t dosage_ct
  */
   __pyx_t_1 = __pyx_v_self->_dosage_present;
   __pyx_v_dosage_present = __pyx_t_1;
 
-  /* "pgenlib.pyx":1912
+  /* "pgenlib.pyx":2023
  *         cdef uintptr_t* genovec = self._genovec
  *         cdef uintptr_t* dosage_present = self._dosage_present
  *         cdef uint16_t* dosage_main = self._dosage_main             # <<<<<<<<<<<<<<
  *         cdef uint32_t dosage_ct
  *         cdef uint32_t uii
  */
   __pyx_t_2 = __pyx_v_self->_dosage_main;
   __pyx_v_dosage_main = __pyx_t_2;
 
-  /* "pgenlib.pyx":1916
+  /* "pgenlib.pyx":2027
  *         cdef uint32_t uii
  *         cdef PglErr reterr
  *         for uii in range(batch_size):             # <<<<<<<<<<<<<<
  *             DoublesToDosage16(<double*>(&(doublearr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  */
   __pyx_t_3 = __pyx_v_batch_size;
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_uii = __pyx_t_5;
 
-    /* "pgenlib.pyx":1917
+    /* "pgenlib.pyx":2028
  *         cdef PglErr reterr
  *         for uii in range(batch_size):
  *             DoublesToDosage16(<double*>(&(doublearr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)             # <<<<<<<<<<<<<<
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:
  */
     __pyx_t_6 = __pyx_v_uii;
@@ -31092,81 +33813,81 @@
     if (unlikely(__pyx_t_6 >= (size_t)__pyx_pybuffernd_doublearr_batch.diminfo[0].shape)) __pyx_t_8 = 0;
     if (__pyx_t_7 < 0) {
       __pyx_t_7 += __pyx_pybuffernd_doublearr_batch.diminfo[1].shape;
       if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 1;
     } else if (unlikely(__pyx_t_7 >= __pyx_pybuffernd_doublearr_batch.diminfo[1].shape)) __pyx_t_8 = 1;
     if (unlikely(__pyx_t_8 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_8);
-      __PYX_ERR(0, 1917, __pyx_L1_error)
+      __PYX_ERR(0, 2028, __pyx_L1_error)
     }
     plink2::DoublesToDosage16(((double *)(&(*__Pyx_BufPtrCContig2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_doublearr_batch.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_doublearr_batch.diminfo[0].strides, __pyx_t_7, __pyx_pybuffernd_doublearr_batch.diminfo[1].strides)))), plink2::SpgwGetSampleCt(__pyx_v_self->_state_ptr), 0x199A, __pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, (&__pyx_v_dosage_ct));
 
-    /* "pgenlib.pyx":1918
+    /* "pgenlib.pyx":2029
  *         for uii in range(batch_size):
  *             DoublesToDosage16(<double*>(&(doublearr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)             # <<<<<<<<<<<<<<
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))
  */
     __pyx_v_reterr = plink2::SpgwAppendBiallelicGenovecDosage16(__pyx_v_genovec, __pyx_v_dosage_present, __pyx_v_dosage_main, __pyx_v_dosage_ct, __pyx_v_self->_state_ptr);
 
-    /* "pgenlib.pyx":1919
+    /* "pgenlib.pyx":2030
  *             DoublesToDosage16(<double*>(&(doublearr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))
  *         return
  */
     __pyx_t_9 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
     if (unlikely(__pyx_t_9)) {
 
-      /* "pgenlib.pyx":1920
+      /* "pgenlib.pyx":2031
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-      __pyx_t_10 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1920, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2031, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1920, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2031, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_dosages_batch_error, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1920, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyUnicode_Concat(__pyx_kp_u_append_dosages_batch_error, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2031, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1920, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2031, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_Raise(__pyx_t_11, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __PYX_ERR(0, 1920, __pyx_L1_error)
+      __PYX_ERR(0, 2031, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1919
+      /* "pgenlib.pyx":2030
  *             DoublesToDosage16(<double*>(&(doublearr_batch[uii, 0])), SpgwGetSampleCt(self._state_ptr), 6554, genovec, dosage_present, dosage_main, &dosage_ct)
  *             reterr = SpgwAppendBiallelicGenovecDosage16(genovec, dosage_present, dosage_main, dosage_ct, self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))
  *         return
  */
     }
   }
 
-  /* "pgenlib.pyx":1921
+  /* "pgenlib.pyx":2032
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("append_dosages_batch() error " + str(reterr))
  *         return             # <<<<<<<<<<<<<<
  * 
  *     cpdef append_dosages_batch(self, np.ndarray floatarr_batch):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1908
+  /* "pgenlib.pyx":2019
  *         return
  * 
  *     cdef append_dosages_batch_internal64(self, np.ndarray[np.float64_t,mode="c",ndim=2] doublearr_batch):             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>doublearr_batch.shape[0]
  *         cdef uintptr_t* genovec = self._genovec
  */
 
@@ -31187,15 +33908,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_doublearr_batch.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1923
+/* "pgenlib.pyx":2034
  *         return
  * 
  *     cpdef append_dosages_batch(self, np.ndarray floatarr_batch):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages_batch cannot be called when PgenWriter was constructed with dosage_present False")
  */
 
@@ -31217,15 +33938,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_dosages_batch); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1923, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_append_dosages_batch); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2034, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_19append_dosages_batch)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -31234,15 +33955,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_floatarr_batch)) : __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)__pyx_v_floatarr_batch));
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1923, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2034, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -31255,158 +33976,158 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1924
+  /* "pgenlib.pyx":2035
  * 
  *     cpdef append_dosages_batch(self, np.ndarray floatarr_batch):
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_dosages_batch cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr_batch.dtype == np.float32:
  */
   __pyx_t_5 = (((__pyx_v_self->_phase_dosage_gflags & plink2::kfPgenGlobalDosagePresent) == 0) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":1925
+    /* "pgenlib.pyx":2036
  *     cpdef append_dosages_batch(self, np.ndarray floatarr_batch):
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages_batch cannot be called when PgenWriter was constructed with dosage_present False")             # <<<<<<<<<<<<<<
  *         if floatarr_batch.dtype == np.float32:
  *             self.append_dosages_batch_internal32(floatarr_batch)
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1925, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2036, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1925, __pyx_L1_error)
+    __PYX_ERR(0, 2036, __pyx_L1_error)
 
-    /* "pgenlib.pyx":1924
+    /* "pgenlib.pyx":2035
  * 
  *     cpdef append_dosages_batch(self, np.ndarray floatarr_batch):
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:             # <<<<<<<<<<<<<<
  *             raise RuntimeError("append_dosages_batch cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr_batch.dtype == np.float32:
  */
   }
 
-  /* "pgenlib.pyx":1926
+  /* "pgenlib.pyx":2037
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages_batch cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr_batch.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             self.append_dosages_batch_internal32(floatarr_batch)
  *         elif floatarr_batch.dtype == np.float64:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_batch), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1926, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_batch), __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2037, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1926, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2037, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1926, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float32); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2037, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1926, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2037, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1926, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 2037, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":1927
+    /* "pgenlib.pyx":2038
  *             raise RuntimeError("append_dosages_batch cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr_batch.dtype == np.float32:
  *             self.append_dosages_batch_internal32(floatarr_batch)             # <<<<<<<<<<<<<<
  *         elif floatarr_batch.dtype == np.float64:
  *             self.append_dosages_batch_internal64(floatarr_batch)
  */
-    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->append_dosages_batch_internal32(__pyx_v_self, ((PyArrayObject *)__pyx_v_floatarr_batch)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1927, __pyx_L1_error)
+    __pyx_t_2 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->append_dosages_batch_internal32(__pyx_v_self, ((PyArrayObject *)__pyx_v_floatarr_batch)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2038, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "pgenlib.pyx":1926
+    /* "pgenlib.pyx":2037
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages_batch cannot be called when PgenWriter was constructed with dosage_present False")
  *         if floatarr_batch.dtype == np.float32:             # <<<<<<<<<<<<<<
  *             self.append_dosages_batch_internal32(floatarr_batch)
  *         elif floatarr_batch.dtype == np.float64:
  */
     goto __pyx_L4;
   }
 
-  /* "pgenlib.pyx":1928
+  /* "pgenlib.pyx":2039
  *         if floatarr_batch.dtype == np.float32:
  *             self.append_dosages_batch_internal32(floatarr_batch)
  *         elif floatarr_batch.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             self.append_dosages_batch_internal64(floatarr_batch)
  *         else:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_batch), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1928, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_floatarr_batch), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2039, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1928, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2039, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1928, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2039, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1928, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2039, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1928, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 2039, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (likely(__pyx_t_5)) {
 
-    /* "pgenlib.pyx":1929
+    /* "pgenlib.pyx":2040
  *             self.append_dosages_batch_internal32(floatarr_batch)
  *         elif floatarr_batch.dtype == np.float64:
  *             self.append_dosages_batch_internal64(floatarr_batch)             # <<<<<<<<<<<<<<
  *         else:
  *             raise RuntimeError("Invalid append_dosages_batch() dosage array element type (float32 or float64 expected).")
  */
-    __pyx_t_3 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->append_dosages_batch_internal64(__pyx_v_self, ((PyArrayObject *)__pyx_v_floatarr_batch)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1929, __pyx_L1_error)
+    __pyx_t_3 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->append_dosages_batch_internal64(__pyx_v_self, ((PyArrayObject *)__pyx_v_floatarr_batch)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2040, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "pgenlib.pyx":1928
+    /* "pgenlib.pyx":2039
  *         if floatarr_batch.dtype == np.float32:
  *             self.append_dosages_batch_internal32(floatarr_batch)
  *         elif floatarr_batch.dtype == np.float64:             # <<<<<<<<<<<<<<
  *             self.append_dosages_batch_internal64(floatarr_batch)
  *         else:
  */
     goto __pyx_L4;
   }
 
-  /* "pgenlib.pyx":1931
+  /* "pgenlib.pyx":2042
  *             self.append_dosages_batch_internal64(floatarr_batch)
  *         else:
  *             raise RuntimeError("Invalid append_dosages_batch() dosage array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   /*else*/ {
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1931, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2042, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 1931, __pyx_L1_error)
+    __PYX_ERR(0, 2042, __pyx_L1_error)
   }
   __pyx_L4:;
 
-  /* "pgenlib.pyx":1932
+  /* "pgenlib.pyx":2043
  *         else:
  *             raise RuntimeError("Invalid append_dosages_batch() dosage array element type (float32 or float64 expected).")
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1923
+  /* "pgenlib.pyx":2034
  *         return
  * 
  *     cpdef append_dosages_batch(self, np.ndarray floatarr_batch):             # <<<<<<<<<<<<<<
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages_batch cannot be called when PgenWriter was constructed with dosage_present False")
  */
 
@@ -31429,15 +34150,15 @@
 static PyObject *__pyx_pw_7pgenlib_10PgenWriter_19append_dosages_batch(PyObject *__pyx_v_self, PyObject *__pyx_v_floatarr_batch) {
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("append_dosages_batch (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr_batch), __pyx_ptype_5numpy_ndarray, 1, "floatarr_batch", 0))) __PYX_ERR(0, 1923, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_floatarr_batch), __pyx_ptype_5numpy_ndarray, 1, "floatarr_batch", 0))) __PYX_ERR(0, 2034, __pyx_L1_error)
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter_18append_dosages_batch(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), ((PyArrayObject *)__pyx_v_floatarr_batch));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -31450,15 +34171,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("append_dosages_batch", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_append_dosages_batch(__pyx_v_self, __pyx_v_floatarr_batch, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1923, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_append_dosages_batch(__pyx_v_self, __pyx_v_floatarr_batch, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2034, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -31467,15 +34188,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1935
+/* "pgenlib.pyx":2046
  * 
  * 
  *     cpdef close(self):             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:
  */
 
@@ -31498,15 +34219,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_close); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1935, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_close); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2046, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_21close)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -31515,15 +34236,15 @@
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1935, __pyx_L1_error)
+        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2046, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
@@ -31536,206 +34257,206 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1936
+  /* "pgenlib.pyx":2047
  * 
  *     cpdef close(self):
  *         cdef PglErr reterr = kPglRetSuccess             # <<<<<<<<<<<<<<
  *         if self._state_ptr:
  *             if SpgwGetVidx(self._state_ptr) != SpgwGetVariantCt(self._state_ptr):
  */
   __pyx_v_reterr = plink2::kPglRetSuccess;
 
-  /* "pgenlib.pyx":1937
+  /* "pgenlib.pyx":2048
  *     cpdef close(self):
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:             # <<<<<<<<<<<<<<
  *             if SpgwGetVidx(self._state_ptr) != SpgwGetVariantCt(self._state_ptr):
  *                 raise RuntimeError("PgenWriter.close() called when number of written variants (" + str(SpgwGetVidx(self._state_ptr)) + ") unequal to initially declared value (" + str(SpgwGetVariantCt(self._state_ptr)) + ").")
  */
   __pyx_t_5 = (__pyx_v_self->_state_ptr != 0);
   if (__pyx_t_5) {
 
-    /* "pgenlib.pyx":1938
+    /* "pgenlib.pyx":2049
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:
  *             if SpgwGetVidx(self._state_ptr) != SpgwGetVariantCt(self._state_ptr):             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("PgenWriter.close() called when number of written variants (" + str(SpgwGetVidx(self._state_ptr)) + ") unequal to initially declared value (" + str(SpgwGetVariantCt(self._state_ptr)) + ").")
  *             reterr = SpgwFinish(self._state_ptr)
  */
     __pyx_t_5 = ((plink2::SpgwGetVidx(__pyx_v_self->_state_ptr) != plink2::SpgwGetVariantCt(__pyx_v_self->_state_ptr)) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":1939
+      /* "pgenlib.pyx":2050
  *         if self._state_ptr:
  *             if SpgwGetVidx(self._state_ptr) != SpgwGetVariantCt(self._state_ptr):
  *                 raise RuntimeError("PgenWriter.close() called when number of written variants (" + str(SpgwGetVidx(self._state_ptr)) + ") unequal to initially declared value (" + str(SpgwGetVariantCt(self._state_ptr)) + ").")             # <<<<<<<<<<<<<<
  *             reterr = SpgwFinish(self._state_ptr)
  *             if reterr != kPglRetSuccess:
  */
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(plink2::SpgwGetVidx(__pyx_v_self->_state_ptr)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1939, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(plink2::SpgwGetVidx(__pyx_v_self->_state_ptr)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2050, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1939, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2050, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_PgenWriter_close_called_when_num, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1939, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_PgenWriter_close_called_when_num, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2050, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_unequal_to_initially_declared_v); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1939, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u_unequal_to_initially_declared_v); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2050, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(plink2::SpgwGetVariantCt(__pyx_v_self->_state_ptr)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1939, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_uint32_t(plink2::SpgwGetVariantCt(__pyx_v_self->_state_ptr)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2050, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1939, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2050, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1939, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2050, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1939, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_t_1, __pyx_kp_u__8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2050, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1939, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2050, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 1939, __pyx_L1_error)
+      __PYX_ERR(0, 2050, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1938
+      /* "pgenlib.pyx":2049
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:
  *             if SpgwGetVidx(self._state_ptr) != SpgwGetVariantCt(self._state_ptr):             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("PgenWriter.close() called when number of written variants (" + str(SpgwGetVidx(self._state_ptr)) + ") unequal to initially declared value (" + str(SpgwGetVariantCt(self._state_ptr)) + ").")
  *             reterr = SpgwFinish(self._state_ptr)
  */
     }
 
-    /* "pgenlib.pyx":1940
+    /* "pgenlib.pyx":2051
  *             if SpgwGetVidx(self._state_ptr) != SpgwGetVariantCt(self._state_ptr):
  *                 raise RuntimeError("PgenWriter.close() called when number of written variants (" + str(SpgwGetVidx(self._state_ptr)) + ") unequal to initially declared value (" + str(SpgwGetVariantCt(self._state_ptr)) + ").")
  *             reterr = SpgwFinish(self._state_ptr)             # <<<<<<<<<<<<<<
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("PgenWriter.close(): SpgwFinish() error " + str(reterr))
  */
     __pyx_v_reterr = plink2::SpgwFinish(__pyx_v_self->_state_ptr);
 
-    /* "pgenlib.pyx":1941
+    /* "pgenlib.pyx":2052
  *                 raise RuntimeError("PgenWriter.close() called when number of written variants (" + str(SpgwGetVidx(self._state_ptr)) + ") unequal to initially declared value (" + str(SpgwGetVariantCt(self._state_ptr)) + ").")
  *             reterr = SpgwFinish(self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("PgenWriter.close(): SpgwFinish() error " + str(reterr))
  *             if self._nonref_flags:
  */
     __pyx_t_5 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "pgenlib.pyx":1942
+      /* "pgenlib.pyx":2053
  *             reterr = SpgwFinish(self._state_ptr)
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("PgenWriter.close(): SpgwFinish() error " + str(reterr))             # <<<<<<<<<<<<<<
  *             if self._nonref_flags:
  *                 aligned_free(self._nonref_flags)
  */
-      __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1942, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2053, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1942, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2053, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_PgenWriter_close_SpgwFinish_erro, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1942, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_kp_u_PgenWriter_close_SpgwFinish_erro, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2053, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1942, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2053, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(0, 1942, __pyx_L1_error)
+      __PYX_ERR(0, 2053, __pyx_L1_error)
 
-      /* "pgenlib.pyx":1941
+      /* "pgenlib.pyx":2052
  *                 raise RuntimeError("PgenWriter.close() called when number of written variants (" + str(SpgwGetVidx(self._state_ptr)) + ") unequal to initially declared value (" + str(SpgwGetVariantCt(self._state_ptr)) + ").")
  *             reterr = SpgwFinish(self._state_ptr)
  *             if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                 raise RuntimeError("PgenWriter.close(): SpgwFinish() error " + str(reterr))
  *             if self._nonref_flags:
  */
     }
 
-    /* "pgenlib.pyx":1943
+    /* "pgenlib.pyx":2054
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("PgenWriter.close(): SpgwFinish() error " + str(reterr))
  *             if self._nonref_flags:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._nonref_flags)
  *             PyMem_Free(self._state_ptr)
  */
     __pyx_t_5 = (__pyx_v_self->_nonref_flags != 0);
     if (__pyx_t_5) {
 
-      /* "pgenlib.pyx":1944
+      /* "pgenlib.pyx":2055
  *                 raise RuntimeError("PgenWriter.close(): SpgwFinish() error " + str(reterr))
  *             if self._nonref_flags:
  *                 aligned_free(self._nonref_flags)             # <<<<<<<<<<<<<<
  *             PyMem_Free(self._state_ptr)
  *             self._state_ptr = NULL
  */
       plink2::aligned_free(__pyx_v_self->_nonref_flags);
 
-      /* "pgenlib.pyx":1943
+      /* "pgenlib.pyx":2054
  *             if reterr != kPglRetSuccess:
  *                 raise RuntimeError("PgenWriter.close(): SpgwFinish() error " + str(reterr))
  *             if self._nonref_flags:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._nonref_flags)
  *             PyMem_Free(self._state_ptr)
  */
     }
 
-    /* "pgenlib.pyx":1945
+    /* "pgenlib.pyx":2056
  *             if self._nonref_flags:
  *                 aligned_free(self._nonref_flags)
  *             PyMem_Free(self._state_ptr)             # <<<<<<<<<<<<<<
  *             self._state_ptr = NULL
  *         return
  */
     PyMem_Free(__pyx_v_self->_state_ptr);
 
-    /* "pgenlib.pyx":1946
+    /* "pgenlib.pyx":2057
  *                 aligned_free(self._nonref_flags)
  *             PyMem_Free(self._state_ptr)
  *             self._state_ptr = NULL             # <<<<<<<<<<<<<<
  *         return
  * 
  */
     __pyx_v_self->_state_ptr = NULL;
 
-    /* "pgenlib.pyx":1937
+    /* "pgenlib.pyx":2048
  *     cpdef close(self):
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:             # <<<<<<<<<<<<<<
  *             if SpgwGetVidx(self._state_ptr) != SpgwGetVariantCt(self._state_ptr):
  *                 raise RuntimeError("PgenWriter.close() called when number of written variants (" + str(SpgwGetVidx(self._state_ptr)) + ") unequal to initially declared value (" + str(SpgwGetVariantCt(self._state_ptr)) + ").")
  */
   }
 
-  /* "pgenlib.pyx":1947
+  /* "pgenlib.pyx":2058
  *             PyMem_Free(self._state_ptr)
  *             self._state_ptr = NULL
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1935
+  /* "pgenlib.pyx":2046
  * 
  * 
  *     cpdef close(self):             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:
  */
 
@@ -31771,15 +34492,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("close", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_close(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1935, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter_close(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2046, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -31788,15 +34509,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1950
+/* "pgenlib.pyx":2061
  * 
  * 
  *     cpdef __exit__(self, exc_type, exc_val, exc_tb):             # <<<<<<<<<<<<<<
  *         self.close()
  *         return
  */
 
@@ -31819,15 +34540,15 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))->tp_flags & (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_exit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1950, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_exit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_7pgenlib_10PgenWriter_23__exit__)) {
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
         __pyx_t_5 = 0;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
@@ -31839,43 +34560,43 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_5 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb};
-          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1950, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2061, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_2);
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb};
-          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1950, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2061, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_2);
         } else
         #endif
         {
-          __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1950, __pyx_L1_error)
+          __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2061, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           if (__pyx_t_4) {
             __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
           }
           __Pyx_INCREF(__pyx_v_exc_type);
           __Pyx_GIVEREF(__pyx_v_exc_type);
           PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_exc_type);
           __Pyx_INCREF(__pyx_v_exc_val);
           __Pyx_GIVEREF(__pyx_v_exc_val);
           PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_exc_val);
           __Pyx_INCREF(__pyx_v_exc_tb);
           __Pyx_GIVEREF(__pyx_v_exc_tb);
           PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_5, __pyx_v_exc_tb);
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1950, __pyx_L1_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2061, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -31890,37 +34611,37 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pgenlib.pyx":1951
+  /* "pgenlib.pyx":2062
  * 
  *     cpdef __exit__(self, exc_type, exc_val, exc_tb):
  *         self.close()             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->close(__pyx_v_self, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1951, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_7pgenlib_PgenWriter *)__pyx_v_self->__pyx_vtab)->close(__pyx_v_self, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pgenlib.pyx":1952
+  /* "pgenlib.pyx":2063
  *     cpdef __exit__(self, exc_type, exc_val, exc_tb):
  *         self.close()
  *         return             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1950
+  /* "pgenlib.pyx":2061
  * 
  * 
  *     cpdef __exit__(self, exc_type, exc_val, exc_tb):             # <<<<<<<<<<<<<<
  *         self.close()
  *         return
  */
 
@@ -31972,40 +34693,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exc_type)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exc_val)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 1); __PYX_ERR(0, 1950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 1); __PYX_ERR(0, 2061, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exc_tb)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 2); __PYX_ERR(0, 1950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, 2); __PYX_ERR(0, 2061, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__exit__") < 0)) __PYX_ERR(0, 1950, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__exit__") < 0)) __PYX_ERR(0, 2061, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_exc_type = values[0];
     __pyx_v_exc_val = values[1];
     __pyx_v_exc_tb = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1950, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__exit__", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 2061, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("pgenlib.PgenWriter.__exit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_7pgenlib_10PgenWriter_22__exit__(((struct __pyx_obj_7pgenlib_PgenWriter *)__pyx_v_self), __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb);
 
@@ -32019,15 +34740,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__exit__", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter___exit__(__pyx_v_self, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1950, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_7pgenlib_10PgenWriter___exit__(__pyx_v_self, __pyx_v_exc_type, __pyx_v_exc_val, __pyx_v_exc_tb, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -32036,15 +34757,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pgenlib.pyx":1955
+/* "pgenlib.pyx":2066
  * 
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:
  */
 
@@ -32066,168 +34787,168 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__dealloc__", 0);
 
-  /* "pgenlib.pyx":1956
+  /* "pgenlib.pyx":2067
  * 
  *     def __dealloc__(self):
  *         cdef PglErr reterr = kPglRetSuccess             # <<<<<<<<<<<<<<
  *         if self._state_ptr:
  *             if SpgwGetVidx(self._state_ptr) == SpgwGetVariantCt(self._state_ptr):
  */
   __pyx_v_reterr = plink2::kPglRetSuccess;
 
-  /* "pgenlib.pyx":1957
+  /* "pgenlib.pyx":2068
  *     def __dealloc__(self):
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:             # <<<<<<<<<<<<<<
  *             if SpgwGetVidx(self._state_ptr) == SpgwGetVariantCt(self._state_ptr):
  *                 reterr = SpgwFinish(self._state_ptr)
  */
   __pyx_t_1 = (__pyx_v_self->_state_ptr != 0);
   if (__pyx_t_1) {
 
-    /* "pgenlib.pyx":1958
+    /* "pgenlib.pyx":2069
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:
  *             if SpgwGetVidx(self._state_ptr) == SpgwGetVariantCt(self._state_ptr):             # <<<<<<<<<<<<<<
  *                 reterr = SpgwFinish(self._state_ptr)
  *                 if reterr != kPglRetSuccess:
  */
     __pyx_t_1 = ((plink2::SpgwGetVidx(__pyx_v_self->_state_ptr) == plink2::SpgwGetVariantCt(__pyx_v_self->_state_ptr)) != 0);
     if (__pyx_t_1) {
 
-      /* "pgenlib.pyx":1959
+      /* "pgenlib.pyx":2070
  *         if self._state_ptr:
  *             if SpgwGetVidx(self._state_ptr) == SpgwGetVariantCt(self._state_ptr):
  *                 reterr = SpgwFinish(self._state_ptr)             # <<<<<<<<<<<<<<
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("PgenWriter.__dealloc__(): SpgwFinish() error " + str(reterr))
  */
       __pyx_v_reterr = plink2::SpgwFinish(__pyx_v_self->_state_ptr);
 
-      /* "pgenlib.pyx":1960
+      /* "pgenlib.pyx":2071
  *             if SpgwGetVidx(self._state_ptr) == SpgwGetVariantCt(self._state_ptr):
  *                 reterr = SpgwFinish(self._state_ptr)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("PgenWriter.__dealloc__(): SpgwFinish() error " + str(reterr))
  *             else:
  */
       __pyx_t_1 = ((__pyx_v_reterr != plink2::kPglRetSuccess) != 0);
       if (unlikely(__pyx_t_1)) {
 
-        /* "pgenlib.pyx":1961
+        /* "pgenlib.pyx":2072
  *                 reterr = SpgwFinish(self._state_ptr)
  *                 if reterr != kPglRetSuccess:
  *                     raise RuntimeError("PgenWriter.__dealloc__(): SpgwFinish() error " + str(reterr))             # <<<<<<<<<<<<<<
  *             else:
  *                 CleanupSpgw(self._state_ptr, &reterr)
  */
-        __pyx_t_2 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1961, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyInt_From_plink2_3a__3a_PglErr(__pyx_v_reterr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2072, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1961, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2072, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_PgenWriter___dealloc___SpgwFinis, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1961, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_PgenWriter___dealloc___SpgwFinis, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2072, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1961, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_RuntimeError, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2072, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_Raise(__pyx_t_3, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __PYX_ERR(0, 1961, __pyx_L1_error)
+        __PYX_ERR(0, 2072, __pyx_L1_error)
 
-        /* "pgenlib.pyx":1960
+        /* "pgenlib.pyx":2071
  *             if SpgwGetVidx(self._state_ptr) == SpgwGetVariantCt(self._state_ptr):
  *                 reterr = SpgwFinish(self._state_ptr)
  *                 if reterr != kPglRetSuccess:             # <<<<<<<<<<<<<<
  *                     raise RuntimeError("PgenWriter.__dealloc__(): SpgwFinish() error " + str(reterr))
  *             else:
  */
       }
 
-      /* "pgenlib.pyx":1958
+      /* "pgenlib.pyx":2069
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:
  *             if SpgwGetVidx(self._state_ptr) == SpgwGetVariantCt(self._state_ptr):             # <<<<<<<<<<<<<<
  *                 reterr = SpgwFinish(self._state_ptr)
  *                 if reterr != kPglRetSuccess:
  */
       goto __pyx_L4;
     }
 
-    /* "pgenlib.pyx":1963
+    /* "pgenlib.pyx":2074
  *                     raise RuntimeError("PgenWriter.__dealloc__(): SpgwFinish() error " + str(reterr))
  *             else:
  *                 CleanupSpgw(self._state_ptr, &reterr)             # <<<<<<<<<<<<<<
  *             if self._nonref_flags:
  *                 aligned_free(self._nonref_flags)
  */
     /*else*/ {
       (void)(plink2::CleanupSpgw(__pyx_v_self->_state_ptr, (&__pyx_v_reterr)));
     }
     __pyx_L4:;
 
-    /* "pgenlib.pyx":1964
+    /* "pgenlib.pyx":2075
  *             else:
  *                 CleanupSpgw(self._state_ptr, &reterr)
  *             if self._nonref_flags:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._nonref_flags)
  *             PyMem_Free(self._state_ptr)
  */
     __pyx_t_1 = (__pyx_v_self->_nonref_flags != 0);
     if (__pyx_t_1) {
 
-      /* "pgenlib.pyx":1965
+      /* "pgenlib.pyx":2076
  *                 CleanupSpgw(self._state_ptr, &reterr)
  *             if self._nonref_flags:
  *                 aligned_free(self._nonref_flags)             # <<<<<<<<<<<<<<
  *             PyMem_Free(self._state_ptr)
  *         return
  */
       plink2::aligned_free(__pyx_v_self->_nonref_flags);
 
-      /* "pgenlib.pyx":1964
+      /* "pgenlib.pyx":2075
  *             else:
  *                 CleanupSpgw(self._state_ptr, &reterr)
  *             if self._nonref_flags:             # <<<<<<<<<<<<<<
  *                 aligned_free(self._nonref_flags)
  *             PyMem_Free(self._state_ptr)
  */
     }
 
-    /* "pgenlib.pyx":1966
+    /* "pgenlib.pyx":2077
  *             if self._nonref_flags:
  *                 aligned_free(self._nonref_flags)
  *             PyMem_Free(self._state_ptr)             # <<<<<<<<<<<<<<
  *         return
  */
     PyMem_Free(__pyx_v_self->_state_ptr);
 
-    /* "pgenlib.pyx":1957
+    /* "pgenlib.pyx":2068
  *     def __dealloc__(self):
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:             # <<<<<<<<<<<<<<
  *             if SpgwGetVidx(self._state_ptr) == SpgwGetVariantCt(self._state_ptr):
  *                 reterr = SpgwFinish(self._state_ptr)
  */
   }
 
-  /* "pgenlib.pyx":1967
+  /* "pgenlib.pyx":2078
  *                 aligned_free(self._nonref_flags)
  *             PyMem_Free(self._state_ptr)
  *         return             # <<<<<<<<<<<<<<
  */
   goto __pyx_L0;
 
-  /* "pgenlib.pyx":1955
+  /* "pgenlib.pyx":2066
  * 
  * 
  *     def __dealloc__(self):             # <<<<<<<<<<<<<<
  *         cdef PglErr reterr = kPglRetSuccess
  *         if self._state_ptr:
  */
 
@@ -32270,15 +34991,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__50, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -32326,15 +35047,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(1, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -32349,15 +35070,15 @@
   __Pyx_AddTraceback("pgenlib.PgenWriter.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":735
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -32366,29 +35087,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":736
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":736
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":735
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -32399,15 +35120,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":738
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -32416,29 +35137,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":739
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":739
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":738
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -32449,15 +35170,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":741
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -32466,29 +35187,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":742
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":742
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 742, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":741
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -32499,15 +35220,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":744
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -32516,29 +35237,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":745
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":745
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 745, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":744
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -32549,15 +35270,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":747
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -32566,29 +35287,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":748
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":748
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 748, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":747
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -32599,212 +35320,212 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":750
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":751
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":752
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":752
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":751
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":754
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":754
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":750
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":929
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("set_array_base", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":930
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":930
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":931
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":931
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":929
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":933
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":934
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":934
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":935
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":936
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":936
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":935
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":937
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":937
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":933
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":941
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -32820,15 +35541,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":942
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -32836,84 +35557,84 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":943
+      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":943
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 943, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":942
+      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":944
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":944
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 944, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":945
+      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 945, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 945, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 945, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":942
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":941
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -32928,15 +35649,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":947
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -32952,15 +35673,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":948
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -32968,84 +35689,84 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":949
+      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":949
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 949, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":948
+      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":950
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":950
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 950, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":951
+      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 951, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 951, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 951, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":948
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":947
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -33060,15 +35781,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":953
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -33084,15 +35805,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":954
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -33100,84 +35821,84 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":955
+      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":955
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 955, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":954
+      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":956
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":956
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 956, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":957
+      /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":957
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 957, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 957, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 957, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":954
+    /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":953
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -33192,187 +35913,310 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":967
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":967
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":979
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":979
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":967
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":967
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":982
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":982
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":994
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":994
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":982
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":982
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":997
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":997
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":1004
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":1004
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":997
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":997
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":1007
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":1007
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":1011
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":1011
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":1007
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":1007
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":1014
+/* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":1018
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":1018
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":1014
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
+static struct __pyx_vtabstruct_7pgenlib_PvarReader __pyx_vtable_7pgenlib_PvarReader;
+
+static PyObject *__pyx_tp_new_7pgenlib_PvarReader(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_7pgenlib_PvarReader *p;
+  PyObject *o;
+  if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
+    o = (*t->tp_alloc)(t, 0);
+  } else {
+    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_empty_tuple, 0);
+  }
+  if (unlikely(!o)) return 0;
+  p = ((struct __pyx_obj_7pgenlib_PvarReader *)o);
+  p->__pyx_vtab = __pyx_vtabptr_7pgenlib_PvarReader;
+  if (unlikely(__pyx_pw_7pgenlib_10PvarReader_1__cinit__(o, a, k) < 0)) goto bad;
+  return o;
+  bad:
+  Py_DECREF(o); o = 0;
+  return NULL;
+}
+
+static void __pyx_tp_dealloc_7pgenlib_PvarReader(PyObject *o) {
+  #if CYTHON_USE_TP_FINALIZE
+  if (unlikely(PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE) && Py_TYPE(o)->tp_finalize) && (!PyType_IS_GC(Py_TYPE(o)) || !_PyGC_FINALIZED(o))) {
+    if (PyObject_CallFinalizerFromDealloc(o)) return;
+  }
+  #endif
+  {
+    PyObject *etype, *eval, *etb;
+    PyErr_Fetch(&etype, &eval, &etb);
+    __Pyx_SET_REFCNT(o, Py_REFCNT(o) + 1);
+    __pyx_pw_7pgenlib_10PvarReader_21__dealloc__(o);
+    __Pyx_SET_REFCNT(o, Py_REFCNT(o) - 1);
+    PyErr_Restore(etype, eval, etb);
+  }
+  (*Py_TYPE(o)->tp_free)(o);
+}
+
+static PyMethodDef __pyx_methods_7pgenlib_PvarReader[] = {
+  {"__enter__", (PyCFunction)__pyx_pw_7pgenlib_10PvarReader_3__enter__, METH_NOARGS, 0},
+  {"get_variant_ct", (PyCFunction)__pyx_pw_7pgenlib_10PvarReader_5get_variant_ct, METH_NOARGS, 0},
+  {"get_variant_id", (PyCFunction)__pyx_pw_7pgenlib_10PvarReader_7get_variant_id, METH_O, 0},
+  {"get_allele_ct", (PyCFunction)__pyx_pw_7pgenlib_10PvarReader_9get_allele_ct, METH_O, 0},
+  {"get_allele_code", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pgenlib_10PvarReader_11get_allele_code, METH_VARARGS|METH_KEYWORDS, 0},
+  {"get_allele_idx_offsets", (PyCFunction)__pyx_pw_7pgenlib_10PvarReader_13get_allele_idx_offsets, METH_NOARGS, 0},
+  {"get_max_allele_ct", (PyCFunction)__pyx_pw_7pgenlib_10PvarReader_15get_max_allele_ct, METH_NOARGS, 0},
+  {"close", (PyCFunction)__pyx_pw_7pgenlib_10PvarReader_17close, METH_NOARGS, 0},
+  {"__exit__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7pgenlib_10PvarReader_19__exit__, METH_VARARGS|METH_KEYWORDS, 0},
+  {"__reduce_cython__", (PyCFunction)__pyx_pw_7pgenlib_10PvarReader_23__reduce_cython__, METH_NOARGS, 0},
+  {"__setstate_cython__", (PyCFunction)__pyx_pw_7pgenlib_10PvarReader_25__setstate_cython__, METH_O, 0},
+  {0, 0, 0, 0}
+};
+
+static PyTypeObject __pyx_type_7pgenlib_PvarReader = {
+  PyVarObject_HEAD_INIT(0, 0)
+  "pgenlib.PvarReader", /*tp_name*/
+  sizeof(struct __pyx_obj_7pgenlib_PvarReader), /*tp_basicsize*/
+  0, /*tp_itemsize*/
+  __pyx_tp_dealloc_7pgenlib_PvarReader, /*tp_dealloc*/
+  #if PY_VERSION_HEX < 0x030800b4
+  0, /*tp_print*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4
+  0, /*tp_vectorcall_offset*/
+  #endif
+  0, /*tp_getattr*/
+  0, /*tp_setattr*/
+  #if PY_MAJOR_VERSION < 3
+  0, /*tp_compare*/
+  #endif
+  #if PY_MAJOR_VERSION >= 3
+  0, /*tp_as_async*/
+  #endif
+  0, /*tp_repr*/
+  0, /*tp_as_number*/
+  0, /*tp_as_sequence*/
+  0, /*tp_as_mapping*/
+  0, /*tp_hash*/
+  0, /*tp_call*/
+  0, /*tp_str*/
+  0, /*tp_getattro*/
+  0, /*tp_setattro*/
+  0, /*tp_as_buffer*/
+  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
+  0, /*tp_doc*/
+  0, /*tp_traverse*/
+  0, /*tp_clear*/
+  0, /*tp_richcompare*/
+  0, /*tp_weaklistoffset*/
+  0, /*tp_iter*/
+  0, /*tp_iternext*/
+  __pyx_methods_7pgenlib_PvarReader, /*tp_methods*/
+  0, /*tp_members*/
+  0, /*tp_getset*/
+  0, /*tp_base*/
+  0, /*tp_dict*/
+  0, /*tp_descr_get*/
+  0, /*tp_descr_set*/
+  0, /*tp_dictoffset*/
+  0, /*tp_init*/
+  0, /*tp_alloc*/
+  __pyx_tp_new_7pgenlib_PvarReader, /*tp_new*/
+  0, /*tp_free*/
+  0, /*tp_is_gc*/
+  0, /*tp_bases*/
+  0, /*tp_mro*/
+  0, /*tp_cache*/
+  0, /*tp_subclasses*/
+  0, /*tp_weaklist*/
+  0, /*tp_del*/
+  0, /*tp_version_tag*/
+  #if PY_VERSION_HEX >= 0x030400a1
+  0, /*tp_finalize*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
+  0, /*tp_vectorcall*/
+  #endif
+  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
+  0, /*tp_print*/
+  #endif
+  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
+  0, /*tp_pypy_flags*/
+  #endif
+};
 static struct __pyx_vtabstruct_7pgenlib_PgenReader __pyx_vtable_7pgenlib_PgenReader;
 
 static PyObject *__pyx_tp_new_7pgenlib_PgenReader(PyTypeObject *t, PyObject *a, PyObject *k) {
   struct __pyx_obj_7pgenlib_PgenReader *p;
   PyObject *o;
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
     o = (*t->tp_alloc)(t, 0);
@@ -33671,15 +36515,17 @@
     #define CYTHON_SMALL_CODE __attribute__((cold))
 #else
     #define CYTHON_SMALL_CODE
 #endif
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
+  {&__pyx_kp_u_0_based_allele_idx_too_large, __pyx_k_0_based_allele_idx_too_large, sizeof(__pyx_k_0_based_allele_idx_too_large), 0, 1, 0, 0},
   {&__pyx_kp_u_0_based_sample_idx_too_large, __pyx_k_0_based_sample_idx_too_large, sizeof(__pyx_k_0_based_sample_idx_too_large), 0, 1, 0, 0},
+  {&__pyx_kp_u_0_based_variant_idx_too_large, __pyx_k_0_based_variant_idx_too_large, sizeof(__pyx_k_0_based_variant_idx_too_large), 0, 1, 0, 0},
   {&__pyx_kp_u_Empty_sample_subset_is_not_curre, __pyx_k_Empty_sample_subset_is_not_curre, sizeof(__pyx_k_Empty_sample_subset_is_not_curre), 0, 1, 0, 0},
   {&__pyx_kp_u_Haplotype_major_read_alleles_lis, __pyx_k_Haplotype_major_read_alleles_lis, sizeof(__pyx_k_Haplotype_major_read_alleles_lis), 0, 1, 0, 0},
   {&__pyx_kp_u_Haplotype_major_read_alleles_lis_2, __pyx_k_Haplotype_major_read_alleles_lis_2, sizeof(__pyx_k_Haplotype_major_read_alleles_lis_2), 0, 1, 0, 0},
   {&__pyx_kp_u_Haplotype_major_read_alleles_lis_3, __pyx_k_Haplotype_major_read_alleles_lis_3, sizeof(__pyx_k_Haplotype_major_read_alleles_lis_3), 0, 1, 0, 0},
   {&__pyx_kp_u_Haplotype_major_read_alleles_ran, __pyx_k_Haplotype_major_read_alleles_ran, sizeof(__pyx_k_Haplotype_major_read_alleles_ran), 0, 1, 0, 0},
   {&__pyx_kp_u_Haplotype_major_read_alleles_ran_2, __pyx_k_Haplotype_major_read_alleles_ran_2, sizeof(__pyx_k_Haplotype_major_read_alleles_ran_2), 0, 1, 0, 0},
   {&__pyx_kp_u_Haplotype_major_read_alleles_ran_3, __pyx_k_Haplotype_major_read_alleles_ran_3, sizeof(__pyx_k_Haplotype_major_read_alleles_ran_3), 0, 1, 0, 0},
@@ -33700,14 +36546,15 @@
   {&__pyx_n_s_PgenReader, __pyx_k_PgenReader, sizeof(__pyx_k_PgenReader), 0, 0, 1, 1},
   {&__pyx_kp_u_PgenReader_multiallelic_variants, __pyx_k_PgenReader_multiallelic_variants, sizeof(__pyx_k_PgenReader_multiallelic_variants), 0, 1, 0, 0},
   {&__pyx_n_s_PgenWriter, __pyx_k_PgenWriter, sizeof(__pyx_k_PgenWriter), 0, 0, 1, 1},
   {&__pyx_kp_u_PgenWriter___dealloc___SpgwFinis, __pyx_k_PgenWriter___dealloc___SpgwFinis, sizeof(__pyx_k_PgenWriter___dealloc___SpgwFinis), 0, 1, 0, 0},
   {&__pyx_kp_u_PgenWriter_close_SpgwFinish_erro, __pyx_k_PgenWriter_close_SpgwFinish_erro, sizeof(__pyx_k_PgenWriter_close_SpgwFinish_erro), 0, 1, 0, 0},
   {&__pyx_kp_u_PgenWriter_close_called_when_num, __pyx_k_PgenWriter_close_called_when_num, sizeof(__pyx_k_PgenWriter_close_called_when_num), 0, 1, 0, 0},
   {&__pyx_kp_u_PgrInit_error, __pyx_k_PgrInit_error, sizeof(__pyx_k_PgrInit_error), 0, 1, 0, 0},
+  {&__pyx_n_s_PvarReader, __pyx_k_PvarReader, sizeof(__pyx_k_PvarReader), 0, 0, 1, 1},
   {&__pyx_n_s_RuntimeError, __pyx_k_RuntimeError, sizeof(__pyx_k_RuntimeError), 0, 0, 1, 1},
   {&__pyx_kp_u_Sample_major_read_list_geno_int, __pyx_k_Sample_major_read_list_geno_int, sizeof(__pyx_k_Sample_major_read_list_geno_int), 0, 1, 0, 0},
   {&__pyx_kp_u_Sample_major_read_list_geno_int_2, __pyx_k_Sample_major_read_list_geno_int_2, sizeof(__pyx_k_Sample_major_read_list_geno_int_2), 0, 1, 0, 0},
   {&__pyx_kp_u_Sample_major_read_range_geno_int, __pyx_k_Sample_major_read_range_geno_int, sizeof(__pyx_k_Sample_major_read_range_geno_int), 0, 1, 0, 0},
   {&__pyx_kp_u_Sample_major_read_range_geno_int_2, __pyx_k_Sample_major_read_range_geno_int_2, sizeof(__pyx_k_Sample_major_read_range_geno_int_2), 0, 1, 0, 0},
   {&__pyx_kp_u_SpgwInitPhase1_error, __pyx_k_SpgwInitPhase1_error, sizeof(__pyx_k_SpgwInitPhase1_error), 0, 1, 0, 0},
   {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
@@ -33725,17 +36572,17 @@
   {&__pyx_kp_u_Variant_major_read_alleles_range_2, __pyx_k_Variant_major_read_alleles_range_2, sizeof(__pyx_k_Variant_major_read_alleles_range_2), 0, 1, 0, 0},
   {&__pyx_kp_u_Variant_major_read_dosages_list, __pyx_k_Variant_major_read_dosages_list, sizeof(__pyx_k_Variant_major_read_dosages_list), 0, 1, 0, 0},
   {&__pyx_kp_u_Variant_major_read_dosages_list_2, __pyx_k_Variant_major_read_dosages_list_2, sizeof(__pyx_k_Variant_major_read_dosages_list_2), 0, 1, 0, 0},
   {&__pyx_kp_u_Variant_major_read_list_geno_int, __pyx_k_Variant_major_read_list_geno_int, sizeof(__pyx_k_Variant_major_read_list_geno_int), 0, 1, 0, 0},
   {&__pyx_kp_u_Variant_major_read_list_geno_int_2, __pyx_k_Variant_major_read_list_geno_int_2, sizeof(__pyx_k_Variant_major_read_list_geno_int_2), 0, 1, 0, 0},
   {&__pyx_kp_u_Variant_major_read_range_geno_in, __pyx_k_Variant_major_read_range_geno_in, sizeof(__pyx_k_Variant_major_read_range_geno_in), 0, 1, 0, 0},
   {&__pyx_kp_u_Variant_major_read_range_geno_in_2, __pyx_k_Variant_major_read_range_geno_in_2, sizeof(__pyx_k_Variant_major_read_range_geno_in_2), 0, 1, 0, 0},
-  {&__pyx_kp_u__10, __pyx_k__10, sizeof(__pyx_k__10), 0, 1, 0, 0},
-  {&__pyx_kp_u__5, __pyx_k__5, sizeof(__pyx_k__5), 0, 1, 0, 0},
-  {&__pyx_kp_u__9, __pyx_k__9, sizeof(__pyx_k__9), 0, 1, 0, 0},
+  {&__pyx_kp_u__12, __pyx_k__12, sizeof(__pyx_k__12), 0, 1, 0, 0},
+  {&__pyx_kp_u__13, __pyx_k__13, sizeof(__pyx_k__13), 0, 1, 0, 0},
+  {&__pyx_kp_u__8, __pyx_k__8, sizeof(__pyx_k__8), 0, 1, 0, 0},
   {&__pyx_n_s_all_phased, __pyx_k_all_phased, sizeof(__pyx_k_all_phased), 0, 0, 1, 1},
   {&__pyx_n_s_allele_ct, __pyx_k_allele_ct, sizeof(__pyx_k_allele_ct), 0, 0, 1, 1},
   {&__pyx_n_s_allele_ct_limit, __pyx_k_allele_ct_limit, sizeof(__pyx_k_allele_ct_limit), 0, 0, 1, 1},
   {&__pyx_n_s_allele_cts, __pyx_k_allele_cts, sizeof(__pyx_k_allele_cts), 0, 0, 1, 1},
   {&__pyx_n_s_allele_idx, __pyx_k_allele_idx, sizeof(__pyx_k_allele_idx), 0, 0, 1, 1},
   {&__pyx_n_s_allele_idx_offsets, __pyx_k_allele_idx_offsets, sizeof(__pyx_k_allele_idx_offsets), 0, 0, 1, 1},
   {&__pyx_n_s_allele_int32, __pyx_k_allele_int32, sizeof(__pyx_k_allele_int32), 0, 0, 1, 1},
@@ -33796,18 +36643,24 @@
   {&__pyx_n_s_exc_type, __pyx_k_exc_type, sizeof(__pyx_k_exc_type), 0, 0, 1, 1},
   {&__pyx_n_s_exc_val, __pyx_k_exc_val, sizeof(__pyx_k_exc_val), 0, 0, 1, 1},
   {&__pyx_n_s_exit, __pyx_k_exit, sizeof(__pyx_k_exit), 0, 0, 1, 1},
   {&__pyx_n_s_filename, __pyx_k_filename, sizeof(__pyx_k_filename), 0, 0, 1, 1},
   {&__pyx_n_s_float32, __pyx_k_float32, sizeof(__pyx_k_float32), 0, 0, 1, 1},
   {&__pyx_n_s_float64, __pyx_k_float64, sizeof(__pyx_k_float64), 0, 0, 1, 1},
   {&__pyx_n_s_floatarr_out, __pyx_k_floatarr_out, sizeof(__pyx_k_floatarr_out), 0, 0, 1, 1},
+  {&__pyx_kp_u_for_this_variant, __pyx_k_for_this_variant, sizeof(__pyx_k_for_this_variant), 0, 1, 0, 0},
   {&__pyx_n_s_geno_int_out, __pyx_k_geno_int_out, sizeof(__pyx_k_geno_int_out), 0, 0, 1, 1},
   {&__pyx_n_s_genocount_uint32_out, __pyx_k_genocount_uint32_out, sizeof(__pyx_k_genocount_uint32_out), 0, 0, 1, 1},
+  {&__pyx_n_s_get_allele_code, __pyx_k_get_allele_code, sizeof(__pyx_k_get_allele_code), 0, 0, 1, 1},
+  {&__pyx_n_s_get_allele_ct, __pyx_k_get_allele_ct, sizeof(__pyx_k_get_allele_ct), 0, 0, 1, 1},
+  {&__pyx_n_s_get_allele_idx_offsets, __pyx_k_get_allele_idx_offsets, sizeof(__pyx_k_get_allele_idx_offsets), 0, 0, 1, 1},
+  {&__pyx_n_s_get_max_allele_ct, __pyx_k_get_max_allele_ct, sizeof(__pyx_k_get_max_allele_ct), 0, 0, 1, 1},
   {&__pyx_n_s_get_raw_sample_ct, __pyx_k_get_raw_sample_ct, sizeof(__pyx_k_get_raw_sample_ct), 0, 0, 1, 1},
   {&__pyx_n_s_get_variant_ct, __pyx_k_get_variant_ct, sizeof(__pyx_k_get_variant_ct), 0, 0, 1, 1},
+  {&__pyx_n_s_get_variant_id, __pyx_k_get_variant_id, sizeof(__pyx_k_get_variant_id), 0, 0, 1, 1},
   {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
   {&__pyx_n_s_hap_maj, __pyx_k_hap_maj, sizeof(__pyx_k_hap_maj), 0, 0, 1, 1},
   {&__pyx_n_s_hardcall_phase_present, __pyx_k_hardcall_phase_present, sizeof(__pyx_k_hardcall_phase_present), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_kp_u_in_file, __pyx_k_in_file, sizeof(__pyx_k_in_file), 0, 1, 0, 0},
   {&__pyx_kp_u_in_file_2, __pyx_k_in_file_2, sizeof(__pyx_k_in_file_2), 0, 1, 0, 0},
   {&__pyx_n_s_int32, __pyx_k_int32, sizeof(__pyx_k_int32), 0, 0, 1, 1},
@@ -33821,14 +36674,16 @@
   {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
   {&__pyx_kp_u_numpy_core_multiarray_failed_to, __pyx_k_numpy_core_multiarray_failed_to, sizeof(__pyx_k_numpy_core_multiarray_failed_to), 0, 1, 0, 0},
   {&__pyx_kp_u_numpy_core_umath_failed_to_impor, __pyx_k_numpy_core_umath_failed_to_impor, sizeof(__pyx_k_numpy_core_umath_failed_to_impor), 0, 1, 0, 0},
   {&__pyx_kp_u_only, __pyx_k_only, sizeof(__pyx_k_only), 0, 1, 0, 0},
   {&__pyx_n_s_phasepresent, __pyx_k_phasepresent, sizeof(__pyx_k_phasepresent), 0, 0, 1, 1},
   {&__pyx_n_s_phasepresent_batch, __pyx_k_phasepresent_batch, sizeof(__pyx_k_phasepresent_batch), 0, 0, 1, 1},
   {&__pyx_n_s_phasepresent_out, __pyx_k_phasepresent_out, sizeof(__pyx_k_phasepresent_out), 0, 0, 1, 1},
+  {&__pyx_n_s_pvar, __pyx_k_pvar, sizeof(__pyx_k_pvar), 0, 0, 1, 1},
+  {&__pyx_kp_u_pvar_cannot_be_specified_at_the, __pyx_k_pvar_cannot_be_specified_at_the, sizeof(__pyx_k_pvar_cannot_be_specified_at_the), 0, 1, 0, 0},
   {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
   {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
   {&__pyx_n_s_raw_sample_ct, __pyx_k_raw_sample_ct, sizeof(__pyx_k_raw_sample_ct), 0, 0, 1, 1},
   {&__pyx_n_s_read, __pyx_k_read, sizeof(__pyx_k_read), 0, 0, 1, 1},
   {&__pyx_n_s_read_alleles, __pyx_k_read_alleles, sizeof(__pyx_k_read_alleles), 0, 0, 1, 1},
   {&__pyx_kp_u_read_alleles_allele_int32_out_is, __pyx_k_read_alleles_allele_int32_out_is, sizeof(__pyx_k_read_alleles_allele_int32_out_is), 0, 1, 0, 0},
   {&__pyx_n_s_read_alleles_and_phasepresent, __pyx_k_read_alleles_and_phasepresent, sizeof(__pyx_k_read_alleles_and_phasepresent), 0, 0, 1, 1},
@@ -33883,584 +36738,616 @@
   {&__pyx_n_s_sample_subset, __pyx_k_sample_subset, sizeof(__pyx_k_sample_subset), 0, 0, 1, 1},
   {&__pyx_kp_u_sample_subset_is_not_in_strictly, __pyx_k_sample_subset_is_not_in_strictly, sizeof(__pyx_k_sample_subset_is_not_in_strictly), 0, 1, 0, 0},
   {&__pyx_n_s_setstate, __pyx_k_setstate, sizeof(__pyx_k_setstate), 0, 0, 1, 1},
   {&__pyx_n_s_setstate_cython, __pyx_k_setstate_cython, sizeof(__pyx_k_setstate_cython), 0, 0, 1, 1},
   {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
   {&__pyx_n_s_sys, __pyx_k_sys, sizeof(__pyx_k_sys), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
+  {&__pyx_n_s_uintp, __pyx_k_uintp, sizeof(__pyx_k_uintp), 0, 0, 1, 1},
   {&__pyx_kp_u_unequal_to_initially_declared_v, __pyx_k_unequal_to_initially_declared_v, sizeof(__pyx_k_unequal_to_initially_declared_v), 0, 1, 0, 0},
   {&__pyx_n_s_variant_ct, __pyx_k_variant_ct, sizeof(__pyx_k_variant_ct), 0, 0, 1, 1},
   {&__pyx_n_s_variant_ct_limit, __pyx_k_variant_ct_limit, sizeof(__pyx_k_variant_ct_limit), 0, 0, 1, 1},
   {&__pyx_n_s_variant_idx, __pyx_k_variant_idx, sizeof(__pyx_k_variant_idx), 0, 0, 1, 1},
   {&__pyx_kp_u_variant_idx_2, __pyx_k_variant_idx_2, sizeof(__pyx_k_variant_idx_2), 0, 1, 0, 0},
   {&__pyx_n_s_variant_idx_end, __pyx_k_variant_idx_end, sizeof(__pyx_k_variant_idx_end), 0, 0, 1, 1},
   {&__pyx_kp_u_variant_idx_end_variant_idx_sta, __pyx_k_variant_idx_end_variant_idx_sta, sizeof(__pyx_k_variant_idx_end_variant_idx_sta), 0, 1, 0, 0},
   {&__pyx_n_s_variant_idx_start, __pyx_k_variant_idx_start, sizeof(__pyx_k_variant_idx_start), 0, 0, 1, 1},
   {&__pyx_n_s_variant_idxs, __pyx_k_variant_idxs, sizeof(__pyx_k_variant_idxs), 0, 0, 1, 1},
   {&__pyx_kp_u_variant_idxs_length_is, __pyx_k_variant_idxs_length_is, sizeof(__pyx_k_variant_idxs_length_is), 0, 1, 0, 0},
+  {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(0, 254, __pyx_L1_error)
-  __pyx_builtin_RuntimeError = __Pyx_GetBuiltinName(__pyx_n_s_RuntimeError); if (!__pyx_builtin_RuntimeError) __PYX_ERR(0, 266, __pyx_L1_error)
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 553, __pyx_L1_error)
+  __pyx_builtin_RuntimeError = __Pyx_GetBuiltinName(__pyx_n_s_RuntimeError); if (!__pyx_builtin_RuntimeError) __PYX_ERR(0, 253, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 304, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(0, 357, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(2, 945, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "pgenlib.pyx":266
+  /* "(tree fragment)":2
+ * def __reduce_cython__(self):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ */
+  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple_)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple_);
+  __Pyx_GIVEREF(__pyx_tuple_);
+
+  /* "(tree fragment)":4
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
+ * def __setstate_cython__(self, __pyx_state):
+ *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
+ */
+  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__2);
+  __Pyx_GIVEREF(__pyx_tuple__2);
+
+  /* "pgenlib.pyx":369
  *         cdef uint32_t subset_size = sample_subset.size
  *         if subset_size == 0:
  *             raise RuntimeError("Empty sample_subset is not currently permitted.")             # <<<<<<<<<<<<<<
  *         cdef sample_uidx = sample_subset[0]
  *         cdef uint32_t idx = 0
  */
-  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_u_Empty_sample_subset_is_not_curre); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 266, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple_);
-  __Pyx_GIVEREF(__pyx_tuple_);
+  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_u_Empty_sample_subset_is_not_curre); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 369, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__3);
+  __Pyx_GIVEREF(__pyx_tuple__3);
 
-  /* "pgenlib.pyx":282
+  /* "pgenlib.pyx":385
  *             # to be returned in a different order
  *             if next_uidx <= sample_uidx:
  *                 raise RuntimeError("sample_subset is not in strictly increasing order.")             # <<<<<<<<<<<<<<
  * 
  *             sample_uidx = next_uidx
  */
-  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_u_sample_subset_is_not_in_strictly); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 282, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__2);
-  __Pyx_GIVEREF(__pyx_tuple__2);
+  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_u_sample_subset_is_not_in_strictly); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 385, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__4);
+  __Pyx_GIVEREF(__pyx_tuple__4);
+
+  /* "pgenlib.pyx":417
+ *         if pvar is not None:
+ *             if (variant_ct is not None) or (allele_idx_offsets is not None):
+ *                 raise RuntimeError("pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets")             # <<<<<<<<<<<<<<
+ *             pr = pvar
+ *             variant_ct = pr.get_variant_ct()
+ */
+  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_u_pvar_cannot_be_specified_at_the); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 417, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__5);
+  __Pyx_GIVEREF(__pyx_tuple__5);
 
-  /* "pgenlib.pyx":350
- *             # wrapping pvar loader the same way as the R interface
+  /* "pgenlib.pyx":461
+ *         if self._info_ptr[0].gflags & kfPgenGlobalMultiallelicHardcallFound:
  *             if self._info_ptr[0].allele_idx_offsets == NULL:
  *                 raise RuntimeError("PgenReader: multiallelic variants present, but allele_idx_offsets not provided")             # <<<<<<<<<<<<<<
  * 
  *         self._state_ptr = <PgenReaderStruct*>PyMem_Malloc(sizeof(PgenReaderStruct))
  */
-  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_u_PgenReader_multiallelic_variants); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 350, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__3);
-  __Pyx_GIVEREF(__pyx_tuple__3);
+  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_u_PgenReader_multiallelic_variants); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 461, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__6);
+  __Pyx_GIVEREF(__pyx_tuple__6);
 
-  /* "pgenlib.pyx":447
+  /* "pgenlib.pyx":558
  *             raise RuntimeError("read() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if geno_int_out.ndim != 1:
  *             raise RuntimeError("read() requires geno_int_out to be one-dimensional.")             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         if geno_int_out.shape[0] < subset_size:
  */
-  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_u_read_requires_geno_int_out_to_be); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 447, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__4);
-  __Pyx_GIVEREF(__pyx_tuple__4);
+  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_u_read_requires_geno_int_out_to_be); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 558, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__7);
+  __Pyx_GIVEREF(__pyx_tuple__7);
 
-  /* "pgenlib.pyx":469
+  /* "pgenlib.pyx":580
  *             GenoarrToInt64sMinus9(genovec, subset_size, data64_ptr)
  *         else:
  *             raise RuntimeError("Invalid read() geno_int_out array element type (int8, int32, or int64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_geno_int_out_array); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 469, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__6);
-  __Pyx_GIVEREF(__pyx_tuple__6);
+  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_geno_int_out_array); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 580, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__9);
+  __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "pgenlib.pyx":477
+  /* "pgenlib.pyx":588
  *             raise RuntimeError("read_dosages() variant_idx too large (" + str(variant_idx) + "; only " + str(self._info_ptr[0].raw_variant_ct) + " in file)")
  *         if floatarr_out.ndim != 1:
  *             raise RuntimeError("read_dosages() requires floatarr_out to be one-dimensional.")             # <<<<<<<<<<<<<<
  *         cdef uint32_t subset_size = self._subset_size
  *         if floatarr_out.shape[0] < subset_size:
  */
-  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_kp_u_read_dosages_requires_floatarr_o); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 477, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__7);
-  __Pyx_GIVEREF(__pyx_tuple__7);
+  __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_read_dosages_requires_floatarr_o); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 588, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__10);
+  __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "pgenlib.pyx":495
+  /* "pgenlib.pyx":606
  *             Dosage16ToDoublesMinus9(self._pgv.genovec, self._pgv.dosage_present, self._pgv.dosage_main, subset_size, dosage_ct, data64_ptr)
  *         else:
  *             raise RuntimeError("Invalid read_dosages() floatarr_out array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_dosages_floatarr_ou); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 495, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__8);
-  __Pyx_GIVEREF(__pyx_tuple__8);
+  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_dosages_floatarr_ou); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 606, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__11);
+  __Pyx_GIVEREF(__pyx_tuple__11);
 
-  /* "pgenlib.pyx":746
+  /* "pgenlib.pyx":857
  *             self.read_range_internal64(variant_idx_start, variant_idx_end, geno_int_out, allele_idx, sample_maj)
  *         else:
  *             raise RuntimeError("Invalid read_range() geno_int_out array element type (int8, int32, or int64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_range_geno_int_out); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 746, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__11);
-  __Pyx_GIVEREF(__pyx_tuple__11);
+  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_range_geno_int_out); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__14);
+  __Pyx_GIVEREF(__pyx_tuple__14);
 
-  /* "pgenlib.pyx":974
+  /* "pgenlib.pyx":1085
  *             self.read_list_internal64(variant_idxs, geno_int_out, allele_idx, sample_maj)
  *         else:
  *             raise RuntimeError("Invalid read_list() geno_int_out array element type (int8, int32, or int64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_list_geno_int_out_a); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 974, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__12);
-  __Pyx_GIVEREF(__pyx_tuple__12);
+  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_list_geno_int_out_a); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 1085, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__15);
+  __Pyx_GIVEREF(__pyx_tuple__15);
 
-  /* "pgenlib.pyx":1017
+  /* "pgenlib.pyx":1128
  *         if allele_idx_offsets != NULL:
  *             if allele_idx_offsets[variant_idx_end] - allele_idx_offsets[variant_idx_start] != (variant_idx_end - variant_idx_start) * k1LU * 2:
  *                 raise RuntimeError("Haplotype-major read_alleles_range() doesn't support multiallelic variants yet.")             # <<<<<<<<<<<<<<
  *         cdef uint32_t variant_batch_ct = DivUp(variant_idx_ct, kPglNypTransposeBatch)
  *         cdef uint32_t variant_batch_size = kPglNypTransposeBatch
  */
-  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_u_Haplotype_major_read_alleles_ran_3); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 1017, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__13);
-  __Pyx_GIVEREF(__pyx_tuple__13);
+  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_kp_u_Haplotype_major_read_alleles_ran_3); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 1128, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__16);
+  __Pyx_GIVEREF(__pyx_tuple__16);
 
-  /* "pgenlib.pyx":1152
+  /* "pgenlib.pyx":1263
  *                 if allele_idx_offsets != NULL:
  *                     if allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx] != 2:
  *                         raise RuntimeError("Haplotype-major read_alleles_list() doesn't support multiallelic variants yet.")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGetP(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, vmaj_geno_iter, phasepresent, vmaj_phaseinfo_iter, &phasepresent_ct)
  *                 if reterr != kPglRetSuccess:
  */
-  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_u_Haplotype_major_read_alleles_lis_3); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 1152, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__14);
-  __Pyx_GIVEREF(__pyx_tuple__14);
+  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_kp_u_Haplotype_major_read_alleles_lis_3); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 1263, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__17);
+  __Pyx_GIVEREF(__pyx_tuple__17);
 
-  /* "pgenlib.pyx":1218
+  /* "pgenlib.pyx":1329
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *             return
  *         raise RuntimeError("read_alleles_and_phasepresent_range() does not support hap_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_u_read_alleles_and_phasepresent_ra_2); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 1218, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__15);
-  __Pyx_GIVEREF(__pyx_tuple__15);
+  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_u_read_alleles_and_phasepresent_ra_2); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__18);
+  __Pyx_GIVEREF(__pyx_tuple__18);
 
-  /* "pgenlib.pyx":1260
+  /* "pgenlib.pyx":1371
  *                 GenoarrMPToAlleleCodesMinus9(&self._pgv, subset_size, phasepresent_data_ptr, main_data_ptr)
  *             return
  *         raise RuntimeError("read_alleles_and_phasepresent_list() does not support hap_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_kp_u_read_alleles_and_phasepresent_li_4); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 1260, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__16);
-  __Pyx_GIVEREF(__pyx_tuple__16);
+  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_u_read_alleles_and_phasepresent_li_4); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 1371, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__19);
+  __Pyx_GIVEREF(__pyx_tuple__19);
 
-  /* "pgenlib.pyx":1284
+  /* "pgenlib.pyx":1395
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  *             return
  *         raise RuntimeError("read_dosages_range() does not support sample_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_kp_u_read_dosages_range_does_not_supp); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 1284, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__17);
-  __Pyx_GIVEREF(__pyx_tuple__17);
+  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_u_read_dosages_range_does_not_supp); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 1395, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__20);
+  __Pyx_GIVEREF(__pyx_tuple__20);
 
-  /* "pgenlib.pyx":1319
+  /* "pgenlib.pyx":1430
  *             self.read_dosages_range_internal64(variant_idx_start, variant_idx_end, floatarr_out, allele_idx, sample_maj)
  *         else:
  *             raise RuntimeError("Invalid read_dosages_range() floatarr_out array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_dosages_range_float); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 1319, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__18);
-  __Pyx_GIVEREF(__pyx_tuple__18);
+  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_dosages_range_float); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 1430, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__21);
+  __Pyx_GIVEREF(__pyx_tuple__21);
 
-  /* "pgenlib.pyx":1353
+  /* "pgenlib.pyx":1464
  *                 Dosage16ToFloatsMinus9(genovec, dosage_present, dosage_main, subset_size, dosage_ct, data32_ptr)
  *             return
  *         raise RuntimeError("read_dosages_list() does not support sample_maj == 1 yet.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_u_read_dosages_list_does_not_suppo); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 1353, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__19);
-  __Pyx_GIVEREF(__pyx_tuple__19);
+  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_u_read_dosages_list_does_not_suppo); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 1464, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
 
-  /* "pgenlib.pyx":1395
+  /* "pgenlib.pyx":1506
  *             self.read_dosages_list_internal64(variant_idxs, floatarr_out, allele_idx, sample_maj)
  *         else:
  *             raise RuntimeError("Invalid read_dosages_list() floatarr_out array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_dosages_list_floata); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 1395, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__20);
-  __Pyx_GIVEREF(__pyx_tuple__20);
+  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_u_Invalid_read_dosages_list_floata); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 1506, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
-  /* "pgenlib.pyx":1424
+  /* "pgenlib.pyx":1535
  *                 type_ct = (allele_ct * (allele_ct + 1)) >> 1
- *                 if genocount_uint32_out.shape[0] <= type_ct:
+ *                 if <uintptr_t>(genocount_uint32_out.shape[0]) <= type_ct:
  *                     raise RuntimeError("count() genocount_uint32_out buffer is too small for multiallelic variant")             # <<<<<<<<<<<<<<
  *                 reterr = PgrGetM(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
  *                 if reterr != kPglRetSuccess:
  */
-  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_u_count_genocount_uint32_out_buffe); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 1424, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_u_count_genocount_uint32_out_buffe); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 1535, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__26);
+  __Pyx_GIVEREF(__pyx_tuple__26);
 
-  /* "pgenlib.pyx":1557
+  /* "pgenlib.pyx":1668
  *             cur_variant_ct_limit = variant_ct_limit
  *         else:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct or variant_ct_upper_bound must be provided).")             # <<<<<<<<<<<<<<
  *         if cur_variant_ct_limit == 0 or cur_variant_ct_limit > kPglMaxVariantCt:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")
  */
-  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_u_Invalid_arguments_for_PgenWriter); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 1557, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_u_Invalid_arguments_for_PgenWriter); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 1668, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
+  __Pyx_GIVEREF(__pyx_tuple__27);
 
-  /* "pgenlib.pyx":1559
+  /* "pgenlib.pyx":1670
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct or variant_ct_upper_bound must be provided).")
  *         if cur_variant_ct_limit == 0 or cur_variant_ct_limit > kPglMaxVariantCt:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")             # <<<<<<<<<<<<<<
  *         if dosage_phase_present and not dosage_present:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")
  */
-  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_u_Invalid_arguments_for_PgenWriter_2); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 1559, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__25);
-  __Pyx_GIVEREF(__pyx_tuple__25);
+  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_u_Invalid_arguments_for_PgenWriter_2); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 1670, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__28);
+  __Pyx_GIVEREF(__pyx_tuple__28);
 
-  /* "pgenlib.pyx":1561
+  /* "pgenlib.pyx":1672
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (variant_ct must be positive, and less than ~2^31).")
  *         if dosage_phase_present and not dosage_present:
  *             raise RuntimeError("Invalid arguments for PgenWriter constructor (dosage_phase_present true but dosage_present false).")             # <<<<<<<<<<<<<<
  *         if allele_ct_limit != 2:
  *             if (allele_ct_limit < 2) or (allele_ct_limit > kPglMaxAlleleCt):
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_u_Invalid_arguments_for_PgenWriter_3); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 1561, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
+  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_u_Invalid_arguments_for_PgenWriter_3); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 1672, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
+  __Pyx_GIVEREF(__pyx_tuple__29);
 
-  /* "pgenlib.pyx":1564
+  /* "pgenlib.pyx":1675
  *         if allele_ct_limit != 2:
  *             if (allele_ct_limit < 2) or (allele_ct_limit > kPglMaxAlleleCt):
  *                 raise RuntimeError("Invalid arguments for PgenWriter constructor (allele_ct_limit must be in [2, 255]).")             # <<<<<<<<<<<<<<
  *             write_mode = kPgenWriteAndCopy
  * 
  */
-  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_u_Invalid_arguments_for_PgenWriter_4); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 1564, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__27);
-  __Pyx_GIVEREF(__pyx_tuple__27);
+  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_u_Invalid_arguments_for_PgenWriter_4); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 1675, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
 
-  /* "pgenlib.pyx":1662
+  /* "pgenlib.pyx":1773
  *         if all_phased:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *                 raise RuntimeError("append_alleles called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")             # <<<<<<<<<<<<<<
  *             phaseinfo = self._phaseinfo
  *         cdef uint32_t patch_01_ct
  */
-  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_all_p); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 1662, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__28);
-  __Pyx_GIVEREF(__pyx_tuple__28);
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_all_p); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 1773, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__31);
+  __Pyx_GIVEREF(__pyx_tuple__31);
 
-  /* "pgenlib.pyx":1668
+  /* "pgenlib.pyx":1779
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, phaseinfo)
  *         if observed_allele_ct == -1:
  *             raise RuntimeError("append_alleles called with invalid allele codes")             # <<<<<<<<<<<<<<
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:
  */
-  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_inval); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 1668, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__29);
-  __Pyx_GIVEREF(__pyx_tuple__29);
+  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_inval); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 1779, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__32);
+  __Pyx_GIVEREF(__pyx_tuple__32);
 
-  /* "pgenlib.pyx":1671
+  /* "pgenlib.pyx":1782
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_alleles called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")             # <<<<<<<<<<<<<<
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:
  */
-  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_allel); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 1671, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__30);
-  __Pyx_GIVEREF(__pyx_tuple__30);
+  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_allel); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 1782, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__33);
+  __Pyx_GIVEREF(__pyx_tuple__33);
 
-  /* "pgenlib.pyx":1674
+  /* "pgenlib.pyx":1785
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")             # <<<<<<<<<<<<<<
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_alleles called with allele_ct > allele_ct_limit")
  */
-  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_allel_2); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 1674, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
-  __Pyx_GIVEREF(__pyx_tuple__31);
+  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_allel_2); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 1785, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__34);
+  __Pyx_GIVEREF(__pyx_tuple__34);
 
-  /* "pgenlib.pyx":1676
+  /* "pgenlib.pyx":1787
  *                 raise RuntimeError("append_alleles called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_alleles called with allele_ct > allele_ct_limit")             # <<<<<<<<<<<<<<
  *             write_allele_ct = allele_ct
  *         cdef PglErr reterr
  */
-  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_allel_3); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 1676, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__32);
-  __Pyx_GIVEREF(__pyx_tuple__32);
+  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_called_with_allel_3); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 1787, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__35);
+  __Pyx_GIVEREF(__pyx_tuple__35);
 
-  /* "pgenlib.pyx":1696
+  /* "pgenlib.pyx":1807
  *     cpdef append_partially_phased(self, np.ndarray[np.int32_t,mode="c"] allele_int32, np.ndarray[np.uint8_t,cast=True] phasepresent, object allele_ct = None):
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased cannot be called when PgenWriter was constructed with hardcall_phase_present False")             # <<<<<<<<<<<<<<
  *         cdef int32_t* allele_codes = <int32_t*>(&(allele_int32[0]))
  *         cdef unsigned char* phasepresent_bytes = <unsigned char*>(&(phasepresent[0]))
  */
-  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_cannot_b); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 1696, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__33);
-  __Pyx_GIVEREF(__pyx_tuple__33);
+  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_cannot_b); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 1807, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__36);
+  __Pyx_GIVEREF(__pyx_tuple__36);
 
-  /* "pgenlib.pyx":1712
+  /* "pgenlib.pyx":1823
  *         cdef int32_t observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  *         if observed_allele_ct == -1:
  *             raise RuntimeError("append_partially_phased called with invalid allele codes")             # <<<<<<<<<<<<<<
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:
  */
-  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_called_w); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 1712, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__34);
-  __Pyx_GIVEREF(__pyx_tuple__34);
+  __pyx_tuple__37 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_called_w); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1823, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__37);
+  __Pyx_GIVEREF(__pyx_tuple__37);
 
-  /* "pgenlib.pyx":1715
+  /* "pgenlib.pyx":1826
  *         cdef uint32_t write_allele_ct = <uint32_t>(observed_allele_ct)
  *         if write_allele_ct > allele_ct_limit:
  *             raise RuntimeError("append_partially_phased called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")             # <<<<<<<<<<<<<<
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:
  */
-  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_called_w_2); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 1715, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__35);
-  __Pyx_GIVEREF(__pyx_tuple__35);
+  __pyx_tuple__38 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_called_w_2); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 1826, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
 
-  /* "pgenlib.pyx":1718
+  /* "pgenlib.pyx":1829
  *         if allele_ct is not None:
  *             if allele_ct < write_allele_ct:
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")             # <<<<<<<<<<<<<<
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased called with allele_ct > allele_ct_limit")
  */
-  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_called_w_3); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 1718, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__36);
-  __Pyx_GIVEREF(__pyx_tuple__36);
+  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_called_w_3); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1829, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
 
-  /* "pgenlib.pyx":1720
+  /* "pgenlib.pyx":1831
  *                 raise RuntimeError("append_partially_phased called with allele codes >= allele_ct argument")
  *             if allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased called with allele_ct > allele_ct_limit")             # <<<<<<<<<<<<<<
  *             write_allele_ct = allele_ct
  *         cdef PglErr reterr
  */
-  __pyx_tuple__37 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_called_w_4); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1720, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__37);
-  __Pyx_GIVEREF(__pyx_tuple__37);
+  __pyx_tuple__40 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_called_w_4); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 1831, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__40);
+  __Pyx_GIVEREF(__pyx_tuple__40);
 
-  /* "pgenlib.pyx":1756
+  /* "pgenlib.pyx":1867
  *     cpdef append_dosages(self, np.ndarray floatarr):
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages cannot be called when PgenWriter was constructed with dosage_present False")             # <<<<<<<<<<<<<<
  *         if floatarr.dtype == np.float32:
  *             self.append_dosages_internal32(floatarr)
  */
-  __pyx_tuple__38 = PyTuple_Pack(1, __pyx_kp_u_append_dosages_cannot_be_called); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 1756, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__38);
-  __Pyx_GIVEREF(__pyx_tuple__38);
+  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_kp_u_append_dosages_cannot_be_called); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1867, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
 
-  /* "pgenlib.pyx":1762
+  /* "pgenlib.pyx":1873
  *             self.append_dosages_internal64(floatarr)
  *         else:
  *             raise RuntimeError("Invalid append_dosages() dosage array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_u_Invalid_append_dosages_dosage_ar); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1762, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__39);
-  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_kp_u_Invalid_append_dosages_dosage_ar); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 1873, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
 
-  /* "pgenlib.pyx":1802
+  /* "pgenlib.pyx":1913
  *                 observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, NULL, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, NULL, NULL)
  *                 if observed_allele_ct == -1:
  *                     raise RuntimeError("append_alleles_batch called with invalid allele codes")             # <<<<<<<<<<<<<<
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:
  */
-  __pyx_tuple__40 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 1802, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__40);
-  __Pyx_GIVEREF(__pyx_tuple__40);
+  __pyx_tuple__43 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1913, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
 
-  /* "pgenlib.pyx":1805
+  /* "pgenlib.pyx":1916
  *                 write_allele_ct = <uint32_t>(observed_allele_ct)
  *                 if write_allele_ct > allele_ct_limit:
  *                     raise RuntimeError("append_alleles_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")             # <<<<<<<<<<<<<<
  *                 if allele_cts is not None:
  *                     casted_allele_ct = allele_cts[uii]
  */
-  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with_2); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1805, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__41);
-  __Pyx_GIVEREF(__pyx_tuple__41);
+  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with_2); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1916, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__44);
+  __Pyx_GIVEREF(__pyx_tuple__44);
 
-  /* "pgenlib.pyx":1809
+  /* "pgenlib.pyx":1920
  *                     casted_allele_ct = allele_cts[uii]
  *                     if casted_allele_ct < write_allele_ct:
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")             # <<<<<<<<<<<<<<
  *                     if casted_allele_ct > allele_ct_limit:
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")
  */
-  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with_3); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 1809, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__42);
-  __Pyx_GIVEREF(__pyx_tuple__42);
+  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with_3); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1920, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__45);
+  __Pyx_GIVEREF(__pyx_tuple__45);
 
-  /* "pgenlib.pyx":1811
+  /* "pgenlib.pyx":1922
  *                         raise RuntimeError("append_alleles_batch called with allele codes >= allele_cts[] value")
  *                     if casted_allele_ct > allele_ct_limit:
  *                         raise RuntimeError("append_alleles_batch called with allele_cts[] value > allele_ct_limit")             # <<<<<<<<<<<<<<
  *                     write_allele_ct = casted_allele_ct
  *                 if (patch_01_ct == 0) and (patch_10_ct == 0):
  */
-  __pyx_tuple__43 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with_4); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1811, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__43);
-  __Pyx_GIVEREF(__pyx_tuple__43);
+  __pyx_tuple__46 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with_4); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 1922, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__46);
+  __Pyx_GIVEREF(__pyx_tuple__46);
 
-  /* "pgenlib.pyx":1821
+  /* "pgenlib.pyx":1932
  *         else:
  *             if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *                 raise RuntimeError("append_alleles_batch called with all_phased True, but PgenWriter was constructed with hardcall_phase_present False")             # <<<<<<<<<<<<<<
  *             for uii in range(batch_size):
  *                 allele_codes = <int32_t*>(&(allele_int32_batch[uii, 0]))
  */
-  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with_5); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1821, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__44);
-  __Pyx_GIVEREF(__pyx_tuple__44);
+  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_u_append_alleles_batch_called_with_5); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1932, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__47);
+  __Pyx_GIVEREF(__pyx_tuple__47);
 
-  /* "pgenlib.pyx":1848
+  /* "pgenlib.pyx":1959
  *     cpdef append_partially_phased_batch(self, np.ndarray[np.int32_t,mode="c",ndim=2] allele_int32_batch, np.ndarray[np.uint8_t,mode="c",cast=True,ndim=2] phasepresent_batch, object allele_cts = None):
  *         if (self._phase_dosage_gflags & kfPgenGlobalHardcallPhasePresent) == 0:
  *             raise RuntimeError("append_partially_phased_batch cannot be called when PgenWriter was constructed with hardcall_phase_present False")             # <<<<<<<<<<<<<<
  *         cdef uint32_t batch_size = <uint32_t>allele_int32_batch.shape[0]
  *         cdef uint32_t sample_ct = SpgwGetSampleCt(self._state_ptr)
  */
-  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_batch_ca); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1848, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__45);
-  __Pyx_GIVEREF(__pyx_tuple__45);
+  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_batch_ca); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1959, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__48);
+  __Pyx_GIVEREF(__pyx_tuple__48);
 
-  /* "pgenlib.pyx":1873
+  /* "pgenlib.pyx":1984
  *             observed_allele_ct = ConvertMultiAlleleCodesUnsafe(allele_codes, phasepresent_bytes, sample_ct, genovec, patch_01_set, patch_01_vals, patch_10_set, patch_10_vals, &patch_01_ct, &patch_10_ct, phasepresent_buf, phaseinfo)
  *             if observed_allele_ct == -1:
  *                 raise RuntimeError("append_partially_phased_batch called with invalid allele codes")             # <<<<<<<<<<<<<<
  *             write_allele_ct = <uint32_t>(observed_allele_ct)
  *             if write_allele_ct > allele_ct_limit:
  */
-  __pyx_tuple__46 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_batch_ca_2); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 1873, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__46);
-  __Pyx_GIVEREF(__pyx_tuple__46);
+  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_batch_ca_2); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1984, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__49);
+  __Pyx_GIVEREF(__pyx_tuple__49);
 
-  /* "pgenlib.pyx":1876
+  /* "pgenlib.pyx":1987
  *             write_allele_ct = <uint32_t>(observed_allele_ct)
  *             if write_allele_ct > allele_ct_limit:
  *                 raise RuntimeError("append_partially_phased_batch called with allele codes >= allele_ct_limit; you may need to construct the PgenWriter with a higher allele_ct_limit setting")             # <<<<<<<<<<<<<<
  *             if allele_cts is not None:
  *                 casted_allele_ct = allele_cts[uii]
  */
-  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_batch_ca_3); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1876, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__47);
-  __Pyx_GIVEREF(__pyx_tuple__47);
+  __pyx_tuple__50 = PyTuple_Pack(1, __pyx_kp_u_append_partially_phased_batch_ca_3); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 1987, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__50);
+  __Pyx_GIVEREF(__pyx_tuple__50);
 
-  /* "pgenlib.pyx":1925
+  /* "pgenlib.pyx":2036
  *     cpdef append_dosages_batch(self, np.ndarray floatarr_batch):
  *         if (self._phase_dosage_gflags & kfPgenGlobalDosagePresent) == 0:
  *             raise RuntimeError("append_dosages_batch cannot be called when PgenWriter was constructed with dosage_present False")             # <<<<<<<<<<<<<<
  *         if floatarr_batch.dtype == np.float32:
  *             self.append_dosages_batch_internal32(floatarr_batch)
  */
-  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_u_append_dosages_batch_cannot_be_c); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1925, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__48);
-  __Pyx_GIVEREF(__pyx_tuple__48);
+  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_u_append_dosages_batch_cannot_be_c); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 2036, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__51);
+  __Pyx_GIVEREF(__pyx_tuple__51);
 
-  /* "pgenlib.pyx":1931
+  /* "pgenlib.pyx":2042
  *             self.append_dosages_batch_internal64(floatarr_batch)
  *         else:
  *             raise RuntimeError("Invalid append_dosages_batch() dosage array element type (float32 or float64 expected).")             # <<<<<<<<<<<<<<
  *         return
  * 
  */
-  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_u_Invalid_append_dosages_batch_dos); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1931, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__49);
-  __Pyx_GIVEREF(__pyx_tuple__49);
+  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_kp_u_Invalid_append_dosages_batch_dos); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 2042, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__52);
+  __Pyx_GIVEREF(__pyx_tuple__52);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__50 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(1, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__50);
-  __Pyx_GIVEREF(__pyx_tuple__50);
+  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(1, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__53);
+  __Pyx_GIVEREF(__pyx_tuple__53);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(1, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__51);
-  __Pyx_GIVEREF(__pyx_tuple__51);
+  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(1, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__54);
+  __Pyx_GIVEREF(__pyx_tuple__54);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":945
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(2, 945, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__52);
-  __Pyx_GIVEREF(__pyx_tuple__52);
+  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(2, 945, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__55);
+  __Pyx_GIVEREF(__pyx_tuple__55);
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":951
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(2, 951, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__53);
-  __Pyx_GIVEREF(__pyx_tuple__53);
+  __pyx_tuple__56 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(2, 951, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__56);
+  __Pyx_GIVEREF(__pyx_tuple__56);
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -34510,14 +37397,35 @@
 static int __Pyx_modinit_type_init_code(void) {
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
+  __pyx_vtabptr_7pgenlib_PvarReader = &__pyx_vtable_7pgenlib_PvarReader;
+  __pyx_vtable_7pgenlib_PvarReader.__pyx___enter__ = (PyObject *(*)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PvarReader___enter__;
+  __pyx_vtable_7pgenlib_PvarReader.get_variant_ct = (PyObject *(*)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PvarReader_get_variant_ct;
+  __pyx_vtable_7pgenlib_PvarReader.get_variant_id = (PyObject *(*)(struct __pyx_obj_7pgenlib_PvarReader *, uint32_t, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PvarReader_get_variant_id;
+  __pyx_vtable_7pgenlib_PvarReader.get_allele_ct = (PyObject *(*)(struct __pyx_obj_7pgenlib_PvarReader *, uint32_t, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PvarReader_get_allele_ct;
+  __pyx_vtable_7pgenlib_PvarReader.get_allele_code = (PyObject *(*)(struct __pyx_obj_7pgenlib_PvarReader *, uint32_t, uint32_t, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PvarReader_get_allele_code;
+  __pyx_vtable_7pgenlib_PvarReader.get_allele_idx_offsets = (PyObject *(*)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PvarReader_get_allele_idx_offsets;
+  __pyx_vtable_7pgenlib_PvarReader.get_max_allele_ct = (PyObject *(*)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PvarReader_get_max_allele_ct;
+  __pyx_vtable_7pgenlib_PvarReader.close = (PyObject *(*)(struct __pyx_obj_7pgenlib_PvarReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PvarReader_close;
+  __pyx_vtable_7pgenlib_PvarReader.__pyx___exit__ = (PyObject *(*)(struct __pyx_obj_7pgenlib_PvarReader *, PyObject *, PyObject *, PyObject *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PvarReader___exit__;
+  if (PyType_Ready(&__pyx_type_7pgenlib_PvarReader) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
+  #if PY_VERSION_HEX < 0x030800B1
+  __pyx_type_7pgenlib_PvarReader.tp_print = 0;
+  #endif
+  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_7pgenlib_PvarReader.tp_dictoffset && __pyx_type_7pgenlib_PvarReader.tp_getattro == PyObject_GenericGetAttr)) {
+    __pyx_type_7pgenlib_PvarReader.tp_getattro = __Pyx_PyObject_GenericGetAttr;
+  }
+  if (__Pyx_SetVtable(__pyx_type_7pgenlib_PvarReader.tp_dict, __pyx_vtabptr_7pgenlib_PvarReader) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_PvarReader, (PyObject *)&__pyx_type_7pgenlib_PvarReader) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_7pgenlib_PvarReader) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
+  __pyx_ptype_7pgenlib_PvarReader = &__pyx_type_7pgenlib_PvarReader;
   __pyx_vtabptr_7pgenlib_PgenReader = &__pyx_vtable_7pgenlib_PgenReader;
   __pyx_vtable_7pgenlib_PgenReader.set_allele_idx_offsets_internal = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, PyArrayObject *))__pyx_f_7pgenlib_10PgenReader_set_allele_idx_offsets_internal;
   __pyx_vtable_7pgenlib_PgenReader.set_sample_subset_internal = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, PyArrayObject *))__pyx_f_7pgenlib_10PgenReader_set_sample_subset_internal;
   __pyx_vtable_7pgenlib_PgenReader.__pyx___enter__ = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenReader___enter__;
   __pyx_vtable_7pgenlib_PgenReader.get_raw_sample_ct = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenReader_get_raw_sample_ct;
   __pyx_vtable_7pgenlib_PgenReader.get_variant_ct = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenReader_get_variant_ct;
   __pyx_vtable_7pgenlib_PgenReader.hardcall_phase_present = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenReader_hardcall_phase_present;
@@ -34543,24 +37451,24 @@
   __pyx_vtable_7pgenlib_PgenReader.read_dosages_list_internal32 = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, PyArrayObject *, PyArrayObject *, struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages_list_internal32 *__pyx_optional_args))__pyx_f_7pgenlib_10PgenReader_read_dosages_list_internal32;
   __pyx_vtable_7pgenlib_PgenReader.read_dosages_list_internal64 = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, PyArrayObject *, PyArrayObject *, struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages_list_internal64 *__pyx_optional_args))__pyx_f_7pgenlib_10PgenReader_read_dosages_list_internal64;
   __pyx_vtable_7pgenlib_PgenReader.read_dosages_list = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, PyArrayObject *, PyArrayObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_7pgenlib_10PgenReader_read_dosages_list *__pyx_optional_args))__pyx_f_7pgenlib_10PgenReader_read_dosages_list;
   __pyx_vtable_7pgenlib_PgenReader.count = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, uint32_t, PyArrayObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_7pgenlib_10PgenReader_count *__pyx_optional_args))__pyx_f_7pgenlib_10PgenReader_count;
   __pyx_vtable_7pgenlib_PgenReader.change_sample_subset = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, int __pyx_skip_dispatch, struct __pyx_opt_args_7pgenlib_10PgenReader_change_sample_subset *__pyx_optional_args))__pyx_f_7pgenlib_10PgenReader_change_sample_subset;
   __pyx_vtable_7pgenlib_PgenReader.close = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenReader_close;
   __pyx_vtable_7pgenlib_PgenReader.__pyx___exit__ = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenReader *, PyObject *, PyObject *, PyObject *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenReader___exit__;
-  if (PyType_Ready(&__pyx_type_7pgenlib_PgenReader) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_7pgenlib_PgenReader) < 0) __PYX_ERR(0, 330, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_7pgenlib_PgenReader.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_7pgenlib_PgenReader.tp_dictoffset && __pyx_type_7pgenlib_PgenReader.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_7pgenlib_PgenReader.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_SetVtable(__pyx_type_7pgenlib_PgenReader.tp_dict, __pyx_vtabptr_7pgenlib_PgenReader) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_PgenReader, (PyObject *)&__pyx_type_7pgenlib_PgenReader) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_7pgenlib_PgenReader) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_7pgenlib_PgenReader.tp_dict, __pyx_vtabptr_7pgenlib_PgenReader) < 0) __PYX_ERR(0, 330, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_PgenReader, (PyObject *)&__pyx_type_7pgenlib_PgenReader) < 0) __PYX_ERR(0, 330, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_7pgenlib_PgenReader) < 0) __PYX_ERR(0, 330, __pyx_L1_error)
   __pyx_ptype_7pgenlib_PgenReader = &__pyx_type_7pgenlib_PgenReader;
   __pyx_vtabptr_7pgenlib_PgenWriter = &__pyx_vtable_7pgenlib_PgenWriter;
   __pyx_vtable_7pgenlib_PgenWriter.__pyx___enter__ = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenWriter___enter__;
   __pyx_vtable_7pgenlib_PgenWriter.append_biallelic = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyArrayObject *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenWriter_append_biallelic;
   __pyx_vtable_7pgenlib_PgenWriter.append_alleles = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyArrayObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_7pgenlib_10PgenWriter_append_alleles *__pyx_optional_args))__pyx_f_7pgenlib_10PgenWriter_append_alleles;
   __pyx_vtable_7pgenlib_PgenWriter.append_partially_phased = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyArrayObject *, PyArrayObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_7pgenlib_10PgenWriter_append_partially_phased *__pyx_optional_args))__pyx_f_7pgenlib_10PgenWriter_append_partially_phased;
   __pyx_vtable_7pgenlib_PgenWriter.append_dosages_internal32 = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyArrayObject *))__pyx_f_7pgenlib_10PgenWriter_append_dosages_internal32;
@@ -34570,24 +37478,24 @@
   __pyx_vtable_7pgenlib_PgenWriter.append_alleles_batch = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyArrayObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_7pgenlib_10PgenWriter_append_alleles_batch *__pyx_optional_args))__pyx_f_7pgenlib_10PgenWriter_append_alleles_batch;
   __pyx_vtable_7pgenlib_PgenWriter.append_partially_phased_batch = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyArrayObject *, PyArrayObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_7pgenlib_10PgenWriter_append_partially_phased_batch *__pyx_optional_args))__pyx_f_7pgenlib_10PgenWriter_append_partially_phased_batch;
   __pyx_vtable_7pgenlib_PgenWriter.append_dosages_batch_internal32 = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyArrayObject *))__pyx_f_7pgenlib_10PgenWriter_append_dosages_batch_internal32;
   __pyx_vtable_7pgenlib_PgenWriter.append_dosages_batch_internal64 = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyArrayObject *))__pyx_f_7pgenlib_10PgenWriter_append_dosages_batch_internal64;
   __pyx_vtable_7pgenlib_PgenWriter.append_dosages_batch = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyArrayObject *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenWriter_append_dosages_batch;
   __pyx_vtable_7pgenlib_PgenWriter.close = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenWriter_close;
   __pyx_vtable_7pgenlib_PgenWriter.__pyx___exit__ = (PyObject *(*)(struct __pyx_obj_7pgenlib_PgenWriter *, PyObject *, PyObject *, PyObject *, int __pyx_skip_dispatch))__pyx_f_7pgenlib_10PgenWriter___exit__;
-  if (PyType_Ready(&__pyx_type_7pgenlib_PgenWriter) < 0) __PYX_ERR(0, 1524, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_7pgenlib_PgenWriter) < 0) __PYX_ERR(0, 1635, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_7pgenlib_PgenWriter.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_7pgenlib_PgenWriter.tp_dictoffset && __pyx_type_7pgenlib_PgenWriter.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_7pgenlib_PgenWriter.tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
-  if (__Pyx_SetVtable(__pyx_type_7pgenlib_PgenWriter.tp_dict, __pyx_vtabptr_7pgenlib_PgenWriter) < 0) __PYX_ERR(0, 1524, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_PgenWriter, (PyObject *)&__pyx_type_7pgenlib_PgenWriter) < 0) __PYX_ERR(0, 1524, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_7pgenlib_PgenWriter) < 0) __PYX_ERR(0, 1524, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_7pgenlib_PgenWriter.tp_dict, __pyx_vtabptr_7pgenlib_PgenWriter) < 0) __PYX_ERR(0, 1635, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_PgenWriter, (PyObject *)&__pyx_type_7pgenlib_PgenWriter) < 0) __PYX_ERR(0, 1635, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_7pgenlib_PgenWriter) < 0) __PYX_ERR(0, 1635, __pyx_L1_error)
   __pyx_ptype_7pgenlib_PgenWriter = &__pyx_type_7pgenlib_PgenWriter;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
@@ -34913,15 +37821,15 @@
  * from libc.stdint cimport int64_t, uintptr_t, uint32_t, int32_t, uint16_t, uint8_t, int8_t
  */
   __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-h4atrljl/lib/python3.10/site-packages/numpy/__init__.pxd":1014
+  /* "../../../../private/var/folders/hw/lw9w89gj5jncz6_gcyh0kj1m0000gn/T/build-env-qwq2j01k/lib/python3.10/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -34991,14 +37899,707 @@
 #else
             "name '%.200s' is not defined", PyString_AS_STRING(name));
 #endif
     }
     return result;
 }
 
+/* RaiseDoubleKeywords */
+static void __Pyx_RaiseDoubleKeywordsError(
+    const char* func_name,
+    PyObject* kw_name)
+{
+    PyErr_Format(PyExc_TypeError,
+        #if PY_MAJOR_VERSION >= 3
+        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
+        #else
+        "%s() got multiple values for keyword argument '%s'", func_name,
+        PyString_AsString(kw_name));
+        #endif
+}
+
+/* ParseKeywords */
+static int __Pyx_ParseOptionalKeywords(
+    PyObject *kwds,
+    PyObject **argnames[],
+    PyObject *kwds2,
+    PyObject *values[],
+    Py_ssize_t num_pos_args,
+    const char* function_name)
+{
+    PyObject *key = 0, *value = 0;
+    Py_ssize_t pos = 0;
+    PyObject*** name;
+    PyObject*** first_kw_arg = argnames + num_pos_args;
+    while (PyDict_Next(kwds, &pos, &key, &value)) {
+        name = first_kw_arg;
+        while (*name && (**name != key)) name++;
+        if (*name) {
+            values[name-argnames] = value;
+            continue;
+        }
+        name = first_kw_arg;
+        #if PY_MAJOR_VERSION < 3
+        if (likely(PyString_Check(key))) {
+            while (*name) {
+                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
+                        && _PyString_Eq(**name, key)) {
+                    values[name-argnames] = value;
+                    break;
+                }
+                name++;
+            }
+            if (*name) continue;
+            else {
+                PyObject*** argname = argnames;
+                while (argname != first_kw_arg) {
+                    if ((**argname == key) || (
+                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
+                             && _PyString_Eq(**argname, key))) {
+                        goto arg_passed_twice;
+                    }
+                    argname++;
+                }
+            }
+        } else
+        #endif
+        if (likely(PyUnicode_Check(key))) {
+            while (*name) {
+                int cmp = (**name == key) ? 0 :
+                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
+                    (__Pyx_PyUnicode_GET_LENGTH(**name) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
+                #endif
+                    PyUnicode_Compare(**name, key);
+                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
+                if (cmp == 0) {
+                    values[name-argnames] = value;
+                    break;
+                }
+                name++;
+            }
+            if (*name) continue;
+            else {
+                PyObject*** argname = argnames;
+                while (argname != first_kw_arg) {
+                    int cmp = (**argname == key) ? 0 :
+                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
+                        (__Pyx_PyUnicode_GET_LENGTH(**argname) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
+                    #endif
+                        PyUnicode_Compare(**argname, key);
+                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
+                    if (cmp == 0) goto arg_passed_twice;
+                    argname++;
+                }
+            }
+        } else
+            goto invalid_keyword_type;
+        if (kwds2) {
+            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
+        } else {
+            goto invalid_keyword;
+        }
+    }
+    return 0;
+arg_passed_twice:
+    __Pyx_RaiseDoubleKeywordsError(function_name, key);
+    goto bad;
+invalid_keyword_type:
+    PyErr_Format(PyExc_TypeError,
+        "%.200s() keywords must be strings", function_name);
+    goto bad;
+invalid_keyword:
+    PyErr_Format(PyExc_TypeError,
+    #if PY_MAJOR_VERSION < 3
+        "%.200s() got an unexpected keyword argument '%.200s'",
+        function_name, PyString_AsString(key));
+    #else
+        "%s() got an unexpected keyword argument '%U'",
+        function_name, key);
+    #endif
+bad:
+    return -1;
+}
+
+/* RaiseArgTupleInvalid */
+static void __Pyx_RaiseArgtupleInvalid(
+    const char* func_name,
+    int exact,
+    Py_ssize_t num_min,
+    Py_ssize_t num_max,
+    Py_ssize_t num_found)
+{
+    Py_ssize_t num_expected;
+    const char *more_or_less;
+    if (num_found < num_min) {
+        num_expected = num_min;
+        more_or_less = "at least";
+    } else {
+        num_expected = num_max;
+        more_or_less = "at most";
+    }
+    if (exact) {
+        more_or_less = "exactly";
+    }
+    PyErr_Format(PyExc_TypeError,
+                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
+                 func_name, more_or_less, num_expected,
+                 (num_expected == 1) ? "" : "s", num_found);
+}
+
+/* ArgTypeTest */
+static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact)
+{
+    if (unlikely(!type)) {
+        PyErr_SetString(PyExc_SystemError, "Missing type object");
+        return 0;
+    }
+    else if (exact) {
+        #if PY_MAJOR_VERSION == 2
+        if ((type == &PyBaseString_Type) && likely(__Pyx_PyBaseString_CheckExact(obj))) return 1;
+        #endif
+    }
+    else {
+        if (likely(__Pyx_TypeCheck(obj, type))) return 1;
+    }
+    PyErr_Format(PyExc_TypeError,
+        "Argument '%.200s' has incorrect type (expected %.200s, got %.200s)",
+        name, type->tp_name, Py_TYPE(obj)->tp_name);
+    return 0;
+}
+
+/* PyCFunctionFastCall */
+#if CYTHON_FAST_PYCCALL
+static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
+    PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
+    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
+    PyObject *self = PyCFunction_GET_SELF(func);
+    int flags = PyCFunction_GET_FLAGS(func);
+    assert(PyCFunction_Check(func));
+    assert(METH_FASTCALL == (flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS | METH_STACKLESS)));
+    assert(nargs >= 0);
+    assert(nargs == 0 || args != NULL);
+    /* _PyCFunction_FastCallDict() must not be called with an exception set,
+       because it may clear it (directly or indirectly) and so the
+       caller loses its exception */
+    assert(!PyErr_Occurred());
+    if ((PY_VERSION_HEX < 0x030700A0) || unlikely(flags & METH_KEYWORDS)) {
+        return (*((__Pyx_PyCFunctionFastWithKeywords)(void*)meth)) (self, args, nargs, NULL);
+    } else {
+        return (*((__Pyx_PyCFunctionFast)(void*)meth)) (self, args, nargs);
+    }
+}
+#endif
+
+/* PyFunctionFastCall */
+#if CYTHON_FAST_PYCALL
+static PyObject* __Pyx_PyFunction_FastCallNoKw(PyCodeObject *co, PyObject **args, Py_ssize_t na,
+                                               PyObject *globals) {
+    PyFrameObject *f;
+    PyThreadState *tstate = __Pyx_PyThreadState_Current;
+    PyObject **fastlocals;
+    Py_ssize_t i;
+    PyObject *result;
+    assert(globals != NULL);
+    /* XXX Perhaps we should create a specialized
+       PyFrame_New() that doesn't take locals, but does
+       take builtins without sanity checking them.
+       */
+    assert(tstate != NULL);
+    f = PyFrame_New(tstate, co, globals, NULL);
+    if (f == NULL) {
+        return NULL;
+    }
+    fastlocals = __Pyx_PyFrame_GetLocalsplus(f);
+    for (i = 0; i < na; i++) {
+        Py_INCREF(*args);
+        fastlocals[i] = *args++;
+    }
+    result = PyEval_EvalFrameEx(f,0);
+    ++tstate->recursion_depth;
+    Py_DECREF(f);
+    --tstate->recursion_depth;
+    return result;
+}
+#if 1 || PY_VERSION_HEX < 0x030600B1
+static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject **args, Py_ssize_t nargs, PyObject *kwargs) {
+    PyCodeObject *co = (PyCodeObject *)PyFunction_GET_CODE(func);
+    PyObject *globals = PyFunction_GET_GLOBALS(func);
+    PyObject *argdefs = PyFunction_GET_DEFAULTS(func);
+    PyObject *closure;
+#if PY_MAJOR_VERSION >= 3
+    PyObject *kwdefs;
+#endif
+    PyObject *kwtuple, **k;
+    PyObject **d;
+    Py_ssize_t nd;
+    Py_ssize_t nk;
+    PyObject *result;
+    assert(kwargs == NULL || PyDict_Check(kwargs));
+    nk = kwargs ? PyDict_Size(kwargs) : 0;
+    if (Py_EnterRecursiveCall((char*)" while calling a Python object")) {
+        return NULL;
+    }
+    if (
+#if PY_MAJOR_VERSION >= 3
+            co->co_kwonlyargcount == 0 &&
+#endif
+            likely(kwargs == NULL || nk == 0) &&
+            co->co_flags == (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)) {
+        if (argdefs == NULL && co->co_argcount == nargs) {
+            result = __Pyx_PyFunction_FastCallNoKw(co, args, nargs, globals);
+            goto done;
+        }
+        else if (nargs == 0 && argdefs != NULL
+                 && co->co_argcount == Py_SIZE(argdefs)) {
+            /* function called with no arguments, but all parameters have
+               a default value: use default values as arguments .*/
+            args = &PyTuple_GET_ITEM(argdefs, 0);
+            result =__Pyx_PyFunction_FastCallNoKw(co, args, Py_SIZE(argdefs), globals);
+            goto done;
+        }
+    }
+    if (kwargs != NULL) {
+        Py_ssize_t pos, i;
+        kwtuple = PyTuple_New(2 * nk);
+        if (kwtuple == NULL) {
+            result = NULL;
+            goto done;
+        }
+        k = &PyTuple_GET_ITEM(kwtuple, 0);
+        pos = i = 0;
+        while (PyDict_Next(kwargs, &pos, &k[i], &k[i+1])) {
+            Py_INCREF(k[i]);
+            Py_INCREF(k[i+1]);
+            i += 2;
+        }
+        nk = i / 2;
+    }
+    else {
+        kwtuple = NULL;
+        k = NULL;
+    }
+    closure = PyFunction_GET_CLOSURE(func);
+#if PY_MAJOR_VERSION >= 3
+    kwdefs = PyFunction_GET_KW_DEFAULTS(func);
+#endif
+    if (argdefs != NULL) {
+        d = &PyTuple_GET_ITEM(argdefs, 0);
+        nd = Py_SIZE(argdefs);
+    }
+    else {
+        d = NULL;
+        nd = 0;
+    }
+#if PY_MAJOR_VERSION >= 3
+    result = PyEval_EvalCodeEx((PyObject*)co, globals, (PyObject *)NULL,
+                               args, (int)nargs,
+                               k, (int)nk,
+                               d, (int)nd, kwdefs, closure);
+#else
+    result = PyEval_EvalCodeEx(co, globals, (PyObject *)NULL,
+                               args, (int)nargs,
+                               k, (int)nk,
+                               d, (int)nd, closure);
+#endif
+    Py_XDECREF(kwtuple);
+done:
+    Py_LeaveRecursiveCall();
+    return result;
+}
+#endif
+#endif
+
+/* PyObjectCall */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
+    PyObject *result;
+    ternaryfunc call = Py_TYPE(func)->tp_call;
+    if (unlikely(!call))
+        return PyObject_Call(func, arg, kw);
+    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
+        return NULL;
+    result = (*call)(func, arg, kw);
+    Py_LeaveRecursiveCall();
+    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
+        PyErr_SetString(
+            PyExc_SystemError,
+            "NULL result without error in PyObject_Call");
+    }
+    return result;
+}
+#endif
+
+/* PyObjectCallMethO */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
+    PyObject *self, *result;
+    PyCFunction cfunc;
+    cfunc = PyCFunction_GET_FUNCTION(func);
+    self = PyCFunction_GET_SELF(func);
+    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
+        return NULL;
+    result = cfunc(self, arg);
+    Py_LeaveRecursiveCall();
+    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
+        PyErr_SetString(
+            PyExc_SystemError,
+            "NULL result without error in PyObject_Call");
+    }
+    return result;
+}
+#endif
+
+/* PyObjectCallOneArg */
+#if CYTHON_COMPILING_IN_CPYTHON
+static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
+    PyObject *result;
+    PyObject *args = PyTuple_New(1);
+    if (unlikely(!args)) return NULL;
+    Py_INCREF(arg);
+    PyTuple_SET_ITEM(args, 0, arg);
+    result = __Pyx_PyObject_Call(func, args, NULL);
+    Py_DECREF(args);
+    return result;
+}
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
+#if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(func)) {
+        return __Pyx_PyFunction_FastCall(func, &arg, 1);
+    }
+#endif
+    if (likely(PyCFunction_Check(func))) {
+        if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
+            return __Pyx_PyObject_CallMethO(func, arg);
+#if CYTHON_FAST_PYCCALL
+        } else if (__Pyx_PyFastCFunction_Check(func)) {
+            return __Pyx_PyCFunction_FastCall(func, &arg, 1);
+#endif
+        }
+    }
+    return __Pyx__PyObject_CallOneArg(func, arg);
+}
+#else
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
+    PyObject *result;
+    PyObject *args = PyTuple_Pack(1, arg);
+    if (unlikely(!args)) return NULL;
+    result = __Pyx_PyObject_Call(func, args, NULL);
+    Py_DECREF(args);
+    return result;
+}
+#endif
+
+/* PyErrFetchRestore */
+#if CYTHON_FAST_THREAD_STATE
+static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
+    PyObject *tmp_type, *tmp_value, *tmp_tb;
+    tmp_type = tstate->curexc_type;
+    tmp_value = tstate->curexc_value;
+    tmp_tb = tstate->curexc_traceback;
+    tstate->curexc_type = type;
+    tstate->curexc_value = value;
+    tstate->curexc_traceback = tb;
+    Py_XDECREF(tmp_type);
+    Py_XDECREF(tmp_value);
+    Py_XDECREF(tmp_tb);
+}
+static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
+    *type = tstate->curexc_type;
+    *value = tstate->curexc_value;
+    *tb = tstate->curexc_traceback;
+    tstate->curexc_type = 0;
+    tstate->curexc_value = 0;
+    tstate->curexc_traceback = 0;
+}
+#endif
+
+/* RaiseException */
+#if PY_MAJOR_VERSION < 3
+static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
+                        CYTHON_UNUSED PyObject *cause) {
+    __Pyx_PyThreadState_declare
+    Py_XINCREF(type);
+    if (!value || value == Py_None)
+        value = NULL;
+    else
+        Py_INCREF(value);
+    if (!tb || tb == Py_None)
+        tb = NULL;
+    else {
+        Py_INCREF(tb);
+        if (!PyTraceBack_Check(tb)) {
+            PyErr_SetString(PyExc_TypeError,
+                "raise: arg 3 must be a traceback or None");
+            goto raise_error;
+        }
+    }
+    if (PyType_Check(type)) {
+#if CYTHON_COMPILING_IN_PYPY
+        if (!value) {
+            Py_INCREF(Py_None);
+            value = Py_None;
+        }
+#endif
+        PyErr_NormalizeException(&type, &value, &tb);
+    } else {
+        if (value) {
+            PyErr_SetString(PyExc_TypeError,
+                "instance exception may not have a separate value");
+            goto raise_error;
+        }
+        value = type;
+        type = (PyObject*) Py_TYPE(type);
+        Py_INCREF(type);
+        if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
+            PyErr_SetString(PyExc_TypeError,
+                "raise: exception class must be a subclass of BaseException");
+            goto raise_error;
+        }
+    }
+    __Pyx_PyThreadState_assign
+    __Pyx_ErrRestore(type, value, tb);
+    return;
+raise_error:
+    Py_XDECREF(value);
+    Py_XDECREF(type);
+    Py_XDECREF(tb);
+    return;
+}
+#else
+static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
+    PyObject* owned_instance = NULL;
+    if (tb == Py_None) {
+        tb = 0;
+    } else if (tb && !PyTraceBack_Check(tb)) {
+        PyErr_SetString(PyExc_TypeError,
+            "raise: arg 3 must be a traceback or None");
+        goto bad;
+    }
+    if (value == Py_None)
+        value = 0;
+    if (PyExceptionInstance_Check(type)) {
+        if (value) {
+            PyErr_SetString(PyExc_TypeError,
+                "instance exception may not have a separate value");
+            goto bad;
+        }
+        value = type;
+        type = (PyObject*) Py_TYPE(value);
+    } else if (PyExceptionClass_Check(type)) {
+        PyObject *instance_class = NULL;
+        if (value && PyExceptionInstance_Check(value)) {
+            instance_class = (PyObject*) Py_TYPE(value);
+            if (instance_class != type) {
+                int is_subclass = PyObject_IsSubclass(instance_class, type);
+                if (!is_subclass) {
+                    instance_class = NULL;
+                } else if (unlikely(is_subclass == -1)) {
+                    goto bad;
+                } else {
+                    type = instance_class;
+                }
+            }
+        }
+        if (!instance_class) {
+            PyObject *args;
+            if (!value)
+                args = PyTuple_New(0);
+            else if (PyTuple_Check(value)) {
+                Py_INCREF(value);
+                args = value;
+            } else
+                args = PyTuple_Pack(1, value);
+            if (!args)
+                goto bad;
+            owned_instance = PyObject_Call(type, args, NULL);
+            Py_DECREF(args);
+            if (!owned_instance)
+                goto bad;
+            value = owned_instance;
+            if (!PyExceptionInstance_Check(value)) {
+                PyErr_Format(PyExc_TypeError,
+                             "calling %R should have returned an instance of "
+                             "BaseException, not %R",
+                             type, Py_TYPE(value));
+                goto bad;
+            }
+        }
+    } else {
+        PyErr_SetString(PyExc_TypeError,
+            "raise: exception class must be a subclass of BaseException");
+        goto bad;
+    }
+    if (cause) {
+        PyObject *fixed_cause;
+        if (cause == Py_None) {
+            fixed_cause = NULL;
+        } else if (PyExceptionClass_Check(cause)) {
+            fixed_cause = PyObject_CallObject(cause, NULL);
+            if (fixed_cause == NULL)
+                goto bad;
+        } else if (PyExceptionInstance_Check(cause)) {
+            fixed_cause = cause;
+            Py_INCREF(fixed_cause);
+        } else {
+            PyErr_SetString(PyExc_TypeError,
+                            "exception causes must derive from "
+                            "BaseException");
+            goto bad;
+        }
+        PyException_SetCause(value, fixed_cause);
+    }
+    PyErr_SetObject(type, value);
+    if (tb) {
+#if CYTHON_FAST_THREAD_STATE
+        PyThreadState *tstate = __Pyx_PyThreadState_Current;
+        PyObject* tmp_tb = tstate->curexc_traceback;
+        if (tb != tmp_tb) {
+            Py_INCREF(tb);
+            tstate->curexc_traceback = tb;
+            Py_XDECREF(tmp_tb);
+        }
+#else
+        PyObject *tmp_type, *tmp_value, *tmp_tb;
+        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
+        Py_INCREF(tb);
+        PyErr_Restore(tmp_type, tmp_value, tb);
+        Py_XDECREF(tmp_tb);
+#endif
+    }
+bad:
+    Py_XDECREF(owned_instance);
+    return;
+}
+#endif
+
+/* PyDictVersioning */
+#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
+static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
+    PyObject *dict = Py_TYPE(obj)->tp_dict;
+    return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
+}
+static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
+    PyObject **dictptr = NULL;
+    Py_ssize_t offset = Py_TYPE(obj)->tp_dictoffset;
+    if (offset) {
+#if CYTHON_COMPILING_IN_CPYTHON
+        dictptr = (likely(offset > 0)) ? (PyObject **) ((char *)obj + offset) : _PyObject_GetDictPtr(obj);
+#else
+        dictptr = _PyObject_GetDictPtr(obj);
+#endif
+    }
+    return (dictptr && *dictptr) ? __PYX_GET_DICT_VERSION(*dictptr) : 0;
+}
+static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version) {
+    PyObject *dict = Py_TYPE(obj)->tp_dict;
+    if (unlikely(!dict) || unlikely(tp_dict_version != __PYX_GET_DICT_VERSION(dict)))
+        return 0;
+    return obj_dict_version == __Pyx_get_object_dict_version(obj);
+}
+#endif
+
+/* PyObjectCallNoArg */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
+#if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(func)) {
+        return __Pyx_PyFunction_FastCall(func, NULL, 0);
+    }
+#endif
+#if defined(__Pyx_CyFunction_USED) && defined(NDEBUG)
+    if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
+#else
+    if (likely(PyCFunction_Check(func)))
+#endif
+    {
+        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
+            return __Pyx_PyObject_CallMethO(func, NULL);
+        }
+    }
+    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
+}
+#endif
+
+/* PyObjectCall2Args */
+static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
+    PyObject *args, *result = NULL;
+    #if CYTHON_FAST_PYCALL
+    if (PyFunction_Check(function)) {
+        PyObject *args[2] = {arg1, arg2};
+        return __Pyx_PyFunction_FastCall(function, args, 2);
+    }
+    #endif
+    #if CYTHON_FAST_PYCCALL
+    if (__Pyx_PyFastCFunction_Check(function)) {
+        PyObject *args[2] = {arg1, arg2};
+        return __Pyx_PyCFunction_FastCall(function, args, 2);
+    }
+    #endif
+    args = PyTuple_New(2);
+    if (unlikely(!args)) goto done;
+    Py_INCREF(arg1);
+    PyTuple_SET_ITEM(args, 0, arg1);
+    Py_INCREF(arg2);
+    PyTuple_SET_ITEM(args, 1, arg2);
+    Py_INCREF(function);
+    result = __Pyx_PyObject_Call(function, args, NULL);
+    Py_DECREF(args);
+    Py_DECREF(function);
+done:
+    return result;
+}
+
+/* GetModuleGlobalName */
+#if CYTHON_USE_DICT_VERSIONS
+static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value)
+#else
+static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name)
+#endif
+{
+    PyObject *result;
+#if !CYTHON_AVOID_BORROWED_REFS
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1
+    result = _PyDict_GetItem_KnownHash(__pyx_d, name, ((PyASCIIObject *) name)->hash);
+    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
+    if (likely(result)) {
+        return __Pyx_NewRef(result);
+    } else if (unlikely(PyErr_Occurred())) {
+        return NULL;
+    }
+#else
+    result = PyDict_GetItem(__pyx_d, name);
+    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
+    if (likely(result)) {
+        return __Pyx_NewRef(result);
+    }
+#endif
+#else
+    result = PyObject_GetItem(__pyx_d, name);
+    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
+    if (likely(result)) {
+        return __Pyx_NewRef(result);
+    }
+    PyErr_Clear();
+#endif
+    return __Pyx_GetBuiltinName(name);
+}
+
+/* ExtTypeTest */
+static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
+    if (unlikely(!type)) {
+        PyErr_SetString(PyExc_SystemError, "Missing type object");
+        return 0;
+    }
+    if (likely(__Pyx_TypeCheck(obj, type)))
+        return 1;
+    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
+                 Py_TYPE(obj)->tp_name, type->tp_name);
+    return 0;
+}
+
 /* IsLittleEndian */
 static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
 {
   union {
     uint32_t u32;
     uint8_t u8[4];
   } S;
@@ -35557,686 +39158,89 @@
 
 /* BufferIndexError */
   static void __Pyx_RaiseBufferIndexError(int axis) {
   PyErr_Format(PyExc_IndexError,
      "Out of bounds on buffer access (axis %d)", axis);
 }
 
-/* PyErrFetchRestore */
-  #if CYTHON_FAST_THREAD_STATE
-static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
-    PyObject *tmp_type, *tmp_value, *tmp_tb;
-    tmp_type = tstate->curexc_type;
-    tmp_value = tstate->curexc_value;
-    tmp_tb = tstate->curexc_traceback;
-    tstate->curexc_type = type;
-    tstate->curexc_value = value;
-    tstate->curexc_traceback = tb;
-    Py_XDECREF(tmp_type);
-    Py_XDECREF(tmp_value);
-    Py_XDECREF(tmp_tb);
-}
-static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
-    *type = tstate->curexc_type;
-    *value = tstate->curexc_value;
-    *tb = tstate->curexc_traceback;
-    tstate->curexc_type = 0;
-    tstate->curexc_value = 0;
-    tstate->curexc_traceback = 0;
-}
-#endif
-
-/* PyObjectCall */
-  #if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
-    PyObject *result;
-    ternaryfunc call = Py_TYPE(func)->tp_call;
-    if (unlikely(!call))
-        return PyObject_Call(func, arg, kw);
-    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
-        return NULL;
-    result = (*call)(func, arg, kw);
-    Py_LeaveRecursiveCall();
-    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
-        PyErr_SetString(
-            PyExc_SystemError,
-            "NULL result without error in PyObject_Call");
-    }
-    return result;
-}
-#endif
-
-/* RaiseException */
-  #if PY_MAJOR_VERSION < 3
-static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
-                        CYTHON_UNUSED PyObject *cause) {
-    __Pyx_PyThreadState_declare
-    Py_XINCREF(type);
-    if (!value || value == Py_None)
-        value = NULL;
-    else
-        Py_INCREF(value);
-    if (!tb || tb == Py_None)
-        tb = NULL;
-    else {
-        Py_INCREF(tb);
-        if (!PyTraceBack_Check(tb)) {
-            PyErr_SetString(PyExc_TypeError,
-                "raise: arg 3 must be a traceback or None");
-            goto raise_error;
-        }
-    }
-    if (PyType_Check(type)) {
-#if CYTHON_COMPILING_IN_PYPY
-        if (!value) {
-            Py_INCREF(Py_None);
-            value = Py_None;
-        }
-#endif
-        PyErr_NormalizeException(&type, &value, &tb);
-    } else {
-        if (value) {
-            PyErr_SetString(PyExc_TypeError,
-                "instance exception may not have a separate value");
-            goto raise_error;
-        }
-        value = type;
-        type = (PyObject*) Py_TYPE(type);
-        Py_INCREF(type);
-        if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
-            PyErr_SetString(PyExc_TypeError,
-                "raise: exception class must be a subclass of BaseException");
-            goto raise_error;
-        }
-    }
-    __Pyx_PyThreadState_assign
-    __Pyx_ErrRestore(type, value, tb);
-    return;
-raise_error:
-    Py_XDECREF(value);
-    Py_XDECREF(type);
-    Py_XDECREF(tb);
-    return;
-}
-#else
-static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
-    PyObject* owned_instance = NULL;
-    if (tb == Py_None) {
-        tb = 0;
-    } else if (tb && !PyTraceBack_Check(tb)) {
-        PyErr_SetString(PyExc_TypeError,
-            "raise: arg 3 must be a traceback or None");
-        goto bad;
+/* PyIntCompare */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED long inplace) {
+    if (op1 == op2) {
+        Py_RETURN_TRUE;
     }
-    if (value == Py_None)
-        value = 0;
-    if (PyExceptionInstance_Check(type)) {
-        if (value) {
-            PyErr_SetString(PyExc_TypeError,
-                "instance exception may not have a separate value");
-            goto bad;
-        }
-        value = type;
-        type = (PyObject*) Py_TYPE(value);
-    } else if (PyExceptionClass_Check(type)) {
-        PyObject *instance_class = NULL;
-        if (value && PyExceptionInstance_Check(value)) {
-            instance_class = (PyObject*) Py_TYPE(value);
-            if (instance_class != type) {
-                int is_subclass = PyObject_IsSubclass(instance_class, type);
-                if (!is_subclass) {
-                    instance_class = NULL;
-                } else if (unlikely(is_subclass == -1)) {
-                    goto bad;
-                } else {
-                    type = instance_class;
-                }
-            }
-        }
-        if (!instance_class) {
-            PyObject *args;
-            if (!value)
-                args = PyTuple_New(0);
-            else if (PyTuple_Check(value)) {
-                Py_INCREF(value);
-                args = value;
-            } else
-                args = PyTuple_Pack(1, value);
-            if (!args)
-                goto bad;
-            owned_instance = PyObject_Call(type, args, NULL);
-            Py_DECREF(args);
-            if (!owned_instance)
-                goto bad;
-            value = owned_instance;
-            if (!PyExceptionInstance_Check(value)) {
-                PyErr_Format(PyExc_TypeError,
-                             "calling %R should have returned an instance of "
-                             "BaseException, not %R",
-                             type, Py_TYPE(value));
-                goto bad;
-            }
-        }
-    } else {
-        PyErr_SetString(PyExc_TypeError,
-            "raise: exception class must be a subclass of BaseException");
-        goto bad;
+    #if PY_MAJOR_VERSION < 3
+    if (likely(PyInt_CheckExact(op1))) {
+        const long b = intval;
+        long a = PyInt_AS_LONG(op1);
+        if (a == b) Py_RETURN_TRUE; else Py_RETURN_FALSE;
     }
-    if (cause) {
-        PyObject *fixed_cause;
-        if (cause == Py_None) {
-            fixed_cause = NULL;
-        } else if (PyExceptionClass_Check(cause)) {
-            fixed_cause = PyObject_CallObject(cause, NULL);
-            if (fixed_cause == NULL)
-                goto bad;
-        } else if (PyExceptionInstance_Check(cause)) {
-            fixed_cause = cause;
-            Py_INCREF(fixed_cause);
+    #endif
+    #if CYTHON_USE_PYLONG_INTERNALS
+    if (likely(PyLong_CheckExact(op1))) {
+        int unequal;
+        unsigned long uintval;
+        Py_ssize_t size = Py_SIZE(op1);
+        const digit* digits = ((PyLongObject*)op1)->ob_digit;
+        if (intval == 0) {
+            if (size == 0) Py_RETURN_TRUE; else Py_RETURN_FALSE;
+        } else if (intval < 0) {
+            if (size >= 0)
+                Py_RETURN_FALSE;
+            intval = -intval;
+            size = -size;
         } else {
-            PyErr_SetString(PyExc_TypeError,
-                            "exception causes must derive from "
-                            "BaseException");
-            goto bad;
-        }
-        PyException_SetCause(value, fixed_cause);
-    }
-    PyErr_SetObject(type, value);
-    if (tb) {
-#if CYTHON_FAST_THREAD_STATE
-        PyThreadState *tstate = __Pyx_PyThreadState_Current;
-        PyObject* tmp_tb = tstate->curexc_traceback;
-        if (tb != tmp_tb) {
-            Py_INCREF(tb);
-            tstate->curexc_traceback = tb;
-            Py_XDECREF(tmp_tb);
-        }
-#else
-        PyObject *tmp_type, *tmp_value, *tmp_tb;
-        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
-        Py_INCREF(tb);
-        PyErr_Restore(tmp_type, tmp_value, tb);
-        Py_XDECREF(tmp_tb);
-#endif
-    }
-bad:
-    Py_XDECREF(owned_instance);
-    return;
-}
-#endif
-
-/* PyCFunctionFastCall */
-  #if CYTHON_FAST_PYCCALL
-static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
-    PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
-    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
-    PyObject *self = PyCFunction_GET_SELF(func);
-    int flags = PyCFunction_GET_FLAGS(func);
-    assert(PyCFunction_Check(func));
-    assert(METH_FASTCALL == (flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS | METH_STACKLESS)));
-    assert(nargs >= 0);
-    assert(nargs == 0 || args != NULL);
-    /* _PyCFunction_FastCallDict() must not be called with an exception set,
-       because it may clear it (directly or indirectly) and so the
-       caller loses its exception */
-    assert(!PyErr_Occurred());
-    if ((PY_VERSION_HEX < 0x030700A0) || unlikely(flags & METH_KEYWORDS)) {
-        return (*((__Pyx_PyCFunctionFastWithKeywords)(void*)meth)) (self, args, nargs, NULL);
-    } else {
-        return (*((__Pyx_PyCFunctionFast)(void*)meth)) (self, args, nargs);
-    }
-}
-#endif
-
-/* PyFunctionFastCall */
-  #if CYTHON_FAST_PYCALL
-static PyObject* __Pyx_PyFunction_FastCallNoKw(PyCodeObject *co, PyObject **args, Py_ssize_t na,
-                                               PyObject *globals) {
-    PyFrameObject *f;
-    PyThreadState *tstate = __Pyx_PyThreadState_Current;
-    PyObject **fastlocals;
-    Py_ssize_t i;
-    PyObject *result;
-    assert(globals != NULL);
-    /* XXX Perhaps we should create a specialized
-       PyFrame_New() that doesn't take locals, but does
-       take builtins without sanity checking them.
-       */
-    assert(tstate != NULL);
-    f = PyFrame_New(tstate, co, globals, NULL);
-    if (f == NULL) {
-        return NULL;
-    }
-    fastlocals = __Pyx_PyFrame_GetLocalsplus(f);
-    for (i = 0; i < na; i++) {
-        Py_INCREF(*args);
-        fastlocals[i] = *args++;
-    }
-    result = PyEval_EvalFrameEx(f,0);
-    ++tstate->recursion_depth;
-    Py_DECREF(f);
-    --tstate->recursion_depth;
-    return result;
-}
-#if 1 || PY_VERSION_HEX < 0x030600B1
-static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject **args, Py_ssize_t nargs, PyObject *kwargs) {
-    PyCodeObject *co = (PyCodeObject *)PyFunction_GET_CODE(func);
-    PyObject *globals = PyFunction_GET_GLOBALS(func);
-    PyObject *argdefs = PyFunction_GET_DEFAULTS(func);
-    PyObject *closure;
-#if PY_MAJOR_VERSION >= 3
-    PyObject *kwdefs;
-#endif
-    PyObject *kwtuple, **k;
-    PyObject **d;
-    Py_ssize_t nd;
-    Py_ssize_t nk;
-    PyObject *result;
-    assert(kwargs == NULL || PyDict_Check(kwargs));
-    nk = kwargs ? PyDict_Size(kwargs) : 0;
-    if (Py_EnterRecursiveCall((char*)" while calling a Python object")) {
-        return NULL;
-    }
-    if (
-#if PY_MAJOR_VERSION >= 3
-            co->co_kwonlyargcount == 0 &&
-#endif
-            likely(kwargs == NULL || nk == 0) &&
-            co->co_flags == (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)) {
-        if (argdefs == NULL && co->co_argcount == nargs) {
-            result = __Pyx_PyFunction_FastCallNoKw(co, args, nargs, globals);
-            goto done;
-        }
-        else if (nargs == 0 && argdefs != NULL
-                 && co->co_argcount == Py_SIZE(argdefs)) {
-            /* function called with no arguments, but all parameters have
-               a default value: use default values as arguments .*/
-            args = &PyTuple_GET_ITEM(argdefs, 0);
-            result =__Pyx_PyFunction_FastCallNoKw(co, args, Py_SIZE(argdefs), globals);
-            goto done;
-        }
-    }
-    if (kwargs != NULL) {
-        Py_ssize_t pos, i;
-        kwtuple = PyTuple_New(2 * nk);
-        if (kwtuple == NULL) {
-            result = NULL;
-            goto done;
-        }
-        k = &PyTuple_GET_ITEM(kwtuple, 0);
-        pos = i = 0;
-        while (PyDict_Next(kwargs, &pos, &k[i], &k[i+1])) {
-            Py_INCREF(k[i]);
-            Py_INCREF(k[i+1]);
-            i += 2;
+            if (size <= 0)
+                Py_RETURN_FALSE;
         }
-        nk = i / 2;
-    }
-    else {
-        kwtuple = NULL;
-        k = NULL;
-    }
-    closure = PyFunction_GET_CLOSURE(func);
-#if PY_MAJOR_VERSION >= 3
-    kwdefs = PyFunction_GET_KW_DEFAULTS(func);
-#endif
-    if (argdefs != NULL) {
-        d = &PyTuple_GET_ITEM(argdefs, 0);
-        nd = Py_SIZE(argdefs);
-    }
-    else {
-        d = NULL;
-        nd = 0;
-    }
-#if PY_MAJOR_VERSION >= 3
-    result = PyEval_EvalCodeEx((PyObject*)co, globals, (PyObject *)NULL,
-                               args, (int)nargs,
-                               k, (int)nk,
-                               d, (int)nd, kwdefs, closure);
-#else
-    result = PyEval_EvalCodeEx(co, globals, (PyObject *)NULL,
-                               args, (int)nargs,
-                               k, (int)nk,
-                               d, (int)nd, closure);
-#endif
-    Py_XDECREF(kwtuple);
-done:
-    Py_LeaveRecursiveCall();
-    return result;
-}
-#endif
-#endif
-
-/* PyObjectCallMethO */
-  #if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
-    PyObject *self, *result;
-    PyCFunction cfunc;
-    cfunc = PyCFunction_GET_FUNCTION(func);
-    self = PyCFunction_GET_SELF(func);
-    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
-        return NULL;
-    result = cfunc(self, arg);
-    Py_LeaveRecursiveCall();
-    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
-        PyErr_SetString(
-            PyExc_SystemError,
-            "NULL result without error in PyObject_Call");
-    }
-    return result;
-}
-#endif
-
-/* PyObjectCallOneArg */
-  #if CYTHON_COMPILING_IN_CPYTHON
-static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
-    PyObject *result;
-    PyObject *args = PyTuple_New(1);
-    if (unlikely(!args)) return NULL;
-    Py_INCREF(arg);
-    PyTuple_SET_ITEM(args, 0, arg);
-    result = __Pyx_PyObject_Call(func, args, NULL);
-    Py_DECREF(args);
-    return result;
-}
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
-#if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(func)) {
-        return __Pyx_PyFunction_FastCall(func, &arg, 1);
-    }
-#endif
-    if (likely(PyCFunction_Check(func))) {
-        if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
-            return __Pyx_PyObject_CallMethO(func, arg);
-#if CYTHON_FAST_PYCCALL
-        } else if (__Pyx_PyFastCFunction_Check(func)) {
-            return __Pyx_PyCFunction_FastCall(func, &arg, 1);
+        uintval = (unsigned long) intval;
+#if PyLong_SHIFT * 4 < SIZEOF_LONG*8
+        if (uintval >> (PyLong_SHIFT * 4)) {
+            unequal = (size != 5) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
+                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[3] != ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[4] != ((uintval >> (4 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
+        } else
 #endif
-        }
-    }
-    return __Pyx__PyObject_CallOneArg(func, arg);
-}
-#else
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
-    PyObject *result;
-    PyObject *args = PyTuple_Pack(1, arg);
-    if (unlikely(!args)) return NULL;
-    result = __Pyx_PyObject_Call(func, args, NULL);
-    Py_DECREF(args);
-    return result;
-}
+#if PyLong_SHIFT * 3 < SIZEOF_LONG*8
+        if (uintval >> (PyLong_SHIFT * 3)) {
+            unequal = (size != 4) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
+                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[3] != ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
+        } else
 #endif
-
-/* RaiseDoubleKeywords */
-  static void __Pyx_RaiseDoubleKeywordsError(
-    const char* func_name,
-    PyObject* kw_name)
-{
-    PyErr_Format(PyExc_TypeError,
-        #if PY_MAJOR_VERSION >= 3
-        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
-        #else
-        "%s() got multiple values for keyword argument '%s'", func_name,
-        PyString_AsString(kw_name));
-        #endif
-}
-
-/* ParseKeywords */
-  static int __Pyx_ParseOptionalKeywords(
-    PyObject *kwds,
-    PyObject **argnames[],
-    PyObject *kwds2,
-    PyObject *values[],
-    Py_ssize_t num_pos_args,
-    const char* function_name)
-{
-    PyObject *key = 0, *value = 0;
-    Py_ssize_t pos = 0;
-    PyObject*** name;
-    PyObject*** first_kw_arg = argnames + num_pos_args;
-    while (PyDict_Next(kwds, &pos, &key, &value)) {
-        name = first_kw_arg;
-        while (*name && (**name != key)) name++;
-        if (*name) {
-            values[name-argnames] = value;
-            continue;
-        }
-        name = first_kw_arg;
-        #if PY_MAJOR_VERSION < 3
-        if (likely(PyString_Check(key))) {
-            while (*name) {
-                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
-                        && _PyString_Eq(**name, key)) {
-                    values[name-argnames] = value;
-                    break;
-                }
-                name++;
-            }
-            if (*name) continue;
-            else {
-                PyObject*** argname = argnames;
-                while (argname != first_kw_arg) {
-                    if ((**argname == key) || (
-                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
-                             && _PyString_Eq(**argname, key))) {
-                        goto arg_passed_twice;
-                    }
-                    argname++;
-                }
-            }
+#if PyLong_SHIFT * 2 < SIZEOF_LONG*8
+        if (uintval >> (PyLong_SHIFT * 2)) {
+            unequal = (size != 3) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
+                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK)) | (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
         } else
-        #endif
-        if (likely(PyUnicode_Check(key))) {
-            while (*name) {
-                int cmp = (**name == key) ? 0 :
-                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                    (__Pyx_PyUnicode_GET_LENGTH(**name) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
-                #endif
-                    PyUnicode_Compare(**name, key);
-                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
-                if (cmp == 0) {
-                    values[name-argnames] = value;
-                    break;
-                }
-                name++;
-            }
-            if (*name) continue;
-            else {
-                PyObject*** argname = argnames;
-                while (argname != first_kw_arg) {
-                    int cmp = (**argname == key) ? 0 :
-                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                        (__Pyx_PyUnicode_GET_LENGTH(**argname) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
-                    #endif
-                        PyUnicode_Compare(**argname, key);
-                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
-                    if (cmp == 0) goto arg_passed_twice;
-                    argname++;
-                }
-            }
+#endif
+#if PyLong_SHIFT * 1 < SIZEOF_LONG*8
+        if (uintval >> (PyLong_SHIFT * 1)) {
+            unequal = (size != 2) || (digits[0] != (uintval & (unsigned long) PyLong_MASK))
+                 | (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long) PyLong_MASK));
         } else
-            goto invalid_keyword_type;
-        if (kwds2) {
-            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
-        } else {
-            goto invalid_keyword;
-        }
+#endif
+            unequal = (size != 1) || (((unsigned long) digits[0]) != (uintval & (unsigned long) PyLong_MASK));
+        if (unequal == 0) Py_RETURN_TRUE; else Py_RETURN_FALSE;
     }
-    return 0;
-arg_passed_twice:
-    __Pyx_RaiseDoubleKeywordsError(function_name, key);
-    goto bad;
-invalid_keyword_type:
-    PyErr_Format(PyExc_TypeError,
-        "%.200s() keywords must be strings", function_name);
-    goto bad;
-invalid_keyword:
-    PyErr_Format(PyExc_TypeError,
-    #if PY_MAJOR_VERSION < 3
-        "%.200s() got an unexpected keyword argument '%.200s'",
-        function_name, PyString_AsString(key));
-    #else
-        "%s() got an unexpected keyword argument '%U'",
-        function_name, key);
     #endif
-bad:
-    return -1;
-}
-
-/* RaiseArgTupleInvalid */
-  static void __Pyx_RaiseArgtupleInvalid(
-    const char* func_name,
-    int exact,
-    Py_ssize_t num_min,
-    Py_ssize_t num_max,
-    Py_ssize_t num_found)
-{
-    Py_ssize_t num_expected;
-    const char *more_or_less;
-    if (num_found < num_min) {
-        num_expected = num_min;
-        more_or_less = "at least";
-    } else {
-        num_expected = num_max;
-        more_or_less = "at most";
-    }
-    if (exact) {
-        more_or_less = "exactly";
-    }
-    PyErr_Format(PyExc_TypeError,
-                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                 func_name, more_or_less, num_expected,
-                 (num_expected == 1) ? "" : "s", num_found);
-}
-
-/* ArgTypeTest */
-  static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact)
-{
-    if (unlikely(!type)) {
-        PyErr_SetString(PyExc_SystemError, "Missing type object");
-        return 0;
-    }
-    else if (exact) {
-        #if PY_MAJOR_VERSION == 2
-        if ((type == &PyBaseString_Type) && likely(__Pyx_PyBaseString_CheckExact(obj))) return 1;
-        #endif
-    }
-    else {
-        if (likely(__Pyx_TypeCheck(obj, type))) return 1;
-    }
-    PyErr_Format(PyExc_TypeError,
-        "Argument '%.200s' has incorrect type (expected %.200s, got %.200s)",
-        name, type->tp_name, Py_TYPE(obj)->tp_name);
-    return 0;
-}
-
-/* ExtTypeTest */
-  static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
-    if (unlikely(!type)) {
-        PyErr_SetString(PyExc_SystemError, "Missing type object");
-        return 0;
+    if (PyFloat_CheckExact(op1)) {
+        const long b = intval;
+        double a = PyFloat_AS_DOUBLE(op1);
+        if ((double)a == (double)b) Py_RETURN_TRUE; else Py_RETURN_FALSE;
     }
-    if (likely(__Pyx_TypeCheck(obj, type)))
-        return 1;
-    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
-                 Py_TYPE(obj)->tp_name, type->tp_name);
-    return 0;
+    return (
+        PyObject_RichCompare(op1, op2, Py_EQ));
 }
 
 /* DivInt[long] */
   static CYTHON_INLINE long __Pyx_div_long(long a, long b) {
     long q = a / b;
     long r = a - q*b;
     q -= ((r != 0) & ((r ^ b) < 0));
     return q;
 }
 
-/* PyDictVersioning */
-  #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
-    PyObject *dict = Py_TYPE(obj)->tp_dict;
-    return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
-}
-static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
-    PyObject **dictptr = NULL;
-    Py_ssize_t offset = Py_TYPE(obj)->tp_dictoffset;
-    if (offset) {
-#if CYTHON_COMPILING_IN_CPYTHON
-        dictptr = (likely(offset > 0)) ? (PyObject **) ((char *)obj + offset) : _PyObject_GetDictPtr(obj);
-#else
-        dictptr = _PyObject_GetDictPtr(obj);
-#endif
-    }
-    return (dictptr && *dictptr) ? __PYX_GET_DICT_VERSION(*dictptr) : 0;
-}
-static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version) {
-    PyObject *dict = Py_TYPE(obj)->tp_dict;
-    if (unlikely(!dict) || unlikely(tp_dict_version != __PYX_GET_DICT_VERSION(dict)))
-        return 0;
-    return obj_dict_version == __Pyx_get_object_dict_version(obj);
-}
-#endif
-
-/* PyObjectCallNoArg */
-  #if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
-#if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(func)) {
-        return __Pyx_PyFunction_FastCall(func, NULL, 0);
-    }
-#endif
-#if defined(__Pyx_CyFunction_USED) && defined(NDEBUG)
-    if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
-#else
-    if (likely(PyCFunction_Check(func)))
-#endif
-    {
-        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
-            return __Pyx_PyObject_CallMethO(func, NULL);
-        }
-    }
-    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
-}
-#endif
-
-/* GetModuleGlobalName */
-  #if CYTHON_USE_DICT_VERSIONS
-static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value)
-#else
-static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name)
-#endif
-{
-    PyObject *result;
-#if !CYTHON_AVOID_BORROWED_REFS
-#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1
-    result = _PyDict_GetItem_KnownHash(__pyx_d, name, ((PyASCIIObject *) name)->hash);
-    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
-    if (likely(result)) {
-        return __Pyx_NewRef(result);
-    } else if (unlikely(PyErr_Occurred())) {
-        return NULL;
-    }
-#else
-    result = PyDict_GetItem(__pyx_d, name);
-    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
-    if (likely(result)) {
-        return __Pyx_NewRef(result);
-    }
-#endif
-#else
-    result = PyObject_GetItem(__pyx_d, name);
-    __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
-    if (likely(result)) {
-        return __Pyx_NewRef(result);
-    }
-    PyErr_Clear();
-#endif
-    return __Pyx_GetBuiltinName(name);
-}
-
 /* ModInt[long] */
   static CYTHON_INLINE long __Pyx_mod_long(long a, long b) {
     long r = a % b;
     r += ((r != 0) & ((r ^ b) < 0)) * b;
     return r;
 }
 
@@ -36427,43 +39431,14 @@
         double a = PyFloat_AS_DOUBLE(op1);
         if ((double)a != (double)b) Py_RETURN_TRUE; else Py_RETURN_FALSE;
     }
     return (
         PyObject_RichCompare(op1, op2, Py_NE));
 }
 
-/* PyObjectCall2Args */
-  static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
-    PyObject *args, *result = NULL;
-    #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(function)) {
-        PyObject *args[2] = {arg1, arg2};
-        return __Pyx_PyFunction_FastCall(function, args, 2);
-    }
-    #endif
-    #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(function)) {
-        PyObject *args[2] = {arg1, arg2};
-        return __Pyx_PyCFunction_FastCall(function, args, 2);
-    }
-    #endif
-    args = PyTuple_New(2);
-    if (unlikely(!args)) goto done;
-    Py_INCREF(arg1);
-    PyTuple_SET_ITEM(args, 0, arg1);
-    Py_INCREF(arg2);
-    PyTuple_SET_ITEM(args, 1, arg2);
-    Py_INCREF(function);
-    result = __Pyx_PyObject_Call(function, args, NULL);
-    Py_DECREF(args);
-    Py_DECREF(function);
-done:
-    return result;
-}
-
 /* GetItemInt */
   static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
     PyObject *r;
     if (!j) return NULL;
     r = PyObject_GetItem(o, j);
     Py_DECREF(j);
     return r;
@@ -37852,85 +40827,85 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to uint32_t");
     return (uint32_t) -1;
 }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_uint32(npy_uint32 value) {
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_uint32_t(uint32_t value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const npy_uint32 neg_one = (npy_uint32) -1, const_zero = (npy_uint32) 0;
+    const uint32_t neg_one = (uint32_t) -1, const_zero = (uint32_t) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
-        if (sizeof(npy_uint32) < sizeof(long)) {
+        if (sizeof(uint32_t) < sizeof(long)) {
             return PyInt_FromLong((long) value);
-        } else if (sizeof(npy_uint32) <= sizeof(unsigned long)) {
+        } else if (sizeof(uint32_t) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(npy_uint32) <= sizeof(unsigned PY_LONG_LONG)) {
+        } else if (sizeof(uint32_t) <= sizeof(unsigned PY_LONG_LONG)) {
             return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
 #endif
         }
     } else {
-        if (sizeof(npy_uint32) <= sizeof(long)) {
+        if (sizeof(uint32_t) <= sizeof(long)) {
             return PyInt_FromLong((long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(npy_uint32) <= sizeof(PY_LONG_LONG)) {
+        } else if (sizeof(uint32_t) <= sizeof(PY_LONG_LONG)) {
             return PyLong_FromLongLong((PY_LONG_LONG) value);
 #endif
         }
     }
     {
         int one = 1; int little = (int)*(unsigned char *)&one;
         unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(npy_uint32),
+        return _PyLong_FromByteArray(bytes, sizeof(uint32_t),
                                      little, !is_unsigned);
     }
 }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_uint32_t(uint32_t value) {
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_uint32(npy_uint32 value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const uint32_t neg_one = (uint32_t) -1, const_zero = (uint32_t) 0;
+    const npy_uint32 neg_one = (npy_uint32) -1, const_zero = (npy_uint32) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
-        if (sizeof(uint32_t) < sizeof(long)) {
+        if (sizeof(npy_uint32) < sizeof(long)) {
             return PyInt_FromLong((long) value);
-        } else if (sizeof(uint32_t) <= sizeof(unsigned long)) {
+        } else if (sizeof(npy_uint32) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(uint32_t) <= sizeof(unsigned PY_LONG_LONG)) {
+        } else if (sizeof(npy_uint32) <= sizeof(unsigned PY_LONG_LONG)) {
             return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
 #endif
         }
     } else {
-        if (sizeof(uint32_t) <= sizeof(long)) {
+        if (sizeof(npy_uint32) <= sizeof(long)) {
             return PyInt_FromLong((long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(uint32_t) <= sizeof(PY_LONG_LONG)) {
+        } else if (sizeof(npy_uint32) <= sizeof(PY_LONG_LONG)) {
             return PyLong_FromLongLong((PY_LONG_LONG) value);
 #endif
         }
     }
     {
         int one = 1; int little = (int)*(unsigned char *)&one;
         unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(uint32_t),
+        return _PyLong_FromByteArray(bytes, sizeof(npy_uint32),
                                      little, !is_unsigned);
     }
 }
 
 /* CIntToPy */
   static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
```

### Comparing `Pgenlib-0.83.0/src/pgenlib/pgenlib.pyx` & `Pgenlib-0.90.0/src/pgenlib/pgenlib.pyx`

 * *Files 2% similar despite different names*

```diff
@@ -115,14 +115,32 @@
         kPglMaxAlleleCt
     cdef enum:
         kPglMaxVariantCt
 
     uintptr_t PglComputeMaxAlleleCt(const uintptr_t* allele_idx_offsets, uint32_t variant_ct)
 
 
+cdef extern from "../plink2/pvar_ffi_support.h" namespace "plink2":
+
+    cdef struct RefcountedWptrStruct:
+        uintptr_t ref_ct
+        uintptr_t p[0]
+
+    cdef struct MinimalPvarStruct:
+        const char** variant_ids
+        const char** allele_storage
+        RefcountedWptrStruct* allele_idx_offsetsp
+        uint32_t variant_ct
+        uint32_t max_allele_ct
+
+    void PreinitMinimalPvar(MinimalPvarStruct* mpp)
+    PglErr LoadMinimalPvar(const char* fname, MinimalPvarStruct* mpp, char* errstr_buf)
+    void CleanupMinimalPvar(MinimalPvarStruct* mpp)
+
+
 cdef extern from "../plink2/pgenlib_ffi_support.h" namespace "plink2":
 
     void GenoarrToBytesMinus9(const uintptr_t* genoarr, uint32_t sample_ct, int8_t* genobytes)
     void GenoarrToInt32sMinus9(const uintptr_t* genoarr, uint32_t sample_ct, int32_t* geno_int32)
     void GenoarrToInt64sMinus9(const uintptr_t* genoarr, uint32_t sample_ct, int64_t* geno_int64)
     void GenoarrMPToAlleleCodesMinus9(const PgenVariantStruct* pgv, uint32_t sample_ct, unsigned char* phasebytes, int32_t* allele_codes)
     void GenoarrPhasedToHapCodes(const uintptr_t* genoarr, const uintptr_t* phaseinfo, uint32_t variant_batch_size, int32_t* hap0_codes_iter, int32_t* hap1_codes_iter)
@@ -220,14 +238,99 @@
     PglErr SpgwAppendBiallelicGenovecDosage16(const uintptr_t* genovec, const uintptr_t* dosage_present, const uint16_t* dosage_main, uint32_t dosage_ct, STPgenWriter* spgwp)
 
     PglErr SpgwFinish(STPgenWriter* spgwp)
 
     BoolErr CleanupSpgw(STPgenWriter* spgwp, PglErr* reterrp)
 
 
+cdef class PvarReader:
+    cdef MinimalPvarStruct _mp
+
+    def __cinit__(self, bytes filename):
+        PreinitMinimalPvar(&self._mp)
+        cdef const char* fname = <const char*>filename
+        cdef char errstr_buf[kPglErrstrBufBlen]
+        if LoadMinimalPvar(fname, &self._mp, errstr_buf) != kPglRetSuccess:
+            raise RuntimeError(errstr_buf[7:])
+        return
+
+
+    cpdef __enter__(self):
+        return self
+
+
+    cpdef get_variant_ct(self):
+        return self._mp.variant_ct
+
+
+    cpdef get_variant_id(self, uint32_t variant_idx):
+        cdef uint32_t variant_ct = self._mp.variant_ct
+        if variant_idx >= variant_ct:
+            raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+        cdef py_string = self._mp.variant_ids[variant_idx]
+        return py_string
+
+
+    cpdef get_allele_ct(self, uint32_t variant_idx):
+        cdef uint32_t variant_ct = self._mp.variant_ct
+        if variant_idx >= variant_ct:
+            raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+        if self._mp.allele_idx_offsetsp == NULL:
+            return 2
+        cdef const uintptr_t* allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+        return allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]
+
+
+    cpdef get_allele_code(self, uint32_t variant_idx, uint32_t allele_idx):
+        cdef uint32_t variant_ct = self._mp.variant_ct
+        if variant_idx >= variant_ct:
+            raise RuntimeError("0-based variant idx too large (" + str(variant_idx) + "; only " + str(variant_ct) + " in file).")
+        cdef uintptr_t allele_idx_offset_base = 2 * variant_idx
+        cdef uint32_t allele_ct = 2
+        cdef const uintptr_t* allele_idx_offsets
+        if self._mp.allele_idx_offsetsp != NULL:
+            allele_idx_offsets = self._mp.allele_idx_offsetsp.p
+            allele_idx_offset_base = allele_idx_offsets[variant_idx]
+            allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offset_base
+        if allele_idx >= allele_ct:
+            raise RuntimeError("0-based allele idx too large (" + str(allele_idx) + "; only " + str(allele_ct) + " for this variant).")
+        cdef bytes py_string = self._mp.allele_storage[allele_idx_offset_base + allele_idx]
+        return py_string
+
+
+    cpdef get_allele_idx_offsets(self):
+        cdef uint32_t variant_ct_p1 = 1 + self._mp.variant_ct
+        cdef np.ndarray[np.uintp_t,mode="c",ndim=1] allele_idx_offsets = np.zeros([variant_ct_p1], dtype=np.uintp)
+        if self._mp.allele_idx_offsetsp == NULL:
+            for variant_idx in range(variant_ct_p1):
+                allele_idx_offsets[variant_idx] = 2 * variant_idx
+        else:
+            memcpy(&(allele_idx_offsets[0]), self._mp.allele_idx_offsetsp.p, variant_ct_p1 * sizeof(uintptr_t))
+        return allele_idx_offsets
+
+
+    cpdef get_max_allele_ct(self):
+        return self._mp.max_allele_ct
+
+
+    cpdef close(self):
+        CleanupMinimalPvar(&self._mp)
+        return
+
+
+    cpdef __exit__(self, exc_type, exc_val, exc_tb):
+        self.close()
+        return
+
+
+    def __dealloc__(self):
+        CleanupMinimalPvar(&self._mp)
+        return
+
+
 cdef class PgenReader:
     cdef PgenFileInfo* _info_ptr
     cdef PgenReaderStruct* _state_ptr
     cdef uintptr_t* _subset_include_vec
     cdef uintptr_t* _subset_include_interleaved_vec
 
     cdef uint32_t* _subset_cumulative_popcounts
@@ -292,26 +395,36 @@
 
         self._subset_size = subset_size
         return
 
 
     def __cinit__(self, bytes filename, object raw_sample_ct = None,
                   object variant_ct = None, object sample_subset = None,
-                  object allele_idx_offsets = None):
+                  object allele_idx_offsets = None, object pvar = None):
         self._info_ptr = <PgenFileInfo*>PyMem_Malloc(sizeof(PgenFileInfo))
         if not self._info_ptr:
             raise MemoryError()
         PreinitPgfi(self._info_ptr)
         # this depends on pgenlib_internal implementation.  could save
         # pgfi_alloc and pgr_alloc instead.
         self._info_ptr[0].vrtypes = NULL
         cdef uint32_t cur_sample_ct = 0xffffffffU
         if raw_sample_ct is not None:
             cur_sample_ct = raw_sample_ct
         cdef uint32_t cur_variant_ct = 0xffffffffU
+        cdef PvarReader pr
+        if pvar is not None:
+            if (variant_ct is not None) or (allele_idx_offsets is not None):
+                raise RuntimeError("pvar cannot be specified at the same time as variant_ct and/or allele_idx_offsets")
+            pr = pvar
+            variant_ct = pr.get_variant_ct()
+            if pr.get_max_allele_ct() == 2:
+                allele_idx_offsets = None
+            else:
+                allele_idx_offsets = pr.get_allele_idx_offsets()
         if variant_ct is not None:
             cur_variant_ct = variant_ct
         cdef const char* fname = <const char*>filename
         cdef PgenHeaderCtrl header_ctrl
         cdef uintptr_t pgfi_alloc_cacheline_ct
         cdef char errstr_buf[kPglErrstrBufBlen]
         if PgfiInitPhase1(fname, NULL, cur_variant_ct, cur_sample_ct, &header_ctrl, self._info_ptr, &pgfi_alloc_cacheline_ct, errstr_buf) != kPglRetSuccess:
@@ -340,16 +453,14 @@
         cdef uint32_t max_vrec_width
         cdef uintptr_t pgr_alloc_cacheline_ct
         if PgfiInitPhase2(header_ctrl, 1, 0, 0, 0, file_variant_ct, &max_vrec_width, self._info_ptr, pgfi_alloc, &pgr_alloc_cacheline_ct, errstr_buf):
             if pgfi_alloc and not self._info_ptr[0].vrtypes:
                 aligned_free(pgfi_alloc)
             raise RuntimeError(errstr_buf[7:])
         if self._info_ptr[0].gflags & kfPgenGlobalMultiallelicHardcallFound:
-            # todo: support easy initialization of allele_idx_offsets by
-            # wrapping pvar loader the same way as the R interface
             if self._info_ptr[0].allele_idx_offsets == NULL:
                 raise RuntimeError("PgenReader: multiallelic variants present, but allele_idx_offsets not provided")
 
         self._state_ptr = <PgenReaderStruct*>PyMem_Malloc(sizeof(PgenReaderStruct))
         if not self._state_ptr:
             raise MemoryError()
         PreinitPgr(self._state_ptr)
@@ -1416,15 +1527,15 @@
             allele_ct = 2
             allele_idx_offsets = self._info_ptr[0].allele_idx_offsets
             if allele_idx_offsets != NULL:
                 allele_ct = allele_idx_offsets[variant_idx + 1] - allele_idx_offsets[variant_idx]
             if allele_ct > 2:
                 # Multiallelic special case.
                 type_ct = (allele_ct * (allele_ct + 1)) >> 1
-                if genocount_uint32_out.shape[0] <= type_ct:
+                if <uintptr_t>(genocount_uint32_out.shape[0]) <= type_ct:
                     raise RuntimeError("count() genocount_uint32_out buffer is too small for multiallelic variant")
                 reterr = PgrGetM(subset_include_vec, subset_index, subset_size, variant_idx, pgrp, &self._pgv)
                 if reterr != kPglRetSuccess:
                     raise RuntimeError("count() error " + str(reterr))
                 genovec = self._pgv.genovec
                 ZeroTrailingNyps(subset_size, genovec)
                 GenoarrCountFreqsUnsafe(genovec, subset_size, data_ptr)
```

### Comparing `Pgenlib-0.83.0/src/plink2/include/check.h` & `Pgenlib-0.90.0/src/plink2/include/check.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/debug-trap.h` & `Pgenlib-0.90.0/src/plink2/include/debug-trap.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/hedley.h` & `Pgenlib-0.90.0/src/plink2/include/hedley.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/pgenlib_misc.cc` & `Pgenlib-0.90.0/src/plink2/include/pgenlib_misc.cc`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/pgenlib_misc.h` & `Pgenlib-0.90.0/src/plink2/include/pgenlib_misc.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/pgenlib_read.cc` & `Pgenlib-0.90.0/src/plink2/include/pgenlib_read.cc`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/pgenlib_read.h` & `Pgenlib-0.90.0/src/plink2/include/pgenlib_read.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/pgenlib_write.cc` & `Pgenlib-0.90.0/src/plink2/include/pgenlib_write.cc`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/pgenlib_write.h` & `Pgenlib-0.90.0/src/plink2/include/pgenlib_write.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/plink2_base.cc` & `Pgenlib-0.90.0/src/plink2/include/plink2_base.cc`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/plink2_base.h` & `Pgenlib-0.90.0/src/plink2/include/plink2_base.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/plink2_bits.cc` & `Pgenlib-0.90.0/src/plink2/include/plink2_bits.cc`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/plink2_bits.h` & `Pgenlib-0.90.0/src/plink2/include/plink2_bits.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/simde-align.h` & `Pgenlib-0.90.0/src/plink2/include/simde-align.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/simde-arch.h` & `Pgenlib-0.90.0/src/plink2/include/simde-arch.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/simde-common.h` & `Pgenlib-0.90.0/src/plink2/include/simde-common.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/simde-constify.h` & `Pgenlib-0.90.0/src/plink2/include/simde-constify.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/simde-detect-clang.h` & `Pgenlib-0.90.0/src/plink2/include/simde-detect-clang.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/simde-diagnostic.h` & `Pgenlib-0.90.0/src/plink2/include/simde-diagnostic.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/simde-features.h` & `Pgenlib-0.90.0/src/plink2/include/simde-features.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/simde-math.h` & `Pgenlib-0.90.0/src/plink2/include/simde-math.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/x86/mmx.h` & `Pgenlib-0.90.0/src/plink2/include/x86/mmx.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/x86/sse.h` & `Pgenlib-0.90.0/src/plink2/include/x86/sse.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/include/x86/sse2.h` & `Pgenlib-0.90.0/src/plink2/include/x86/sse2.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/pgenlib_ffi_support.cc` & `Pgenlib-0.90.0/src/plink2/pgenlib_ffi_support.cc`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/src/plink2/pgenlib_ffi_support.h` & `Pgenlib-0.90.0/src/plink2/pgenlib_ffi_support.h`

 * *Files identical despite different names*

### Comparing `Pgenlib-0.83.0/tests/test_pgenlib.py` & `Pgenlib-0.90.0/tests/test_pgenlib.py`

 * *Files identical despite different names*

